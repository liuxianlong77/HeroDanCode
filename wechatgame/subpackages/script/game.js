window.__require=function t(e,i,n){function o(a,s){if(!i[a]){if(!e[a]){var h=a.split("/");if(h=h[h.length-1],!e[h]){var l="function"==typeof __require&&__require;if(!s&&l)return l(h,!0);if(r)return r(h,!0);throw new Error("Cannot find module '"+a+"'")}a=h}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){return o(e[a][1][t]||t)},c,c.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<n.length;a++)o(n[a]);return o}({BlackMap:[function(t,e,n){"use strict";cc._RF.push(e,"027edNMxy5OPqo/04YuL5GY","BlackMap");var o=cc.Class({extends:cc.Node,properties:{cFrame:0,currentFrame:{get:function(){return this.cFrame+1}},totalFrame:{get:function(){return this.frameArr.length}},isYMC:!0,frameArr:[],imgNode:cc.Node,actionObj:null,eventObj:null,tagObj:null,stageNode:cc.Node,frameNode:cc.Node,spriteArr:[],currentArr:[],rect:cc.Rect,revise:!0},Init:function(t,e,i,n,o,r,a,s,h,l){this.revise=l,this.stopBo=!1,this.offBo=!1,this.currActArr=null,this.name=e,this.frameArr=i,this.actionObj=n,this.eventObj=o,this.tagObj=a,this.spriteArr=s,this.cFrame=0,this.SpriteObj=h,this.rect=r,this.eventFunObj={},this.currentArr=this.frameArr[this.cFrame],this.parent=t,this.frameNode=new cc.Node,this.frameNode.parent=this,this.frameNode.addComponent(cc.Sprite),this.frameNode.anchorX=0,this.frameNode.anchorY=1,this.anchorX=0,this.anchorY=1,this.setSprite()},Init2:function(t,e,i,n){this.revise=n,this.stopBo=!1,this.offBo=!1,this.currActArr=null,this.spriteArr=e,this.cFrame=0,this.SpriteObj=i,this.rect=t,this.eventFunObj={},this.currentArr=this.frameArr[this.cFrame],this.setSprite()},onEventFun:function(){if(this.EventFrame!=this.cFrame&&(this.EventFrame=this.cFrame,null!=this.eventObj[this.cFrame]))for(var t in this.eventObj[this.cFrame])null!=this.eventObj[this.cFrame][t]?this.eventObj[this.cFrame][t]():this.dispatchEvent(new cc.Event.EventCustom(t,!1))},setEventFun:function(t,e,i){var n=t-1;null!=this.eventObj[n]&&this.eventObj[n].hasOwnProperty(e)&&(this.eventObj[n][e]=i)},addEventFun:function(t,e,i){var n=t-1;null==this.eventObj[n]&&(this.eventObj[n]={}),this.eventObj[n][e]=i},deleteEventFun:function(t,e){var i=t-1;null!=this.eventObj[i]&&this.eventObj[i].hasOwnProperty(e)&&delete this.eventObj[i][e]},deleteAllEventFun:function(t){var e=t-1;this.eventObj.hasOwnProperty(e)&&delete this.eventObj[e]},setFrame:function(t,e,i,n,o){if(this.stopBo=n,this.offBo=o,(0==i||null==i)&&null!=this.actionObj&&(this.currActArr=this.actionObj[0],null!=this.currActArr&&"stop"==this.currActArr[0]))return this.cFrame=0,this.onHitComponent(),this.currentArr=this.frameArr[this.cFrame],this.setActionObj(this.cFrame),this.setSprite(),void(this.EventFrame=this.cFrame);if(n||o||1==this.totalFrame)return 1==this.totalFrame?this.cFrame=0:this.cFrame=t,this.onHitComponent(),this.currentArr=this.frameArr[this.cFrame],this.setActionObj(this.cFrame),this.setSprite(),void(this.EventFrame=this.cFrame);var r=e-i;if(null==this.actionObj){var a=r%this.totalFrame;return t+a>=this.totalFrame?this.cFrame=t+a-this.totalFrame:this.cFrame=t+a,this.onHitComponent(),this.currentArr=this.frameArr[this.cFrame],this.setActionObj(this.cFrame),this.setSprite(),void this.onEventFun()}if(this.cFrame=t,r>=3*this.totalFrame&&r>50){var s={},h=i,l=[];this.setActionObj(this.cFrame);for(var c=0;c<3*this.totalFrame;c++)if(this.currentArr=this.frameArr[this.cFrame],this.cFrame=this.addFrame(),h++,l[l.length]=this.cFrame,null==s[this.cFrame])s[this.cFrame]=1;else if(s[this.cFrame]++,s[this.cFrame]>=3)for(var u=[],p=l.length-2;p>0;p--)if(u.unshift(l[p]),l[p]==this.cFrame){var d=(r=e-h)%u.length;this.cFrame=u[d],this.onHitComponent(),this.currentArr=this.frameArr[this.cFrame],this.setActionObj(this.cFrame),this.setSprite(),this.onEventFun(),c=4*this.totalFrame;break}}else{this.setActionObj(this.cFrame);for(var f=0;f<r;f++)this.cFrame=this.addFrame();this.onHitComponent(),this.currentArr=this.frameArr[this.cFrame],this.setActionObj(this.cFrame),this.setSprite(),this.onEventFun()}},setActionObj:function(t){null!=this.actionObj&&(this.currActArr=this.actionObj[t])},addFrame:function(){var t=this.cFrame;return this.stopBo?(t<0&&(t=0),t>=this.totalFrame&&(t=0),t):(null==this.actionObj?t++:null!=this.currActArr?"gotoAndStop"==this.currActArr[0]?(t!=this.currActArr[1]&&(this.currActArr[1]<this.totalFrame?t=this.currActArr[1]:(this.currActArr[1]=this.totalFrame-1,t=this.currActArr[1])),this.stopBo=!0,this.currActArr=null):"gotoAndPlay"==this.currActArr[0]?(t!=this.currActArr[1]&&(this.currActArr[1]<this.totalFrame?t=this.currActArr[1]:(this.currActArr[1]=this.totalFrame-1,t=this.currActArr[1])),this.currActArr=null,this.stopBo=!1):"stop"==this.currActArr[0]?this.stopBo=!0:"play"==this.currActArr[0]&&(this.stopBo=!1,t++):t++,t>=this.frameArr.length&&(t=0),this.setActionObj(t),t)},removeThis:function(){this.frameNode.getComponent(cc.Sprite).spriteFrame=null,this.parent=null,this.frameNode.parent=null,this.name="",this.frameArr=null,this.actionObj=null,this.eventObj=null,this.tagObj=null,this.spriteArr=null,this.cFrame=0,this.rect=null,this.SpriteObj=null,this.frameNode.destroy(),this.destroy()},gotoAndPlay:function(t){if(null!=t)if("number"==typeof t){if(t%1==0){var e=t-1;e>-1&&e<this.totalFrame&&(this.stopBo=!1,this.offBo=!1,this.cFrame=e,this.onHitComponent(),this.setActionObj(this.cFrame))}}else null!=this.tagObj[t]&&(this.stopBo=!1,this.offBo=!1,this.cFrame=this.tagObj[t],this.onHitComponent(),this.setActionObj(this.tagObj[t]))},gotoAndStop:function(t){if(null!=t)if("number"==typeof t){if(t%1==0){var e=t-1;e>-1&&e<this.totalFrame&&(this.stopBo=!0,this.offBo=!1,this.cFrame=e,this.onHitComponent(),this.setActionObj(this.cFrame))}}else null!=this.tagObj[t]&&(this.stopBo=!0,this.offBo=!1,this.cFrame=this.tagObj[t],this.onHitComponent(),this.setActionObj(this.tagObj[t]))},play:function(){this.stopBo=!1,this.offBo=!1,this.cFrame++;var t=this.cFrame+1;t<0&&(t=0),t>=this.totalFrame&&(t=0),this.cFrame=t,this.onHitComponent(),this.setActionObj(this.cFrame)},stop:function(){this.offBo=!0,this.stopBo=!0},getPraent:function(){return null!=this._y_parent?this._y_parent.parent:this.parent},getRect:function(){return this.rect},setSprite:function(){var t=this.frameNode.getComponent(cc.Sprite);this.currentArr.length>0?(t.spriteFrame=this.SpriteObj[this.spriteArr[this.currentArr[0]][0][1].Sprite.spriteFrame],this.frameNode.x=this.currentArr[1],this.frameNode.y=this.currentArr[2]):t.spriteFrame=null,this.revise&&(this.frameNode.width+=1,this.frameNode.height+=1)},startYMC:function(){this.offBo||(this.cFrame=this.addFrame(),this.onEventFun(),this.onHitComponent(),this.frameArr[this.cFrame]!=this.currentArr&&(this.currentArr=this.frameArr[this.cFrame],this.setSprite()))},onHitComponent:function(){if(null!=this.pz)for(var t=0;t<this.pz.length;t++)if(null!=this.pz[t][1][this.cFrame]){this.pz[t][0].enabled||(this.pz[t][0].enabled=!0);for(var e in this.pz[t][1][this.cFrame])this.pz[t][0][e]=this.pz[t][1][this.cFrame][e]}else this.pz[t][0].enabled&&(this.pz[t][0].enabled=!1)},setLocationFun:function(t,e){this.x=t,this.y=e}});cc.Class({extends:cc.Component,properties:{revise:{default:!0,tooltip:"\u5f53\u51fa\u73b0\u900f\u660e\u7f1d\u9699\u65f6\u53ef\u4ee5\u5f00\u542f\uff0c\u8be5\u5c5e\u6027\u4f1a\u9020\u6210\u6240\u6709\u56fe\u5757\u589e\u52a0\u4e00\u50cf\u7d20\u7684\u8ddd\u79bb\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u8854\u63a5\u95ee\u9898\uff0c\u6240\u4ee5\u672a\u51fa\u73b0\u95ee\u9898\u4ecb\u610f\u4e0d\u8981\u52a8"},SpriteObj:{default:{},visible:!1},nodeAllObj:{default:{},visible:!1},MapSprArr:{default:[],visible:!1},NodeIdArr:[],LayerArr:{default:[],visible:!1},FPS:{get:function(){return null==this._FPS&&(null!=this.FPS2?this._FPS=this.FPS2:this._FPS=25),this._FPS},set:function(t){if("number"==typeof t){var e=Math.floor(t);e<=100&&e>=1&&(null!=this._FPS?(null!=this.timDelay&&this.unschedule(this.timerFun),this._FPS=e,this.timDelay=1/this._FPS,this.schedule(this.timerFun,this.timDelay)):this._FPS=e)}},visible:!1},mapCameraNode:{get:function(){return this._mapCameraNode},set:function(t){this._mapCameraNode!=t&&(null==t?null!=this._mapCameraNode&&this._mapCameraNode.off("position-changed",this.onMapCamera,this):t.on("position-changed",this.onMapCamera,this),this._mapCameraNode=t)},visible:!1},BGObj:{get:function(){return this._BGObj},set:function(t){this._BGObj=t},visible:!1},viewOrg:{default:cc.v2(0,0)},viewSz:{default:cc.size(0,0)}},onLoad2:function(){this.viewOrg=cc.v2(cc.view.getVisibleOrigin().x-200,cc.view.getVisibleOrigin().y-200),this.viewSz=cc.size(cc.view.getVisibleSize().width+400,cc.view.getVisibleSize().height+400),this.LocObj={},this.isHit={},this.isTop={},this.timInt=0,this.pointObj={},this.stageRectObj={},this.showNodeObj={},this.stageNodeObj={},this.LoadBo=!1,this.onSrpiteFun(),this.ymcStageArr=[],this.MapMcArr={},this.ymcFrameObj={},this.ymcTimInt=0,this.mcPool={},null==this.timDelay&&(this.timDelay=1/this.FPS,this.schedule(this.timerFun,this.timDelay))},timerFun:function(){this.timInt+=this.timDelay;for(var t=0;t<this.ymcStageArr.length;t++)this.ymcStageArr[t].startYMC();this.ymcTimInt++},showAll:function(){this._showAllBo=!0},addAll:function(){console.log("\u6dfb\u52a0\u4e86");for(var t in this.nodeAllObj)for(var e=0;e<this.LayerArr.length;e++)if(this.LayerArr[e].LayerName==t){this.LayerArr[e].Position={};for(var i in this.nodeAllObj[t]){var n=this.nodeAllObj[t][i];this.addNodeChildFun(n[0],n[1]-this.flagPoint.x,n[2]-this.flagPoint.y,e,i)}}},setLocationFun:function(t,e,i,n){if(this.LoadBo&&!this._showAllBo&&(null==i&&(i="this"),"this"==i||null!=this.LayerNodeObj[i])){var o;null==this.pointObj[i]&&(this.pointObj[i]=new cc.Vec2(this.node.x-1,this.node.y-1)),o="this"==i?this.node:this.LayerNodeObj[i],null!=t&&(o.x=t),null!=e&&(o.y=e);var r=o.x,a=o.y;if(null!=this._mapCameraNode&&(r+=this._mapCameraNode.x,a+=this._mapCameraNode.y),this.pointObj[i].x!=r||this.pointObj[i].y!=a||n){var s=o.parent.convertToWorldSpaceAR(cc.v2(o.x,o.y)),h=this.node.scaleX,l=this.node.scaleY;null==this._mapCameraNode?this.AddMapChildFun(new cc.Rect((this.viewOrg.x-s.x)/h,(this.viewOrg.y-s.y)/l,this.viewSz.width/h,this.viewSz.height/l),i):this.AddMapChildFun(new cc.Rect((this.viewOrg.x-s.x+this._mapCameraNode.x)/h,(this.viewOrg.y-s.y+this._mapCameraNode.y)/l,this.viewSz.width/h,this.viewSz.height/l),i),this.pointObj[i].x=r,this.pointObj[i].y=a}}},onMapCamera:function(){this.setLocationFun()},scaleFun:function(t,e,i,n){if((this.node.scaleX!=i||this.node.scaleY!=n)&&(i>=.1||n>=.1)){var o=cc.v2((t-this.node.x)/this.node.scaleX,(e-this.node.y)/this.node.scaleY),r=cc.v2(t-o.x,e-o.y);this.node.scaleX=i,this.node.scaleY=n,this.setLocationFun(o.x*(this.node.scaleX-1)*-1+r.x,o.y*(this.node.scaleY-1)*-1+r.y,"this",!0)}},removeAll:function(){this.unschedule(this.timerFun);for(var t=0;t<this.LayerNodeArr.length;t++)this.LayerNodeArr[t].destroyAllChildren(),this.LayerNodeArr[t].parent=null,this.LayerNodeArr[t].destroy();for(var e=0;e<this.MapSprArr.length;e++)for(var i=this.MapSprArr[e][2],n=0;n<i.length;n++)i[n].destroy();for(var o in this.mcArr)for(var r=this.mcArr[o].pool,a=0;a<r.length;a++)r[a].removeThis();for(var s=0;s<this.killFrameArr.length;s++)this.killFrameArr[s].destroy();if(null!=this.killSprArr)for(var h=0;h<this.killSprArr.length;h++)cc.loader.releaseRes(this.killSprArr[0],cc.SpriteFrame);for(var l in this.nodeParentObj)null!=this.nodeParentObj[l][7]&&this.nodeParentObj[l][7].destroy();if(cc.loader.release(this.killArr),null!=this.pathFind&&this.node.removeComponent(this.pathFind),null!=this.BGObj){null!=this.BGObj.alt&&(cc.loader.releaseRes(this.BGObj.path+"/s"),this.BGObj.alt=null);for(var c in this.BGObj.sprite)cc.loader.releaseAsset(this.BGObj.sprite[c]);for(var u=0;u<this.BGObj.pool.length;u++)this.BGObj.pool[u].destroy();null!=this.BGNode&&(this.BGNode.destroy(),this.BGNode=null)}null!=this._mapCameraNode&&this._mapCameraNode.off("position-changed",this.onMapCamera,this),this.BGObj=null,this.mcArr=null,this.pathFind=null,this.PathGridObj=null,this.killFrameArr=null,this.nodeParentObj=null,this.SpriteObj=null,this.MapSprArr=null,this.LayerArr=null,this.LayerNodeArr=null,this.LayerNodeObj=null,this.stageRectObj=null,this.stageNodeObj=null,this.showNodeObj=null,this.killArr=null,this.killSprArr=null,this.LocObj=null,this.Loading=null,this.layerRect=null,this.Init=null,this.onLoadYMovieClip=null,this.onLoadSprite=null,this.onLoadSpriteParent=null,this.killSprite=null,this.killSpriteParent=null,this.killYMovieClip=null,this.ymcAllObj=null,this.ymcStageArr=null,this.MapMcArr=null,this.ymcFrameObj=null,this.ymcMapSprArr=null},getLayerRectFun:function(t){if(null!=t)return this.layerRect[t][0]},getLayerNodeFun:function(t){if(null!=t)return this.LayerNodeObj[t]},killNodePool:function(t){if(null!=t){for(var e=t.constructor==Number,n=0;n<this.MapSprArr.length;n++){var o=this.MapSprArr[n][2];if(e){var r=this.MapSprArr[n][3];if(this.timInt-r>t){for(var a=0;a<o.length;a++)o[n].destroy();this.MapSprArr[n][2]=[]}}else{if(this.MapSprArr[n][0]==t){for(var s=0;s<o.length;s++)o[n].destroy();this.MapSprArr[n][2]=[]}}}for(var h in this.mcPool){var l=this.mcPool[h].pool;if(e){var c=this.mcPool[h].timer;if(this.timInt-c>t){for(var u=0;u<l.length;u++)l[i].removeThis();this.mcPool[h].pool=[]}}else if(this.mcPool[h].name==t){for(var p=0;p<l.length;p++)l[i].removeThis();this.mcPool[h].pool=[]}}}},setSpriteFrame:function(t,e,i){if(null!=this.SpriteObj[t+"-"+e]){var n=this.SpriteObj[t+"-"+e];this.SpriteObj[t+"-"+e]=i;for(var o=0;o<this.LayerNodeArr.length;o++)for(var r=0;r<this.LayerNodeArr[o].childrenCount;r++){var a=this.LayerNodeArr[o].children[r].getComponent(cc.Sprite);null!=a&&a.spriteFrame==n&&(a.spriteFrame=i)}}},LoadLength:function(){return this.MapObj.loadLen},onSrpiteFun:function(){this.killArr=[],this.killSprArr=[],this.killFrameArr=[];var t=0,e=this.MapObj.loadLen,i=this;if(null==this.BGObj||(e++,cc.loader.loadRes(this.BGObj.path+"/s",cc.SpriteAtlas,function(n,o){t++,i.BGObj.alt=o,null!=i.Loading&&i.Loading(t,e),t>=e&&i.onLayerFun()}),0!=e))if(0!=e){var n=this.MapObj.fraArr,o=this.MapObj.atlArr,r=function(o){"k"==o[4]?(t++,null!=i.Loading&&i.Loading(t,e),t>=e&&i.onLayerFun()):cc.loader.loadRes(o,cc.SpriteFrame,function(r,a){if(null==r){var s=a.clone();i.killFrameArr[i.killFrameArr.length]=s,i.SpriteObj[o+"-"+n[o]]=s,i.killSprArr[i.killSprArr.length]=[o,a],s.getTexture().setFilters(cc.Texture2D.Filter.NEAREST,cc.Texture2D.Filter.NEAREST)}t++,null!=i.Loading&&i.Loading(t,e),t>=e&&i.onLayerFun()})};for(var a in n)r(a);var s=null,h=function(n){cc.loader.loadRes(n,cc.SpriteAtlas,function(r,a){for(var h=cc.loader.getDependsRecursively(a),l=0;l<o[n].length;l++)s=a.getSpriteFrame(o[n][l]),i.killFrameArr[i.killFrameArr.length]=s,i.SpriteObj[n+"-"+o[n][l]]=s;for(var c=0;c<h.length;c++)i.killArr[i.killArr.length]=h[c];t++,null!=i.Loading&&i.Loading(t,e),t>=e&&i.onLayerFun()})};for(var l in o)h(l)}else this.onLayerFun()},addNode:function(t,e){var i;(i=null==e?new cc.Node:e).anchorX=0,i.anchorY=1;for(var n in t)if("Collider"==n||"PolygonCollider"==n)this.hitObject(i,this.getComponentType(n),t[n]);else if("Sprite"==n||"Graphics"==n){var o=t[n],r=i.addComponent(this.getComponentType(n));r.srcBlendFactor=cc.macro.BlendFactor.ONE;for(var a in o)if("Graphics"==n&&"rect"==a)"rect"==a&&r.rect(o[a].x,o[a].y,o[a].width,o[a].height);else if("spriteFrame"==a){var s=t.name;if("k"==s[0]){i.anchorX=1,i.scaleX=-1;var h=s.indexOf("+"),l=s.substring(1,h),c="Map/"+s.substring(h+1)+"-"+(s="i"+l);r[a]=this.SpriteObj[c]}else r[a]=this.SpriteObj[o[a]]}else r[a]="fillColor"==a?new cc.Color(o[a].r,o[a].g,o[a].b,o[a].a):o[a];if(this.revise)if("Sprite"==n)i.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.CUSTOM,i.width+=1,i.height+=1;"Graphics"==n&&r.fill()}else i[n]=t[n];return i},hitObject:function(t,e,i){for(var n=0;n<i.length;n++){var o=t.addComponent(e),r=i[n];null!=r.pz&&(null==t.pz&&(t.pz=[]),t.pz[t.pz.length]=[o,r.pz]);for(var a in r)o[a]=r[a]}},getComponentType:function(t){return"Sprite"==t?cc.Sprite:"Graphics"==t?cc.Graphics:"Collider"==t?cc.BoxCollider:"PolygonCollider"==t?cc.PolygonCollider:void 0},getBGNode:function(t,e){var i,n=this.BGObj.name+t+this.BGObj.pname+e;if(this.BGObj.pool.length>0){var o=this.BGObj.pool.length-1;i=this.BGObj.pool[o],this.BGObj.pool.splice(o,1)}else(i=new cc.Node).spr=i.addComponent(cc.Sprite),i.anchorX=0,i.anchorY=1;null!=this.BGObj.sprite[n]?i.spr.spriteFrame=this.BGObj.sprite[n]:(this.LoadMapBG(n),i.spr.spriteFrame=this.BGObj.alt.getSpriteFrame(n),null==i.spr.spriteFrame&&console.log("\u627e\u5230\u7a7a"+n));var r=t*this.BGObj.width,a=e*this.BGObj.height*-1;i.x=r,i.y=a,i.width=this.BGObj.width,i.height=this.BGObj.height,i.parent=this.BGNode,this.BGObj.stageNode[n]=i},BGInit:function(){if(null!=this.BGObj){this.BGObj.rect=new cc.Rect(this.BGObj.x,this.BGObj.y,this.BGObj.width*this.BGObj.nx,this.BGObj.height*this.BGObj.ny),this.BGObj.pool=[],this.BGObj.sprite={},this.BGObj.length=this.BGObj.nx*this.BGObj.ny,this.BGObj.loadArr=[],this.BGObj.loadObj={},this.BGObj.stageNode={},this.BGObj.rect2=null,this.BGObj.loadBo=!1,this.BGNode=new cc.Node,this.BGNode.zIndex=-1,this.BGNode.x=this.BGObj.x,this.BGNode.y=this.BGObj.y,this.BGNode.parent=this.node;for(var t=0;t<this.BGObj.nx;t++)for(var e=0;e<this.BGObj.ny;e++){var i=this.BGObj.name+t+this.BGObj.pname+e;this.BGObj.loadArr[this.BGObj.loadArr.length]=i,this.BGObj.loadObj[i]=!1}this.LoadMapBG(null,!0)}},getBGID:function(){var t=this.BGObj.loadArr.length-1,e=this.BGObj.loadArr[t];return this.BGObj.loadArr.splice(t,1),e},LoadMapBG:function(t,e){if(null!=this.BGObj&&0!=this.BGObj.length){var i=this;if(e){if(!(this.BGObj.loadArr.length>0))return;for(t=this.getBGID();null!=this.BGObj.stageNode[t];)t=this.getBGID()}this.BGObj.loadObj[t]||(this.BGObj.loadObj[t]=!0,cc.loader.loadRes(this.BGObj.path+"/"+t,cc.SpriteFrame,function(n,o){n||(null!=i.BGObj?(i.BGObj.sprite[t]=o,null!=i.BGObj.stageNode[t]&&(i.BGObj.stageNode[t].spr.spriteFrame=o),i.BGObj.length--,0==i.BGObj.length?(cc.loader.releaseRes(i.BGObj.path+"/s"),i.BGObj.alt=null,this.BGObj.loadObj=null):e&&i.LoadMapBG(null,!0)):cc.loader.releaseAsset(o))}))}},AddMapBG:function(t){var e=this.BGObj.width,i=this.BGObj.height;this.BGObj.rect.x=0,this.BGObj.rect.y=0;var n=new cc.Rect;this.BGObj.rect.intersection(n,new cc.Rect(t.x-this.BGNode.x,-1*t.y-t.height- -1*this.BGNode.y,t.width,t.height));var o=Math.floor(n.x/e),r=Math.floor(n.y/i),a=Math.ceil((n.x+n.width)/e),s=Math.ceil((n.y+n.height)/i);if(o<0&&(o=0),r<0&&(r=0),a>=this.BGObj.nx&&(a=this.BGObj.nx-1),s>=this.BGObj.ny&&(s=this.BGObj.ny-1),null!=this.BGObj.rect2){for(var h=this.getHitRectObj(this.BGObj.rect2,new cc.Rect(o,r,a-o,s-r)),l=0;l<h.length;l++)for(var c=h[l].x,u=h[l].y,p=h[l].width+h[l].x,d=h[l].height+h[l].y,f=c;f<p;f++)for(var _=u;_<d;_++){var g=this.BGObj.name+f+this.BGObj.pname+_;null!=this.BGObj.stageNode[g]&&(this.BGObj.stageNode[g].parent=null,this.BGObj.pool.push(this.BGObj.stageNode[g]),delete this.BGObj.stageNode[g])}if(n.width>0&&n.height>0)for(var m=this.getHitRectObj(new cc.Rect(o,r,a-o,s-r),this.BGObj.rect2),y=0;y<m.length;y++)this.fBG(m[y].x,m[y].y,m[y].width+m[y].x,m[y].height+m[y].y)}else this.fBG(o,r,a,s);this.BGNode.childrenCount>0?this.BGObj.rect2=new cc.Rect(o,r,a-o,s-r):this.BGObj.rect2=null},fBG:function(t,e,i,n){for(var o=t;o<=i;o++)for(var r=e;r<=n;r++)this.getBGNode(o,r)},AddMapChildFun:function(t,e){if(null!=this.BGObj&&this.AddMapBG(t),"this"==e||null!=this.LayerNodeObj[e])for(var i={},n=t.x+this.flagPoint.x,o=t.y+this.flagPoint.y,r=t.x+this.flagPoint.x+t.width,a=t.y+this.flagPoint.y+t.height,s=0;s<this.LayerArr.length;s++)if("this"==e||this.LayerNodeArr[s].name==e){var h=this.LayerNodeArr[s],l=this.layerRect[h.name][1],c=this.layerRect[h.name][2],u=Math.floor(n/l),p=Math.floor(o/c)+1,d=Math.ceil((r-u*l)/l),f=Math.ceil((a-p*c)/c)+1,_=[];if(null!=this.stageRectObj[h.name]){var g=this.stageRectObj[h.name];if(u==g.x&&p==g.y&&d==g.width&&f==g.height)continue;if(_=this.getHitRectObj(new cc.Rect(u,p,d,f),g),null==this.LayerNodeArr[s].parent){this.removeNodeChildFun([g],new cc.Rect,h.name),this.stageRectObj[h.name]=null;continue}this.removeNodeChildFun(this.getHitRectObj(g,new cc.Rect(u,p,d,f)),new cc.Rect(this.viewOrg.x,this.viewOrg.y,this.viewSz.width,this.viewSz.height),h.name),this.stageRectObj[h.name]=new cc.Rect(u,p,d,f)}else{if(null==this.LayerNodeArr[s].parent)continue;this.stageRectObj[h.name]=new cc.Rect(u,p,d,f),_=[new cc.Rect(u,p,d,f)]}for(var m=0;m<_.length;m++){u=_[m].x,p=_[m].y,d=_[m].width,f=_[m].height;var y=this.LayerArr[s].Position;i[this.LayerNodeArr[s].name]={};for(var v=0;v<d;v++)for(var b=u*l+v*l,C=0;C<f;C++){var S=p*c+C*c;if(null!=y[b]&&null!=y[b][S]){i[this.LayerNodeArr[s].name][b+" + "+S]=0;for(var w=y[b][S],x=0;x<w.length;x++){var I=w[x],P=this.nodeAllObj[this.LayerNodeArr[s].name][I];this.addNodeChildFun(P[0],P[1]-this.flagPoint.x,P[2]-this.flagPoint.y,s,I)}}}}}},getHitRectObj:function(t,e){if(t.x+t.width<=e.x||e.x+e.width<=t.x||t.y+t.height<=e.y||e.y+e.height<=t.y)return[t];var i=[];if(t.x<e.x){var n=new cc.Rect(t.x,t.y,e.x-t.x,0);e.y+e.height<t.y+t.height?n.height=e.y+e.height-t.y:n.height=t.height,i[i.length]=n}if(t.y+t.height>e.y+e.height){var o=new cc.Rect(t.x,e.y+e.height,0,t.y+t.height-(e.y+e.height));e.x+e.width<t.x+t.width?o.width=e.x+e.width-t.x:o.width=t.width,i[i.length]=o}if(t.y<e.y){var r=new cc.Rect(0,t.y,0,e.y-t.y);e.x>t.x?r.x=e.x:r.x=t.x,r.width=t.x+t.width-r.x,i[i.length]=r}if(t.x+t.width>e.x+e.width){var a=new cc.Rect(e.x+e.width,0,t.x+t.width-(e.x+e.width),0);e.y>t.y?a.y=e.y:a.y=t.y,a.height=t.y+t.height-a.y,i[i.length]=a}return i},addNodeChildFun:function(t,e,i,n,r){var a,s=this.layerRect[this.LayerNodeArr[n].name][1],h=this.layerRect[this.LayerNodeArr[n].name][2],l=!1,c=!1,u=null,p=!1;if("number"==typeof t){var d=this.MapSprArr[t];if(null!=d[1][r+""])return;var f,_=d[0],g=this,m=function(){f=_.length>=5?g.addNode(g.extend({name:_[0],x:e,y:i,rotation:_[4],zIndex:r},_[1])):g.addNode(g.extend({name:_[0],x:e,y:i,zIndex:r},_[1])),d[1][r+""]=f};if(this.NodeIdArr[r])(f=this.NodeIdArr[r]).x=e,f.y=i,f.zIndex=r,d[1][r+""]=f;else{var y=window.bigNodeManager.manager[_[0]];if(y&&y.length)(f=y[0]).x=e,f.y=i,f.zIndex=r,y.splice(0,1),"k"==_[0][0]&&(f.scaleX=-1);else if(d[2].length>0){var v=d[2].length-1,b=d[2][v];b.NodeId?m():(f=b,d[2].splice(v,1),d[3]=this.timInt,f.x=e,f.y=i,f.zIndex=r,d[1][r+""]=f)}else m()}if(f.scaleY=1,a=new cc.Rect(f.x,f.y,_[2],_[3]),null==this.nodeAllObj[this.LayerNodeArr[n].name][r+""]);if(_.length>=5||this.nodeAllObj[this.LayerNodeArr[n].name][r+""].length>=4){if(null!=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][0]&&(a.x=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][0]-this.flagPoint.x),null!=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][1]&&(a.y=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][1]-this.flagPoint.y),null!=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][2]&&(f.opacity=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][2]),null!=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][4]){var C=f.scaleX>0?1:-1;f.scaleX=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][4]*C}null!=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][5]&&(f.scaleY=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][5]),null!=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][3]&&(p=!0,this.addNodeParent(f,this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][3],n))}f.color=new cc.Color(255,255,255),f.bID=[r,this.nodeAllObj[this.LayerNodeArr[n].name][r+""],a],u=f,f.Info=this.infoObj[r],p||(f.parent=this.LayerNodeArr[n]),f.mapLayerName=f.parent.name,this.showNodeObj[r]=f}else{if(null!=this.MapMcArr[r+""])return;l=!0;var S,w=this.ymcMapSprArr[t][0];null==this.mcPool[t]&&(this.mcPool[t]={},this.mcPool[t].pool=[],this.mcPool[t].name=w),this.mcPool[t].timer=this.timInt;var x=!1;if(this.mcPool[t].pool.length<=0)S=new o;else{var I=this.mcPool[t].pool.length-1;S=this.mcPool[t].pool[I],this.mcPool[t].pool.splice(I,1),x=!0}S.pid=t;var P={};for(var T in this.ymcAllObj[w][2])for(var k in this.ymcAllObj[w][2][T])P[T]={},P[T][k]=null;x?S.Init2(this.ymcAllObj[w][3],this.MapSprArr,this.SpriteObj,this.revise):(S.Init(null,w,this.ymcAllObj[w][0],this.ymcAllObj[w][1],P,this.ymcAllObj[w][3],this.ymcAllObj[w][4],this.MapSprArr,this.SpriteObj,this.revise),this.addNode(this.ymcMapSprArr[t][1],S)),S.setLocationFun(e,i),null==this.ymcFrameObj[r+""]?(c=!0,S.setFrame(0,this.ymcTimInt,0,!1,!1)):S.setFrame(this.ymcFrameObj[r+""][0],this.ymcTimInt,this.ymcFrameObj[r+""][1],this.ymcFrameObj[r+""][2],this.ymcFrameObj[r+""][3]),this.ymcStageArr[this.ymcStageArr.length]=S,this.MapMcArr[r+""]=S,S.zIndex=r,a=new cc.Rect(S.x+S.getRect().x,S.y+S.getRect().y,S.getRect().width,S.getRect().height),t=S,this.nodeAllObj[this.LayerNodeArr[n].name][r+""].length>=4&&(null!=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][2]&&(S.opacity=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][2]),null!=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][4]&&(newNode.scaleX=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][4]),null!=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][5]&&(newNode.scaleY=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][5]),null!=this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][3]&&(p=!0,this.addNodeParent(S,this.nodeAllObj[this.LayerNodeArr[n].name][r+""][3][3],n))),S.color=new cc.Color(255,255,255),S.bID=[r,this.nodeAllObj[this.LayerNodeArr[n].name][r+""],a],S.info=this.infoObj[r],p||(S.parent=this.LayerNodeArr[n]),S.mapLayerName=S.parent.name,this.showNodeObj[r]=S,u=S}this.setStageNodeInfo(this.LayerNodeArr[n].name,r,s,h,!1),l?null!=this.onLoadYMovieClip&&this.onLoadYMovieClip(u,this.LayerNodeArr[n].name,c):null!=this.onLoadSprite&&this.onLoadSprite(u,this.LayerNodeArr[n].name,r)},addNodeParent:function(t,e,i){if(null!=this.nodeParentObj[e])if(null==this.nodeParentObj[e][7]){var n=this.addNode(this.extend({name:this.nodeParentObj[e][0],x:this.nodeParentObj[e][1]-this.flagPoint.x,y:this.nodeParentObj[e][2]-this.flagPoint.y,zIndex:this.nodeParentObj[e][5]+.5,parent:this.LayerNodeArr[i]},this.nodeParentObj[e][6]));t._y_parent=n,t.parent=n,this.nodeParentObj[e][7]=n,t.x-=n.x,t.y-=n.y,n.zIndex=t.zIndex,null!=this.onLoadSpriteParent&&this.onLoadSpriteParent(n,this.LayerNodeArr[i].name,!0,this.nodeParentObj[e][5],i)}else t._y_parent=this.nodeParentObj[e][7],t.parent=this.nodeParentObj[e][7],t.x-=this.nodeParentObj[e][7].x,t.y-=this.nodeParentObj[e][7].y,null==this.nodeParentObj[e][7].parent&&(this.nodeParentObj[e][7].parent=this.LayerNodeArr[i],this.nodeParentObj[e][7].zIndex=t.zIndex,null!=this.onLoadSpriteParent&&this.onLoadSpriteParent(this.nodeParentObj[e][7],this.LayerNodeArr[i].name,!1,this.nodeParentObj[e][5],i));t._y_parID=e},setYMovieClipFrame:function(t,e,i){if(null!=this.showNodeObj[t])i?null!=this.showNodeObj[t].gotoAndPlay&&this.showNodeObj[t].gotoAndPlay(e):null!=this.showNodeObj[t].gotoAndStop&&this.showNodeObj[t].gotoAndStop(e);else{if("number"==typeof e)e>0&&(e-=1);else{for(var n in this.nodeAllObj)if(this.nodeAllObj[n][t]){e=this.ymcAllObj[this.ymcMapSprArr[this.nodeAllObj[n][t][0]][0]][4][e];break}if(null==e)return}this.ymcFrameObj[t]=i?[e,this.ymcTimInt,!1,!1]:[e,this.ymcTimInt,!0,!0]}},removeNodeParent:function(t,e){null!=t._y_parent&&(0==t._y_parent.childrenCount&&(t._y_parent.parent=null,null!=this.killSpriteParent&&this.onLoadSpriteParent(t._y_parent,e)),t._y_parent=null),null!=t._y_parID&&(t._y_parID=null)},addStageNodeObjFun:function(t,e,i){null==this.stageNodeObj[t]&&(this.stageNodeObj[t]={}),null==this.stageNodeObj[t][i]&&(this.stageNodeObj[t][i]={}),void 0===this.stageNodeObj[t][i][e]&&(this.stageNodeObj[t][i][e]=null)},extend:function(t,e){for(var i in e)t[i]=e[i];return t},getNodesByLocation:function(t,e,i){var n=this.stageNodeObj[t],o=[];if(null!=n){var r=this.layerRect[t][1],a=this.layerRect[t][2],s=Math.floor((e+this.flagPoint.x)/r)*r,h=Math.ceil((i+this.flagPoint.y)/a)*a;if(null!=n[s+"-"+h]){var l=this.stageNodeObj[t][s+"-"+h];if(null!=l)for(var c in l)null!=this.showNodeObj[c]&&(o[o.length]=this.showNodeObj[c])}}return o},getTopNodeByLocation:function(t,e,i){var n,o=this.stageNodeObj[t];if(null!=o){var r=this.layerRect[t][1],a=this.layerRect[t][2],s=Math.floor((e+this.flagPoint.x)/r)*r,h=Math.ceil((i+this.flagPoint.y)/a)*a;if(null!=o[s+"-"+h]){var l=this.stageNodeObj[t][s+"-"+h];if(null!=l)for(var c in l)null!=this.showNodeObj[c]&&(null==n?n=this.showNodeObj[c]:n.zInde<this.showNodeObj[c].zIndex&&(n=this.showNodeObj[c]))}}return n},addMapNode:function(t,e,i,n){var o=null,r=!1;if(t instanceof cc.Node){if(null==t.bID)return!1;o=t.bID[0],r=!0}else{if("number"!=typeof t)return!1;o=t}if(null==this.nodeAllObj[e])return!1;var a=this.layerRect[e][1],s=this.layerRect[e][2],h=-1;if(null==this.LayerNodeObj[e])return!1;h=this.LayerNodeObj[e].LayerArrID;var l=null;for(var c in this.nodeAllObj)c!=e&&null!=this.nodeAllObj[c][o]&&(l=this.nodeAllObj[c][o],this.setStageNodeInfo(c,o,this.layerRect[c][1],this.layerRect[c][2],!0),this.Info(c,o,h,null,!0),delete this.nodeAllObj[c][o]);null!=l&&(this.nodeAllObj[e][o]=l,this.setStageNodeInfo(e,o,a,s,!0),this.Info(e,o,h,null,!0));var u=!1;"number"!=typeof this.nodeAllObj[e][o][0]&&(u=!0);var p=this.showNodeObj[o];null==i&&(i=this.nodeAllObj[e][o][1]-this.flagPoint.x),null==n&&(n=this.nodeAllObj[e][o][2]-this.flagPoint.y);this.nodeAllObj[e][o][1],this.flagPoint.x,this.nodeAllObj[e][o][2],this.flagPoint.y;var d=this;return this.setNodeLocation(e,o,i+d.flagPoint.x,n+d.flagPoint.y,p),this.Info(e,o,h,function(t,r,l){var c=new cc.Rect(this.viewOrg.x,this.viewOrg.y,this.viewSz.width,this.viewSz.height),p=new cc.Vec2(l.x-d.flagPoint.x,l.y-d.flagPoint.y),f=new cc.Rect(0,0,l.width*this.node.scaleX,l.height*this.node.scaleY),_=d.LayerNodeObj[e].convertToWorldSpaceAR(cc.v2(p.x,p.y));f.x=_.x,f.y=-1*_.y;var g=f,m=new cc.Rect(c.x,c.y-c.height,c.width,c.height);g.x+g.width<=m.x||m.x+m.width<=g.x||g.y+g.height<=m.y||m.y+m.height<=g.y?null!=d.showNodeObj[o]&&d.killStageNode(e,d.showNodeObj[o],o,u):null!=d.showNodeObj[o]?(d.showNodeObj[o].x=i,d.showNodeObj[o].y=n,d.setStageNodeInfo(e,o,a,s,!1)):null!=d.LayerNodeArr[h].parent&&d.addNodeChildFun(d.nodeAllObj[e][o][0],i-d.flagPoint.x,n-d.flagPoint.y,h,o)}),r&&t.destroy(),!0},removeNodeChildFun:function(t,e,i){for(var n=0;n<this.LayerNodeArr.length;n++)if("this"==i||this.LayerNodeArr[n].name==i)for(var o=0;o<t.length;o++){var r=this.layerRect[this.LayerNodeArr[n].name][1],a=this.layerRect[this.LayerNodeArr[n].name][2],s=t[o].x,h=t[o].y,l=t[o].width,c=t[o].height,u=this.stageNodeObj[this.LayerNodeArr[n].name];if(null!=u)for(var p=0;p<l;p++)for(var d=0;d<c;d++){var f=s*r+p*r,_=h*a+d*a;if(null!=u[f+"-"+_]){var g=this.stageNodeObj[this.LayerNodeArr[n].name][f+"-"+_];if(null==g)continue;for(var m in g)this.removeStageNode(m,e)}}}},removeStageNode:function(t,e){var i=this.showNodeObj[t];if("i_12"==i.name);if(null!=i){var n,o=i.bID[2],r=!1;if("number"==typeof i.bID[1][0]?n=null!=i._y_parent?i._y_parent.parent:i.parent:(n=i.getPraent(),r=!0),null!=n){var a=n.name,s=this.layerRect[a][1],h=this.layerRect[a][2],l=(new cc.Vec2(o.x,o.y),n.convertToWorldSpaceAR(cc.v2(i.MRect.x*s-this.flagPoint.x,i.MRect.y*h-this.flagPoint.y))),c=new cc.Rect(l.x,-1*l.y,(i.MRect.width-i.MRect.x+1)*s*this.node.scaleX,(i.MRect.y-i.MRect.height+1)*h*this.node.scaleY),u=new cc.Rect(e.x,e.y-e.height,e.width,e.height);(c.x+c.width<=u.x||u.x+u.width<=c.x||c.y+c.height<=u.y||u.y+u.height<=c.y)&&(this.setStageNodeInfo(a,t,s,h,!0),this.killStageNode(a,i,t,r))}}},getMapNodeObj:function(t,e){var i=null;if(t instanceof cc.Node?(i=t.bID[0],e=t.mapLayerName):i=t,null==e)for(var n in this.nodeAllObj)if(null!=this.nodeAllObj[n][i]){e=n;break}if(null==e)return null;var o={};return"number"==typeof this.nodeAllObj[e][i][0]?o.name=this.MapSprArr[this.nodeAllObj[e][i][0]][0]:o.name=this.ymcMapSprArr[this.nodeAllObj[e][i][0]][0],o.LayerName=e,o.id=i,o.x=this.nodeAllObj[e][i][1]-this.flagPoint.x,o.y=this.nodeAllObj[e][i][2]-this.flagPoint.y,o.sx=null!=this.nodeAllObj[e][i][3][4]?this.nodeAllObj[e][i][3][4]:1,o.sy=null!=this.nodeAllObj[e][i][3][5]?this.nodeAllObj[e][i][3][5]:1,o},getShadow:function(t,e){var i=this,n=this.getMapNodeObj(t,e);return new Proxy(n,{get:function(t,e,i){return t[e]},set:function(t,e,o,r){return t[e]=o,i.setMapLocation(t.id,t,n.LayerName),!0}})},setMapLocation:function(t,e,i,n){var o=-1,r=!1,a=e.x,s=e.y,h=e.sx,l=e.sy;if(t instanceof cc.Node){if(i=newNode.mapLayerName,null==t.bID)return;o=t.bID[0]}else o=t;if(-1!=o){if(null==i)for(var c in this.nodeAllObj)if(null!=this.nodeAllObj[c][o]){i=c;break}if(null!=i){var u=-1;if(null!=this.LayerNodeObj[i]){u=this.LayerNodeObj[i].LayerArrID,"number"!=typeof this.nodeAllObj[i][o][0]&&(r=!0);var p=this.showNodeObj[o],d=this.layerRect[i][1],f=this.layerRect[i][2];null==a?a=this.nodeAllObj[i][o][1]-this.flagPoint.x:n&&(a=this.nodeAllObj[i][o][1]-this.flagPoint.x+a),null==s?s=this.nodeAllObj[i][o][2]-this.flagPoint.y:n&&(s=this.nodeAllObj[i][o][2]-this.flagPoint.y+s);var _=this.nodeAllObj[i][o][1]-this.flagPoint.x,g=this.nodeAllObj[i][o][2]-this.flagPoint.y,m=this,y=!1,v=null==this.nodeAllObj[i][o][3][4]?1:this.nodeAllObj[i][o][3][4],b=null==this.nodeAllObj[i][o][3][5]?1:this.nodeAllObj[i][o][3][5];null!=h&&h!=v&&(y=!0),null!=l&&l!=b&&(y=!0),(a!=_||s!=g||y)&&(this.setStageNodeInfo(i,o,d,f,!0),this.Info(i,o,u,null,!0),null!=h&&(this.nodeAllObj[i][o][3][4]=h),null!=l&&(this.nodeAllObj[i][o][3][5]=l),this.setNodeLocation(i,o,a+m.flagPoint.x,s+m.flagPoint.y,p),this.Info(i,o,u,function(t,e,n){var c=new cc.Rect(this.viewOrg.x,this.viewOrg.y,this.viewSz.width,this.viewSz.height),p=new cc.Vec2(n.x-m.flagPoint.x,n.y-m.flagPoint.y),_=new cc.Rect(0,0,n.width*m.node.scaleX,n.height*m.node.scaleY),g=m.LayerNodeObj[i].convertToWorldSpaceAR(cc.v2(p.x,p.y));_.x=g.x,_.y=-1*g.y;var y=_,v=new cc.Rect(c.x,c.y-c.height,c.width,c.height);y.x+y.width<=v.x||v.x+v.width<=y.x||y.y+y.height<=v.y||v.y+v.height<=y.y?null!=m.showNodeObj[o]&&m.killStageNode(i,m.showNodeObj[o],o,r):null!=m.showNodeObj[o]?(m.showNodeObj[o].x=a,m.showNodeObj[o].y=s,null!=h&&(m.showNodeObj[o].scaleX=h),null!=l&&(m.showNodeObj[o].scaleY=l),m.setStageNodeInfo(i,o,d,f,!1)):null!=m.LayerNodeArr[u].parent&&m.addNodeChildFun(m.nodeAllObj[i][o][0],a-m.flagPoint.x,s-m.flagPoint.y,u,o)}))}}}},setStageNodeInfo:function(t,e,i,n,o){var r=this.showNodeObj[e];if(null!=r){var a,s,h,l;r.bID[2];if(o)a=r.MRect.x,s=r.MRect.y,h=r.MRect.width,l=r.MRect.height;else{var c=this.getNodeRect(t,e),u=c.x,p=c.y;a=Math.floor(u/i),s=Math.ceil(p/n),h=Math.floor((c.width+u-1)/i),l=Math.ceil((p-c.height+1)/n),r.MRect=new cc.rect(a,s,h,l)}for(var d=a;d<=h;d++)for(var f=s;f>=l;f--)null!=r&&(o?null!=this.stageNodeObj[t][d*i+"-"+f*n]&&delete this.stageNodeObj[t][d*i+"-"+f*n][e]:this.addStageNodeObjFun(t,e,d*i+"-"+f*n))}},killStageNode:function(t,e,i,n){var o=this.MapSprArr[e.bID[1][0]];if(n){null!=this.killYMovieClip&&this.killYMovieClip(e,t),this.mcPool[e.pid].pool[this.mcPool[e.pid].pool.length]=e,delete this.MapMcArr[i],this.ymcFrameObj[i]=[e.cFrame,this.ymcTimInt,e.stopBo,e.offBo];var r=this.ymcStageArr.indexOf(e);-1!=r&&this.ymcStageArr.splice(r,1),e.parent=null}else{null!=this.killSprite&&this.killSprite(e,t),e.parent=null,e.opacity=255,o[2][o[2].length]=e,delete o[1][i]}delete this.showNodeObj[i],this.removeNodeParent(e,t)},getIntersectsRectFun:function(t,e){var i=new cc.Rect;i.x=t.x>e.x?t.x:e.x,i.y=t.y<e.y?t.y:e.y;var n=t.x+t.width>e.x+e.width?e.x+e.width:t.x+t.width,o=t.y-t.height<e.y-e.height?e.y-e.height:t.y-t.height;return i.width=n-i.x,i.height=Math.abs(i.y-o),i},removeMapNode:function(t){var e=null,i=!1;if(t instanceof cc.Node){if(null==t.bID)return!1;e=t.bID[0],i=!0}else{if("number"!=typeof t)return!1;e=t,null!=this.showNodeObj[e]&&(i=!0,t=this.showNodeObj[e])}var n=null;for(var r in this.nodeAllObj)if(null!=this.nodeAllObj[r][e]){n=r;break}if(null!=n){var a=-1;if(null!=this.LayerNodeObj[n]){a=this.LayerNodeObj[n].LayerArrID;var s=!1;if(i&&null!=this.showNodeObj[e]){var h=this.layerRect[n][1],l=this.layerRect[n][2],c=this.MapSprArr[this.nodeAllObj[n][e][0]];if(t instanceof o&&(s=!0),this.setStageNodeInfo(n,e,h,l,!0),s){null!=this.MapMcArr[e]&&delete this.MapMcArr[e],this.ymcFrameObj[e]=[t.cFrame,this.ymcTimInt,t.stopBo,t.offBo];var u=this.ymcStageArr.indexOf(t);-1!=u&&this.ymcStageArr.splice(u,1)}else{var p=c[1];null!=p[e]&&delete p[e]}delete this.showNodeObj[e]}this.Info(n,e,a,null,!0),s&&t.removeThis()}}},getNodeParentByName:function(t){for(var e in this.nodeParentObj)if(this.nodeParentObj[e][0]==t&&this.nodeParentObj[e].length>=8)return this.nodeParentObj[e][7];return null},getNodeParentBySprite:function(t){return null!=node._y_parent?node._y_parent.parent:null},getNodeRect:function(t,e){var i=new cc.Rect(this.nodeAllObj[t][e][1],this.nodeAllObj[t][e][2]),n=this.nodeAllObj[t][e][0],o=1,r=1;if(this.nodeAllObj[t][e].length>=4&&(null!=this.nodeAllObj[t][e][3][0]&&(i.x=this.nodeAllObj[t][e][3][0]),null!=this.nodeAllObj[t][e][3][1]&&(i.y=this.nodeAllObj[t][e][3][1]),null!=this.nodeAllObj[t][e][3][4]&&(o=this.nodeAllObj[t][e][3][4]),null!=this.nodeAllObj[t][e][3][5]&&(r=this.nodeAllObj[t][e][3][5])),"number"==typeof n)i.width=this.MapSprArr[n][0][2]*o,i.height=this.MapSprArr[n][0][3]*r;else{var a=this.ymcAllObj[this.ymcMapSprArr[n][0]][3];i.x+=a.x,i.y+=a.y,i.width=a.width*o,i.height=a.height*r}return i},setNodeLocation:function(t,e,i,n,o){var r=i-this.nodeAllObj[t][e][1],a=n-this.nodeAllObj[t][e][2];this.nodeAllObj[t][e][1]+=r,this.nodeAllObj[t][e][2]+=a,this.nodeAllObj[t][e].length>=4&&(null!=this.nodeAllObj[t][e][3][0]&&(this.nodeAllObj[t][e][3][0]+=r),null!=this.nodeAllObj[t][e][3][1]&&(this.nodeAllObj[t][e][3][1]+=a)),null!=o&&null!=o.bID&&(o.bID[2].x+=r,o.bID[2].y+=a)},isShow:function(t){return null!=this.showNodeObj[t]?this.showNodeObj[t]:null},Info:function(t,e,i,n,o){if(-1==i)for(var r=0;r<this.LayerArr.length;r++)if(this.LayerArr[r].LayerName==t){i=r;break}if(-1!=i){null==o&&(o=!1);var a=this.nodeAllObj[t][e][0],s=this.getNodeRect(t,e),h=this.layerRect[t][1],l=this.layerRect[t][2],c=s.x,u=s.y,p=Math.floor(c/h),d=Math.ceil(u/l),f=Math.floor((s.width+c-1)/h),_=Math.ceil((u-s.height+1)/l),g=this.isHit,m="";"number"==typeof a?null!=this.MapSprArr[a]&&(m=this.MapSprArr[a][0][0]):null!=this.ymcMapSprArr[a]&&(m=this.ymcMapSprArr[a][0]);for(var y=p;y<=f;y++)for(var v=d;v>=_;v--){var b=(y*h).toString(),C=(v*l).toString();if(o){if(null!=this.LayerArr[i].Position[b]&&null!=this.LayerArr[i].Position[b][C]){var S=this.LayerArr[i].Position[b][C].indexOf(e);if(-1!=S&&this.LayerArr[i].Position[b][C].splice(S,1),null!=this.hitObj[b]&&null!=this.hitObj[b][C])for(var w=0;w<this.hitObj[b][C].length;w++)if(this.hitObj[b][C][w].id==e){this.hitObj[b][C].splice(w,1),0==this.hitObj[b][C].length&&delete this.hitObj[b][C];break}}}else if(null==this.LayerArr[i].Position[b]&&(this.LayerArr[i].Position[b]={}),null==this.LayerArr[i].Position[b][C]&&(this.LayerArr[i].Position[b][C]=[]),this.LayerArr[i].Position[b][C].push(Number(e)),g[m]){null==this.hitObj[b]&&(this.hitObj[b]={}),null==this.hitObj[b][C]&&(this.hitObj[b][C]=[]);var x=this.isTop[m]?1:0;this.hitObj[b][C].push({x:s.x,y:-1*s.y,width:s.width,height:s.height,id:e,type:x})}null!=n&&n(b,C,s)}}},getTag:function(t){return null!=this.tagObj[t]?this.tagObj[t]:[]},onPath:function(t){if(null!=t.pathObj){for(var e={},i=0;i<t.pathObj.length;i++)e[t.pathObj[i][1]+"*"+t.pathObj[i][0]]={x:t.pathObj[i][0],y:t.pathObj[i][1]};t.pathObj=e,this.PathGridObj=t}},set ols(t){this.onLoadSprite=olp},set oLsp(t){this.onLoadSpriteParent=t},set olymc(t){this.onLoadYMovieClip=t},onLayerFun:function(){console.log("\u5730\u56fe\u52a0\u8f7d\u5b8c\u4e86"),this.hitObj={},this.BGInit(),this.onLayerFun2();var t=this.MapObj.mcArr;this.ymcAllObj={};for(var e in t)for(var i=t[e][0],n=[],o=0;o<i.length;o++){for(var r=[],a=i[o],s=a[0],h=1;h<a.length;h++)r[r.length]=a[h];for(var l=0;l<s;l++)n[n.length]=r;this.ymcAllObj[e]=[n,t[e][1],t[e][2],new cc.Rect(t[e][3][0],t[e][3][1],t[e][3][2],t[e][3][3]),t[e][4]]}for(var c in this.nodeAllObj)for(var u=0;u<this.LayerArr.length;u++)if(this.LayerArr[u].LayerName==c&&null==this.LayerArr[u].Position){this.LayerArr[u].Position={};for(var p in this.nodeAllObj[c])this.Info(c,p,u),null==this.nodeAllObj[c][p][3]&&(this.nodeAllObj[c][p][3]=[])}var d=function(t,e){for(var i=0;i<t.length;i++)if(null!=t[i].pz){var n={};for(var o in t[i].pz)if(t[i].pz[o])if(e)n[o]={},n[o].offset=new cc.Vec2(t[i].pz[o][0],t[i].pz[o][1]),n[o].size=new cc.Size(t[i].pz[o][2],t[i].pz[o][3]);else{n[o]={},n[o].points=[];for(var r=0;r<t[i].pz[o].length;r++)n[o].points[n[o].points.length]=new cc.Vec2(t[i].pz[o][r][0],t[i].pz[o][r][1])}t[i].pz=n}};for(var f in this.ymcMapSprArr){var _=this.ymcMapSprArr[f][1];null!=_.Collider&&d(_.Collider,!0),null!=_.PolygonCollider&&d(_.PolygonCollider,!1)}this.LayerNodeArr=new Array,this.LayerNodeObj={};for(var g=0;g<this.LayerArr.length;g++){var m=this.addNode(this.extend({name:this.LayerArr[g].LayerName,zIndex:100*g,parent:this.node},this.LayerArr[g].Pro));this.LayerNodeObj[this.LayerArr[g].LayerName]=m,this.LayerNodeArr[g]=m,m.LayerArrID=g}this.LoadBo=!0,this._showAllBo?this.addAll():this.setLocationFun(this.node.x,this.node.y),null!=this.cInit&&(this.cInit(),this.cInit=null),window.hitObj=this.hitObj,null!=this.Init&&this.Init()}}),cc._RF.pop()},{}],BonusData:[function(t,e,i){"use strict";cc._RF.push(e,"074eevyDWlDz7sXDcJjAekS","BonusData"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../../util/structure/hd_map"),o=t("../../game/user_info/user_info"),r=t("../../game/tools/storage_control"),a=t("../../util/storage"),s=function(){function t(){}return t.parseSignInData=function(e){if(e)for(var i in e)if(e.hasOwnProperty(i)){var n=e[i],o=new l;o.id=i,o.name=n.name,o.reward_id=n.reward_id,o.numb=n.numb,o.day=n.day,o.icon=n.icon,o.tag=n.tag,t.signInDatMap_.put(i,o)}},t.parseTaskData=function(e){if(e){var i=!1;for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],a=new h;a.id=n,a.name=r.name,a.target=r.target,a.reward_id1=r.reward_id1,a.reward_id2=r.reward_id2,a.numb1=r.numb1,a.numb2=r.numb2,a.difficulty=r.difficulty,t.taskDataMap_.put(n,a),o.GameUserInfo.dailyDat.taskDegMap.containsKey(n)||(i=!0,o.GameUserInfo.dailyDat.taskDegMap.put(n,0),o.GameUserInfo.dailyDat.taskBonusMap.put(n,!1))}i&&o.GameUserInfo.saveSignIn()}},t.parseBoxData=function(e){if(e)for(var i in e)if(e.hasOwnProperty(i)){var n=e[i],o=new c;o.id=i,o.name=n.name,o.reward_id=n.reward_id,o.numb=n.numb,o.probability_qingtong=100*n.probability_qingtong,o.probability_huangjin=100*n.probability_huangjin,o.icon=n.icon,t.goldenBoxTotalProbability+=100*n.probability_huangjin,t.silverBoxTotalProbability+=100*n.probability_qingtong,t.boxDataMap_.put(i,o)}},t.parseAchievementData=function(e){if(e){var i=!1;for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],a=new u;a.id=n,a.name=r.name,a.target=r.target,a.reward_id=r.reward_id,a.numb=r.numb,a.difficulty=r.difficulty,t.achievementDataMap_.put(n,a),o.GameUserInfo.achievement.taskFullMap.containsKey(n)||(i=!0,o.GameUserInfo.achievement.taskFullMap.put(n,0),o.GameUserInfo.achievement.taskReceiveMap.put(n,!1))}i&&o.GameUserInfo.saveAchievement()}},Object.defineProperty(t,"getboxDataMap",{get:function(){return t.boxDataMap_},enumerable:!0,configurable:!0}),Object.defineProperty(t,"getGoldenProbability",{get:function(){return t.goldenBoxTotalProbability},enumerable:!0,configurable:!0}),Object.defineProperty(t,"getSilverProbability",{get:function(){return t.silverBoxTotalProbability},enumerable:!0,configurable:!0}),t.getSignInData=function(e){return t.signInDatMap_.get(e)},t.getTaskData=function(e){return t.taskDataMap_.get(e)},t.getAchievements=function(){var e=[],i=[],n=[];return t.achievementDataMap_.each(function(t,r,a){var s=o.GameUserInfo.achievement.taskFullMap.get(a.id);if(s<a.target)e.push(a);else if(s>=a.target){o.GameUserInfo.achievement.taskReceiveMap.get(a.id)?n.push(a):i.push(a)}}),i.concat(e,n)},t.getAchievement=function(e){return t.achievementDataMap_.get(e)},Object.defineProperty(t,"getAchievementSize",{get:function(){return t.achievementDataMap_.size()},enumerable:!0,configurable:!0}),t.isRefreshTask=function(){if(t.preInitTime>0){var e=(new Date).getTime();if(e-t.preInitTime>=432e5){var i=(e-t.preInitTime)/432e5;return t.preInitTime=e-432e5*(i-Math.floor(i)),t.savePreInitTime(),2}return 3}return t.preInitTime=(new Date).getTime(),t.savePreInitTime(),1},t.getRefreshTime=function(){return 432e5-((new Date).getTime()-t.preInitTime)},t.getTasks=function(){var e=[];2===t.isRefreshTask()?(e=t._getDataGroup(t.taskDataMap_,4,t.preTaskId+4)).length>0&&(t.preTaskId=e[0].id,t.save()):e=t._getDataGroup(t.taskDataMap_,4,t.preTaskId);for(var i=[],n=[],r=[],a=0;a<e.length;a++){var s=e[a],h=o.GameUserInfo.dailyDat.taskDegMap.get(s.id);if(h<s.target)i.push(s);else if(h>=s.target){o.GameUserInfo.dailyDat.taskBonusMap.get(s.id)?r.push(s):n.push(s)}}return n.concat(i,r)},t.read=function(){t.preTaskId=r.default.instance.getNum(a.SaveDef.kPreTaskId,0),t.preInitTime=r.default.instance.getNum(a.SaveDef.initTaskTime,0)},t.save=function(){r.default.instance.setNum(a.SaveDef.kPreTaskId,t.preTaskId)},t.savePreInitTime=function(){r.default.instance.setNum(a.SaveDef.initTaskTime,t.preInitTime)},t._getDataGroup=function(t,e,i){var n=[],o=t.size();if(o>0)for(var r=0;r<e;r++,i++)i===o&&(i=0),n.push(t.getByIndex(i));return n},t.preInitTime=0,t.signInDatMap_=new n.default,t.taskDataMap_=new n.default,t.boxDataMap_=new n.default,t.achievementDataMap_=new n.default,t.preTaskId=0,t.goldenBoxTotalProbability=0,t.silverBoxTotalProbability=0,t}();i.BonusData=s;var h=function(){return function(){this.id=null,this.name="",this.target=null,this.reward_id1=null,this.numb1=null,this.reward_id2=null,this.numb2=null,this.difficulty=null}}();i.TaskData=h;var l=function(){return function(){this.id=null,this.name="",this.reward_id=null,this.numb=0,this.day=null,this.icon=null,this.tag=null}}();i.SignInData=l;var c=function(){return function(){this.id=null,this.name="",this.reward_id=null,this.numb=0,this.probability_qingtong=0,this.probability_huangjin=0,this.icon=""}}();i.SignInBoxData=c;var u=function(){return function(){this.id=null,this.name="",this.target=null,this.reward_id=null,this.numb=null,this.difficulty=null}}();i.AchievementData=u,cc._RF.pop()},{"../../game/tools/storage_control":"storage_control","../../game/user_info/user_info":"user_info","../../util/storage":"storage","../../util/structure/hd_map":"hd_map"}],EndLayer:[function(t,e,i){"use strict";cc._RF.push(e,"89929+dmv1HDIIgvxxbfEz1","EndLayer");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../common/base_ui"),a=t("../../util/mgp_util"),s=t("../../data/data_hub"),h=t("../../util/global_def"),l=t("../../game_logic"),c=cc._decorator,u=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.closeCb=null,e.isBannerJump=!1,e}var i;return n(e,t),i=e,e.prototype.init=function(t){var e=this;t&&(this.com_=t,t.sortingOrder=r.UIHierarchy.KEndLayer,this.isBannerJump=!1,r.BaseUI.root.addChild(t),this.com_.enabled=!1,l.default.instance.scheduleOnce(function(){if(h.G.randRange(0,100)<s.DataHub.config.bnrJumpProb){e.isBannerJump=!0;var i=t.getChild("bannerLine");a.MgpUtil.preloadBanner(h.G.bannerIDs[1],i,400,s.DataHub.config.bnrGap,null,null,1,s.DataHub.config.bnrRefresh,"endLayer",250)}},5))},e.prototype.showBAd=function(t){if(this.closeCb=t,this.isBannerJump){a.MgpUtil.showBannerWithRule(h.G.bannerIDs[1],null,null,"endLayer");var e=this;l.default.instance.scheduleOnce(function(){e.hideBAd()},1.5)}else this.hideBAd()},e.prototype.hideBAd=function(){this.isBannerJump&&a.MgpUtil.hideBanner(h.G.bannerIDs[1],"endLayer"),this.closeCb&&this.closeCb(),this.closeCb=null},e.instance=new i,e=i=o([u],e)}(r.BaseUI));i.default=p,cc._RF.pop()},{"../../data/data_hub":"data_hub","../../game_logic":"game_logic","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../common/base_ui":"base_ui"}],EnemyFactory:[function(t,e,i){"use strict";cc._RF.push(e,"48345fc2OVP7JhkVByYP/F6","EnemyFactory");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.hidHole=i.hidAct=void 0;var r=t("../../tools/resource_control"),a=t("../enemy"),s=t("../../scene/gameScene"),h=t("../../../util/global_def"),l=t("../../../game_logic"),c=t("../../../util/event_mgr"),u=t("../lifeBase"),p=cc._decorator,d=p.ccclass,f=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.addEnemy=function(t,e){var i=r.default.instance.getPrefabs("enemy");"b"==t[0]&&(i=r.default.instance.getPrefabs(t));var n=cc.instantiate(i);return n.getComponent("enemy").init(t,!0,e),n},e.prototype.create=function(t){for(var e=t.hid?t.hid.y:1,i=t.hid?t.hid.x:0,n=t.time?t.time.x:0,o=t.hid?1:0,r=t.index?t.index.x:null,a=t.count?t.count.x:1,s=t.name.substr(2),h=0;h<a;++h){var u=t.scaleX||1,p=this.addEnemy(s,u);p.parent=t.parent;var d=cc.v2(t.width/2,t.height/2);p.position=cc.v3(t.x+d.x,t.y-d.y,t.z);var f=null;null!=r?f=p.addComponent(y):0==o?f=p.addComponent(g):1==o&&(f=p.addComponent(m)),f.init(i,n,o,r,e),l.default.instance.eventManager.addEvent(c.EventType.KGuide,p)}t.destroy()},e.instance=null,e=o([d],e)}(cc.Component));i.default=f;var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dx=null,e.v=null,e.time=null,e.type=null,e.index=null,e.act=null,e.entity=null,e}return n(e,t),e.prototype.init=function(t,e,i,n,o){this.dx=t,this.v=o,this.time=e,this.type=i,this.index=n},e.prototype.onLoad=function(){var t=this;this.act=this.node.getComponent(a.enemyAct),this.entity=this.node.getComponent(u.default),this.act.enabled=!1,this.schedule(function(){s.default.instance.hero&&t.check()},.1,cc.macro.REPEAT_FOREVER,.1)},e.prototype.check=function(){},e}(cc.Component);i.hidAct=_;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.check=function(){var t=this,e=h.G.viewX/2,i=this.node.convertToWorldSpaceAR(cc.v2(0,0));s.default.instance.mapCamera.convertToNodeSpaceAR(i).x<e&&this.scheduleOnce(function(){t.act.enabled=!0,t.node.removeComponent(_)},this.time)},e}(_),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.change=!1,e.active=!1,e}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.entity.enabled=!1,this.node.getComponent(cc.BoxCollider).enabled=!1,this.node.scale=0},e.prototype.check=function(){var t=this,e=s.default.instance.hero,i=this.node.position.sub(e.position);Math.abs(i.x-this.dx)<50&&Math.abs(i.y)<400&&this.scheduleOnce(function(){t.entity.enabled=!0,t.show()},this.time)},e.prototype.show=function(){this.node.getComponent(cc.BoxCollider).enabled=!0,this.node.x+=h.G.randRange(-50,50),this.node.scale=this.act.originSc,this.act.playTime=100;var t=(s.default.instance.hero.x-this.node.x)/2,e=t/Math.abs(t);Math.abs(t)>100&&(t=100*e),this.node.scaleX=-e*this.act.originSc;var i=600;0==this.v&&(t=0,i=200),this.act.jump(t,i,!0),this.unscheduleAllCallbacks()},e.prototype.update=function(){if(!this.change&&this.act.entity.lineVelocity.y<=0){this.change=!0;var t=s.default.instance.map,e=t.getLayerNodeFun("before");this.act.isBoss&&(e=t.getLayerNodeFun("before1")),this.node.parent=null,this.node.parent=e}this.active||0!=this.act.entity.gravity||(this.active=!0,this.act.enabled=!0,this.node.removeComponent(_))},e}(_),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.check=function(){},e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.node.addComponent(u.checkLimit);var i=this,n=l.default.instance.eventManager.addListener(c.EventType.KActiveEnemy,function(t){var o=Number(t.num);i.index==o&&(l.default.instance.eventManager.removeListener(c.EventType.KActiveEnemy,n,!0),l.default.instance.eventManager.addEvent(c.EventType.KActiveEnemySucc,{num:1,act:e.act}),i.entity.enabled=!0,i.show())});s.default.instance.listenerManager.push({key:c.EventType.KActiveEnemy,id:n})},e}(m),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.node.getComponent(cc.BoxCollider).enabled=!1,this.entity.enabled=!1;var i=this,n=l.default.instance.eventManager.addListener(c.EventType.KActiveEnemy,function(t,o){255==o.index&&o.holdId==i.node.holdId&&(e.scheduleOnce(i.show.bind(e),2*Math.random()),l.default.instance.eventManager.removeListener(c.EventType.KActiveEnemy,n,!0))});s.default.instance.listenerManager.push({key:c.EventType.KActiveEnemy,id:n})},e.prototype.show=function(){var t=this,e=this.node.scaleX>0?-50:50;this.entity.ani.playAnimation(this.act.aniName.aniMv,-1);var i=this;this.node.runAction(cc.sequence(cc.moveTo(1,cc.v2(e,0)),cc.callFunc(function(){var e=s.default.instance.map.getLayerNodeFun("before"),n=i.node.convertToWorldSpaceAR(cc.v2(0,0));n=e.convertToNodeSpaceAR(n),i.node.parent=null,i.node.parent=e,i.node.position=cc.v3(n),t.node.getComponent(cc.BoxCollider).enabled=!0,i.entity.enabled=!0,i.act.enabled=!0;var o=t.node.scaleX>0?a.eActState.left:a.eActState.right;h.G.randRange(0,100)>50?i.act.setState(a.eActState.idle):i.act.setState(o)})))},e}(_);i.hidHole=v,cc._RF.pop()},{"../../../game_logic":"game_logic","../../../util/event_mgr":"event_mgr","../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../../tools/resource_control":"resource_control","../enemy":"enemy","../lifeBase":"lifeBase"}],ExportFriPnl:[function(t,e,i){"use strict";cc._RF.push(e,"a8536o31JVNlLRpQkSD7pDZ","ExportFriPnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=(r.property,t("../common/base_ui")),h=t("../common/export_ui"),l=t("../../util/mgp_util"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.closeCb=null,e}var i;return n(e,t),i=e,e.prototype.init=function(t){if(t){this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height);var e=t.getChild(h.ExportUIName.KEPF).asCom;t.visible=!1,t.sortingOrder=s.UIHierarchy.KExprotFriPnl,s.BaseUI.root.addChild(t),e.getChild("closeBtn").asButton.onClick(this.hide.bind(this)),h.ExportUIInst.bindRCScrollEx(h.ExportUIName.KEPF,t,10,10,0,"",h.ExportTransType.kNone,null,null,5,!0,2,!0,2,.8)}},e.prototype.show=function(t){this.closeCb=t,this.com_&&0==this.com_.visible&&(this.com_.visible=!0,h.ExportUIInst.showTM(h.ExportUIName.KEPF,h.ExportTmID.KExprotFri),h.ExportUIInst.show(h.ExportUIName.KEPF)),l.MgpUtil.hideCurBanner()},e.prototype.hide=function(){h.ExportUIInst.hide(h.ExportUIName.KEPF),this.com_.visible=!1,this.closeCb&&this.closeCb()},e.instance=new i,e=i=o([a],e)}(s.BaseUI);i.default=c,cc._RF.pop()},{"../../util/mgp_util":"mgp_util","../common/base_ui":"base_ui","../common/export_ui":"export_ui"}],ExportPnl:[function(t,e,i){"use strict";cc._RF.push(e,"223f86NUN5HfI52VWmkIWHE","ExportPnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.ExportPnl=void 0;var o=t("../common/base_ui"),r=t("../common/export_ui"),a=t("../../util/global_def"),s=t("../../data/data_hub"),h=t("../../util/mgp_util"),l=t("../../game_logic"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.closeCb=null,e._firstClick=!0,e._time=null,e._timeLab=null,e.cutDown=!1,e.positionId=null,e.creativeId=null,e.listData=null,e}return n(e,t),e.prototype.init=function(t){var e=this;if(t){this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),t.visible=!1,t.sortingOrder=o.UIHierarchy.kExportPnl;var i=t.getChild(r.ExportUIName.kEP0).asCom;this._time=i.getChild("time").asCom,this._time.node.addComponent(cc.BlockInputEvents),this._timeLab=i.getChild("timeLab").asLabel,i.getChild("backToHome").asButton.onClick(this.hide.bind(this),this),o.BaseUI.root.addChild(t),r.ExportUIInst.bindRCScrollEx(r.ExportUIName.kEP0,t,15,20,0,"",r.ExportTransType.kNone,null,null,5,!0,2,!0,2,.8),a.G.getTmSdkData(r.ExportTmID.kExportPnl,function(t){e.setData(t)})}},e.prototype.show=function(t,e){var i=this;if(void 0===e&&(e=0),this.setData(this.listData),0==e)this._time.visible=!1,this._timeLab.visible=!1;else{this.cutDown=!0,this._time.visible=!0,this._timeLab.visible=!0;var n=10;this._timeLab.text=n+"\u79d2",l.default.instance.schedule(function(){n--,i._timeLab.text=n+"\u79d2",0==n&&(i.cutDown=!1,i.close())},1,10,1),h.MgpUtil.hideCurBanner()}this._firstClick=!0,this.closeCb=t,this.com_&&(this.com_.visible=!0,r.ExportUIInst.hideAll(),r.ExportUIInst.showTM(r.ExportUIName.kEP0,r.ExportTmID.kExportPnl),r.ExportUIInst.show(r.ExportUIName.kEP0))},e.prototype.close=function(){r.ExportUIInst.hide(r.ExportUIName.kEP0),this.com_.visible=!1,this.closeCb&&this.closeCb()},e.prototype.hide=function(){var t=this;0==s.DataHub.blockType&&this._firstClick?(this._firstClick=!1,r.ExportUI.instance.navigateTM(this.positionId,this.creativeId)):(a.G.Game.forceVideo=!0,t.close())},e.prototype.setData=function(t){if(null!=t&&0!=t.length){null==this.listData&&(this.listData=t);var e=t[a.G.randRange(0,t.length-1)];this.positionId=e.positionId,this.creativeId=e.creativeId}},e.instance=new e,e}(o.BaseUI);i.ExportPnl=c,cc._RF.pop()},{"../../data/data_hub":"data_hub","../../game_logic":"game_logic","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../common/base_ui":"base_ui","../common/export_ui":"export_ui"}],GamePnl:[function(t,e,i){"use strict";cc._RF.push(e,"70a9a+62WBCoIY5Bt07p7ds","GamePnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../common/base_ui"),a=t("../common/export_ui"),s=t("../../game/tools/resource_control"),h=t("../../util/global_def"),l=cc._decorator,c=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconNewItme=null,e.newItemIconManager=[],e.content=null,e.pos=null,e.hasInit=!1,e}var i;return n(e,t),i=e,e.prototype.init=function(t){t&&(this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),t.visible=!1,t.sortingOrder=r.UIHierarchy.KGamePnl,r.BaseUI.root.addChild(t),this.content=t.getChild(a.ExportUIName.KGSL1).node,this.pos=this.content.position,this.iconNewItme=s.default.instance.getPrefabs("iconNewItem"),this.initSDK())},e.prototype.show=function(){this.com_&&(this.com_.visible=!0)},e.prototype.hide=function(){this.com_&&(this.com_.visible=!1)},e.prototype.setData=function(t){if(null!=t&&0!=t.length){h.G.randRange(0,t.length-1);var e=t;this.createNewItem(0,e,this.pos.x,this.pos.y,.8,this.content.parent,0)}},e.prototype.initSDK=function(){var t=this;h.G.getTmSdkData(a.ExportTmID.KHomeSigles,function(e){t.setData(e)})},e.prototype.createNewItem=function(t,e,i,n,o,r,a){var s=this.newItemIconManager[t];if(!s){if(s=cc.instantiate(this.iconNewItme),r.addChild(s),o){s.scale=o,s.getComponent("iconItem").init(e,this.setData,this),i&&(s.x=i),n&&(s.y=n),this.newItemIconManager[t]=s;s.runAction(cc.repeatForever(cc.sequence(cc.delayTime(3),cc.rotateBy(.12,8),cc.rotateBy(.12,-8),cc.rotateBy(.12,-8),cc.rotateBy(.12,8))))}var l=cc.repeatForever(cc.sequence(cc.scaleTo(.1,.8*o,.8*o),cc.scaleTo(.1,1.1*o,1.1*o),cc.scaleTo(.1,.8*o,.8*o),cc.scaleTo(.1,1.1*o,1.1*o),cc.scaleTo(.1,.9*o,.9*o),cc.scaleTo(.1,1*o,1*o),cc.delayTime(2)));return s.runAction(l),s}h.G.console("\u5237\u65b0icon"),s.getComponent("iconItem").init(e,this.setData,this)},e.instance=new i,e=i=o([c],e)}(r.BaseUI));i.default=u,cc._RF.pop()},{"../../game/tools/resource_control":"resource_control","../../util/global_def":"global_def","../common/base_ui":"base_ui","../common/export_ui":"export_ui"}],HDSDK:[function(t,e,i){"use strict";cc._RF.push(e,"33520KCnLdOhY5QZMcLVQin","HDSDK"),Object.defineProperty(i,"__esModule",{value:!0});var n="https://huandong-1257458597.cos.ap-guangzhou.myqcloud.com/HDSDK/NavList/Pub/",o="https://huandong-1257458597.cos.ap-guangzhou.myqcloud.com/HDSDK/NavList/QRCode/",r="https://huandong-1257458597.cos.ap-guangzhou.myqcloud.com/HDSDK/NavList/Banner/",a="https://login.joyfulh.com/comLogin",s="https://statistic.joyfulh.com/statistic",h="/jumpData/getJumpData",l="/data/updImportStat",c="/data/updExportStat",u=function(){return function(){this.url="",this.data=""}}(),p=function(){return function(){this.gridCb=null,this.likeCb=null,this.qrCb=null,this.bnrCb=null}}(),d=function(){return function(){this.sn=0,this.path="",this.img="",this.type=0,this.extra=null,this.appId="",this.id="",this.name="",this.alias="",this.qrUrl="",this.bnrUrl="",this.tag=0,this.verCode="",this.box=0,this.tmPosId="",this.tmCid=""}}();i.HDNavData=d;var f=function(){function t(){}return Object.defineProperty(t,"needUpdateNavData",{get:function(){return this.bUpdateNav_},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isDataExisted",{get:function(){return this.bDataExisted_},enumerable:!0,configurable:!0}),Object.defineProperty(t,"getForceNavIds",{get:function(){return this.forceIds_},enumerable:!0,configurable:!0}),t.getForceNavData=function(t){var e=null;if(this.forceMap_[t]){var i=this.forceMap_[t];if(i){var n=i.length-1;e=i[Math.round(Math.random()*(n-0))+0]}}return e},t.register=function(t,e,i,n,o){this._readSave(),this.bRegister_=!0;var r=Date.now()-this.loginTime_;this.openID_&&""!==this.openID_&&"null"!=this.openID_&&r<=144e5?(this.init(this.openID_,t,e,i,n,o),console.log("[HDSDK] no need login",r,this.openID_)):this._isWechat?(console.log("[HDSDK] login for SDK"),this._login(t,e,i,n,o)):this.init("",t,e,i,n,o)},t.init=function(t,e,i,n,o,r){if(this.openID_=t||"",this.proName_=e,this.bRegister_||this._readSave(),console.log("[HDSDK] init",this.newUser_,e,this.openID_),Date.now()-this.lastRefreshTime_>9e5?(this.bDownloaded_=!1,this.loadNativeData(i,n,o,r),this._requstQueue(i,n,o,r)):(this.gridArr_.length>0&&i&&i(this.gridArr_),this.likeArr_.length>0&&n&&n(this.likeArr_),this.qrArr_.length>0&&o&&o(this.qrArr_),this.bnrArr_.length>0&&r&&r(this.bnrArr_)),this._isWechat){var a=wx.getLaunchOptionsSync();if(a.query&&(a.query.hdg&&""!=a.query.hdg||a.query.HDg_nav_0&&""!=a.query.HDg_nav_0)){var s=a.query.HDg_nav_0||a.query.hdg;this._reportImportStat(e,t,s)}}this.bRegister_=!1,this.newUser_=0,""!=this.openID_&&"null"!=this.openID_&&(this._isWechat?(wx.setStorageSync("user",this.openID_),wx.setStorageSync("login",this.loginTime_)):localStorage.setItem("user",this.openID_))},t.loadNativeData=function(t,e,i,n){var o=this;this.bLoadedNative_||(void 0!==window.Laya?window.Laya.loader.load("data/hd_nav.json",window.Laya.Handler.create(null,function(){var r=window.Laya.loader.getRes("data/hd_nav.json");r?(o._parseNavData(r,t,e,i,n),window.Laya.loader.clearRes("data/hd_nav.json")):console.log("no native data")}),null,window.Laya.Loader.JSON):void 0!==window.cc&&window.cc.loader.loadRes("data/hd_nav.json",window.cc.JsonAsset,function(o,r){o?console.log("no native data"):(this._parseNavData(r.json,t,e,i,n),window.cc.loader.release(r))}))},t.getGridArray=function(){return this.gridArr_},t.getLikeArray=function(){return this.likeArr_},t.getQRCodeArray=function(){return this.qrArr_},t.getBannerArray=function(){return this.bnrArr_},t.navigate=function(t,e,i){var n=this;if(this._isWechat){if(this.datMap_[t]){var o=this.datMap_[t];if(3===o.type)wx.previewImage({urls:[o.qrUrl],success:function(t){console.log("[HDSDK] navigate qr")}});else{var r=wx.getSystemInfoSync();if(1==this._compareVersionForWx(r.SDKVersion,"2.2.0")){if(1===o.box&&-1!==r.platform.indexOf("ios"))return void(i&&i());wx.navigateToMiniProgram({appId:o.appId,path:o.path,extraData:o.extra,success:function(){n._reportExportStat(o),e&&e()},fail:function(){i&&i()}})}else wx.showModal({title:"\u7248\u672c\u63d0\u793a",content:"\u5fae\u4fe1\u7248\u672c\u8f83\u4f4e\uff0c\u6682\u4e0d\u652f\u6301\u6e38\u620f\u8df3\u8f6c"})}}}else{var a=this.datMap_[t];console.log("[HDSDK] not wechat platform,navigate data is",a.sn,a.name,a)}},t.uploadImportData=function(t){1===this.newUser_&&this._reportImportStat(this.proName_,this.openID_,t)},t._fetchData=function(t,e,i,n,o){var r=this;t&&""!==t&&this._getNavData(t,function(a){if(console.log("[HDSDK] fetch data",a),a&&a.res){1===r.currPage_&&a.res.length>0&&(r.bUpdateNav_=!0,r.bDownloaded_=!0,r.datMap_={},r.forceMap_={},r.forceIds_=[],r.gridArr_=[],r.likeArr_=[],r.qrArr_=[],r.bnrArr_=[],r.reqQue_=[],r.bDataExisted_=!1,console.log("[HDSDK] page one clear flag")),a.res.length>0&&(++r.currPage_,r._fetchData(t,e,i,n,o));for(var s=a.res,h=0;h<s.length;++h)r._createNavData(s[h]);r.gridArr_.length>0||r.likeArr_.length>0?r.lastRefreshTime_=Date.now():r.lastRefreshTime_=0,0==a.res.length&&r.currPage_>=1&&(e&&e(r.gridArr_),i&&i(r.likeArr_),n&&n(r.qrArr_),o&&o(r.bnrArr_),r.bDataExisted_=!0)}})},t._readSave=function(){var t=null;if(this._isWechat)try{t=wx.getStorageSync("user");var e=wx.getStorageSync("login");this.loginTime_=Number(e)}catch(e){this.loginTime_=0,t=null}else t=localStorage.getItem("user");t?(this.newUser_=0,console.log("[HDSDK] read dat",t,this.loginTime_),""!=t&&"null"!=t&&(this.openID_=t)):this.newUser_=1},t._getNavData=function(t,e){var i=a+h,n={proName:t,page:this.currPage_,limit:20};this._common(i,n,e)},t._parseNavData=function(t,e,i,n,o){if(!this.bDownloaded_){for(var r in t)t.hasOwnProperty(r)&&this._createNavData(t[r],!0);e&&this.gridArr_.length>0&&e(this.gridArr_),i&&this.likeArr_.length>0&&i(this.likeArr_),n&&this.qrArr_.length>0&&n(this.qrArr_),o&&this.bnrArr_.length>0&&o(this.bnrArr_),this.bLoadedNative_=!0,this.bDataExisted_=!0,console.log("[HDSDK] load native data")}},t._checkUpdate=function(t){var e=!1,i=t.id+"_"+t.s;if(this.datMap_[i]){var n=this.datMap_[i],o=this._genVerificationCode(t);n.verCode!=o&&(e=!0)}return e},t._createNavData=function(t,e){void 0===e&&(e=!1);var i=new d;if(-1!==t.img.indexOf(".")?i.img=n+t.img:i.img=n+t.img+".png",i.sn=t.s,i.type=t.t,i.name=t.n,i.path=t.p,i.alias=t.a,""!==t.e&&(i.extra=JSON.parse(t.e)),i.appId=t.id,i.id=i.appId+"_"+i.sn,e&&(i.verCode=this._genVerificationCode(t)),i.extra){if(i.extra.bnr){var a=i.extra.bnr;-1!==a.indexOf(".")?i.bnrUrl=r+a:i.bnrUrl=r+a+".png",this.bnrArr_.push(i)}if(i.extra.tag&&(i.tag=1),i.extra.box&&(i.box=1),i.extra.force)if(this.forceMap_[i.appId])this.forceMap_[i.appId].push(i);else this.forceMap_[i.appId]=[],this.forceMap_[i.appId].push(i),this.forceIds_.push(i.appId)}if(1===t.t)this.gridArr_.push(i);else if(2===t.t)this.likeArr_.push(i);else if(3===t.t){if(i.extra&&i.extra.qr){var s=i.extra.qr;-1!==s.indexOf(".")?i.qrUrl=o+s:i.qrUrl=o+s+".png"}this.qrArr_.push(i)}else 4===t.t&&(this.gridArr_.push(i),this.likeArr_.push(i));this.datMap_[i.id]=i},t._genVerificationCode=function(t){var e=t.s+t.n+t.a,i=t.p,n=i.length+i.charAt(0)+i.charAt(Math.round(i.length/2))+i.charAt(i.length-1),o="";if(""!==t.e){var r=t.e;o=r.length+r.charAt(0)+r.charAt(Math.round(r.length/2))+r.charAt(r.length-1)}return e+n+o},t._reportImportStat=function(t,e,i){if(null!=e&&"null"!=e&&""!=e){var n=s+l,o={proName:t,openid:e,source:i};this._common(n,o,null),console.log("[HDSDK] import stat",e,i)}else this._login(t),console.error("[HDSDK] _reportImportStat openId\u4e0d\u5b58\u5728\uff0c\u8bf7\u4fdd\u8bc1openId\u7684\u83b7\u53d6")},t._reportExportStat=function(t){if(null!=this.openID_&&"null"!=this.openID_&&""!=this.openID_){var e=s+c,i="";""!==t.bnrUrl?i="banner"+t.sn:1==t.type?i="grid"+t.sn:2==t.type?i="like"+t.sn:4==t.type&&(i="all"+t.sn);var n={proName:this.proName_,openid:this.openID_,gameName:t.name,location:i,appid:t.appId,alias:t.alias};this._common(e,n,null),console.log("[HDSDK] export stat",this.openID_,t.appId,t.id,t.name)}else console.error("[HDSDK] _reportExportStat openId\u4e0d\u5b58\u5728\uff0c\u8bf7\u4fdd\u8bc1openId\u7684\u83b7\u53d6")},t._common=function(t,e,i,n){if(null!=e){var o=new u;if(o.url=t,"object"==typeof e){for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];if(null==a)continue;if(""!=o.data&&(o.data+="&"),"object"==typeof a){var s=JSON.stringify(a);o.data+=r+"="+encodeURI(s)}else"string"==typeof a||"number"==typeof a||"boolean"==typeof a?o.data+=r+"="+encodeURI(a.toString()):(o.data+=r+"="+encodeURI(a.toString()),console.warn("[HttpRequest] please check your data type,only support object,string,number or boolean"))}}else o.data=encodeURI(e);this._send(o,i,n),o=null}else console.error("[HttpRequest] failed")},t._send=function(t,e,i){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&n.status>=200&&n.status<400?(console.log("[HDSDK] req succ",n.responseText),e&&e(JSON.parse(n.responseText))):(n.status<200||n.status>=400)&&console.log("[HDSDK] conn",n.readyState,n.status)},n.onerror=function(){console.log("[HDSDK] error",n.status),i&&i()};var o=t.url+"?"+t.data;n.open("GET",o,!0),n.send()},t._compareVersionForWx=function(t,e){for(var i=t.split("."),n=e.split("."),o=Math.max(i.length,n.length);i.length<o;)i.push("0");for(;n.length<o;)n.push("0");for(var r=0;r<o;r++){var a=parseInt(i[r]),s=parseInt(n[r]);if(a>s)return 1;if(a<s)return-1}return 0},t._requstQueue=function(t,e,i,n){if(this.reqLimited_<5&&!this.bDownloaded_){var o=new p;o.gridCb=t,o.likeCb=e,o.qrCb=i,o.bnrCb=n,this.reqQue_.push(o),console.log("[HDSDK] _requstQueue",this.reqQue_.length)}++this.reqLimited_,this._requestProc()},t._requestProc=function(){if(Date.now()-this.lastReqTime_>1e4){var t=this.reqQue_.shift();t&&(this.lastReqTime_=Date.now(),this.currPage_=1,this._fetchData(this.proName_,t.gridCb,t.likeCb,t.qrCb,t.bnrCb),clearTimeout(this.reqTimerId_),this.reqTimerId_=setTimeout(this._requestProc.bind(this),15e3),console.log("[HDSDK] _requestProc",this.reqQue_.length))}},t._login=function(t,e,i,n,o){var r=this;wx.login({success:function(s){s.code&&wx.request({url:a+"/user/getSessionKey",data:{code:s.code,proName:t,choose:"1"},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(a){if(a.statusCode>=200&&a.statusCode<=400){console.log("[HDSDK] login request succ",a),r.loginTime_=Date.now();var s=JSON.parse(a.data.res);s&&s.openId&&r.init(s.openId,t,e,i,n,o)}else console.log("[HDSDK] login request fail",a),r.init("",t,e,i,n,o)},fail:function(t){console.log("[HDSDK] login request error",t)}})},fail:function(a){console.log("[HDSDK] wx login error",a),r.init("",t,e,i,n,o)},complete:function(t){}})},Object.defineProperty(t,"_isWechat",{get:function(){return"undefined"!=typeof wx},enumerable:!0,configurable:!0}),t.gridArr_=[],t.likeArr_=[],t.qrArr_=[],t.bnrArr_=[],t.forceMap_={},t.forceIds_=[],t.datMap_={},t.openID_="",t.proName_="",t.lastRefreshTime_=0,t.lastReqTime_=0,t.reqQue_=[],t.reqLimited_=0,t.bDownloaded_=!1,t.reqTimerId_=0,t.autoTimerId_=0,t.newUser_=1,t.currPage_=1,t.loginTime_=0,t.dataLen_=0,t.bRegister_=!1,t.bLoadedNative_=!1,t.bUpdateNav_=!1,t.bDataExisted_=!1,t}();i.HDSDK=f,cc._RF.pop()},{}],HomePnl:[function(t,e,i){"use strict";cc._RF.push(e,"4d63cWYUE1NSICTorlh+v92","HomePnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=t("../common/base_ui"),r=t("../common/export_ui"),a=t("./StoryPnl"),s=t("./SignInPnl"),h=t("./repository"),l=t("./TaskPnl"),c=t("../../util/global_def"),u=t("../../util/audio_mgr"),p=t("../common/tip_ui"),d=t("../../game/scene/home"),f=t("../../util/mgp_util"),_=t("./ExportFriPnl"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicBtn=null,e.vibrateBtn=null,e}return n(e,t),e.prototype.init=function(t){if(t){t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),this.com_=t,r.ExportUIInst.bindRCScroll(r.ExportUIName.kHMHor0,this.com_,0,0,c.G.randRange(0,5),r.ExportTransType.kShake,null,function(){_.default.instance.show(function(){e.instance.showExport()})}),r.ExportUIInst.bindRCScroll(r.ExportUIName.kHMHor1,this.com_,0,0,c.G.randRange(5,7),r.ExportTransType.kShake,null,function(){_.default.instance.show(function(){e.instance.showExport()})}),t.getChild("roleBtn").asButton.onClick(this.openRepositoryPnl.bind(this),this),t.getChild("loginBtn").asButton.onClick(this.openSignInPnl.bind(this),this),t.getChild("taskBtn").asButton.onClick(this.openTaskPnl.bind(this),this),t.getChild("storyBtn").asButton.onClick(this.openStoryPnl.bind(this),this),t.getChild("friendBtn").asButton.onClick(this.openFriendMode.bind(this),this),this.musicBtn=t.getChild("musicBtn").asButton,this.musicBtn.onClick(this.onClickMusicBtn.bind(this),this),this.vibrateBtn=t.getChild("vBtn").asButton,this.vibrateBtn.onClick(this.onClickVibrabtn.bind(this),this),t.visible=!1,t.sortingOrder=o.UIHierarchy.kHomePnl,o.BaseUI.root.addChild(t),t.getChild("deathMatchBtn").asButton.onClick(function(){_.default.instance.show()});var i=t.getChild("deathBtn0").asButton;i.onClick(this.openDeathMatch.bind(this),i);var n=t.getChild("deathBtn1").asButton;n.onClick(this.openDeathMatch.bind(this),this);var a=t.getChild("deathBtn2").asButton;a.onClick(this.openDeathMatch.bind(this),this);var s=t.getChild("deathBtn3").asButton;s.onClick(this.openDeathMatch.bind(this),this),i._node.num=0,n._node.num=1,a._node.num=2,s._node.num=3,this.show(),t.getChild("friBtn").asButton.onClick(this.onClickFriendBtn.bind(this),i)}},e.prototype.showRedPoint=function(t){this.com_.getChild(t).visible=!0},e.prototype.showExport=function(){r.ExportUIInst.showTM(r.ExportUIName.kHMHor0,r.ExportTmID.KHomeSigles),r.ExportUIInst.showTM(r.ExportUIName.kHMHor1,r.ExportTmID.KHomeSigles)},e.prototype.hideExport=function(){r.ExportUIInst.hide(r.ExportUIName.kHMHor0),r.ExportUIInst.hide(r.ExportUIName.kHMHor1)},e.prototype.show=function(){this.com_&&(r.ExportUIInst.hideAll(),this.showExport(),this.com_.visible=!0)},e.prototype.hide=function(){this.com_&&(this.hideExport(),this.com_.visible=!1)},e.prototype.openStoryPnl=function(){_.default.instance.show(function(){c.G.Game.isCanEnterGame?c.G.novice?d.default.instance.toGame(0,!0):(f.MgpUtil.showInterstitialAd(),a.default.instance.show()):p.TipUI.instance.show("\u8d44\u6e90\u51c6\u5907\u4e2d\u8bf7\u7a0d\u540e2\u79d2!")})},e.prototype.openDeathMatch=function(t,e){if(c.G.Game.isCanEnterGame){var i=t.target.num;d.default.instance.toDeathMath(Number(i)),this.com_.getController("deathPanel").selectedIndex=0}else p.TipUI.instance.show("\u8d44\u6e90\u51c6\u5907\u4e2d\u8bf7\u7a0d\u540e2\u79d2!")},e.prototype.openFriendMode=function(){_.default.instance.show(function(){f.MgpUtil.shareForTMSDK("homeShare")})},e.prototype.onClickMusicBtn=function(){this.musicBtn.selected?u.AudioMgr.instance.setIfMuteSound(!0):u.AudioMgr.instance.setIfMuteSound(!1)},e.prototype.onClickVibrabtn=function(){this.vibrateBtn.selected?c.G.Game.vibrate=!1:c.G.Game.vibrate=!0},e.prototype.openSignInPnl=function(){var t=this;f.MgpUtil.showInterstitialAd(),s.SignInPnl.instance.show(function(){t.showExport()})},e.prototype.openRepositoryPnl=function(){var t=this;f.MgpUtil.showInterstitialAd(),h.Repository.instance.show(function(){t.showExport()})},e.prototype.openTaskPnl=function(){var t=this;f.MgpUtil.showInterstitialAd(),l.TaskPnl.instance.show(l.TaskPnlName.task,function(){t.showExport()})},e.prototype.onClickFriendBtn=function(){var t=this;_.default.instance.show(function(){t.showExport()})},e.instance=new e,e}(o.BaseUI);i.default=g,cc._RF.pop()},{"../../game/scene/home":"home","../../util/audio_mgr":"audio_mgr","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../common/base_ui":"base_ui","../common/export_ui":"export_ui","../common/tip_ui":"tip_ui","./ExportFriPnl":"ExportFriPnl","./SignInPnl":"SignInPnl","./StoryPnl":"StoryPnl","./TaskPnl":"TaskPnl","./repository":"repository"}],ItemInfo:[function(t,e,i){"use strict";cc._RF.push(e,"8be23eoX4lDg7XqqgXsItRl","ItemInfo");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.persistent=!0,e}return n(e,t),e.prototype.init=function(){this.node.parent.removeComponent(cc.Sprite)},e.prototype.clear=function(){this.node.destroy(),window.game.map.removeMapNode(this.node.parent)},e=o([a],e)}(cc.Component));i.default=s,cc._RF.pop()},{}],Map:[function(t,e,i){"use strict";cc._RF.push(e,"e1c9e9ZocdDmIKUCOL4Uwm5","Map");var n=t("BlackMap");cc.Class({extends:n,mapObj:null,init:function(){null==window.mapData&&(window.mapData=JSON.stringify(this.mapObj)),this.o=JSON.parse(window.mapData);for(var t=["infoObj","FPS2","flagPoint","MapObj","layerRect","MapRect","tagObj","nodeParentObj","nodeAllObj","ymcMapSprArr","MapSprArr","LayerArr"],e=0;e<t.length;e++)this[t[e]]=this.o[t[e]];this.onLoad2()},onLayerFun2:function(){var t=this.o.pathObj;this.o.actObj,this.o.anchorObj,this.o.rotaObj,this.o.runObj;this.onPath(t),this.o=null},_isBo:function(t){for(var e in t)return!0;return!1}}),cc._RF.pop()},{BlackMap:"BlackMap"}],PausePnl:[function(t,e,i){"use strict";cc._RF.push(e,"a09cfDRIGpH94dEyT1DKVzO","PausePnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../common/base_ui"),a=t("../../util/transitions"),s=t("./HomePnl"),h=t("./StoryPnl"),l=t("../common/export_ui"),c=cc._decorator,u=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pauseBtn=null,e}var i;return n(e,t),i=e,e.prototype.init=function(t){t&&(t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),this.com_=t,this.pauseBtn=t.getChild("pause").asButton,this.pauseBtn.onClick(this.onClickPauseBtn.bind(this),this),t.getChild("home").asButton.onClick(this.onClickHomeBtn.bind(this),this),t.visible=!1,r.BaseUI.root.addChild(t),l.ExportUIInst.bindRCScroll(l.ExportUIName.KPau0,this.com_,0,0,5),l.ExportUIInst.bindRCScroll(l.ExportUIName.KPau1,this.com_))},e.prototype.show=function(t){this.com_&&(l.ExportUIInst.showTM(l.ExportUIName.KPau0,l.ExportTmID.kTrailSingles),l.ExportUIInst.showTM(l.ExportUIName.KPau1,l.ExportTmID.kTrailSingles),this.pauseBtn.selected=!0,this.com_.visible=!0,this.com_.getTransition("show").play(t))},e.prototype.hide=function(t){l.ExportUIInst.hide(l.ExportUIName.KPau0),l.ExportUIInst.hide(l.ExportUIName.KPau1),this.com_.getTransition("hide").play(t)},e.prototype.onClickHomeBtn=function(){cc.director.resume(),l.ExportUIInst.hide(l.ExportUIName.KPau0),l.ExportUIInst.hide(l.ExportUIName.KPau1),this.com_.visible=!1,window.mapData=null;a.default.instance.loadScene("home",["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],["Canvas/MainCamera"],"crop-circle",null,null,function(){s.default.instance.show(),h.default.instance.show()})},e.prototype.onClickPauseBtn=function(){this.pauseBtn.selected=!0,cc.director.resume(),this.hide()},e.instance=new i,e=i=o([u],e)}(r.BaseUI));i.default=p,cc._RF.pop()},{"../../util/transitions":"transitions","../common/base_ui":"base_ui","../common/export_ui":"export_ui","./HomePnl":"HomePnl","./StoryPnl":"StoryPnl"}],ResultPnl:[function(t,e,i){"use strict";cc._RF.push(e,"7f136wcQhtGzINTkI7m3+/K","ResultPnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=t("../common/base_ui"),r=t("../../game/user_info/user_info"),a=t("../common/export_ui"),s=t("./ExportPnl"),h=t("../../game/scene/uiControl"),l=t("../../util/mgp_util"),c=t("../../util/global_def"),u=t("../../data/data_hub"),p=t("../../game_logic"),d=function(){function t(){}return t.com="com",t.deathMatch="deathMatch",t}();i.ResultPageName=d;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.control=null,e.coinNum=0,e.closeCb_=null,e.abandonBtn=null,e}return n(e,t),e.prototype.init=function(t){if(t){t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),this.com_=t,this.control=t.getController("c1");var e=t.getChild("abandonBtn").asButton;e.onClick(this.hide.bind(this),this),this.abandonBtn=e,t.getChild("doubleBtn").asButton.onClick(this.doubleClick.bind(this),this),t.visible=!1,t.sortingOrder=o.UIHierarchy.kResultPnl,o.BaseUI.root.addChild(t),a.ExportUIInst.bindGrid3x3(a.ExportUIName.KResult,t,0,0,2,a.ExportTransType.kNone,null,null,5,!0,!1,1.2);var i=t.getChild("bannerLine");p.default.instance.scheduleOnce(function(){l.MgpUtil.preloadBanner(c.G.bannerIDs[0],i,300,u.DataHub.config.bnrGap,null,null,1,u.DataHub.config.bnrRefresh,"result",250)},4)}},e.prototype.show=function(t,e,i){if(void 0===t&&(t=d.com),this.closeCb_=i,this.com_){switch(a.ExportUIInst.showTM(a.ExportUIName.KResult,a.ExportTmID.kRevive),this.control.selectedPage=t,t){case d.com:this.comResult(e);break;case d.deathMatch:this.deathMatchResult(e)}this.com_.visible=!0,c.G.isCanBannerJump()?c.G.bannerNodeJump(this.abandonBtn,function(){l.MgpUtil.showBannerWithRule(c.G.bannerIDs[0],null,null,"result")}):l.MgpUtil.showBannerWithRule(c.G.bannerIDs[0],null,null,"result")}},e.prototype.hide=function(){this.com_&&(a.ExportUIInst.hide(a.ExportUIName.KResult),s.ExportPnl.instance.show(function(){h.default.instance.toHome()}),r.GameUserInfo.updUserCoin(this.coinNum),this.com_.visible=!1,l.MgpUtil.hideBanner(c.G.bannerIDs[0],"result"))},e.prototype.comResult=function(t){this.com_.getChild("coinNum").asTextField.text=t,this.coinNum=t},e.prototype.deathMatchResult=function(t){this.coinNum=t.award,t.suc?this.com_.getChild("tip").asLoader.url="ui://CommUI/suc":this.com_.getChild("tip").asLoader.url="ui://CommUI/fail",this.com_.getChild("lvl").asTextField.text=t.lv,this.com_.getChild("deathMatchCoin").asTextField.setVar("coin",t.coin).flushVars(),this.com_.getChild("time").asTextField.setVar("time",t.time).flushVars(),this.com_.getChild("damage").asTextField.setVar("damage",t.damage).flushVars(),this.com_.getChild("grade").asTextField.setVar("grade",t.grade).flushVars(),this.com_.getChild("award").asTextField.setVar("award",t.award).flushVars()},e.prototype.doubleClick=function(){var t=this;l.MgpUtil.watchVideoAds(c.G.VideoIDs[0],function(){t.coinNum=t.coinNum<<1,t.hide()},function(){})},e.instance=new e,e}(o.BaseUI);i.default=f,cc._RF.pop()},{"../../data/data_hub":"data_hub","../../game/scene/uiControl":"uiControl","../../game/user_info/user_info":"user_info","../../game_logic":"game_logic","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../common/base_ui":"base_ui","../common/export_ui":"export_ui","./ExportPnl":"ExportPnl"}],RevivePnl:[function(t,e,i){"use strict";cc._RF.push(e,"e1d0e9YP2RCVJLO3bdAXXUZ","RevivePnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.RevivePnl=void 0;var o=t("../common/base_ui"),r=t("../../game/user_info/user_info"),a=t("./ExportPnl"),s=t("../../game_logic"),h=t("../../util/event_mgr"),l=t("../common/export_ui"),c=t("../../game/scene/uiControl"),u=t("../../util/mgp_util"),p=t("../../util/global_def"),d=t("../../data/data_hub"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coinNum=null,e.coin=null,e.abandonBtn=null,e.isShow=!1,e}return n(e,t),e.prototype.init=function(t){if(t){this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height);var e=t.getChild("abandonBtn").asButton;e.onClick(this.closeClick.bind(this),this),this.abandonBtn=e,t.getChild("adReviveBtn").asButton.onClick(this.adClick.bind(this),this),this.coinNum=t.getChild("coinNum").asTextField,t.visible=!1,t.sortingOrder=o.UIHierarchy.kRevivePnl,o.BaseUI.root.addChild(t),l.ExportUIInst.bindGrid3x3(l.ExportUIName.kRevive,t,0,0,2,l.ExportTransType.kNone,null,null,5,!0,!1,1.2);var i=t.getChild("bannerLine");s.default.instance.scheduleOnce(function(){u.MgpUtil.preloadBanner(p.G.bannerIDs[0],i,300,d.DataHub.config.bnrGap,null,null,1,d.DataHub.config.bnrRefresh,"revive",250)},3)}},e.prototype.show=function(t){this.isShow||(this.isShow=!0,this.com_&&(this.coin=t,this.coinNum.text=""+t,l.ExportUIInst.hideAll(),this.com_.visible=!0,l.ExportUIInst.showTM(l.ExportUIName.kRevive,l.ExportTmID.kRevive),p.G.isCanBannerJump()?p.G.bannerNodeJump(this.abandonBtn,function(){u.MgpUtil.showBannerWithRule(p.G.bannerIDs[0],null,null,"revive")}):u.MgpUtil.showBannerWithRule(p.G.bannerIDs[0],null,null,"revive")))},e.prototype.hide=function(){this.isShow=!1,this.com_.visible=!1,l.ExportUIInst.hide(l.ExportUIName.kRevive),u.MgpUtil.hideBanner(p.G.bannerIDs[0],"revive")},e.prototype.closeClick=function(){null!=this.coin&&r.GameUserInfo.updUserCoin(this.coin),this.hide(),this.isShow=!0;var t=this;a.ExportPnl.instance.show(function(){t.isShow=!1,c.default.instance.toHome()})},e.prototype.adClick=function(){var t=this;u.MgpUtil.watchVideoAds(p.G.VideoIDs[0],function(){t.hide(),s.default.instance.eventManager.addEvent(h.EventType.kCloseRevivePnl)},function(){})},e.instance=new e,e}(o.BaseUI);i.RevivePnl=f,cc._RF.pop()},{"../../data/data_hub":"data_hub","../../game/scene/uiControl":"uiControl","../../game/user_info/user_info":"user_info","../../game_logic":"game_logic","../../util/event_mgr":"event_mgr","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../common/base_ui":"base_ui","../common/export_ui":"export_ui","./ExportPnl":"ExportPnl"}],SignInPnl:[function(t,e,i){"use strict";cc._RF.push(e,"34824jhXXFDJK+j74PU00V3","SignInPnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.SignInPnl=void 0;var o=t("../common/base_ui"),r=t("../../game/tools/resource_control"),a=t("../../game/user_info/user_info"),s=t("../common/tip_ui"),h=t("../../util/global_def"),l=t("./BonusData"),c=t("./repository"),u=t("../common/export_ui"),p=t("../../util/mgp_util"),d=t("./HomePnl"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.closeCb_=null,e.centerPointUrl1="ui://CommUI/lingxingdian1",e.centerPointUrl2="ui://CommUI/lingxingdian2",e.barUrl1="ui://CommUI/signInBar1",e.barUrl2="ui://CommUI/signInBar2",e}return n(e,t),e.prototype.init=function(t){if(t){this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),l.BonusData.read();var e=r.default.instance.getJsonAsset("task"),i=r.default.instance.getJsonAsset("qiandao"),n=r.default.instance.getJsonAsset("box"),a=r.default.instance.getJsonAsset("chengjiu");l.BonusData.parseTaskData(e),l.BonusData.parseSignInData(i),l.BonusData.parseBoxData(n),l.BonusData.parseAchievementData(a),t.getChild("closeBtn").asButton.onClick(this.hide.bind(this),this),this.initSignInPnl(),t.visible=!1,t.sortingOrder=o.UIHierarchy.kSign,o.BaseUI.root.addChild(t)}},e.prototype.show=function(t){this.closeCb_=t,this.com_&&(u.ExportUIInst.hideAll(),this.com_.visible=!0)},e.prototype.hide=function(){this.com_.visible=!1,this.closeCb_&&(this.closeCb_(),this.closeCb_=null)},e.prototype.initSignInPnl=function(){for(var t=this.com_.getChild("list").asList,e=0;e<7;e++){var i=fgui.UIPackage.createObject("HomeHUD","signInDetail").asCom,n=e;i.getChild("day").asTextField.text=""+(n+1);var o=i.getChild("centerPoint").asLoader,r=i.getChild("bar").asLoader;r.url=this.barUrl1,r.width=265,r.height=20;var s=!1;n<1?(o.url=this.centerPointUrl1,s=!0):n<=a.GameUserInfo.dailyDat.signInAwardCnt?(s=!0,o.url=this.centerPointUrl1,t.getChildAt(e-1).asCom.getChild("bar").asLoader.url=this.barUrl2):o.url=this.centerPointUrl2;var h=l.BonusData.getSignInData(e+"_"+e),c=l.BonusData.getSignInData(e);this.initSignInData1(h,i,s),this.initSignInData2(c,i,s),t.addChild(i)}var u=fgui.UIPackage.createObject("HomeHUD","doubleReceive").asCom;_.instance.init(u)},e.prototype.initSignInData1=function(t,e,i){var n=e.getChild("signInData1").asImage;n.name=t.id;var o=null;switch(t.reward_id){case 5:if(a.GameUserInfo.dailyDat.signInBonusMap.containsKey(t.id)){switch((f=a.GameUserInfo.dailyDat.signInBonusMap.get(t.id).boxData).reward_id){case 6:var r=c.Repository.instance.getRoleDragon(t.tag);n.node.addChild(r),n.alpha=.75;break;default:o=fgui.UIPackage.createObject("HomeHUD",f.icon).asCom}}else{var s=l.BonusData.getboxDataMap;if("goldenBox"==t.icon){for(var u=l.BonusData.getGoldenProbability,p=h.G.randRange(0,u-1),f=null,_=0,g=s.values(),m=0;m<g.length;m++){var y=g[m];if(p>=_&&p<_+y.probability_huangjin){f=y;break}_+=y.probability_huangjin}t.boxData=f}else if("silverBox"==t.icon){u=l.BonusData.getSilverProbability,p=h.G.randRange(0,u-1);var f=null;for(_=0,g=s.values(),m=0;m<g.length;m++){y=g[m];if(p>=_&&p<_+y.probability_qingtong){f=y;break}_+=y.probability_qingtong}t.boxData=f}o=fgui.UIPackage.createObject("HomeHUD",t.icon).asButton}break;case 6:var v=c.Repository.instance.getRoleDragon(t.tag);n.node.addChild(v),n.alpha=.75;break;default:o=fgui.UIPackage.createObject("HomeHUD",t.icon).asButton}i&&(e.getChild("lock1").visible=!1),o&&(o.node.zIndex=10,n.node.addChild(o.node),i||(n.alpha=.75)),this.createHalo(n,i),a.GameUserInfo.dailyDat.signInBonusMap.containsKey(t.id)?e.getChild("receive1").visible=!0:i&&(n.on(fgui.Event.CLICK,this.adSignInClick.bind(this),this),d.default.instance.showRedPoint("loginRedPoint")),e.getChild("title1").asTextField.text=t.name},e.prototype.initSignInData2=function(t,e,i){var n=e.getChild("signInData2").asImage;n.name=t.id;var o=null;switch(t.reward_id){case 5:if(a.GameUserInfo.dailyDat.signInBonusMap.containsKey(t.id)){switch((d=a.GameUserInfo.dailyDat.signInBonusMap.get(t.id).boxData).reward_id){case 6:var r=c.Repository.instance.getRoleDragon(t.tag);n.node.addChild(r),n.alpha=.75;break;default:o=fgui.UIPackage.createObject("HomeHUD",d.icon).asCom}}else{var s=l.BonusData.getboxDataMap;if("goldenBox"==t.icon){for(var u=l.BonusData.getGoldenProbability,p=h.G.randRange(0,u-1),d=null,f=0,_=s.values(),g=0;g<_.length;g++){var m=_[g];if(p>=f&&p<f+m.probability_huangjin){d=m;break}f+=m.probability_huangjin}t.boxData=d}else if("silverBox"==t.icon){u=l.BonusData.getSilverProbability,p=h.G.randRange(0,u-1);var d=null;for(f=0,_=s.values(),g=0;g<_.length;g++){m=_[g];if(p>=f&&p<f+m.probability_qingtong){d=m;break}f+=m.probability_qingtong}t.boxData=d}o=fgui.UIPackage.createObject("HomeHUD",t.icon).asButton}break;case 6:var y=c.Repository.instance.getRoleDragon(t.tag);n.node.addChild(y),n.alpha=.75;break;default:o=fgui.UIPackage.createObject("HomeHUD",t.icon).asCom}i&&(e.getChild("lock2").visible=!1),o&&(o.node.zIndex=10,n.node.addChild(o.node),i||(n.alpha=.75)),this.createHalo(n,i),a.GameUserInfo.dailyDat.signInBonusMap.containsKey(t.id)?e.getChild("receive2").visible=!0:i&&n.on(fgui.Event.CLICK,this.freeSignInClick.bind(this),this),e.getChild("title2").asTextField.text=t.name},e.prototype.adSignInClick=function(t){var e=fgui.GObject.cast(t.currentTarget).asCom,i=e.name,n=e.parent;p.MgpUtil.watchVideoAds(h.G.VideoIDs[0],function(){var t=l.BonusData.getSignInData(i);switch(t.reward_id){case 3:a.GameUserInfo.updUserCoin(t.numb),s.TipUIInst.show("\u9886\u53d6\u91d1\u5e01x"+t.numb);break;case 4:a.GameUserInfo.updUserSpecialCurrency(t.numb),s.TipUIInst.show("\u9886\u53d6\u8d27\u5e01x"+t.numb);break;case 5:switch(t.boxData.reward_id){case 3:a.GameUserInfo.updUserCoin(t.numb);break;case 4:a.GameUserInfo.updUserSpecialCurrency(t.numb)}break;case 6:a.GameUserInfo.addRole(t.tag),s.TipUIInst.show("\u9886\u53d6\u89d2\u8272"+t.name)}n.getChild("receive1").visible=!0,a.GameUserInfo.dailyDat.signInBonusMap.put(i,t),_.instance.show(t),e.off(fgui.Event.CLICK),a.GameUserInfo.saveSignIn()},function(){})},e.prototype.freeSignInClick=function(t){var e=fgui.GObject.cast(t.currentTarget).asCom,i=e.name,n=l.BonusData.getSignInData(i);switch(n.reward_id){case 3:a.GameUserInfo.updUserCoin(n.numb),s.TipUIInst.show("\u9886\u53d6\u91d1\u5e01x"+n.name);break;case 4:a.GameUserInfo.updUserSpecialCurrency(n.numb),s.TipUIInst.show("\u9886\u53d6\u8d27\u5e01x"+n.name);break;case 5:switch(n.boxData.reward_id){case 3:a.GameUserInfo.updUserCoin(n.numb);break;case 4:a.GameUserInfo.updUserSpecialCurrency(n.numb)}break;case 6:a.GameUserInfo.addRole(n.tag),s.TipUIInst.show("\u9886\u53d6\u89d2\u8272"+n.name)}a.GameUserInfo.dailyDat.signInBonusMap.put(i,n),_.instance.show(n),e.parent.getChild("receive2").visible=!0,e.off(fgui.Event.CLICK),a.GameUserInfo.saveSignIn()},e.prototype.createHalo=function(t,e){if(e){var i=new fgui.GLoader;i.pivotX=.5,i.pivotY=.5,i.width=300,i.height=300,i.fill=fgui.LoaderFillType.ScaleMatchWidth,i.url="ui://CommUI/daguangquan",t.node.addChild(i.node),i.node.zIndex=1}},e.instance=new e,e}(o.BaseUI);i.SignInPnl=f;var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img=null,e.detail=null,e.num=null,e.doubleBtn=null,e.data=null,e}return n(e,t),e.prototype.init=function(t){t&&(this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),t.getChild("block").asCom.onClick(this.hide.bind(this),this),this.detail=t.getChild("detail").asCom,this.img=this.detail.getChild("img").asImage,this.num=this.detail.getChild("num").asTextField,this.doubleBtn=this.detail.getChild("btn").asButton,t.visible=!1,t.sortingOrder=o.UIHierarchy.kReceivePnl,o.BaseUI.root.addChild(t))},e.prototype.show=function(t){this.com_&&(t&&(this.data=t,this.doubleBtn.on(fgui.Event.CLICK,this.doubleClick.bind(this),this),this.initPnl()),this.com_.visible=!0)},e.prototype.hide=function(){this.data=null;for(var t=this.img.node.children,e=t.length,i=0;i<e;i++){var n=t[0];n.destroy(),this.img.node.removeChild(n)}this.com_.visible=!1},e.prototype.initPnl=function(){var t=this,e=null;switch(this.data.reward_id){case 5:e=fgui.UIPackage.createObject("HomeHUD",this.data.icon).asCom;var i=this.data.boxData,n=null;switch(i.reward_id){case 6:break;default:n=fgui.UIPackage.createObject("HomeHUD",i.icon).asCom}if(n){var o=n.node;o.scale=0,o.zIndex=20,o.name="random",this.img.node.addChild(o)}e.getTransition("t0").play(function(){var e=t.img.node.getChildByName("random");e&&(e.runAction(cc.scaleTo(.6,1,1)),s.TipUIInst.show("x"+i.name))});break;case 6:var r=c.Repository.instance.getRoleDragon(this.data.tag);this.img.node.addChild(r);break;default:e=fgui.UIPackage.createObject("HomeHUD",this.data.icon).asCom}e&&(e.node.zIndex=10,this.img.node.addChild(e.node)),this.num.text=""+this.data.name},e.prototype.doubleClick=function(){var t=this;p.MgpUtil.watchVideoAds(h.G.VideoIDs[0],function(){switch(t.doubleBtn.off(fgui.Event.CLICK),t.data.reward_id){case 3:a.GameUserInfo.updUserCoin(t.data.numb),s.TipUIInst.show("\u9886\u53d6\u91d1\u5e01x"+t.data.numb);break;case 4:a.GameUserInfo.updUserSpecialCurrency(t.data.numb),s.TipUIInst.show("\u9886\u53d6\u8d27\u5e01x"+t.data.numb);break;case 5:var e=t.data.boxData;switch(e.reward_id){case 3:a.GameUserInfo.updUserCoin(t.data.numb),s.TipUIInst.show("\u9886\u53d6\u91d1\u5e01x"+t.data.numb);break;case 4:a.GameUserInfo.updUserSpecialCurrency(t.data.numb),s.TipUIInst.show("\u9886\u53d6\u8d27\u5e01x"+t.data.numb)}s.TipUIInst.show("x"+e.name);break;case 6:s.TipUIInst.show("\u9886\u53d6\u89d2\u8272"+t.data.name)}},function(){})},e.instance=new e,e}(o.BaseUI);cc._RF.pop()},{"../../game/tools/resource_control":"resource_control","../../game/user_info/user_info":"user_info","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../common/base_ui":"base_ui","../common/export_ui":"export_ui","../common/tip_ui":"tip_ui","./BonusData":"BonusData","./HomePnl":"HomePnl","./repository":"repository"}],Store:[function(t,e,i){"use strict";cc._RF.push(e,"9fb10Fmt8ZBlpBCs3K11vz0","Store");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=t("../common/base_ui"),r=t("../../util/global_def"),a=t("../../util/event_mgr"),s=t("../../game/user_info/user_info"),h=t("../../game/tools/resource_control"),l=t("../../game_logic"),c=t("../../util/structure/hd_map"),u=t("./repository"),p=t("../common/export_ui"),d=function(){return function(){this.currBlood=100,this.maxBlood=100,this.weapons=new Array}}();i.StoreData=d;var f=function(){return function(){this.id=null,this.currBullet=null}}(),_=function(){return function(){this.addBlood=!1,this.addBloodPerc=0,this.weapons=new Array,this.addWeapons=new Array}}(),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.products=new c.default,e.productsImgPath=["p_gun0","p_gun1","p_knife","p_darts","p_brick","p_apple","p_chicken"],e.tipTran=null,e.productCom1=null,e.productCom2=null,e.productIds=[],e.data=null,e.sendData=new _,e.product1=null,e.product2=null,e}return n(e,t),e.prototype.show=function(t){this.com_&&(this.data=t,this.randomProduct(),this.com_.visible=!0,p.ExportUIInst.hideAll(),p.ExportGroup.showMembersTM(p.ExportGroupName.kStore2,p.ExportTmID.kStoreSignles),p.ExportUIInst.showTM(p.ExportUIName.kHT,p.ExportTmID.kStoreHT))},e.prototype.hide=function(){l.default.instance.eventManager.addEvent(a.EventType.closeStore,this.sendData),this.sendData=new _,p.ExportGroup.hideMembers(p.ExportGroupName.kStore2),p.ExportUIInst.hide(p.ExportUIName.kHT),this.tipTran.playing&&this.tipTran.stop(),this.com_.visible=!1},e.prototype.init=function(t){if(t){this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height);var e=h.default.instance.getJsonAsset("shop");this.initProductNames(e),this.tipTran=t.getTransition("tip"),this.productCom1=t.getChild("product1").asCom,this.productCom2=t.getChild("product2").asCom,t.getChild("exitBtn").asButton.onClick(this.hide.bind(this),this),this.initProductIds(),t.visible=!1,t.sortingOrder=o.UIHierarchy.kStore,o.BaseUI.root.addChild(t),this.initExport()}},e.prototype.setMat=function(t,e){var i=t._components[0],n=h.default.instance.getMat(e),o=cc.MaterialVariant.create(n,i);i.setMaterial(0,o)},e.prototype.randomProduct=function(){this.productCom1.getChild("select").visible=!1,this.productCom2.getChild("select").visible=!1;var t=this.products,e=this.productIds,i=r.G.randRange(0,e.length-1),n=e[i];this.product1=t.get(n),this.productCom1.getChild("name").asTextField.text=this.product1.name,this.productCom1.getChild("coinNum").asTextField.text=this.product1.money,this.productCom1.getChild("icon").asLoader.texture=u.Repository.instance.comAtlas[this.productsImgPath[this.product1.id]];var o=(e=e.filter(function(t){return t!=i}))[r.G.randRange(0,e.length-1)];this.product2=t.get(o),this.productCom2.getChild("name").asTextField.text=this.product2.name,this.productCom2.getChild("coinNum").asTextField.text=this.product2.money,this.productCom2.getChild("icon").asLoader.texture=u.Repository.instance.comAtlas[this.productsImgPath[this.product2.id]],this.productCom1.on(fgui.Event.CLICK,this.productClick.bind(this),this),this.productCom2.on(fgui.Event.CLICK,this.productClick.bind(this),this);var a=this.productCom1.getChild("icon").node;this.setMat(a.children[0],"sprite-flash-light");var s=this.productCom2.getChild("icon").node;this.setMat(s.children[0],"sprite-flash-light")},e.prototype.productClick=function(t){switch(fgui.GObject.cast(t.currentTarget).name){case"product1":this.buyProduct(this.product1,this.productCom1);break;case"product2":this.buyProduct(this.product2,this.productCom2)}},e.prototype.buyProduct=function(t,e){var i=this;if(1==t.type){for(var n=this.data.weapons,o=!1,r=null,a=0;a<n.length;a++)if(r=n[a],t.id==r.id){o=!0;break}var h=u.Repository.instance.weaponData.get(t.id),l=function(){if(s.GameUserInfo.updUserCoin(-t.money)){e.off(fgui.Event.CLICK),e.getChild("select").visible=!0;var n=new f;n.currBullet=1,n.id=t.tag,i.sendData.addWeapons.push(n),i.showTipTrans()}else i.showTipTrans(!1)};if(o){var c=s.GameUserInfo.getWeaponLvl(r.id.toString());h.num+h.num_lv*c>r.currBullet?l():this.showTipTrans(!1)}else l()}else if(2==t.type){this.data.currBlood<this.data.maxBlood&&s.GameUserInfo.updUserCoin(-t.money)?(e.off(fgui.Event.CLICK),e.getChild("select").visible=!0,this.sendData.addBlood=!0,this.sendData.addBloodPerc=this.products.get(t.id).effect,this.showTipTrans()):this.showTipTrans(!1)}},e.prototype.showTipTrans=function(t){void 0===t&&(t=!0),this.com_.getChild("thanks").visible=t,this.com_.getChild("notNeed").visible=!t,this.tipTran.playing&&this.tipTran.stop(),this.tipTran.play()},e.prototype.initProductNames=function(t){for(var e in t){var i=t[e];i.id=e,this.products.put(e,i)}},e.prototype.initProductIds=function(){var t=this;this.products.each(function(e,i,n){t.productIds.push(i)})},e.prototype.initExport=function(){var t=[p.ExportUIName.kSSL1,p.ExportUIName.kSSL2];p.ExportGroup.addMembers(p.ExportGroupName.kStore2,t);for(var e=0;e<t.length;++e)p.ExportUIInst.bindSingle(t[e],this.com_);p.ExportUIInst.bindRCScroll(p.ExportUIName.kHT,this.com_)},e.instance=new e,e}(o.BaseUI);i.Store=g,cc._RF.pop()},{"../../game/tools/resource_control":"resource_control","../../game/user_info/user_info":"user_info","../../game_logic":"game_logic","../../util/event_mgr":"event_mgr","../../util/global_def":"global_def","../../util/structure/hd_map":"hd_map","../common/base_ui":"base_ui","../common/export_ui":"export_ui","./repository":"repository"}],StoryPnl:[function(t,e,i){"use strict";cc._RF.push(e,"8c911dLkDBN96o08MkTbX/v","StoryPnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.StoryData=void 0;var o=t("../common/base_ui"),r=t("../../game/tools/resource_control"),a=t("../../util/structure/hd_map"),s=t("../../game/user_info/user_info"),h=t("../../game/scene/home"),l=t("../common/export_ui"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chapterList=null,e.periodList=null,e}return n(e,t),e.prototype.init=function(t){if(t){t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),this.com_=t;var e=r.default.instance.getJsonAsset("plot");u.parseStoryData(e),t.getChild("closeBtn").asButton.onClick(this.hide.bind(this),this),this.chapterList=t.getChild("list1").asCom.getChild("list").asList,this.periodList=t.getChild("list2").asCom.getChild("list").asList,this.initChapter(),t.visible=!1,t.sortingOrder=o.UIHierarchy.kStoryPnl,o.BaseUI.root.addChild(t),l.ExportUIInst.bindRCScroll(l.ExportUIName.kHMHor2,this.com_,0,0,0,l.ExportTransType.kShake)}},e.prototype.show=function(){this.com_&&(this.initChapter(),this.com_.visible=!0,l.ExportUIInst.showTM(l.ExportUIName.kHMHor2,l.ExportTmID.KHomeSigles))},e.prototype.hide=function(){this.com_&&(this.com_.visible=!1,l.ExportUIInst.hide(l.ExportUIName.kHMHor2))},e.prototype.initChapter=function(){var t=this,e=s.GameUserInfo.storyProp.curChapter,i=u.getStoryData();this.chapterList.removeChildren(),i.each(function(i,n,o){var r=fgui.UIPackage.createObject("HomeHUD","storyBtn").asCom;if(r.getChild("title").asTextField.text=o.name,r.name=n,s.GameUserInfo.storyProp.chapterMap.containsKey(n)&&(r.getChild("mask").visible=!1,r.onClick(function(){t.initPeriod(o,"0"),s.GameUserInfo.updCurChapter(n),s.GameUserInfo.updCurPeriod("0"),s.GameUserInfo.storyProp.chapterMap.each(function(e,i,o){t.chapterList.getChild(i).asCom.getChild("grayFloor").visible=i!=n})},t)),e==n){r.getChild("grayFloor").visible=!1;var a=s.GameUserInfo.storyProp.curPeriod;t.initPeriod(o,a)}t.chapterList.addChild(r)})},e.prototype.initPeriod=function(t,e){var i=this;this.periodList.removeChildren();for(var n=t.periodData,o=function(o){var a=n[o],h=fgui.UIPackage.createObject("HomeHUD","storyBtn").asCom;h.getChild("title").asTextField.text=a.name,h.name=a.id,s.GameUserInfo.storyProp.periodMap.containsKey(t.id+"_"+a.id)&&(h.getChild("mask").visible=!1,h.onClick(function(){i.clickPeriod(a,n,h),s.GameUserInfo.updCurPeriod(a.id)},r)),e==a.id&&(h.getChild("grayFloor").visible=!1),r.periodList.addChild(h)},r=this,a=0;a<n.length;a++)o(a)},e.prototype.clickPeriod=function(t,e,i){console.log("\u70b9\u51fb\u4e86==========",t);for(var n in this.periodList._children){this.periodList._children[n].asCom.getChild("grayFloor").visible=!0}i.getChild("grayFloor").visible=!1,s.GameUserInfo.updCurPeriod(t.id),h.default.instance.toGame(Number(t.id))},e.instance=new e,e}(o.BaseUI);i.default=c;var u=function(){function t(){}return t.parseStoryData=function(e){for(var i in e)if(e.hasOwnProperty(i)){var n=e[i].tag;if(t.map.containsKey(n)){var o=t.map.get(n);(r=new d).id=i,r.name=e[i].name_node,o.periodData.push(r),t.map.put(n,o)}else{var r;(o=new p).id=n,o.name=e[i].name,(r=new d).id=i,r.name=e[i].name_node,o.periodData.push(r),t.map.put(n,o)}}},t.getStoryData=function(){return t.map},t.getChapterCount=function(){return t.map.keyLen()},t.getPerioCount=function(e){return t.map.get(e).periodData.length},t.map=new a.default,t}();i.StoryData=u;var p=function(){return function(){this.id=null,this.name="",this.periodData=new Array}}(),d=function(){return function(){this.id=null,this.name=""}}();cc._RF.pop()},{"../../game/scene/home":"home","../../game/tools/resource_control":"resource_control","../../game/user_info/user_info":"user_info","../../util/structure/hd_map":"hd_map","../common/base_ui":"base_ui","../common/export_ui":"export_ui"}],TaskPnl:[function(t,e,i){"use strict";cc._RF.push(e,"da572tw1zBBsZza1DOvvKFz","TaskPnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.TaskPnl=i.TaskPnlName=void 0;var o=t("../common/base_ui"),r=t("../../game/user_info/user_info"),a=t("../../util/timed_task"),s=t("../../game_logic"),h=t("../../util/event_mgr"),l=t("./BonusData"),c=t("../common/export_ui"),u=t("./HomePnl"),p=function(){function t(){}return t.task="task",t.achievement="achievement",t}();i.TaskPnlName=p;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contrl=null,e.taskDetailList=null,e.achievementList=null,e.taskBtn=null,e.achievementBtn=null,e.timeField=null,e.taskTimeId=null,e.closeCb_=null,e.isFirst=!1,e}return n(e,t),e.prototype.init=function(t){t&&(this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),this.contrl=t.getController("c1"),t.getChild("closeBtn").asButton.onClick(this.hide.bind(this),this),this.taskBtn=t.getChild("taskBtn").asButton,this.achievementBtn=t.getChild("achievementBtn").asButton,this.taskBtn.on(fgui.Event.CLICK,this.taskBtnClick.bind(this),this),this.achievementBtn.on(fgui.Event.CLICK,this.achievementBtnClick.bind(this),this),this.taskDetailList=t.getChild("list").asList,this.achievementList=t.getChild("list2").asList,this.timeField=t.getChild("time").asTextField,t.visible=!1,t.sortingOrder=o.UIHierarchy.kSign,o.BaseUI.root.addChild(t),this.initTaskListener(),this.initTaskPnl())},e.prototype.show=function(t,e){void 0===t&&(t=p.task),this.closeCb_=e,this.com_&&(c.ExportUIInst.hideAll(),this.contrl.selectedPage=t,this.initTaskPnl(),this.updateTime(),this.initAchievementTask(),this.com_.visible=!0)},e.prototype.hide=function(){a.TimedTaskInst.remove(this.taskTimeId,a.TimedTaskType.kTaskResTime),this.taskBtnClick(),this.taskDetailList.removeChildren(),this.achievementList.removeChildren(),this.com_.visible=!1,this.closeCb_&&(this.closeCb_(),this.closeCb_=null)},e.prototype.initTaskPnl=function(){0==l.BonusData.preInitTime&&(this.isFirst=!0);var t=l.BonusData.getTasks();if(t)for(var e=0;e<t.length;e++){var i=t[e],n=fgui.UIPackage.createObject("HomeHUD","taskDetail").asCom;n.name=i.id,n.getChild("title").asTextField.text=i.name,n.getChild("medium").visible=1===i.difficulty,n.getChild("difficulty").visible=2===i.difficulty,n.getChild("bonus1").visible=4===i.reward_id1,n.getChild("bonus2").visible=4===i.reward_id2,n.getChild("bonusNum1").asTextField.text="x"+i.numb1,n.getChild("bonusNum2").asTextField.text="x"+i.numb2,this.initReceiveBtn(n,i),this.taskDetailList.addChild(n)}},e.prototype.initAchievementTask=function(){for(var t=l.BonusData.getAchievements(),e=0;e<t.length;e++){var i=t[e],n=fgui.UIPackage.createObject("HomeHUD","achievementDetail").asCom;n.name=i.id,n.getChild("title").asTextField.text=i.name,n.getChild("medium").visible=2===i.difficulty,n.getChild("difficulty").visible=3===i.difficulty,n.getChild("bonus").visible=4===i.reward_id,n.getChild("bonusNum").asTextField.text="x"+i.numb,this.initAchievementReceiveBtn(n,i),this.achievementList.addChild(n)}},e.prototype.initReceiveBtn=function(t,e){var i=t.getChild("bar"),n=r.GameUserInfo.dailyDat.taskDegMap.get(e.id),o=364/e.target*n;i.width=o>364?364:o,t.getChild("completNum").asTextField.text=n+"/"+e.target;var a=t.getChild("btn").asButton;if(n<e.target)a.enabled=!1;else if(n>=e.target){var s=r.GameUserInfo.dailyDat.taskBonusMap.get(e.id);a.visible=!s,s||(a.enabled=!0,a.on(fgui.Event.CLICK,this.receiveBtnClick.bind(this),this),u.default.instance.showRedPoint("taskRedPoint"))}},e.prototype.initAchievementReceiveBtn=function(t,e){var i=t.getChild("bar"),n=r.GameUserInfo.achievement.taskFullMap.get(e.id),o=364/e.target*n;i.width=o>364?364:o,t.getChild("completNum").asTextField.text=n+"/"+e.target;var a=t.getChild("btn").asButton;if(n<e.target)a.enabled=!1;else if(n>=e.target){var s=r.GameUserInfo.achievement.taskReceiveMap.get(e.id);a.visible=!s,s||(a.enabled=!0,a.on(fgui.Event.CLICK,this.achievementReceiveBtnClick.bind(this),this))}},e.prototype.receiveBtnClick=function(t){var e=fgui.GObject.cast(t.currentTarget).asButton,i=e.parent,n=l.BonusData.getTaskData(i.name);3===n.reward_id1?r.GameUserInfo.updUserCoin(n.numb1):4===n.reward_id1&&r.GameUserInfo.updUserSpecialCurrency(n.numb1),3===n.reward_id2?r.GameUserInfo.updUserCoin(n.numb2):4===n.reward_id2&&r.GameUserInfo.updUserSpecialCurrency(n.numb2),r.GameUserInfo.dailyDat.taskBonusMap.put(n.id,!0),r.GameUserInfo.saveSignIn(),e.visible=!1,this.taskDetailList.setChildIndex(i,4),this.taskDetailList.sortingOrder=fgui.ChildrenRenderOrder.Descent},e.prototype.achievementReceiveBtnClick=function(t){var e=fgui.GObject.cast(t.currentTarget).asButton,i=e.parent,n=l.BonusData.getAchievement(i.name);3===n.reward_id?r.GameUserInfo.updUserCoin(n.numb):4===n.reward_id&&r.GameUserInfo.updUserSpecialCurrency(n.numb),r.GameUserInfo.achievement.taskReceiveMap.put(n.id,!0),r.GameUserInfo.saveSignIn(),e.visible=!1,this.achievementList.setChildIndex(i,l.BonusData.getAchievementSize),this.achievementList.sortingOrder=fgui.ChildrenRenderOrder.Descent},e.prototype.updateTime=function(){var t=this,e=this.com_.getChild("time").asTextField,i=l.BonusData.getRefreshTime();this.taskTimeId=a.TimedTaskInst.add(function(){i<=0&&!t.isFirst&&(t.initTaskPnl(),i=l.BonusData.getRefreshTime());var n=i/1e3,o=t.addNumber(Math.floor(n/3600%24)),r=t.addNumber(Math.floor(n/60%60)),a=t.addNumber(Math.floor(n%60));e.setVar("hour",o).setVar("minute",r).setVar("second",a).flushVars(),i-=1e3},1,-2,1,null,a.TimedTaskType.kTaskResTime)},e.prototype.addNumber=function(t){return t>9?t:"0"+t},e.prototype.initTaskListener=function(){s.default.instance.eventManager.addListener(h.EventType.KBeatEnemy,this.KBeatEnemy.bind(this)),s.default.instance.eventManager.addListener(h.EventType.kBeatStickEnemy,this.kBeatStickEnemy.bind(this)),s.default.instance.eventManager.addListener(h.EventType.kBeatGunEnemy,this.kBeatGunEnemy.bind(this)),s.default.instance.eventManager.addListener(h.EventType.kBeatShieldenemy,this.kBeatShieldenemy.bind(this)),s.default.instance.eventManager.addListener(h.EventType.KUseGunBeatEnemy,this.KUseGunBeatEnemy.bind(this)),s.default.instance.eventManager.addListener(h.EventType.KUseDartsBeatEnemy,this.KUseDartsBeatEnemy.bind(this)),s.default.instance.eventManager.addListener(h.EventType.KUseBrickBeatEnemy,this.KUseBrickBeatEnemy.bind(this)),s.default.instance.eventManager.addListener(h.EventType.KUseKnifeBeatEnemy,this.KUseKnifeBeatEnemy.bind(this)),s.default.instance.eventManager.addListener(h.EventType.KCollectApple,this.KCollectApple.bind(this)),s.default.instance.eventManager.addListener(h.EventType.KCollectChicken,this.KCollectChicken.bind(this)),s.default.instance.eventManager.addListener(h.EventType.KCollectCoin,this.KCollectCoin.bind(this)),s.default.instance.eventManager.addListener(h.EventType.KXiaTiEnemy,this.KXiaTiEnemy.bind(this)),s.default.instance.eventManager.addListener(h.EventType.KXuliEnemy,this.KXuliEnemy.bind(this)),s.default.instance.eventManager.addListener(h.EventType.KQNEnemy,this.KQNEnemy.bind(this))},e.prototype.taskBtnClick=function(){this.taskBtn.getChild("select").visible=!0,this.achievementBtn.getChild("select").visible=!1,this.taskBtn.getChild("title").alpha=1,this.achievementBtn.getChild("title").alpha=.3},e.prototype.achievementBtnClick=function(){this.achievementBtn.getChild("select").visible=!0,this.taskBtn.getChild("select").visible=!1,this.achievementBtn.getChild("title").alpha=1,this.taskBtn.getChild("title").alpha=.3},e.prototype.KBeatEnemy=function(t){this.changeTaskDeg(0,3,t.num),this.changeAchievementTask(0,4,t.num)},e.prototype.kBeatStickEnemy=function(t){this.changeTaskDeg(3,2,t.num),this.changeAchievementTask(4,1,t.num)},e.prototype.kBeatGunEnemy=function(t){this.changeTaskDeg(5,2,t.num),this.changeAchievementTask(5,1,t.num)},e.prototype.kBeatShieldenemy=function(t){this.changeTaskDeg(7,2,t.num),this.changeAchievementTask(6,1,t.num)},e.prototype.KUseGunBeatEnemy=function(t){this.changeTaskDeg(9,1,t.num),this.changeAchievementTask(7,1,t.num)},e.prototype.KUseDartsBeatEnemy=function(t){this.changeTaskDeg(10,1,t.num),this.changeAchievementTask(8,1,t.num)},e.prototype.KUseBrickBeatEnemy=function(t){this.changeTaskDeg(11,1,t.num),this.changeAchievementTask(9,1,t.num)},e.prototype.KUseKnifeBeatEnemy=function(t){this.changeTaskDeg(12,1,t.num),this.changeAchievementTask(10,1,t.num)},e.prototype.KCollectApple=function(t){this.changeTaskDeg(13,2,t.num),this.changeAchievementTask(11,2,t.num)},e.prototype.KCollectChicken=function(t){this.changeTaskDeg(15,2,t.num),this.changeAchievementTask(13,2,t.num)},e.prototype.KCollectCoin=function(t){this.changeTaskDeg(17,3,t.num),this.changeAchievementTask(15,3,t.num)},e.prototype.shangti=function(t){this.changeAchievementTask(21,3,t.num)},e.prototype.KXiaTiEnemy=function(t){this.changeTaskDeg(20,3,t.num),this.changeAchievementTask(18,3,t.num)},e.prototype.KXuliEnemy=function(t){this.changeTaskDeg(23,3,t.num),this.changeAchievementTask(24,3,t.num)},e.prototype.KQNEnemy=function(t){this.changeAchievementTask(27,3,t.num)},e.prototype.changeTaskDeg=function(t,e,i){for(var n=t+e;t<n;t++){var o=r.GameUserInfo.dailyDat.taskDegMap.get(t);r.GameUserInfo.dailyDat.taskDegMap.put(t,o+i)}r.GameUserInfo.saveSignIn()},e.prototype.changeAchievementTask=function(t,e,i){for(var n=t+e;t<n;t++){var o=r.GameUserInfo.achievement.taskFullMap.get(t);o<l.BonusData.getAchievement(t).target&&r.GameUserInfo.achievement.taskFullMap.put(t,o+i)}r.GameUserInfo.saveAchievement()},e.instance=new e,e}(o.BaseUI);i.TaskPnl=d,cc._RF.pop()},{"../../game/user_info/user_info":"user_info","../../game_logic":"game_logic","../../util/event_mgr":"event_mgr","../../util/timed_task":"timed_task","../common/base_ui":"base_ui","../common/export_ui":"export_ui","./BonusData":"BonusData","./HomePnl":"HomePnl"}],TrialPnl:[function(t,e,i){"use strict";cc._RF.push(e,"24cb3/foS1K/YB/tgIop8Gi","TrialPnl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.TrialPnl=void 0;var o=t("../common/base_ui"),r=t("./repository"),a=t("../../util/global_def"),s=t("./Store"),h=t("../../game_logic"),l=t("../../util/event_mgr"),c=(t("../common/tip_ui"),t("../common/export_ui")),u=t("../../util/mgp_util"),p=t("../../data/data_hub"),d=t("../../game/tools/resource_control"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.closeCb_=null,e.trialIds={weaponId:null,products:[],heroId:null},e.trialWeaponId=null,e.adTrialBtn=null,e.coinWeapon=new Array,e.productIds=[],e.continue=null,e.trialHero=null,e.trialHeroId=null,e}return n(e,t),e.prototype.init=function(t){if(t){this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),this.initProductIds(),this.adTrialBtn=t.getChild("trialBtn").asButton,this.adTrialBtn.onClick(this.adTrialClick.bind(this),this);for(var e=1;e<3;e++){var i=t.getChild("coinBuy"+e).asCom;i.onClick(this.coinToBuyClick.bind(this),this),this.coinWeapon.push(i)}var n=t.getChild("continueBtn").asButton;n.onClick(this.hide.bind(this),this),this.continue=n,t.visible=!1,t.sortingOrder=o.UIHierarchy.kTrialPnl,o.BaseUI.root.addChild(t),this.initExport();var r=t.getChild("bannerLine");h.default.instance.scheduleOnce(function(){u.MgpUtil.preloadBanner(a.G.bannerIDs[0],r,300,p.DataHub.config.bnrGap,null,null,1,p.DataHub.config.bnrRefresh,"trial")},3)}},e.prototype.show=function(t){this.closeCb_=t,this.com_&&(this.randomTrialWeapon(),this.com_.visible=!0,c.ExportUIInst.hideAll(),c.ExportUIInst.showTM(c.ExportUIName.kTHT,c.ExportTmID.kTrailHT),c.ExportGroup.showMembersTM(c.ExportGroupName.kTrail4,c.ExportTmID.kTrailSingles),a.G.isCanBannerJump()?a.G.bannerNodeJump(this.continue,function(){u.MgpUtil.showBannerWithRule(a.G.bannerIDs[0],null,null,"trial")}):u.MgpUtil.showBannerWithRule(a.G.bannerIDs[0],null,null,"trial"))},e.prototype.hide=function(){0==this.trialIds.products.length&&null==this.trialIds.weaponId||(a.G.Game.trialIds=this.trialIds),h.default.instance.eventManager.addEvent(l.EventType.closeTrialPnl,this.trialIds),this.trialIds={weaponId:null,products:[],heroId:null},c.ExportUIInst.hide(c.ExportUIName.kTHT),c.ExportGroup.hideMembers(c.ExportGroupName.kTrail4),this.com_.visible=!1,u.MgpUtil.hideBanner(a.G.bannerIDs[0],"trial"),this.closeCb_&&(this.closeCb_(),this.closeCb_=null)},e.prototype.randomTrialWeapon=function(){var t=r.Repository.instance.weaponData,e=a.G.randRange(0,t.size()-1);this.trialWeaponId=e.toString();var i=s.Store.instance.products,n=this.productIds,o=a.G.randRange(0,n.length-1),h=n[o],l=i.get(h),c=(n=n.filter(function(t){return t!=o}))[a.G.randRange(0,n.length-1)],u=i.get(c);if(this.coinWeapon[0].name=l.id,this.coinWeapon[1].name=u.id,this.initDetail(t.get(e),[l,u]),null==this.trialHero){var p=this.com_.getChild("heroIcon").asImage.node,f=p.position;this.trialHero=new cc.Node,this.trialHero.parent=p.parent,this.trialHero.position=f,p.destroy()}this.trialHeroId=a.G.randRange(0,2);var _="hero"+this.trialHeroId,g=this.trialHero.getComponent(dragonBones.ArmatureDisplay);g||(g=this.trialHero.addComponent(dragonBones.ArmatureDisplay)),g.dragonAsset=d.default.instance.getDragonBonesAsset(_+"_ske"),g.dragonAtlasAsset=d.default.instance.getDragonBonesAtlasAsset(_+"_tex"),g.armatureName="Armature",g.playAnimation("daiji",-1)},e.prototype.initDetail=function(t,e){var i=r.Repository.instance.imgLoadPkg;this.com_.getChild("weaponIcon").asLoader.texture=r.Repository.instance.comAtlas[s.Store.instance.productsImgPath[Number(t.id)]],this.com_.getChild("name").asLoader.url=i+t.icon,this.com_.getChild("lv").asTextField.text="LV."+t.max_lv;for(var n=0;n<this.coinWeapon.length;n++){var o=this.coinWeapon[n],a=o.getChild("icon").asLoader,h=s.Store.instance.productsImgPath[parseInt(e[n].id)];a.texture=r.Repository.instance.comAtlas[h],o.getChild("coin").asTextField.text=e[n].money}},e.prototype.adTrialClick=function(){var t=this;u.MgpUtil.watchVideoAds(a.G.VideoIDs[0],function(){t.trialIds.weaponId=t.trialWeaponId,t.trialIds.heroId=t.trialHeroId,t.hide()},function(){})},e.prototype.coinToBuyClick=function(t){var e=s.Store.instance.products,i=fgui.GObject.cast(t.currentTarget).asCom,n=i.name;e.get(n);-1===this.trialIds.products.indexOf(n)&&(i.getChild("select").visible=!0,i.off(fgui.Event.CLICK,this.coinToBuyClick.bind(this),this),this.trialIds.products.push(n))},e.prototype.initProductIds=function(){var t=this;s.Store.instance.products.each(function(e,i,n){0==n.effect&&t.productIds.push(i)})},e.prototype.initExport=function(){var t=[c.ExportUIName.kTSL1,c.ExportUIName.kTSL2,c.ExportUIName.kTSR1,c.ExportUIName.kTSR2];c.ExportGroup.addMembers(c.ExportGroupName.kTrail4,t);for(var e=0;e<t.length;++e)c.ExportUIInst.bindSingle(t[e],this.com_,c.ExportTransType.kShake);c.ExportUIInst.bindRCScroll(c.ExportUIName.kTHT,this.com_)},e.instance=new e,e}(o.BaseUI);i.TrialPnl=f,cc._RF.pop()},{"../../data/data_hub":"data_hub","../../game/tools/resource_control":"resource_control","../../game_logic":"game_logic","../../util/event_mgr":"event_mgr","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../common/base_ui":"base_ui","../common/export_ui":"export_ui","../common/tip_ui":"tip_ui","./Store":"Store","./repository":"repository"}],ad_sim_ui:[function(t,e,i){"use strict";cc._RF.push(e,"d7e178COe5KxKuMf9QKRmMg","ad_sim_ui"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../../data/data_hub"),o=t("./base_ui"),r=t("../../util/structure/hd_map"),a=t("../../util/global_def"),s=function(){function t(){}return t.addTestBannerHolder=function(t,e,i,r){if(void 0===i&&(i=1),void 0===r&&(r=0),!this.testBnrMap_.containsKey(t)){var s=fgui.UIPackage.createObject("CommUI","BnrTestHolder");if(s){e?s.setPosition(r+a.G.viewX/2-s._container.width/2,e.localToGlobal().y+e.height+n.DataHub.config.bnrGap):1===i?s.setPosition(0,cc.view.getVisibleSize().height-s.height):s.setPosition(0,0),s.visible=!1;var h=s.getChild("txt");h&&((h=h).text=t),s.sortingOrder=o.UIHierarchy.kTestBnr,o.BaseUI.root.addChild(s),this.testBnrMap_.put(t,s)}}},t.isTestBannerHolderShowed=function(t){var e=!1;this.testBnrMap_.containsKey(t)&&(e=this.testBnrMap_.get(t).visible);return e},t.isTestBannerLimited=function(t){},t.showTestBannerHolder=function(t){if(this.hideLastTestBanner(),this.testBnrMap_.containsKey(t)){var e=this.testBnrMap_.get(t);e.visible=!0,this.lastTestBnrStack_.push(e)}},t.hideTestBannerHolder=function(t){this.testBnrMap_.containsKey(t)&&(this.testBnrMap_.get(t).visible=!1,this.lastTestBnrStack_.pop(),this.lastTestBnrStack_.length>0&&(this.lastTestBnrStack_[this.lastTestBnrStack_.length-1].visible=!0))},t.showLastTestBanner=function(){this.lastTestBnrStack_.length>0&&(this.lastTestBnrStack_[this.lastTestBnrStack_.length-1].visible=!0)},t.hideLastTestBanner=function(){this.lastTestBnrStack_.length>0&&(this.lastTestBnrStack_[this.lastTestBnrStack_.length-1].visible=!1)},t.hideAllTestBanner=function(){var t=this;this.hideLastTestBanner(),this.testBnrMap_.each(function(e,i,n){t.hideTestBannerHolder(i)})},t.testBnrMap_=new r.default,t.lastTestBnrStack_=[],t}();i.BannerSimUI=s,cc._RF.pop()},{"../../data/data_hub":"data_hub","../../util/global_def":"global_def","../../util/structure/hd_map":"hd_map","./base_ui":"base_ui"}],animation:[function(t,e,i){"use strict";cc._RF.push(e,"57f29XxfBBB3JC9AGSkzThc","animation");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../tools/nodePool_control"),a=cc._decorator,s=a.ccclass,h=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=.5,e}return n(e,t),e.prototype.reuse=function(t){var e=this;void 0===t&&(t=0);var i=this.node.getComponent(cc.Animation);i.play(i.defaultClip.name),0==t?this.scheduleOnce(function(){i.stop(),r.default.instance.putNode(e.node)},this.time):this.scheduleOnce(function(){e.node.destroy()},this.time)},o([h({type:Number})],e.prototype,"time",void 0),e=o([s],e)}(cc.Component);i.default=l,cc._RF.pop()},{"../tools/nodePool_control":"nodePool_control"}],apple:[function(t,e,i){"use strict";cc._RF.push(e,"960c1doSFRAI4n0kaudVkv1","apple");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./food"),a=t("../../../../game_logic"),s=t("../../../../util/event_mgr"),h=cc._decorator,l=h.ccclass,c=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blood=20,e.ani=null,e}return n(e,t),e.prototype.onLoad=function(){this.ani=this.node.getComponent(cc.Animation),this.ani.play("apple_rota")},e.prototype.doDestroy=function(){var t=this;this.ani.play("apple_eat"),this.scheduleOnce(function(){t.clear()},.5),this.node.runAction(cc.moveBy(.5,cc.v2(0,100))),a.default.instance.eventManager.addEvent(s.EventType.KCollectApple,{num:1})},e=o([l],e)}(r.default));i.default=c,cc._RF.pop()},{"../../../../game_logic":"game_logic","../../../../util/event_mgr":"event_mgr","./food":"food"}],archive:[function(t,e,i){"use strict";cc._RF.push(e,"aaa84vFllxBmIu9EUV9i+qZ","archive");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../tools/storage_control"),a=t("../../util/global_def"),s=t("./ItemInfo"),h=t("../../game_ui/game/ResultPnl"),l=t("../scene/gameScene"),c=t("./hero"),u=t("./lifeBase"),p=t("../user_info/user_info"),d=t("../scene/uiControl"),f=cc._decorator,_=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=0,e.tip=null,e.finger=null,e.archiveDes0=null,e.archiveDes1=null,e}return n(e,t),e.prototype.init=function(){var t=this.node.parent;t.removeComponent(cc.Sprite),t.type&&(this.type=t.type.x),this.archiveDes0=this.node.getChildByName("archiveDes0"),this.archiveDes1=this.node.getChildByName("archiveDes1"),this.tip=this.node.getChildByName("tip"),this.finger=this.tip.getChildByName("finger"),0==this.type?this.archiveDes0.active=!0:this.archiveDes1.active=!0},e.prototype.onLoad=function(){var t=this;this.schedule(function(){var e=cc.scaleTo(.08,1,.7),i=cc.scaleTo(.08,1,1.2),n=cc.scaleTo(.08,1,1),o=cc.jumpBy(.15,cc.v2(0,0),15,1);t.node.runAction(cc.sequence(e,cc.spawn(i,o),n))},2,cc.macro.REPEAT_FOREVER)},e.prototype.onCollisionEnter=function(t,e){var i=t.node;if("hero"==i.group&&"point"!=i.name)if(0==this.type)this.tip.active=!0,this.finger.stopAllActions(),this.finger.scale=1,this.finger.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.2,1))));else if(1==this.type){p.GameUserInfo.addCurPeriod();var n=l.default.instance.hero;n.getComponent(c.heroAct).setState(c.actState.idle),n.getComponent(u.default).isDie=!0,h.default.instance.show(h.ResultPageName.com,100,function(){d.default.instance.toHome()})}},e.prototype.onCollisionExit=function(t,e){var i=t.node;"hero"==i.group&&"point"!=i.name&&(this.tip.active=!1)},e.prototype.save=function(){if(this.tip.active){var t=this.node.convertToWorldSpaceAR(cc.v2(0,0)),e=this.node.parent.parent.convertToNodeSpaceAR(t),i={x:e.x+window.flagPoint.x-a.G.viewX/2,y:e.y+window.flagPoint.y-200};r.default.instance.setJson("archivePoint",i)}},e=o([_],e)}(s.default));i.default=g,cc._RF.pop()},{"../../game_ui/game/ResultPnl":"ResultPnl","../../util/global_def":"global_def","../scene/gameScene":"gameScene","../scene/uiControl":"uiControl","../tools/storage_control":"storage_control","../user_info/user_info":"user_info","./ItemInfo":"ItemInfo","./hero":"hero","./lifeBase":"lifeBase"}],audio_mgr:[function(t,e,i){"use strict";cc._RF.push(e,"a3032yTr8hMuYzzfFM5cYC5","audio_mgr");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.AudioMgr=i.SfxType=i.BgmType=void 0;var r,a=t("./global_def"),s=t("./storage"),h=t("./structure/hd_map"),l=cc._decorator,c=l.ccclass;l.property;(function(t){t[t.kHome=0]="kHome",t[t.kWaterBg=1]="kWaterBg",t[t.Kwater=2]="Kwater",t[t.kNone=9999]="kNone"})(r=i.BgmType||(i.BgmType={}));var u,p=["home"];(function(t){t[t.kButton=0]="kButton",t[t.kAtt_Air=1]="kAtt_Air",t[t.KAtt_Foot0=2]="KAtt_Foot0",t[t.KAtt1_Foot0=3]="KAtt1_Foot0",t[t.KAtt_Foot1=4]="KAtt_Foot1",t[t.KAtt1_Foot1=5]="KAtt1_Foot1",t[t.KAtt_Hand0=6]="KAtt_Hand0",t[t.KAtt1_Hand0=7]="KAtt1_Hand0",t[t.KAtt_Hand1=8]="KAtt_Hand1",t[t.KAtt1_Hand1=9]="KAtt1_Hand1",t[t.KJump=10]="KJump",t[t.KBottle=11]="KBottle",t[t.KCoin=12]="KCoin",t[t.KDown=13]="KDown",t[t.KXuli=14]="KXuli",t[t.KBoxBoom=15]="KBoxBoom",t[t.KGun=16]="KGun",t[t.KHeroHurt=17]="KHeroHurt",t[t.KHeroHurt_1=18]="KHeroHurt_1",t[t.KHeroAtt0=19]="KHeroAtt0",t[t.KHeroAtt0_1=20]="KHeroAtt0_1",t[t.KHeroAtt1=21]="KHeroAtt1",t[t.KHeroAtt1_1=22]="KHeroAtt1_1",t[t.KHeroAtt2=23]="KHeroAtt2",t[t.KHeroAtt2_1=24]="KHeroAtt2_1",t[t.KHeroAtt3=25]="KHeroAtt3",t[t.KHeroAtt3_1=26]="KHeroAtt3_1",t[t.KHeroAtt4=27]="KHeroAtt4",t[t.KStick=28]="KStick",t[t.kNone=9999]="kNone"})(u=i.SfxType||(i.SfxType={}));var d=["button","att_air","att_foot0","att1_foot0","att_foot1","att1_foot1","att_hand0","att1_hand0","att_hand1","att1_hand1","jump","bottle","coin","down","xuli","boxBoom","gun","heroHurt","heroHurt_1","heroAtt0","heroAtt0_1","heroAtt1","heroAtt1_1","heroAtt2","heroAtt2_1","heroAtt3","heroAtt3_1","heroAtt4","stick"],f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bMuteMusic_=!1,e.bMuteSound_=!1,e.curBgmType_=r.kWaterBg,e.bgmId_=0,e.maxBgmVol_=1,e.maxSfxVol_=1,e.maxFadeVol_=0,e.bgms_=new h.default,e.sfxMap_=new h.default,e.bgmRemoteDelayType_=r.kNone,e.bgmProcCb_=null,e.sfxProcCb_=null,e.bgmProcCnt_=0,e.bgmProcTotal_=0,e.sfxProcCnt_=0,e.sfxProcTotal_=0,e.attFoot0=[u.KAtt_Foot0,u.KAtt_Foot0,u.KAtt_Foot0],e.attFoot1=[u.KAtt_Foot1,u.KAtt_Foot1,u.KAtt_Foot1],e.attHand0=[u.KAtt_Hand0,u.KAtt_Hand0,u.KAtt_Hand0],e.attHand1=[u.KAtt_Hand1,u.KAtt_Hand1,u.KAtt_Hand1],e.hurtAudio=[u.KHeroHurt,u.KHeroHurt_1],e.att0Audio=[u.KHeroAtt0,u.KHeroAtt0_1],e.att1Audio=[u.KHeroAtt1,u.KHeroAtt1_1],e.att2Audio=[u.KHeroAtt2,u.KHeroAtt2_1],e.att3Audio=[u.KHeroAtt3,u.KHeroAtt3_1],e.att4Audio=[u.KHeroAtt4,null],e.hurtTime=!1,e}var i;return n(e,t),i=e,e.prototype.isStopMusic=function(){return this.bMuteMusic_},e.prototype.isStopSound=function(){return this.bMuteSound_},e.prototype.onLoad=function(){i.instance=this,this._readData(),cc.game.addPersistRootNode(this.node)},e.prototype.start=function(){},e.prototype.preloadAll=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);for(var i=0;i<p.length;++i)this.bgms_.containsKey(i)||(++this.bgmProcTotal_,a.G.readAudio("audio/"+p[i],this._loadBgm.bind(this),i));for(i=0;i<d.length;++i)this.sfxMap_.containsKey(i)||(++this.sfxProcTotal_,a.G.readAudio("audio/"+d[i],this._loadSfx.bind(this),i));this.bgmProcCb_=t,this.sfxProcCb_=e},e.prototype.preloadBgmInEnumRange=function(t,e,i){if(void 0===e&&(e=r.kNone),void 0===i&&(i=null),e!=r.kNone)for(var n=t;n<=e;++n)this.bgms_.containsKey(n)||(++this.bgmProcTotal_,a.G.readAudio("audio/"+p[n],this._loadBgm.bind(this),n));else this.bgms_.containsKey(t)||(++this.bgmProcTotal_,a.G.readAudio("audio/"+p[t],this._loadBgm.bind(this),t));this.bgmProcCb_=i},e.prototype.releaseBgmInEnumRange=function(t,e){if(void 0===e&&(e=r.kNone),cc.audioEngine.stopMusic(),e==r.kNone)this.bgms_.containsKey(e)&&(cc.loader.release(this.bgms_.get(e)),this.bgms_.remove(e));else for(var i=t;i<=e;++i)this.bgms_.containsKey(i)&&(cc.loader.release(this.bgms_.get(i)),this.bgms_.remove(i))},e.prototype.preloadSfxInEnumRange=function(t,e,i){void 0===i&&(i=null);for(var n=t;n<=e;++n)this.sfxMap_.containsKey(n)||(++this.sfxProcTotal_,a.G.readAudio("audio/"+d[n],this._loadSfx.bind(this),n));this.sfxProcCb_=i},e.prototype.releaseSfxInEnumRange=function(t,e){cc.audioEngine.stopAllEffects();for(var i=t;i<=e;++i)this.sfxMap_.containsKey(i)||(cc.loader.release(this.sfxMap_.get(i)),this.sfxMap_.remove(i))},e.prototype._loadBgm=function(t,e,i){void 0===i&&(i=!1),this.bgms_.put(e,t),this.bgmRemoteDelayType_!=r.kNone&&this.bgmRemoteDelayType_==e?(this.playMusic(this.bgmRemoteDelayType_),this.bgmRemoteDelayType_=r.kNone):i&&this.playMusic(e),++this.bgmProcCnt_,this.bgmProcCb_&&(this.bgmProcCb_(this.bgmProcCnt_,this.bgmProcTotal_),this.bgmProcCnt_>=this.bgmProcTotal_&&(this.bgmProcCb_=null))},e.prototype._loadSfx=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),this.sfxMap_.put(e,t),i&&!this.bMuteSound_&&cc.audioEngine.playEffect(t,n),++this.sfxProcCnt_,this.sfxProcCb_&&(this.sfxProcCb_(this.sfxProcCnt_,this.sfxProcTotal_),this.sfxProcCnt_>=this.sfxProcTotal_&&(this.sfxProcCb_=null))},e.prototype.setIfMuteMusic=function(t){this.bMuteMusic_=t,t?cc.audioEngine.stopMusic():this.bgmId_=cc.audioEngine.playMusic(this.bgms_.get(this.curBgmType_),!0),this.bMuteMusic_!=t&&this._saveData()},e.prototype.setIfMuteSound=function(t){this.bMuteSound_=t,this.bMuteSound_!=t&&this._saveData()},e.prototype.setBgmVolume=function(t){this.maxBgmVol_=t,cc.audioEngine.setMusicVolume(t),a.G.isEqualF(t,this.maxBgmVol_)||this._saveData()},e.prototype.setSfxVolume=function(t){this.maxSfxVol_=t,cc.audioEngine.setEffectsVolume(t),a.G.isEqualF(t,this.maxSfxVol_)||this._saveData()},e.prototype._saveData=function(){var t={bMuteBgm:this.bMuteMusic_,bMuteSfx:this.bMuteSound_,maxBgmVol:this.maxBgmVol_,maxSfxVol:this.maxSfxVol_};s.default.writeJSON(s.SaveDef.kAudio,t)},e.prototype._readData=function(){var t=s.default.readJSON(s.SaveDef.kAudio);a.G.isExistObj(t)?(this.bMuteMusic_=t.bMuteBgm,this.bMuteSound_=t.bMuteSfx,this.maxBgmVol_=t.maxBgmVol,this.maxSfxVol_=t.maxSfxVol):this._saveData(),this.setBgmVolume(this.maxBgmVol_),this.setSfxVolume(this.maxSfxVol_)},e.prototype.playMusic=function(t,e){void 0===e&&(e=!1),this.bMuteMusic_||(cc.audioEngine.stopMusic(),t!==r.kNone&&(this.curBgmType_=t,this.bgms_.containsKey(t)?this.bgmId_=cc.audioEngine.playMusic(this.bgms_.get(t),!0):e?this.bgmRemoteDelayType_=t:a.G.readAudio("audio/"+p[t],this._loadBgm.bind(this),t,!0)))},e.prototype.replayMusic=function(){this.curBgmType_&&this.bgms_.containsKey(this.curBgmType_)&&(cc.audioEngine.stopMusic(),this.bgmId_=cc.audioEngine.playMusic(this.bgms_.get(this.curBgmType_),!0))},e.prototype.pauseMusic=function(){cc.audioEngine.pauseMusic()},e.prototype.resumeMusic=function(){cc.audioEngine.resumeMusic()},e.prototype.stopMusic=function(){cc.audioEngine.stopMusic()},e.prototype.stopEffects=function(){cc.audioEngine.stopAllEffects()},e.prototype.changeBgmWithFade=function(t,e){void 0===e&&(e=1),this.unscheduleAllCallbacks(),this.maxFadeVol_>0&&(this.maxBgmVol_=this.maxFadeVol_),this.maxFadeVol_=this.maxBgmVol_;var i=this.maxBgmVol_,n=e/10,o=this.maxFadeVol_/10*2,r=!1;this.schedule(function(){this.maxBgmVol_>0&&!r?(this.maxBgmVol_-=o,this.maxBgmVol_<=0&&(this.maxBgmVol_=0,this.playMusic(t),r=!0)):(this.maxBgmVol_+=o,this.maxBgmVol_>=i&&(this.maxBgmVol_=i)),cc.log(this.maxBgmVol_),this.setBgmVolume(this.maxBgmVol_)}.bind(this),n,10)},e.prototype._playSfx=function(t,e){void 0===e&&(e=!1),null!=t&&(this.bMuteSound_||(this.sfxMap_.containsKey(t)?cc.audioEngine.playEffect(this.sfxMap_.get(t),e):a.G.readAudio(d[t],this._loadSfx.bind(this),t,!0)))},e.prototype.playSound=function(t,e){void 0===e&&(e=!1),t!==u.kNone&&this._playSfx(t,e)},e.prototype.playButton=function(){this._playSfx(u.kButton)},e.prototype.playAttAir=function(){this._playSfx(u.kAtt_Air)},e.prototype.playAttFoot0=function(){this._playSfx(this.attFoot0[a.G.Game.curHeroID])},e.prototype.playAttFoot1=function(){this._playSfx(this.attFoot1[a.G.Game.curHeroID])},e.prototype.playAttHand0=function(){this._playSfx(this.attHand0[a.G.Game.curHeroID])},e.prototype.playAttHand1=function(){this._playSfx(this.attHand1[a.G.Game.curHeroID])},e.prototype.playJump=function(){this._playSfx(u.KJump)},e.prototype.playBottle=function(){this._playSfx(u.KBottle)},e.prototype.playCoin=function(){this._playSfx(u.KCoin)},e.prototype.playDown=function(){this._playSfx(u.KDown)},e.prototype.playXuLi=function(){this._playSfx(u.KXuli)},e.prototype.playBoxBoom=function(){this._playSfx(u.KBoxBoom)},e.prototype.playGun=function(){this._playSfx(u.KGun)},e.prototype.playHerHurt=function(){var t=this;this.hurtTime||(this.hurtTime=!0,this.scheduleOnce(function(){t.hurtTime=!1},1),this._playSfx(this.hurtAudio[a.G.Game.curHeroID]))},e.prototype.playHeroAtt0=function(){this._playSfx(this.att0Audio[a.G.Game.curHeroID])},e.prototype.playHeroAtt1=function(){this._playSfx(this.att1Audio[a.G.Game.curHeroID])},e.prototype.playHeroAtt2=function(){this._playSfx(this.att2Audio[a.G.Game.curHeroID])},e.prototype.playHeroAtt3=function(){this._playSfx(this.att3Audio[a.G.Game.curHeroID])},e.prototype.playHeroAtt4=function(){this._playSfx(this.att4Audio[a.G.Game.curHeroID])},e.prototype.playStick=function(){this._playSfx(u.KStick)},e.instance=null,e=i=o([c],e)}(cc.Component);i.AudioMgr=f,cc._RF.pop()},{"./global_def":"global_def","./storage":"storage","./structure/hd_map":"hd_map"}],base_ui:[function(t,e,i){"use strict";cc._RF.push(e,"19787PQWoNAEZGrfcDakdpb","base_ui"),Object.defineProperty(i,"__esModule",{value:!0}),function(t){t[t.kDefault=0]="kDefault",t[t.kHomePnl=1]="kHomePnl",t[t.kRepository=2]="kRepository",t[t.kTrialPnl=3]="kTrialPnl",t[t.kStore=4]="kStore",t[t.KGamePnl=5]="KGamePnl",t[t.kExportPnl=6]="kExportPnl",t[t.kRevivePnl=7]="kRevivePnl",t[t.KExprotFriPnl=8]="KExprotFriPnl",t[t.kSign=9]="kSign",t[t.kStoryPnl=10]="kStoryPnl",t[t.kReceivePnl=11]="kReceivePnl",t[t.kResultPnl=12]="kResultPnl",t[t.kSetting=994]="kSetting",t[t.kDialog=995]="kDialog",t[t.kCoin=996]="kCoin",t[t.kBlocker=997]="kBlocker",t[t.kTrans=998]="kTrans",t[t.kExportCom=999]="kExportCom",t[t.kExportPage=1e3]="kExportPage",t[t.kTip=1101]="kTip",t[t.kTestBnr=1002]="kTestBnr",t[t.KEndLayer=1003]="KEndLayer"}(i.UIHierarchy||(i.UIHierarchy={}));var n=function(){function t(){this.com_=null,this.id_=0,this.bLock_=!1}return t.prototype.init=function(t){},t.prototype.add=function(t){this.com_&&(t.addChild(this.com_),this.com_.visible=!1)},t.prototype.reset=function(){},t.prototype.remove=function(){this.com_&&this.com_.removeFromParent()},t.root=null,t}();i.BaseUI=n,cc._RF.pop()},{}],bg:[function(t,e,i){"use strict";cc._RF.push(e,"0eab5mUMcJJ9JFBZuqu54js","bg");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../util/global_def"),a=cc._decorator,s=a.ccclass,h=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.camera=null,e.peak0=null,e.peak1=null,e.peak2=null,e.lines=[500,-320,300],e.px=[978,1550,1150],e.firstX=[-786,-1140,-850],e.offset=[126,500,190],e.itemManager=[[],[],[]],e}return n(e,t),e.prototype.setManager=function(t,e,i){var n=t.children;for(var o in n){var a=n[o];e.push(a),1!=i?a.height=this.lines[i]+r.G.randRange(0,100):a.y=this.lines[i]-r.G.randRange(0,100)}},e.prototype.init=function(){this.setManager(this.peak0,this.itemManager[0],0),this.setManager(this.peak1,this.itemManager[1],1),this.setManager(this.peak2,this.itemManager[2],2)},e.prototype.getDir=function(){return-1},e.prototype.goRight=function(t){if(-1!=this.getDir()){var e=-r.G.viewX/2+this.camera.x,i=[];r.G.copyArr(this.itemManager[t],i);for(var n in this.itemManager[t]){var o=this.itemManager[t][n];if(!(o.x+o.width<e))break;o.x=this.px[t],this.px[t]+=this.offset[t],this.firstX[t]+=this.offset[t],i.splice(0,1),i[i.length]=o}this.itemManager[t]=i}},e.prototype.goLeft=function(t){if(1!=this.getDir()){var e=r.G.viewX/2+10+this.camera.x,i=[];r.G.copyArr(this.itemManager[t],i);for(var n=this.itemManager[t].length-1;n>=0;n--){var o=this.itemManager[t][n];if(!(o.x>e))break;o.x=this.firstX[t]-this.offset[t],this.px[t]-=this.offset[t],this.firstX[t]-=this.offset[t],i.pop(),i.unshift(o)}this.itemManager[t]=i}},e.prototype.onLoad=function(){var t=this;this.node.x=r.G.viewX/2,this.node.y=r.G.viewY/2,this.init();var e=0;this.schedule(function(){if(++e%2==0)for(var i=0;i<3;++i)t.goLeft(i);else for(i=0;i<3;++i)t.goRight(i)},.15,cc.macro.REPEAT_FOREVER,1)},o([h(cc.Node)],e.prototype,"camera",void 0),o([h(cc.Node)],e.prototype,"peak0",void 0),o([h(cc.Node)],e.prototype,"peak1",void 0),o([h(cc.Node)],e.prototype,"peak2",void 0),e=o([s],e)}(cc.Component);i.default=l,cc._RF.pop()},{"../../util/global_def":"global_def"}],bigNodeManager:[function(t,e,i){"use strict";cc._RF.push(e,"fd87bIrpPpL0Jxlwdwzfew5","bigNodeManager");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.bigNode=void 0;var r=t("../../../util/global_def"),a=cc._decorator,s=a.ccclass,h=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.manager={},e.info=[],e.levelX=300,e.mapCamera=null,e}var i;return n(e,t),i=e,e.prototype.initCamera=function(t){this.mapCamera=t},e.prototype.onLoad=function(){var t=this;i.instance=this,window.bigNodeManager=this;var e=-r.G.viewX/2-this.levelX,n=r.G.viewX/2+this.levelX;this.schedule(function(){for(var i=t.info.length-1;i>=0;i--){var o=t.info[i],r=o.pos,a=t.mapCamera.convertToNodeSpaceAR(r),s=0,h=0;if(o.sx>0?(s=a.x+o.width*(1-o.anchorX),h=a.x-o.width*o.anchorX):(s=a.x+o.width*o.anchorX,h=a.x-o.width*(1-o.anchorX)),h<n&&s>e||s>e&&h<n){var l=t.manager[o.name][0];t.manager[o.name].splice(0,1);var c=o.parent;if(!l)return;null==l.parent&&(l.parent=c),l.position=c.convertToNodeSpaceAR(r),l.scaleX=o.sx,l.scaleY=o.sy,t.info.splice(Number(i),1)}}},.7,cc.macro.REPEAT_FOREVER)},e.instance=null,e=i=o([s],e)}(cc.Component));i.default=h;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this.checkPause()},e.prototype.checkPause=function(){var t=this,e=-r.G.viewX/2-h.instance.levelX,i=r.G.viewX/2+h.instance.levelX;this.schedule(function(){var n=t.node.convertToWorldSpaceAR(cc.v2(0,0)),o=h.instance.mapCamera.convertToNodeSpaceAR(n),r=0,a=0;t.node.scaleX>0?(r=o.x+t.node.width*(1-t.node.anchorX),a=o.x-t.node.width*t.node.anchorX):(r=o.x+t.node.width*t.node.anchorX,a=o.x-t.node.width*(1-t.node.anchorX)),(r<e||a>i)&&t.pause(n)},.1,cc.macro.REPEAT_FOREVER,1)},e.prototype.pause=function(t){var e=h.instance.manager,i=h.instance.info,n=this.node.name;e[n]||(e[n]=[]),e[n].push(this.node),i.push({name:n,parent:this.node.parent,pos:t,sx:this.node.scaleX,sy:this.node.scaleY,width:this.node.width,anchorX:this.node.anchorX}),this.node.scale=1,this.node.parent=null},e}(cc.Component);i.bigNode=l,cc._RF.pop()},{"../../../util/global_def":"global_def"}],bonus_data:[function(t,e,i){"use strict";cc._RF.push(e,"6b38dIa7PVENZ1lrJM38f9K","bonus_data"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../util/global_def"),o=t("../util/structure/hd_map"),r=function(){return function(){this.val=0,this.prob=0}}(),a=function(){return function(){this.id=0,this.day=0,this.amountBase=0,this.bAmountCal=!1,this.items=[],this.desc=""}}(),s=function(){return function(){this.idRand=[],this.amountRand=[],this.idBase=0,this.bIdCal=!1,this.amountBase=0,this.bAmoutCal=!1}}(),h=function(){return function(){this.id=0,this.count=0,this.items=[]}}(),l=function(){return function(){this.id=0,this.name="",this.res=""}}(),c=function(){function t(){}return t.fetch=function(t){this._parseCategory(t.bonusCategory),this._parseSignInData(t.signInGenRule),this._parseBoxData(t.boxGenRule)},t.getSignInDataGroup=function(t){return this._getDataGroup(this.signInDatMap_,7,t)},t.getBoxDataGroup=function(t){return this._getDataGroup(this.boxDataMap_,3,t)},t.getSignInBonusID=function(t){var e=0;if(this.signInDatMap_.containsKey(t)){var i=this.signInDatMap_.get(t);if(i.items.length>0)if(1==i.items.length)e=i.items[0].val;else for(var o=0,r=0,a=n.G.randRange(0,100),s=0;s<i.items.length;++s){if(a<=(r+=i.items[s].prob)&&a>o){e=i.items[s].val;break}o+=i.items[s].prob}}return e},t.getSignInBonusAmount=function(t,e){var i=0;if(this.signInDatMap_.containsKey(t)){var n=this.signInDatMap_.get(t);i=n.bAmountCal&&e?e(n.amountBase):n.amountBase}return i},t.getBoxBonusID=function(t,e){return this._calBoxBonusVal(t.idRand,t.idBase,t.bIdCal,e)},t.getBoxBonusAmount=function(t,e){return this._calBoxBonusVal(t.amountRand,t.amountBase,t.bAmoutCal,e)},t.getBonusCategoryData=function(t){var e=null;return this.categoryMap_.containsKey(t)&&(e=this.categoryMap_.get(t)),e},t._getDataGroup=function(t,e,i){var n=[],o=t.size();if(o>0){for(;i*e>o-1;)--i;var r=0;for((n=t.values(i*e,e)).length;n.length<e;)n.push(n[r]),++r>=n.length&&(r=0)}return n},t._calBoxBonusVal=function(t,e,i,o){var r=0;if(0==t.length)r=i&&o?o(e):e;else if(1==t.length)r=t[0].val;else for(var a=0,s=0,h=n.G.randRange(0,100),l=0;l<t.length;++l){if(h<=(s+=t[l].prob)&&h>a){r=t[l].val;break}a+=t[l].prob}return r},t._parseSignInData=function(e){if(e)for(var i in e)if(e.hasOwnProperty(i)){var n=e[i],o=new a;o.id=parseInt(i),o.day=n.day;var r=this._parseFuncGrammar(n.amount);o.amountBase=r.base,o.bAmountCal=r.bCal,o.items=this._parseRandGrammar(n.bid),o.desc=n.desc,t.signInDatMap_.put(o.id,o)}},t._parseBoxData=function(e){var i=this;if(e){var n=function(t,e,n){var o=new s;if(""!==t)if(i._isFuncGrammar(t)){var r=i._parseFuncGrammar(t);o.idBase=r.base,o.bIdCal=r.bCal}else i._isRandGrammar(t)?o.idRand=i._parseRandGrammar(t):o.idBase=Number(t);if(""!==e)if(i._isFuncGrammar(e)){r=i._parseFuncGrammar(e);o.amountBase=r.base,o.bAmoutCal=r.bCal}else i._isRandGrammar(e)?o.amountRand=i._parseRandGrammar(e):o.amountBase=Number(e);(o.idBase>0||o.idRand.length>0||o.amountBase>0||o.amountRand.length>0)&&n.push(o)};for(var o in e)if(e.hasOwnProperty(o)){var r=e[o],a=new h;a.id=parseInt(o),a.count=r.count,n(r.bid1,r.num1,a.items),n(r.bid2,r.num2,a.items),n(r.bid3,r.num3,a.items),t.boxDataMap_.put(a.id,a)}}},t._parseCategory=function(e){if(e)for(var i in e)if(e.hasOwnProperty(i)){var n=e[i],o=new l;o.id=parseInt(i),o.name=n.name,o.res=n.res,t.categoryMap_.put(o.id,o)}},t._isFuncGrammar=function(t){return"string"==typeof t&&-1!=t.indexOf("f")},t._isRandGrammar=function(t){return"string"==typeof t&&-1!=t.indexOf(",")},t._parseFuncGrammar=function(t){var e={base:0,bCal:!1};if("string"==typeof t&&-1!=t.indexOf("f")){var i=t.indexOf("("),n=t.indexOf(")");if(-1!=i&&-1!=n){var o=t.substring(i+1,n);e.base=Number(o),e.bCal=!0}else e.base=1,e.bCal=!1}else e.base=Number(t);return e},t._parseRandGrammar=function(t){var e=[];if("string"==typeof t&&-1!=t.indexOf(",")){for(var i=0,n=0,o=t.indexOf(","),a=-1!=o?2:0;a>0;){var s=new r,h=-1!=o?t.substring(0,o):t,l=h.indexOf(":");if(-1!=l){var c=h.substring(0,l);if(s.val=Number(c),i<100){var u=h.substring(l+1);if(s.prob=Number(u),(i+=s.prob)>100){var p=i-100;s.prob-=p,s.prob<0&&(s.prob=0)}}else s.prob=0}else s.val=Number(h),s.prob=-1,++n;--a,-1!=o&&-1!=(o=(t=t.substring(o+1)).indexOf(","))&&++a,e.push(s)}if(i<100){var d=100-i;if(n>0){for(var f=d/n,_=0;_<e.length;++_)-1==e[_].prob&&(e[_].prob=f);e[e.length-1].prob+=1e-7}else e[e.length-1].prob+=d}}else{(s=new r).val=Number(t),s.prob=100,e[0]=s}return e},t.signInDatMap_=new o.default,t.boxDataMap_=new o.default,t.categoryMap_=new o.default,t}();i.BonusData=c,cc._RF.pop()},{"../util/global_def":"global_def","../util/structure/hd_map":"hd_map"}],boss0:[function(t,e,i){"use strict";cc._RF.push(e,"21f8eP+VCJNVJ0xwgmUWI1z","boss0");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.footCom=i.eBossState=void 0;var r,a=t("../enemy"),s=t("../../../util/global_def"),h=t("../../scene/gameScene"),l=t("../../tools/resource_control"),c=t("../hero"),u=t("../../../util/mgp_util"),p=t("../../tools/nodePool_control"),d=t("../weapon/weapon"),f=t("../../../util/audio_mgr"),_=cc._decorator,g=_.ccclass,m=_.property;(function(t){t[t.jump=a.eActState.Ext+1]="jump",t[t.shoot=a.eActState.Ext+2]="shoot",t[t.sprint=a.eActState.Ext+3]="sprint",t[t.weak=a.eActState.Ext+4]="weak"})(r=i.eBossState||(i.eBossState={}));(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aniChong="",e.aniYunDao="",e.aniLianCai="",e.aniLuoDi="",e.aniSheJiUp="",e.aniSheJiDown="",e.aniSheJiMid="",e.aniDieBefore="",e.aniDie="",e}n(e,t)})(a.eAniName);var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.foot=null,e.footBox=null,e.isCanQn=!1,e.originSc=.8,e.dataName="boss0",e.redTag=null,e.state=null,e.isBoss=!0,e.powerNum=100,e.barNode=null,e.bloodBar=null,e.powerBar=null,e.aniName={aniMv:"BOSS1_zou",aniIdle:"BOSS1_daiji",aniAttack:"BOSS1_cai",aniJm:"BOSS1_tiaoqi",aniPaQi0:"BOSS1_zhanqi",aniChong:"BOSS1_chongfeng",aniYunDao:"BOSS1_yundao",aniLianCai:"BOSS1_liancai",aniLuoDi:"BOSS1_luodi",aniSheJiUp:"BOSS1_sheji-shang",aniSheJiDown:"BOSS1_sheji-xia",aniSheJiMid:"BOSS1_sheji-zhong",aniDieBefore:"BOSS1_siwang_1",aniDie:"BOSS1_siwang_2"},e.upTime=0,e.tartgetX=0,e.downAtting=!1,e}return n(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.entity.blood=400,this.entity.bloodLimit=400,this.entity.noCollItem=!0,this.redTag=new cc.Node,this.redTag.addComponent(cc.Sprite).spriteFrame=l.default.instance.getSpriteFrame("redTag"),this.redTag.parent=this.node.parent,this.redTag.setPosition(this.node.x,-1e4),this.redTag.active=!1,this.footBox=this.foot.getComponent(cc.BoxCollider),this.footBox.enabled=!1,this.foot.addComponent(v),this.barNode=this.node.getChildByName("barNode"),this.bloodBar=this.barNode.getChildByName("bloodBar").getComponent(cc.Sprite),this.powerBar=this.barNode.getChildByName("powerBar").getComponent(cc.Sprite),this.barNode.parent=null,this.barNode.parent=h.default.instance.node,this.barNode.position=cc.v3(400,300,0),this.schedule(function(){e.updatePower()},.1,cc.macro.REPEAT_FOREVER,.1)},e.prototype.updatePower=function(){this.state!=r.weak&&(this.powerNum+=2,this.powerNum>100&&(this.powerNum=100),this.powerBar.fillRange=this.powerNum/100,this.entity.isDie&&(this.powerBar.fillRange=0))},e.prototype.checkSearchPath=function(){var t=this;this.schedule(function(){t.updateState()},2,cc.macro.REPEAT_FOREVER,1)},e.prototype.doBloodAni=function(t){this.bloodBar.fillRange=this.entity.blood/this.entity.bloodLimit},e.prototype.pause=function(t){},e.prototype.updateState=function(){if(this.state==a.eActState.idle||this.state==a.eActState.hurt||this.state==a.eActState.right||this.state==a.eActState.left)if(this.hitInfo.x)this.setState(a.eActState.attack);else{var t=this.node.x-h.default.instance.hero.x;if(Math.abs(t)>300)this.setState(r.shoot);else{var e=s.G.randRange(0,100);e>90?this.setState(r.shoot):e<=90&&e>70?this.setState(r.jump):e<=70&&e>50?this.setState(r.sprint):this.searchPath()}}},e.prototype.recoverRect=function(){this.entity.Rect=new cc.Rect(0,0,300,540),this.entity.ani.node.y=300},e.prototype.setRectbyTime=function(t){void 0===t&&(t=!0)},e.prototype.getPath=function(t,e){return[{pos:cc.v2(t,e+50)}]},e.prototype.gotoHero=function(){if(this.run&&null!=this.targetPos){if(this.checkXing=!1,null==this.target){if(0==this.targetPos.length)return void(this.run=!1);this.getTarget(),this.toTarget=!1}var t=cc.v2(this.node.x,this.node.y-this.entity.Rect.height*this.node.anchorY),e=cc.v2(this.target.x,this.target.y).sub(t);e.mag()<=10&&(this.target=null),this.toTarget||(e.x>0?this.setState(a.eActState.right,!0):e.x<0&&this.setState(a.eActState.left,!0),this.toTarget=!0)}},e.prototype.setDir=function(){var t=this.node.x>h.default.instance.hero.x?1:-1;this.node.scaleX=t*this.originSc},e.prototype.setState=function(t,e,i){var n=this;if(void 0===e&&(e=!1),void 0===i&&(i=cc.v2(0,0)),!this.entity.isDie){if(this.state==r.weak&&(t<a.eActState.hurt||t>a.eActState.Ext)&&!e)return!0;switch(t){case a.eActState.idle:this.dir=0,this.entity.lineVelocity.x=0,this.playAni(this.aniName.aniIdle,-1);break;case a.eActState.attack:this.state=t,this.doAttack();break;case a.eActState.left:case a.eActState.right:if(this.playTime>0)break;this.dir=-1,t==a.eActState.right&&(this.dir=1),this.hitInfo.x!=t||e?(this.entity.lineVelocity.x=this.speedMv*this.dir,this.node.scaleX=-this.dir*this.originSc,this.playAni(this.aniName.aniMv,-1)):this.setState(a.eActState.attack);break;case r.shoot:this.doShoot(t);break;case r.jump:this.playAni(this.aniName.aniJm,1),this.entity.lineVelocity.y=1700,this.scheduleOnce(function(){n.entity.cancelGravity=!0,n.entity.gravity=0,n.entity.lineVelocity.y=0,n.setUpTime(3)},1);break;case r.sprint:this.setDir(),this.playAni(this.aniName.aniChong,1);var o=h.default.instance.hero.x>this.node.x?1:-1;this.entity.lineVelocity.x=400*o,cc.tween(this).delay(.75).call(function(){n.entity.lineVelocity.x=0}).delay(.6).call(function(){n.state==r.sprint&&(n.setFootAtt(),n.setState(r.shoot))}).start();break;case r.weak:this.entity.lineVelocity.x=0,this.playAni(this.aniName.aniYunDao,1),this.scheduleOnce(function(){n.powerNum=100,n.setState(r.jump,!0)},2.5);break;default:if(this.showRed(),t==a.eActState.hurtLianJi0?f.AudioMgr.instance.playAttHand0():t==a.eActState.hurtLianJi1?f.AudioMgr.instance.playAttHand1():t==a.eActState.hurtLianJi2?f.AudioMgr.instance.playAttFoot0():t==a.eActState.hurtLianJi3||f.AudioMgr.instance.playAttFoot1(),this.state==r.weak)return;return this.state=a.eActState.hurt,this.powerNum-=20,this.powerNum<=0&&(this.powerNum=0,this.setState(r.weak)),void(this.powerBar.fillRange=this.powerNum/100)}this.state=t}},e.prototype.doShoot=function(t){var e=this;this.setDir(),this.state=t;var i=h.default.instance.hero.y-this.node.y,n=0;i>200?(n=this.node.y+250,this.playAni(this.aniName.aniSheJiUp,1)):i<=200&&i>100?(this.playAni(this.aniName.aniSheJiMid,1),n=this.node.y+150):(this.playAni(this.aniName.aniSheJiDown,1),n=this.node.y+50),this.runShoot(cc.v2(this.node.x,n)),this.stateScheduleOnce(function(){e.setState(a.eActState.idle)},.9)},e.prototype.doDie=function(t){var e=this;cc.tween(this).call(function(){e.playAni(e.aniName.aniDieBefore,1)}).delay(1.7).call(function(){e.playAni(e.aniName.aniDie,1)}).delay(1.5).call(function(){e.node.destroy(),e.barNode.destroy()}).start()},e.prototype.runShoot=function(t){var e=this,i=this.getDir();this.stateSchedule(function(){var n=p.default.instance.getNode("bulletEnemy");n.parent=e.node.parent,n.x=t.x+400*i,n.y=t.y+s.G.randRange(10,30),n.scale=1.5,n.getComponent(d.default).fly(i)},.2,2,.2)},e.prototype.setFootAtt=function(t){var e=this;void 0===t&&(t=.2),this.footBox.enabled=!0,this.scheduleOnce(function(){e.footBox.enabled=!1},t)},e.prototype.setUpTime=function(t){var e=this;this.upTime=60*t;var i=s.G.viewY+h.default.instance.mapCamera.y;this.node.y=i+100,this.redTag.y=this.node.y-500,this.redTag.x=this.node.x,this.redTag.active=!0,this.tartgetX=h.default.instance.hero.x+10,this.schedule(function(){e.tartgetX=h.default.instance.hero.x+10},.2,cc.macro.REPEAT_FOREVER,.2)},e.prototype.downAtt=function(){this.node.x=this.redTag.x,this.entity.cancelGravity=!1,this.entity.lineVelocity.y=-900,this.entity.gravity=this.entity.originGy,this.downAtting=!0,this.setDir(),this.setFootAtt(1)},e.prototype.down=function(){var e=this;t.prototype.down.call(this),this.downAtting&&(this.downAtting=!1,this.playAni(this.aniName.aniLuoDi,1),this.foot.width=700,this.foot.getComponent(cc.BoxCollider).size.width=700,this.shake(),this.scheduleOnce(function(){e.foot.width=200,e.foot.getComponent(cc.BoxCollider).size.width=200,e.setState(a.eActState.idle)},.1))},e.prototype.shake=function(){u.MgpUtil.vibrateShort(),h.default.instance.startShake()},e.prototype.doAttack=function(){var t=this;this.setDir(),this.entity.lineVelocity.x=0,this.cleanPath(),Math.random()<.8?(this.playAni(this.aniName.aniAttack,1),cc.tween(this).delay(.6).call(function(){t.shake(),t.setFootAtt()}).delay(1).call(function(){t.setState(a.eActState.idle)}).start()):(this.playAni(this.aniName.aniLianCai,1),cc.tween(this).delay(.3).call(function(){t.shake(),t.setFootAtt()}).delay(1).call(function(){t.setState(a.eActState.idle)}).start())},e.prototype.update=function(){if(t.prototype.update.call(this),this.upTime--,this.upTime>0){var e=this.tartgetX-this.redTag.x;if(Math.abs(e)<=2.5)return void(this.redTag.x=this.tartgetX);var i=e>0?1:-1;this.redTag.x+=2.5*i}else 0==this.upTime&&(this.redTag.active=!1,this.downAtt())},e.prototype.onCollisionEnter=function(t,e){"hero"==t.node.group&&1001==t.tag&&(this.state!=r.sprint&&this.state!=a.eActState.left&&this.state!=a.eActState.right&&this.state!=a.eActState.idle||this.setState(a.eActState.attack))},o([m(cc.Node)],e.prototype,"foot",void 0),e=o([g],e)}(a.enemyAct);i.default=y;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onCollisionEnter=function(t,e){if("point"!=t.node.name){var i=t.node.getComponent(c.heroAct),n=this.node.convertToWorldSpaceAR(cc.v2(0,0)),o=h.default.instance.hero.convertToWorldSpaceAR(cc.v2(0,0));i.hurtDir=n>o?1:-1;var r=e.node.width>200?-40:-30;i.setState(c.actState.fallWater,!1,r),this.node.getComponent(cc.BoxCollider).enabled=!1}},e}(cc.Component);i.footCom=v,cc._RF.pop()},{"../../../util/audio_mgr":"audio_mgr","../../../util/global_def":"global_def","../../../util/mgp_util":"mgp_util","../../scene/gameScene":"gameScene","../../tools/nodePool_control":"nodePool_control","../../tools/resource_control":"resource_control","../enemy":"enemy","../hero":"hero","../weapon/weapon":"weapon"}],boss1:[function(t,e,i){"use strict";cc._RF.push(e,"431b87vUaBArq8Pj6XAVm6+","boss1");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./boss0"),a=t("../enemy"),s=t("../../scene/gameScene"),h=t("../../../util/global_def"),l=(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aniChong="",e.aniYunDao="",e.aniLianCai="",e.aniLuoDi="",e.aniQuanJi="",e.aniSheJiMid="",e.aniDieBefore="",e.aniDie="",e}n(e,t)}(a.eAniName),cc._decorator),c=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hand=null,e.handBox=null,e.dataName="boss1",e.aniName={aniMv:"BOSS2_zou",aniIdle:"BOSS2_daiji",aniAttack:"BOSS2_cai",aniJm:"BOSS2_tiaoqi",aniPaQi0:"BOSS2_zhanqi",aniChong:"BOSS2_chongfeng",aniYunDao:"BOSS2_yundao",aniLianCai:"BOSS2_liancai",aniLuoDi:"BOSS2_luodi",aniDieBefore:"BOSS2_siwang_1",aniDie:"BOSS2_siwang_2",aniQuanJi:"BOSS2_quanji"},e}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.hand.addComponent(r.footCom),this.handBox=this.hand.getComponent(cc.BoxCollider),this.handBox.enabled=!1},e.prototype.doShoot=function(t){var e=this;this.setDir(),this.state=t,this.playAni(this.aniName.aniQuanJi,1),this.scheduleOnce(function(){e.setHandAtt(.2)},.4),this.stateScheduleOnce(function(){e.setState(a.eActState.idle)},1.5)},e.prototype.downAtt=function(){this.node.x=this.redTag.x,this.entity.cancelGravity=!1,this.entity.lineVelocity.y=-900,this.entity.gravity=this.entity.originGy,this.downAtting=!0,this.setDir(),this.setFootAtt(.6)},e.prototype.updateState=function(){if(this.state==a.eActState.idle||this.state==a.eActState.hurt||this.state==a.eActState.right||this.state==a.eActState.left)if(this.hitInfo.x)this.setState(a.eActState.attack);else{var t=this.node.x-s.default.instance.hero.x;if(Math.abs(t)>70&&Math.abs(t)<200&&Math.random()>.6)this.setState(r.eBossState.shoot);else{var e=h.G.randRange(0,100);e>90?this.setState(r.eBossState.shoot):e<=90&&e>80?this.setState(r.eBossState.jump):e<=80&&e>50?this.setState(r.eBossState.sprint):this.searchPath()}}},e.prototype.setHandAtt=function(t){var e=this;void 0===t&&(t=.2),this.handBox.enabled=!0,this.scheduleOnce(function(){e.handBox.enabled=!1},t)},o([u(cc.Node)],e.prototype,"hand",void 0),e=o([c],e)}(r.default);i.default=p,cc._RF.pop()},{"../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../enemy":"enemy","./boss0":"boss0"}],bottle:[function(t,e,i){"use strict";cc._RF.push(e,"80dfeP0XDRG/4vp/Muzq+/h","bottle");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../util/global_def"),a=t("../tools/nodePool_control"),s=t("../../util/audio_mgr"),h=t("../tools/resource_control"),l=t("./ItemInfo"),c=t("../scene/gameScene"),u=t("../../util/mgp_util"),p=cc._decorator,d=p.ccclass,f=p.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=0,e.leaveSpr=null,e.coinNum=3,e.boomTime=.25,e.foodPro=0,e.ani=null,e.hasCount=3,e.originHeight=0,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.ani=this.node.getComponent(cc.Animation),this.originHeight=this.node.height;var e=Math.random();this.schedule(function(){if(!(e<.7||t.hasCount<=0)){var i=cc.scaleTo(.08,1,.7),n=cc.scaleTo(.08,1,1.2),o=cc.scaleTo(.08,1,1),r=cc.jumpBy(.15,cc.v2(0,0),15,1);t.node.runAction(cc.sequence(i,cc.spawn(n,r),o))}},2,cc.macro.REPEAT_FOREVER)},e.prototype.play=function(){var t=this.ani.defaultClip.name;this.ani.play(t)},e.prototype.playMusic=function(){s.AudioMgr.instance.playBottle()},e.prototype.doDestroyAni=function(){this.playMusic();var t=this.node.getChildByName("boom");t.active=!0;var e=t.getComponent(cc.Animation);e.play(e.defaultClip.name),this.scheduleOnce(function(){t.destroy()},this.boomTime);var i=a.default.instance.getNode("bottle_boom");i.getComponent("animation").reuse();var n=this.node.position;i.position=n,i.parent=this.node.parent,this.node.removeComponent(cc.Animation),this.node.getComponent(cc.Sprite).spriteFrame=this.leaveSpr,this.node.y-=(this.originHeight-this.node.height)*this.node.anchorY;for(var o=function(t){var e="coin_"+r.G.randRange(0,2),i=h.default.instance.getPrefabs(e),o=cc.instantiate(i);o.parent=s.node.parent,o.position=n,o.getComponent("coin").run=!1;var a=80*s.coinNum/3,l=cc.jumpBy(.5,cc.v2(r.G.randRange(-a,a),20),100,1);o.runAction(cc.sequence(l,cc.callFunc(function(){o.getComponent("coin").run=!0})))},s=this,l=0;l<this.coinNum;++l)o();if(r.G.randRange(0,100)<this.foodPro){var u="apple";r.G.randRange(0,100)>70&&(u="chicken");var p=h.default.instance.getPrefabs(u),d=cc.instantiate(p);d.parent=this.node.parent,d.position=n,d.getComponent("food").run=!1;var f=100,_=cc.jumpBy(.5,cc.v2(r.G.randRange(-f,f),40),120,1);d.runAction(cc.sequence(_,cc.callFunc(function(){d.getComponent("food").run=!0})))}if(c.default.instance.type==c.gameSceneType.deathMath){u="clock1";this.type>0&&(u="clock2");var g=h.default.instance.getPrefabs(u),m=cc.instantiate(g);m.getComponent("clock").run=!1,m.parent=this.node.parent,m.position=n;f=80;var y=cc.jumpBy(.5,cc.v2(r.G.randRange(-f,f),20),100,1);m.runAction(cc.sequence(y,cc.callFunc(function(){m.getComponent("clock").run=!0})))}},e.prototype.onCollisionEnter=function(t,e){var i=t.node;t.tag;("hero"==i.group&&"point"==i.name||"weapon"==i.group)&&this.hasCount>0&&(this.hasCount--,this.play(),0==this.hasCount?this.doDestroyAni():(u.MgpUtil.vibrateShort(),s.AudioMgr.instance.playAttHand0()),"weapon"==i.group&&a.default.instance.putNode(i))},o([f({type:Number})],e.prototype,"type",void 0),o([f(cc.SpriteFrame)],e.prototype,"leaveSpr",void 0),o([f({type:Number})],e.prototype,"coinNum",void 0),o([f({type:Number})],e.prototype,"boomTime",void 0),o([f({type:Number})],e.prototype,"foodPro",void 0),e=o([d],e)}(l.default);i.default=_,cc._RF.pop()},{"../../util/audio_mgr":"audio_mgr","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../scene/gameScene":"gameScene","../tools/nodePool_control":"nodePool_control","../tools/resource_control":"resource_control","./ItemInfo":"ItemInfo"}],box_0:[function(t,e,i){"use strict";cc._RF.push(e,"806e9TsR5VMy7I+1vZ9GNld","box_0");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./bottle"),a=t("../../util/audio_mgr"),s=t("../scene/gameScene"),h=cc._decorator,l=h.ccclass,c=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this.ani=this.node.getComponent(cc.Animation),this.originHeight=this.node.height},e.prototype.playMusic=function(){a.AudioMgr.instance.playBoxBoom()},e.prototype.doDestroyAni=function(){t.prototype.doDestroyAni.call(this),s.default.instance.map.removeMapNode(this.node.parent)},e=o([l],e)}(r.default));i.default=c,cc._RF.pop()},{"../../util/audio_mgr":"audio_mgr","../scene/gameScene":"gameScene","./bottle":"bottle"}],brick:[function(t,e,i){"use strict";cc._RF.push(e,"545b1LGxnJN7LI07imFV8IJ","brick");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./weapon"),a=cc._decorator,s=a.ccclass,h=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="brick",e.weaponType=r.WeaponType.brick,e.iconImage="p_brick",e}return n(e,t),e=o([s],e)}(r.default));i.default=h,cc._RF.pop()},{"./weapon":"weapon"}],buff_data:[function(t,e,i){"use strict";cc._RF.push(e,"1c20fwKUwFHSaAlvxko6vrR","buff_data"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../util/global_def"),o=t("../util/structure/hd_map"),r=function(){return function(){this.id=0,this.desc="",this.effect=0,this.incr=0,this.owner=0}}();i.BuffInfo=r;var a=function(){function t(){}return t.fetch=function(e){null==t.itemMap_&&(t.itemMap_=new o.default),t._parseData(e)},t.getDataById=function(e){return t.itemMap_.get(e)},t._parseData=function(e){if(!n.G.isEmptyObj(e))for(var i in e)if(e.hasOwnProperty(i)){var o=e[i],a=new r;a.id=parseInt(i),a.desc=o.desc,a.effect=o.effect,a.incr=o.incr,a.owner=o.owner,t.itemMap_.put(a.id,a)}},t.itemMap_=null,t}();i.BuffData=a,cc._RF.pop()},{"../util/global_def":"global_def","../util/structure/hd_map":"hd_map"}],bulletEnemy:[function(t,e,i){"use strict";cc._RF.push(e,"be87bSP64xFDJ3WT/EtaWlH","bulletEnemy");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./../weapon/weapon"),a=t("../hero"),s=t("../../tools/nodePool_control"),h=cc._decorator,l=h.ccclass,c=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=1,e}return n(e,t),e.prototype.fly=function(e){t.prototype.fly.call(this,e),this.node.scaleX=this.dir},e.prototype.mv=function(){this.node.x+=5*this.dir},e.prototype.onCollisionEnter=function(t,e){var i=t.node;if("point"!=i.name){var n=i.getComponent(a.heroAct);n.hurtDir=-this.dir,n.setState(a.actState.hurt,!1,-10),s.default.instance.putNode(this.node)}},e=o([l],e)}(r.default));i.default=c,cc._RF.pop()},{"../../tools/nodePool_control":"nodePool_control","../hero":"hero","./../weapon/weapon":"weapon"}],bullet:[function(t,e,i){"use strict";cc._RF.push(e,"bb9138SZvJDVq/uEuS/COkY","bullet");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./weapon"),a=cc._decorator,s=a.ccclass,h=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="bullet",e.type=1,e}return n(e,t),e.prototype.fly=function(e){t.prototype.fly.call(this,e),this.node.scaleX=this.dir},e.prototype.mv=function(){this.node.x+=15*this.dir},e=o([s],e)}(r.default));i.default=h,cc._RF.pop()},{"./weapon":"weapon"}],cg_gun:[function(t,e,i){"use strict";cc._RF.push(e,"69a23Pt9LRHtJF9fuEoMYFa","cg_gun");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../enemy"),a=t("../../scene/gameScene"),s=t("../../tools/resource_control"),h=t("../../../util/audio_mgr"),l=t("../../../util/global_def"),c=cc._decorator,u=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataName="enemy_act_1",e.aniName={aniMv:"chiqiangpao",aniIdle:"chiqiangdaiji",aniAttack:"chiqianggongji",aniHurtYiJi:"chiqiangyiji",aniHurtLianJi0:"chiqianglianji0",aniHurtLianJi1:"chiqianglianji1",aniHurtLianJi2:"chiqianglianji2",aniHurtLianJi3:"chiqianglianji3",aniHurtDaoDi0:"chiqiangdaodi_0",aniHurtDaoDi1:"chiqiangdaodi_1",aniHurtQinNa:"chiqiangbeiqinna_0",aniHurtQinNa1:"chiqiangbeiqinna_1",aniHurtQinNa2:"chiqiangbeiqinna_2",aniFeiChu:"chiqiangfeichu",aniJm:"chiqiangtiao",aniTiaoXin:"chiqiangtiaoxi",aniPaQi0:"chiqiangpaqi_0",ainPaQi1:"chiqiangpaqi_1"},e}return n(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.schedule(function(){e.checkAttack()},.3,cc.macro.REPEAT_FOREVER,.3)},e.prototype.checkAttack=function(){if(0==this.entity.gravity&&(this.state==r.eActState.left||this.state==r.eActState.right||this.state==r.eActState.idle)){var t=a.default.instance.hero,e=this.node.x-t.x,i=this.node.y+40-t.y;Math.abs(e)<150&&Math.abs(e)>50&&Math.abs(i)<40&&this.setState(r.eActState.attack)}},e.prototype.hitHero=function(){this.state!=r.eActState.elude||this.setState(r.eActState.idle)},e.prototype.doAttack=function(){var t=this;this.entity.lineVelocity.x=0,this.cleanPath(),this.playAni(this.aniName.aniIdle,-1),this.stateScheduleOnce(function(){t.playAni(t.aniName.aniAttack,1),t.point.setTartget(10,cc.v3(-100,40,0),cc.v3(0,40,0));var e=new cc.Node;e.addComponent(cc.Sprite).spriteFrame=s.default.instance.getSpriteFrame("fire1"),e.parent=t.node.parent,e.x=t.node.x+100*t.getDir(),e.y=t.node.y+40,e.scale=-1.5*t.getDir(),e.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){e.destroy()}))),h.AudioMgr.instance.playGun(),t.stateScheduleOnce(function(){t.setState(r.eActState.elude)},l.G.randRange(1,1.5))},.8)},e=o([u],e)}(r.enemyAct));i.default=p;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.entity.lineVelocity.x=0,this.playAni(this.aniName.aniTiaoXin,-1)},e.prototype.doAttack=function(){this.setState(r.eActState.idle)},e.prototype.checkSearchPath=function(){},e.prototype.checkPause=function(){},e}(p);i.stopAct=d,cc._RF.pop()},{"../../../util/audio_mgr":"audio_mgr","../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../../tools/resource_control":"resource_control","../enemy":"enemy"}],cg_stick:[function(t,e,i){"use strict";cc._RF.push(e,"8eaa2aQhYJO243zMBO9vnAP","cg_stick");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../enemy"),a=t("../../scene/gameScene"),s=t("../../../util/global_def"),h=cc._decorator,l=h.ccclass,c=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aniName={aniMv:"chigunpao",aniIdle:"chigundaiji",aniAttack:"chigungongji",aniHurtYiJi:"chigunyiji",aniHurtLianJi0:"chigunlianji0",aniHurtLianJi1:"chigunlianji1",aniHurtLianJi2:"chigunlianji2",aniHurtLianJi3:"chigunlianji3",aniHurtDaoDi0:"chigundaodi_0",aniHurtDaoDi1:"chigundaodi_1",aniHurtQinNa:"chigunbeiqinna_0",aniHurtQinNa1:"chigunbeiqinna_1",aniHurtQinNa2:"chigunbeiqinna_2",aniFeiChu:"chigunfeichu",aniJm:"chiguntiao",aniTiaoXin:"chiguntiaoxi",aniPaQi0:"chigunpaqi_0",ainPaQi1:"chigunpaqi_1"},e.patrolTime=0,e}return n(e,t),e.prototype.isCanSearchPath=function(){return!(this.state!=r.eActState.left&&this.state!=r.eActState.right&&this.state!=r.eActState.idle&&this.state!=r.eActState.patrol||s.G.Game.searchPathCount<=0||0!=this.entity.gravity||this.isDoCliff||this.playTime>0)},e.prototype.noFindPath=function(){this.patrolTime>0||(this.run=!1,Math.random()>.5||0!=this.hitInfo.x?this.setState(r.eActState.idle):this.setState(r.eActState.patrol))},e.prototype.doPatrol=function(){var t=this;if(this.state!=r.eActState.patrol){this.patrolTime=2;var e=function(){if(t.state!=r.eActState.patrol&&t.state!=r.eActState.idle)return t.unschedule(e),void(t.patrolTime=0);t.playAni(t.aniName.aniMv,-1),2==t.patrolTime?t.entity.node.scaleX=a.default.instance.hero.x>t.node.x?-t.originSc:t.originSc:t.entity.node.scaleX=-t.entity.node.scaleX,t.entity.lineVelocity.x=t.getDir()*t.speedMv,t.patrolTime--};this.schedule(e,2,this.patrolTime,0)}},e.prototype.doCliff=function(){var t=this;this.isDoCliff||this.state!=r.eActState.patrol&&this.state!=r.eActState.elude||(this.cleanPath(),this.entity.lineVelocity.x=-this.entity.lineVelocity.x/Math.abs(this.entity.lineVelocity.x)*this.speedMv,this.entity.lineVelocity.y=100,this.isDoCliff=!0,this.scheduleOnce(function(){t.setState(r.eActState.idle),t.isDoCliff=!1},.5))},e=o([l],e)}(r.enemyAct));i.default=c,cc._RF.pop()},{"../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../enemy":"enemy"}],checken:[function(t,e,i){"use strict";cc._RF.push(e,"7b8e5xE2G1EpoP3FYltBLE3","checken");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./food"),a=t("../../../../game_logic"),s=t("../../../../util/event_mgr"),h=cc._decorator,l=h.ccclass,c=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blood=50,e.ani=null,e}return n(e,t),e.prototype.onLoad=function(){this.ani=this.node.getComponent(cc.Animation),this.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(2),cc.rotateBy(.8,360))))},e.prototype.doDestroy=function(){var t=this;this.ani.play("checken"),this.scheduleOnce(function(){t.clear()},.5),this.node.runAction(cc.moveBy(.5,cc.v2(0,100))),a.default.instance.eventManager.addEvent(s.EventType.KCollectChicken,{num:1})},e=o([l],e)}(r.default));i.default=c,cc._RF.pop()},{"../../../../game_logic":"game_logic","../../../../util/event_mgr":"event_mgr","./food":"food"}],clock:[function(t,e,i){"use strict";cc._RF.push(e,"9c166zroc9L6auvLSE+wOkA","clock");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../ItemInfo"),a=t("../../../game_logic"),s=t("../../../util/event_mgr"),h=t("../../../util/global_def"),l=cc._decorator,c=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=0,e.time=1,e.run=!0,e.addImage=null,e.numImages=[],e}return n(e,t),e.prototype.onLoad=function(){this.time=[1,3,6][this.type]},e.prototype.onCollisionEnter=function(t,e){if(this.run){var i=t.node;if("hero"==i.group&&"point"!=i.name){a.default.instance.eventManager.addEvent(s.EventType.KAddTime,this,this.time);var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=this.addImage,n.position=this.node.position,n.parent=this.node.parent;var o=new cc.Node;o.addComponent(cc.Sprite).spriteFrame=this.numImages[this.type],o.position=this.node.position,o.x+=25,o.parent=this.node.parent;var r=h.G.randRange(-80,80),l=h.G.randRange(250,300),c=cc.sequence(cc.moveBy(2,r,l),cc.fadeOut(2),cc.callFunc(function(){n.destroy()})),u=cc.sequence(cc.moveBy(2,r,l),cc.fadeOut(2),cc.callFunc(function(){o.destroy()}));n.runAction(c),o.runAction(u),this.clear()}}},o([u({type:Number})],e.prototype,"type",void 0),o([u(cc.SpriteFrame)],e.prototype,"addImage",void 0),o([u([cc.SpriteFrame])],e.prototype,"numImages",void 0),e=o([c],e)}(r.default);i.default=p,cc._RF.pop()},{"../../../game_logic":"game_logic","../../../util/event_mgr":"event_mgr","../../../util/global_def":"global_def","../ItemInfo":"ItemInfo"}],cloud:[function(t,e,i){"use strict";cc._RF.push(e,"e41779iSx9G2YCUT8VCHfpx","cloud");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./ItemInfo"),a=cc._decorator,s=a.ccclass,h=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.persistent=!1,e.cloudShow=null,e.cloudHide=null,e.content=null,e.image=null,e.time=2,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.content=this.node.getChildByName("content"),this.image=this.node.getChildByName("image");var e=0;this.schedule(function(){e%2==0?t.hide():t.show(),e++},this.time,cc.macro.REPEAT_FOREVER,this.time)},e.prototype.hide=function(){var t=this,e=cc.scaleTo(.1,1.1),i=cc.scaleTo(.1,.9),n=cc.scaleTo(.1,1.1),o=cc.scaleTo(.2,.3);this.image.runAction(cc.sequence(e,i,n,o,cc.callFunc(function(){t.image.runAction(cc.scaleTo(.3,0)),t.content.active=!1;var e=cc.instantiate(t.cloudHide);e.getComponent("animation").reuse(1),e.parent=t.node.parent,e.position=t.node.position})))},e.prototype.show=function(){this.content.active=!0;var t=cc.scaleTo(.2,1.2),e=cc.scaleTo(.1,1);this.image.runAction(cc.sequence(cc.delayTime(.1),t,e));var i=cc.instantiate(this.cloudShow);i.getComponent("animation").reuse(1),i.parent=this.node.parent,i.position=this.node.position},o([h(cc.Prefab)],e.prototype,"cloudShow",void 0),o([h(cc.Prefab)],e.prototype,"cloudHide",void 0),e=o([s],e)}(r.default);i.default=l,cc._RF.pop()},{"./ItemInfo":"ItemInfo"}],coin:[function(t,e,i){"use strict";cc._RF.push(e,"4e4b7UOnFZKdLGJ1Z0RHnL7","coin");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../tools/resource_control"),a=t("../../util/audio_mgr"),s=t("../tools/wordFactory"),h=t("../scene/uiControl"),l=t("../../game_logic"),c=t("../../util/event_mgr"),u=t("./ItemInfo"),p=t("../scene/gameScene"),d=t("../tools/nodePool_control"),f=cc._decorator,_=f.ccclass,g=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.num=2,e.hasColl=!1,e.run=!0,e.type=0,e}return n(e,t),e.prototype.cutDown=function(){var t=this;this.unscheduleAllCallbacks(),this.node.stopAllActions(),this.scheduleOnce(function(){t.node.runAction(cc.sequence(cc.fadeTo(.2,100),cc.fadeTo(.2,255),cc.fadeTo(.2,100),cc.fadeTo(.2,255),cc.fadeTo(.2,100),cc.fadeTo(.2,255),cc.callFunc(function(){d.default.instance.putNode(t.node)})))},5)},e.prototype.onCollisionEnter=function(t,e){var i=this;if(this.run&&("hero"==t.node.group&&0==this.hasColl)){this.hasColl=!0;var n=cc.jumpBy(.25,cc.v2(0,50),50,1);a.AudioMgr.instance.playCoin(),this.scheduleOnce(function(){var t=r.default.instance.getPrefabs("coinEffect"),e=cc.instantiate(t);e.position=i.node.position,e.y-=10,e.parent=i.node.parent;var n=cc.v3(i.node.x,i.node.y-60,0),o="$"+String(i.num);s.default.instance.play(s.wordType.flutter,o,n,i.node.parent),h.default.instance.addCoin(i.num),l.default.instance.eventManager.addEvent(c.EventType.KCollectCoin,{num:i.num})},.15),this.node.runAction(cc.sequence(n,cc.callFunc(function(){0==i.type?(i.hasColl=!1,i.node.destroy(),p.default.instance.map.removeMapNode(i.node.parent)):(i.hasColl=!1,d.default.instance.putNode(i.node))})))}},o([g({type:Number})],e.prototype,"num",void 0),e=o([_],e)}(u.default);i.default=m,cc._RF.pop()},{"../../game_logic":"game_logic","../../util/audio_mgr":"audio_mgr","../../util/event_mgr":"event_mgr","../scene/gameScene":"gameScene","../scene/uiControl":"uiControl","../tools/nodePool_control":"nodePool_control","../tools/resource_control":"resource_control","../tools/wordFactory":"wordFactory","./ItemInfo":"ItemInfo"}],collItem:[function(t,e,i){"use strict";cc._RF.push(e,"31395oJ62tHsLvy+WlBtlNA","collItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./lifeBase"),a=cc._decorator,s=a.ccclass,h=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.items={},e}return n(e,t),e.prototype.onLoad=function(){this.node.group="lifeBase"},e.prototype.onCollisionEnter=function(t,e){var i=t.node;this.items[i.uuid]=i;var n=i.getComponent(r.default);if(n&&!n.noCollItem){var o=t.world.aabb,a=e.world.aabb,s=cc.rect(o.x,o.y,o.width,o.height),h=cc.rect(a.x,a.y,a.width,a.height),l=s.intersection(new cc.Rect,h),c=a.yMax-o.yMin;if(c<16&&c>=0&&n.lineVelocity.y<0){n.inCollItem=this.node,i.y+=l.height,n.setLineVelocity(cc.v2(n.lineVelocity.x,0)),n.gravity=0,n.checkHit=!1,n.dealBottom();var u=i.getComponent(cc.BoxCollider);"hero"==i.group&&(u.size=cc.size(i.getComponent(r.default).Rect.width,i.getComponent(r.default).Rect.height)),n.collEnter()}}},e.prototype.onCollisionExit=function(t,e){var i=t.node;delete this.items[i.uuid];var n=i.getComponent(r.default);n&&!n.noCollItem&&(n.gravity=n.originGy,n.checkHit=!0,n.inCollItem=null,n.collExit(),this.scheduleOnce(function(){n.origSize&&"hero"==i.group&&(i.getComponent(cc.BoxCollider).size=n.origSize)},.15))},e=o([s],e)}(cc.Component));i.default=h,cc._RF.pop()},{"./lifeBase":"lifeBase"}],darts:[function(t,e,i){"use strict";cc._RF.push(e,"8b918CfRYVLU43J5MwYztKS","darts");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./weapon"),a=cc._decorator,s=a.ccclass,h=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="darts",e.weaponType=r.WeaponType.darts,e.iconImage="p_darts",e}return n(e,t),e=o([s],e)}(r.default));i.default=h,cc._RF.pop()},{"./weapon":"weapon"}],data_control:[function(t,e,i){"use strict";cc._RF.push(e,"f2b8cLt9StLj608OUFMEn42","data_control");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var i;return n(e,t),i=e,e.prototype.onLoad=function(){cc.game.addPersistRootNode(this.node),i.hasInit||(i.hasInit=!0,console.log("\u521d\u59cbjson\u6570\u636e"),i.instance=this)},e.prototype.getMap0Data=function(){},e.instance=null,e.hasInit=!1,e=i=o([a],e)}(cc.Component));i.default=s,cc._RF.pop()},{}],data_hub:[function(t,e,i){"use strict";cc._RF.push(e,"0fba8pPIztJvpHFywCQ0fNU","data_hub"),Object.defineProperty(i,"__esModule",{value:!0}),i.DataHub=void 0;var n=t("../util/global_def"),o=t("./bonus_data"),r=function(){function t(){}return Object.defineProperty(t,"getMessage",{get:function(){return this.message.sh[n.G.randRange(0,this.message.sh.length-1)]},enumerable:!1,configurable:!0}),t.loadBackendConfig=function(t){var e=this;if(n.G.isTMSDK){var i=wx.getLaunchOptionsSync().scene;console.log("\u5929\u5e55 is actived",t),wx.tmSDK.getJudgeConfig().then(function(n){var o=!1,r=!1,a=!1;for(var s in n){var h=n[s];"chkOff"==h.key?o=1!=h.status:"adChkOff"==h.key?r=1!=h.status:"mpChkOff"==h.key&&(a=1!=h.status)}console.log("version cfg",o,r,a),wx.tmSDK.getAppJSONConfig().then(function(n){var s=n.gameCfg;console.log("\u5929\u5e55\u5f00\u5173\u6570\u636e",n,s.VideoExportShare),e.config.chk=o?1:0,e.config.adChk=r?1:0,e.config.export=a?2:parseInt(s.export),e.config.bnrGap=parseInt(s.bnrGap),e.config.bnrRefresh=parseInt(s.bnrRefresh),e.config.videoBonus=parseInt(s.videoBonus),e.config.bnrJumpProb=parseInt(s.bnrJumpProb),e.config.bnrClickCD=parseInt(s.bnrClickCD),e.config.bnrClickSucTime=parseInt(s.bnrClickSucTime),e.config.bnrClickCnt=parseInt(s.bnrClickCnt),e.config.forceNavProb=parseInt(s.forceNavProb),e.config.forceVideoNum=parseInt(s.forceVideoNum),e.config.VideoExportShare=s.VideoExportShare,1===e.config.chk&&(e.config.v2sh=0,e.config.adChk=1),1===e.config.adChk&&(e.config.bnrGap=40,e.config.bnrJumpProb=0,e.config.videoBonus=0,e.config.fakeBnrShow=1),console.log("Game Config",e.config);var h=e._calIpBlockType(n.blockArea,t,i);console.log("\u5c4f\u853d\u8fd4\u56de\u503c",h),e.blockType=h,h>0?(2!==h&&(e.config.v2sh=0,e.config.sh2v=0,1!==e.config.chk&&e.config.bnrGap<20&&(e.config.bnrGap=20),e.config.videoBonus=0,e.config.bnrJumpProb=0,e.config.fakeBtnClick=0,e.config.forceVideoNum=0),e.config.forceNavProb=0,2===e.config.export&&(1!==h?(e.config.export=0,e.config.forceFakePageProb=0):e.config.export=1)):e.config.fakeBnrShow=1,console.log("ipBlock",h)})})}},t.loadJson=function(){var t=this;n.G.readJson("data/bonus_dat",function(e){o.BonusData.fetch(e),t.bJsonLoaded=!0})},t._calIpBlockType=function(t,e,i){console.log("\u573a\u666f\u503c\u5c4f\u853d",t,e,i);var n=t.norm.scene;for(var o in n)if(i==n[o])return 3;var r=0;if(t){var a=function(i){var n=!1;if(i)for(var o=0;o<i.length;++o)if(-1!==e.indexOf(i[o])){n=!0,console.log("\u573a\u666f\u8fd4\u56de\u6210\u529f",t,i);break}return n};if(t.norm){var s=!1;(s=a(t.norm.city))||(s=a(t.norm.province)),s&&(r=1)}if(t.mp){s=!1;(s=a(t.mp.city))||(s=a(t.mp.province)),s&&(r=3)}}return r},t.version=window.g_gameVersion||"1.0.0",t.blockType=0,t.config={export:1,sh2v:0,chk:0,adChk:0,bnrGap:15,bnrRefresh:2,videoBonus:100,bnrJumpProb:100,bnrClickCD:10,bnrClickSucTime:30,bnrClickCnt:4,forceNavProb:0,forceVideoNum:0,VideoExportShare:[50,50,0],fakeBnrShow:1,fakeBtnClick:100,forceFakePageProb:50,directAward:0,v2sh:1,exportPageTypeProb:100},t.message={sh:[{title:"\u5206\u4eab\u6807\u9898\uff0c\u8bf7\u81ea\u884c\u4fee\u6539",img:"https://huandong-1257458597.cos.ap-guangzhou.myqcloud.com/Shared/test/sh1.png"}]},t.bJsonLoaded=!1,t}();i.DataHub=r,cc._RF.pop()},{"../util/global_def":"global_def","./bonus_data":"bonus_data"}],deathMath:[function(t,e,i){"use strict";cc._RF.push(e,"548880lUDtMWbfC7/ppUGvu","deathMath");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./scenControl"),a=t("../../../game_ui/game/ResultPnl"),s=t("../../tools/wordFactory"),h=t("../../scene/gameScene"),l=t("../lifeBase"),c=t("../hero"),u=t("../../scene/uiControl"),p=t("../../../game_logic"),d=t("../../../util/event_mgr"),f=t("../../tools/resource_control"),_=t("../../../util/global_def"),g=cc._decorator,m=g.ccclass,y=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.totalTime=0,e.time=0,e.hero=null,e.tipLab=null,e.data=null,e}var i;return n(e,t),i=e,e.prototype.setInfo=function(t){var e=this;this.data=t,this.totalIndex=t.index,this.time=t.time,this.totalTime=t.time,this.hero=h.default.instance.hero;var i=new cc.Node;i.x=25,i.y=300,this.tipLab=i.addComponent(cc.Label),this.tipLab.string=String(this.time),i.parent=this.node;var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=f.default.instance.getSpriteFrame("clock"),n.parent=this.node,n.x=-25,n.y=300,this.doStart("\u6bd4\u8cfd\u5f00\u59cb!"),this.schedule(function(){e.time--,e.tipLab.string=String(e.time),0==e.time&&(e.unscheduleAllCallbacks(),e.doOver("\u6bd4\u8d5b\u5931\u8d25!"),e.scheduleOnce(function(){e.showEnd(!1,0)},1))},1,cc.macro.REPEAT_FOREVER,1);var o=p.default.instance.eventManager.addListener(d.EventType.KAddTime,function(t,i){var n=Number(i);e.addTime(n)});h.default.instance.listenerManager.push({key:d.EventType.KAddTime,id:o})},e.prototype.addList=function(){var t=this;p.default.instance.eventManager.addListener(d.EventType.KActiveEnemySucc,function(e){var i=Number(e.num);if(t.count+=i,e.act){var n=e.act;n.createClock=function(t){for(var e=function(e){var i=f.default.instance.getPrefabs("clock0"),o=cc.instantiate(i);o.getComponent("clock").run=!1,o.parent=n.node.parent,o.position=t;var r=cc.jumpBy(.5,cc.v2(_.G.randRange(-80,80),20),100,1);o.runAction(cc.sequence(r,cc.callFunc(function(){o.getComponent("clock").run=!0})))},i=0;i<1;++i)e()}}})},e.prototype.addTime=function(t){this.time+=t,this.tipLab.string=String(this.time)},e.prototype.success=function(){var t=this;this.doOver("\u606d\u559c\u901a\u5173!"),this.scheduleOnce(function(){var e=t.time;t.showEnd(!0,e)},1)},e.prototype.doOver=function(t){var e=t||"Go!",i=cc.v3(-45*e.length/2,200,0);s.default.instance.showDes(e,i,h.default.instance.node)},e.prototype.showEnd=function(t,e){this.unscheduleAllCallbacks();var n=this.hero.getComponent(l.default),o=this.hero.getComponent(c.heroAct);n.isDie=!0,n.ani.animationName!=o.aniName.aniDie&&n.ani.playAnimation(o.aniName.aniIdle,-1);var r=u.default.instance.curCoin,s=100-n.blood,h="c",p=r/40*.3;p>.3&&(p=.3);var d=.3*this.time/(.5*this.totalTime);d>.3&&(d=.3);var f=p+d+n.blood/100*.4,_=0,g=this.data.numb;f>.9?(h="S",_=g*this.data.s+r):f>.6?(h="A",_=g*this.data.a+r):f>.3?(h="B",_=g*this.data.b+r):(h="C",_=g*this.data.c+r),_=Math.floor(_);var m=Math.floor(1e4*f);a.default.instance.show(a.ResultPageName.deathMatch,{lv:h,coin:r,time:e,damage:s,grade:m,award:_,suc:t},function(){u.default.instance.toHome(!1)}),this.node.removeComponent(i)},e=i=o([m],e)}(r.default));i.default=y,cc._RF.pop()},{"../../../game_logic":"game_logic","../../../game_ui/game/ResultPnl":"ResultPnl","../../../util/event_mgr":"event_mgr","../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../../scene/uiControl":"uiControl","../../tools/resource_control":"resource_control","../../tools/wordFactory":"wordFactory","../hero":"hero","../lifeBase":"lifeBase","./scenControl":"scenControl"}],dialog_ui:[function(t,e,i){"use strict";cc._RF.push(e,"82e3b/7ktlMx78PcmFK65BN","dialog_ui");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=t("./base_ui"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleLbl_=null,e.contentLbl_=null,e.confirmBtn_=null,e.closeBtn_=null,e.showTrans_=null,e.closeTrans_=null,e.yesCallback_=null,e.noCallback_=null,e}return n(e,t),e.prototype.init=function(t){t&&(this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),this.titleLbl_=t.getChild("titleLbl").asTextField,this.contentLbl_=t.getChild("contentLbl").asTextField,this.confirmBtn_=t.getChild("confirmBtn").asButton,this.closeBtn_=t.getChild("closeBtn").asButton,this.showTrans_=t.getTransition("showTrans"),this.closeTrans_=t.getTransition("closeTrans"),t.sortingOrder=o.UIHierarchy.kDialog,t.visible=!1,o.BaseUI.root.addChild(t))},e.prototype.show=function(t,e,i,n,o){var r=this;void 0===o&&(o=!1),this.com_&&(this.com_.visible=!0,this.titleLbl_.text=t,this.contentLbl_.text=e,this.bLock_=!0,this.showTrans_.play(function(){r.bLock_=!1}),this.confirmBtn_.onClick(this._onConfirm,this),this.closeBtn_.onClick(this._onClose,this),this.yesCallback_=i,this.noCallback_=n,this.closeBtn_.visible=!o)},e.prototype.reset=function(){this.com_&&(this.bLock_=!1,this.com_.visible=!1,this.confirmBtn_.offClick(this._onConfirm,this),this.closeBtn_.offClick(this._onClose,this),this.com_.sortingOrder!=o.UIHierarchy.kDialog&&this.renderSortOriginal())},e.prototype.renderSortTop=function(){this.com_&&(this.com_.sortingOrder=o.UIHierarchy.kTip)},e.prototype.renderSortOriginal=function(){this.com_&&(this.com_.sortingOrder=o.UIHierarchy.kDialog)},e.prototype._onConfirm=function(){this.bLock_||(this.yesCallback_&&this.yesCallback_(),this.bLock_=!0,this.closeTrans_.play(this.reset.bind(this)))},e.prototype._onClose=function(){this.bLock_||(this.noCallback_&&this.noCallback_(),this.bLock_=!0,this.closeTrans_.play(this.reset.bind(this)))},e.instance=new e,e}(o.BaseUI);i.DialogUI=r,i.DialogUIInst=r.instance,cc._RF.pop()},{"./base_ui":"base_ui"}],enemyPoint:[function(t,e,i){"use strict";cc._RF.push(e,"85249NZhh9OjLYgtGt2y+Xr","enemyPoint");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./hero"),a=t("./enemy"),s=cc._decorator,h=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.power=0,e.target=cc.v3(0,0,0),e.easing=.3,e}return n(e,t),e.prototype.onCollisionEnter=function(t,e){if("point"!=t.node.name){var i=t.node.getComponent(r.heroAct),n=this.node.parent.getComponent(a.enemyAct);n.pointHitHero=!0,i.hurtDir=-n.getDir(),i.setState(r.actState.hurt)}},e.prototype.setTartget=function(t,e,i){void 0===i&&(i=cc.v3(20,40,0)),this.node.position=i,this.node.active=!0,this.target=e,this.power=t},e.prototype.update=function(){var t=this.target.sub(this.node.position);if(t.mag()<1)return this.node.position=this.target,void(this.node.active=!1);var e=t.mul(this.easing);this.node.position=this.node.position.add(e)},e=o([h],e)}(cc.Component));i.default=l,cc._RF.pop()},{"./enemy":"enemy","./hero":"hero"}],enemy:[function(t,e,i){"use strict";cc._RF.push(e,"0b6f6PjnYlDRr9zZc7pe/T7","enemy");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.plotAct=i.enemyAct=i.eAniName=i.eActState=void 0;var r,a=t("./lifeBase"),s=t("./findPath"),h=t("../scene/gameScene"),l=t("./hero"),c=t("../../util/global_def"),u=t("../../util/audio_mgr"),p=t("../../util/effect/shaker"),d=t("../tools/resource_control"),f=t("../tools/nodePool_control"),_=t("./enemyPoint"),g=t("../../game_logic"),m=t("../../util/event_mgr"),y=t("../../util/mgp_util"),v=cc._decorator,b=v.ccclass,C=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hid=null,e.act=null,e.Rect=new cc.Rect(0,0,40,110),e.blood=100,e}return n(e,t),e.prototype.onLoad=function(){if(t.prototype.onLoad.call(this),c.G.Game.GameLevel>=1e3){var e=[80,100,150,200];this.blood=e[c.G.Game.GameLevel-1e3],this.bloodLimit=e[c.G.Game.GameLevel-1e3]}else this.blood=80+20*c.G.Game.GameLevel,this.bloodLimit=80+20*c.G.Game.GameLevel},e.prototype.dealStop=function(e){t.prototype.dealStop.call(this,e),this.act.doStop(e)},e.prototype.init=function(t,e,i,n){if(void 0===e&&(e=!0),void 0===i&&(i=1),void 0===n&&(n=!1),e)switch(t){case"cg_stick":this.act=this.node.addComponent("cg_stick");break;case"cg_gun":this.act=this.node.addComponent("cg_gun");break;case"jc_stick":this.act=this.node.addComponent("jc_stick"),this.ani.dragonAsset=d.default.instance.getDragonBonesAsset("enemy2_ske"),this.ani.dragonAtlasAsset=d.default.instance.getDragonBonesAtlasAsset("enemy2_tex");break;case"jc_gun":this.act=this.node.addComponent("jc_gun"),this.ani.dragonAsset=d.default.instance.getDragonBonesAsset("enemy1_ske"),this.ani.dragonAtlasAsset=d.default.instance.getDragonBonesAtlasAsset("enemy1_tex");break;case"boss0":this.act=this.node.getComponent("boss0");break;case"boss1":this.act=this.node.getComponent("boss1")}n&&(this.node.removeComponent(this.act),this.act=this.node.addComponent(x)),this.act.originSc=i*this.act.originSc,this.act.setScalex()},e.prototype.dealBottom=function(){this.act.down(),this.act.jumping=!1,this.act.fall()},e.prototype.dealBorder=function(t){this.act.state==r.fall&&(this.lineVelocity.x*t>0?this.lineVelocity.x=-this.lineVelocity.x/100:this.node.y+=50)},e.prototype.addBloodAni=function(t){this.act.doBloodAni(t)},e.prototype.dealCliff=function(){this.act.doCliff()},e.prototype.die=function(t){this.act.doDie(t),"cg_stick"==this.act.type?g.default.instance.eventManager.addEvent(m.EventType.kBeatStickEnemy,{num:1}):"jc_gun"==this.act.type?g.default.instance.eventManager.addEvent(m.EventType.kBeatGunEnemy,{num:1}):"jc_stick"==this.act.type&&g.default.instance.eventManager.addEvent(m.EventType.kBeatShieldenemy,{num:1}),"bullet"==t?g.default.instance.eventManager.addEvent(m.EventType.KUseGunBeatEnemy,{num:1}):"darts"==t?g.default.instance.eventManager.addEvent(m.EventType.KUseDartsBeatEnemy,{num:1}):"knife"==t?g.default.instance.eventManager.addEvent(m.EventType.KUseKnifeBeatEnemy,{num:1}):"brick"==t&&g.default.instance.eventManager.addEvent(m.EventType.KUseBrickBeatEnemy,{num:1}),g.default.instance.eventManager.addEvent(m.EventType.KBeatEnemy,{num:1}),g.default.instance.eventManager.addEvent(m.EventType.KActiveEnemySucc,{num:-1})},e.prototype.update=function(e){t.prototype.update.call(this,e),this.act&&this.act.gotoHero()},e=o([b],e)}(a.default));i.default=C,function(t){t[t.left=-1]="left",t[t.right=1]="right",t[t.attack=2]="attack",t[t.elude=3]="elude",t[t.idle=4]="idle",t[t.defense=5]="defense",t[t.patrol=6]="patrol",t[t.hurt=7]="hurt",t[t.qinNa=8]="qinNa",t[t.hurtLianJi0=9]="hurtLianJi0",t[t.hurtLianJi1=10]="hurtLianJi1",t[t.hurtLianJi2=11]="hurtLianJi2",t[t.hurtLianJi3=12]="hurtLianJi3",t[t.hurtQinNa0_0=13]="hurtQinNa0_0",t[t.hurtQinNa1_0=14]="hurtQinNa1_0",t[t.hurtQinNa1_1=15]="hurtQinNa1_1",t[t.hurtQinNa1_2=16]="hurtQinNa1_2",t[t.hurtQinNa1_3=17]="hurtQinNa1_3",t[t.hurtXuLi1=18]="hurtXuLi1",t[t.hurtXuli2=19]="hurtXuli2",t[t.hurtYiJi=20]="hurtYiJi",t[t.hurtXiaTi=21]="hurtXiaTi",t[t.hurtShangTi=22]="hurtShangTi",t[t.hurtImpact=23]="hurtImpact",t[t.hurtSL=24]="hurtSL",t[t.hurtPedal=25]="hurtPedal",t[t.hurtJiFei=26]="hurtJiFei",t[t.hurtUppercut=27]="hurtUppercut",t[t.fall=28]="fall",t[t.Ext=29]="Ext"}(r=i.eActState||(i.eActState={}));var S=function(){return function(){this.aniMv="",this.aniJm="",this.aniIdle="",this.aniAttack="",this.aniHurtYiJi="",this.aniHurtLianJi0="",this.aniHurtLianJi1="",this.aniHurtLianJi2="",this.aniHurtLianJi3="",this.aniHurtDaoDi0="",this.aniHurtDaoDi1="",this.aniHurtQinNa="",this.aniHurtQinNa1="",this.aniHurtQinNa2="",this.aniFeiChu="",this.aniTiaoXin="",this.aniPaQi0="",this.ainPaQi1="",this.aniFangYu=""}}();i.eAniName=S;var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.entity=null,e.type="",e.speedMv=200,e.speedJm=900,e.hero=null,e.state=null,e.dir=null,e.aniName=new S,e.originSc=.9,e.playTime=-1,e.stopTime=0,e.effect=0,e.data=0,e.dataName="enemy_act_0",e.point=null,e.pointHitHero=!1,e.isCanQn=!0,e.isBoss=!1,e.path=null,e.maxJ=4,e.jumping=!1,e.isBeiShua=!1,e.hurtDir=null,e.createClock=null,e.checkXing=!1,e.targetPos=[],e.target=null,e.run=!1,e.toTarget=!1,e.mvDir=0,e.isDoCliff=!1,e.TiaoXinCount=2,e.hitInfo=cc.rect(0,0,0,0),e}return n(e,t),e.prototype.stateScheduleOnce=function(t,e){var i=this,n=this.state;this.scheduleOnce(function(){if(i.state==n)t();else{if(n==r.fall);}},e)},e.prototype.stateSchedule=function(t,e,i,n){var o=this,r=this.state;this.schedule(function(){o.state==r?t():o.unschedule(t)},e,i,n)},e.prototype.pause=function(t){h.default.instance.enemyManager.push({node:this.node,parent:this.node.parent,pos:t}),this.node.parent=null},e.prototype.setScalex=function(){this.node.scaleX=this.originSc},e.prototype.doBloodAni=function(t){},e.prototype.onLoad=function(){this.data=d.default.instance.getJsonAsset(this.dataName),this.entity=this.node.getComponent(C),this.entity.setLineVelocity(cc.v2(this.speedMv,0)),this.path=this.node.getComponent(s.default),this.path.setMaxJ(this.maxJ),this.setState(r.idle),this.recoverRect(),this.setMat("glowColor",cc.color(255,0,0)),this.point=this.node.getChildByName("point").getComponent(_.default),this.checkSearchPath(),this.checkPause()},e.prototype.checkSearchPath=function(){var t=this;this.schedule(function(){t.searchPath()},.8,cc.macro.REPEAT_FOREVER,1)},e.prototype.checkPause=function(){var t=this;this.schedule(function(){var e=-c.G.viewX/2-h.default.instance.levelX,i=c.G.viewX/2+h.default.instance.levelX,n=t.node.convertToWorldSpaceAR(cc.v2(0,0)),o=h.default.instance.mapCamera.convertToNodeSpaceAR(n);(o.x<e||o.x>i)&&t.pause(n)},.1,cc.macro.REPEAT_FOREVER,1)},e.prototype.isCanSearchPath=function(){return!(this.state!=r.left&&this.state!=r.right&&this.state!=r.idle||c.G.Game.searchPathCount<=0||0!=this.entity.gravity||this.playTime>0)},e.prototype.searchPath=function(){if(this.isCanSearchPath()){var t=h.default.instance.hero.getComponent(l.heroAct);if(this.entity.inCollItem){if(this.entity.inCollItem==t.entity.inCollItem){for(var e=Math.floor((t.node.x-this.node.x)/3),i=1;i<4;++i){var n={pos:cc.v2(this.node.x+e,this.node.y)};this.targetPos=[n]}return this.target=null,void(this.run=!0)}this.noFindPath()}else t.jumping||t.entity.isDie||this.jumping||(c.G.Game.searchPathCount--,this.targetPos=this.getPath(t.node.x,t.node.y),c.G.Game.searchPathCount++,0!=this.targetPos.length?(this.target=null,this.run=!0):this.noFindPath())}},e.prototype.getPath=function(t,e){var i=t+window.flagPoint.x,n=e+window.flagPoint.y;return this.path.search(cc.v2(i,n))},e.prototype.noFindPath=function(){this.run=!1,this.setState(r.idle)},e.prototype.playAni=function(t,e){return t==this.entity.ani.animationName&&-1==this.entity.ani.playTimes||(this.entity.ani.playAnimation(t,e),!0)},e.prototype.jump=function(t,e,i){void 0===i&&(i=!1),0!=this.entity.gravity&&0==i||(this.playAni(this.aniName.aniJm,1),this.jumping=!0,this.entity.lineVelocity.x=null!=t?t:this.speedMv,this.entity.lineVelocity.y=null!=e?e:this.speedJm,this.entity.gravity=this.entity.originGy,this.node.y+=1)},e.prototype.down=function(){this.jumping&&this.recover()},e.prototype.setMat=function(t,e){this.entity.ani.getMaterial(0).setProperty(t,e)},e.prototype.pickUp=function(t){var e=this,i=this.aniName.aniPaQi0;1==t&&(i=this.aniName.ainPaQi1,this.isBeiShua=!1),this.cleanPath(),this.playAni(i,1),this.recoverRect(),this.stateScheduleOnce(function(){if(e.setState(r.idle,!0),0!=e.hitInfo.x){var t=h.default.instance.hero.getComponent(l.heroAct),i=t.node.x-e.node.x;Math.abs(i)>40&&e.isCanHurt()&&null==t.qNEnemy&&t.checkQnReason(e.node)}},.4)},e.prototype.doDie=function(t){var e=this;if("water"!=t){if(this.getComponent(cc.BoxCollider).enabled=!1,this.state!=r.fall){this.entity.ani.playAnimation(this.aniName.aniFeiChu,1),this.setRectbyTime();this.hurtDir||this.mvDir;this.entity.setLineVelocity(cc.v2(this.mvDir*c.G.randRange(c.G.randRange(450,500),350),500)),this.entity.startUpdate()}}else this.entity.ani.animationName!=this.aniName.aniFeiChu&&(this.entity.lineVelocity.y=200,this.entity.lineVelocity.x=0,this.entity.ani.playAnimation(this.aniName.aniFeiChu,1),this.enabled=!1,this.node.runAction(cc.sequence(cc.fadeOut(3),cc.callFunc(function(){e.node.destroy()}))))},e.prototype.createCoin=function(t){for(var e=c.G.randRange(1,2),i=function(i){var o="coin_"+c.G.randRange(0,2),r=f.default.instance.getNode(o);r.getComponent("coin").type=1,r.getComponent("coin").cutDown(),r.parent=n.node.parent,r.position=t,r.getComponent("coin").run=!1;var a=80*e/3,s=cc.jumpBy(.5,cc.v2(c.G.randRange(-a,a),20),100,1);r.runAction(cc.sequence(s,cc.callFunc(function(){r.getComponent("coin").run=!0})))},n=this,o=0;o<e;++o)i();this.createClock&&this.createClock(t)},e.prototype.fall=function(){var t=this;if(!(this.playTime<0)&&this.state==r.fall){this.playTime=-1,this.entity.lineVelocity.x=this.entity.lineVelocity.x/1.5,this.entity.lineVelocity.y=180,this.stateScheduleOnce(function(){t.entity.lineVelocity.x=0;t.entity.act.state;t.isBeiShua?(t.playAni(t.aniName.aniHurtDaoDi1,1),t.entity.isDie?(t.createCoin(t.node.position),t.node.runAction(cc.sequence(cc.fadeOut(1),cc.callFunc(function(){t.node.destroy()})))):t.stateScheduleOnce(function(){t.pickUp(1)},.5)):(t.playAni(t.aniName.aniHurtDaoDi0,1),t.entity.isDie?(t.createCoin(t.node.position),t.node.runAction(cc.sequence(cc.fadeOut(1),cc.callFunc(function(){t.node.destroy()})))):t.stateScheduleOnce(function(){t.pickUp(0)},.5))},.2),this.entity.act.state!=r.hurtXiaTi&&h.default.instance.startShake();var e=f.default.instance.getNode("enemyFall");e.getComponent("animation").reuse(),e.parent=this.node.parent,e.x=this.node.x,e.y=this.node.y-this.entity.Rect.height/2}},e.prototype.getTarget=function(){var t=this.targetPos.pop();this.target={x:0,y:0,id:0,j:0},this.target.x=t.pos.x,this.target.y=t.pos.y,this.target.id=t.id,this.target.j=t.j,this.target.o=t.ofx,this.target.dir=t.d},e.prototype.cleanPath=function(){this.run=!1,this.target=null,this.targetPos=[]},e.prototype.gotoHero=function(){if(this.run&&null!=this.targetPos){if(this.checkXing=!1,null==this.target){if(0==this.targetPos.length)return void(this.run=!1);this.getTarget(),this.toTarget=!1}var t=cc.v2(this.node.x,this.node.y-this.entity.Rect.height*this.node.anchorY),e=cc.v2(this.target.x,this.target.y).sub(t);if(Math.abs(e.x)<10&&0!=this.entity.gravity&&(this.entity.lineVelocity.x=0),e.mag()<=10&&0==this.entity.gravity&&(this.target=null,0==this.targetPos.length||Math.random()>.8&&0==this.entity.gravity))this.setState(r.idle);else if(!this.toTarget){var i=0;e.x>0?(i=1,this.node.scaleX>0&&(this.node.scaleX=-this.originSc)):e.x<0&&(i=-1,this.node.scaleX<0&&(this.node.scaleX=this.originSc)),e.y>=5?(this.jump(),this.entity.lineVelocity.x=this.speedMv*i):Math.abs(e.x)>2*c.G.Game.pw-this.entity.Rect.width/2?(this.jump(),Math.abs(e.x)>200?this.entity.lineVelocity.x=270*i:this.entity.lineVelocity.x=this.speedMv*i):e.x>0?this.setState(r.right,!0):e.x<0&&this.setState(r.left,!0),this.toTarget=!0}}},e.prototype.recover=function(){this.isStateProtect()||(this.entity.startUpdate(),0!=this.hitInfo.x?this.setState(r.attack):0==this.dir?this.setState(r.idle):1==this.dir?this.setState(r.right,!0):-1==this.dir&&this.setState(r.left,!0))},e.prototype.setRectbyTime=function(t){void 0===t&&(t=!0),this.playTime=1e4,this.cleanPath(),this.entity.startUpdate(),this.setState(r.fall),t&&(this.entity.Rect=new cc.Rect(0,0,100,40)),this.entity.ani.node.y=20},e.prototype.recoverRect=function(){this.entity.Rect=new cc.Rect(0,0,40,100),this.entity.ani.node.y=40},e.prototype.setMvDir=function(){this.mvDir=h.default.instance.hero.scaleX>0?1:-1,this.node.scaleX=this.mvDir*this.originSc},e.prototype.doStop=function(t){},e.prototype.getData=function(){var t=this.entity.ani.animationName;return this.data[t]},e.prototype.showRed=function(){var t=this;this.setMat("glowColorSize",.1),this.scheduleOnce(function(){t.setMat("glowColorSize",0)},.2)},e.prototype.doCliff=function(){var t=this;this.isDoCliff||this.state!=r.elude||(this.entity.lineVelocity.x=-this.entity.lineVelocity.x/Math.abs(this.entity.lineVelocity.x)*this.speedMv,this.entity.lineVelocity.y=100,this.isDoCliff=!0,this.scheduleOnce(function(){t.setState(r.idle),t.isDoCliff=!1},.5))},e.prototype.doAttack=function(){var t=this;this.entity.lineVelocity.x=0,this.cleanPath(),this.playAni(this.aniName.aniIdle,1),this.stateScheduleOnce(function(){0!=t.hitInfo.x?(t.playAni(t.aniName.aniAttack,1),t.stateScheduleOnce(function(){t.point.setTartget(10,cc.v3(-70,40,0)),u.AudioMgr.instance.playStick()},.3),t.stateScheduleOnce(function(){t.pointHitHero?(t.setState(r.elude),t.pointHitHero=!1):t.setState(r.idle)},c.G.randRange(.5,1.5))):t.recover()},.5)},e.prototype.doElude=function(){var t=this,e=this.getDir();this.entity.ani.animationName!=this.aniName.aniMv&&this.playAni(this.aniName.aniMv,-1),this.entity.lineVelocity.x=-e*this.speedMv/2,this.stateScheduleOnce(function(){t.setState(r.idle)},c.G.randRange(.5,.8))},e.prototype.isStateProtect=function(){return this.state==r.fall},e.prototype.isCanHurt=function(){return this.state!=r.fall},e.prototype.setDefense=function(){},e.prototype.doDefense=function(){},e.prototype.doPatrol=function(){},e.prototype.setState=function(t,e,i){var n=this;if(void 0===e&&(e=!1),void 0===i&&(i=cc.v2(0,0)),!this.isStateProtect()||0!=e){switch(t){case r.idle:this.dir=0,this.entity.lineVelocity.x=0,this.TiaoXinCount<=0?(this.TiaoXinCount=c.G.randRange(3,5),this.playAni(this.aniName.aniTiaoXin,1),this.node.scaleX=h.default.instance.hero.x>this.node.x?-this.originSc:this.originSc,this.playTime=126):this.playAni(this.aniName.aniIdle,-1),this.TiaoXinCount--;break;case r.attack:this.state=t,this.doAttack();break;case r.left:case r.right:if(this.playTime>0)break;this.dir=-1,t==r.right&&(this.dir=1),this.hitInfo.x!=t||e?(this.entity.lineVelocity.x=this.speedMv*this.dir,this.node.scaleX=-this.dir*this.originSc,this.playAni(this.aniName.aniMv,-1)):this.setState(r.idle);break;case r.hurtYiJi:if(this.state==r.hurtLianJi3||this.state==r.hurtQinNa1_3)return;this.entity.stopUpdate(),this.showRed(),this.setMvDir(),this.playAni(this.aniName.aniHurtYiJi,1);var o=this.getData();this.playTime=Math.ceil(60*o.t1),y.MgpUtil.vibrateShort(),this.entity.lineVelocity.x=0,this.cleanPath(),u.AudioMgr.instance.playAttHand0();break;case r.hurtLianJi0:case r.hurtLianJi1:case r.hurtLianJi2:case r.hurtLianJi3:y.MgpUtil.vibrateShort(),this.cleanPath(),this.setMvDir();var a=t-r.hurtLianJi0,s="";t==r.hurtLianJi0?(s=this.aniName.aniHurtLianJi0,u.AudioMgr.instance.playAttHand0()):t==r.hurtLianJi1?(s=this.aniName.aniHurtLianJi1,u.AudioMgr.instance.playAttHand1()):t==r.hurtLianJi2?(s=this.aniName.aniHurtLianJi2,u.AudioMgr.instance.playAttFoot0()):t==r.hurtLianJi3&&(s=this.aniName.aniHurtLianJi3),this.playAni(s,1);o=this.getData();if(this.playTime=Math.ceil(60*o.t1),3==a)return this.setRectbyTime(),void this.entity.setLineVelocity(cc.v2(this.mvDir*c.G.randRange(380,420),500));this.entity.stopUpdate(),this.showRed(),this.entity.lineVelocity.x=0,0!=i.mag()&&(this.scheduleOnce(function(){n.entity.startUpdate()},.07),this.entity.lineVelocity=i);break;case r.hurtSL:u.AudioMgr.instance.playAttFoot0(),this.playAni(this.aniName.aniHurtLianJi3,1);o=this.getData();return this.playTime=Math.ceil(60*o.t1),this.setRectbyTime(!1),void this.entity.setLineVelocity(cc.v2(0,900));case r.qinNa:this.setMvDir(),this.entity.lineVelocity.x=0,this.cleanPath(),this.playAni(this.aniName.aniHurtQinNa,1);o=this.getData();this.playTime=Math.ceil(60*o.t1);break;case r.hurtQinNa0_0:this.setMvDir(),this.playAni(this.aniName.aniHurtQinNa2,1);o=this.getData();this.playTime=10,this.cleanPath(),u.AudioMgr.instance.playAttAir(),y.MgpUtil.vibrateShort(),this.setRectbyTime();var l=c.G.randRange(480,520),p=500;return 0!=i.mag()&&(l=i.x,p=i.y),this.entity.setLineVelocity(cc.v2(-this.mvDir*l,p)),this.isBeiShua=!0,void g.default.instance.eventManager.addEvent(m.EventType.KQNEnemy,{num:1});case r.hurtQinNa1_0:case r.hurtQinNa1_1:case r.hurtQinNa1_2:case r.hurtQinNa1_3:this.cleanPath(),this.setMvDir();a=t-r.hurtQinNa1_0,s="";t==r.hurtQinNa1_0?(s=this.aniName.aniHurtLianJi0,u.AudioMgr.instance.playAttHand0()):t==r.hurtQinNa1_1?(s=this.aniName.aniHurtLianJi1,u.AudioMgr.instance.playAttHand1()):t==r.hurtQinNa1_2?(s=this.aniName.aniHurtLianJi2,u.AudioMgr.instance.playAttFoot0()):t==r.hurtQinNa1_3&&(s=this.aniName.aniHurtLianJi3),this.playAni(s,1);o=this.getData();if(this.playTime=Math.ceil(60*o.t1),3==a)return this.setRectbyTime(),void this.entity.setLineVelocity(cc.v2(this.mvDir*c.G.randRange(380,420),500));this.entity.lineVelocity.x=0;break;case r.hurtPedal:u.AudioMgr.instance.playAttFoot1(),this.playAni(this.aniName.aniHurtLianJi3,1);o=this.getData();return this.playTime=Math.ceil(60*o.t1),this.setRectbyTime(),void this.entity.setLineVelocity(cc.v2(this.mvDir*c.G.randRange(580,620),500));case r.hurtJiFei:u.AudioMgr.instance.playAttHand0(),this.playAni(this.aniName.aniFeiChu,1);o=this.getData();this.playTime=Math.ceil(60*o.t1),this.setRectbyTime();l=c.G.randRange(400,440),p=500;return 0!=i.mag()&&(l=i.x,p=i.y),void this.entity.setLineVelocity(cc.v2(this.mvDir*l,p));case r.hurtXuLi1:case r.hurtXuli2:if(this.cleanPath(),this.setMvDir(),this.showRed(),1==(a=t-r.hurtXuLi1)){g.default.instance.eventManager.addEvent(m.EventType.KXuliEnemy,{num:1}),this.playAni(this.aniName.aniHurtLianJi3,1),this.playTime+=120,this.setRectbyTime(),this.entity.setLineVelocity(cc.v2(this.mvDir*c.G.randRange(580,620),500));o=this.getData();return void(this.playTime=Math.ceil(60*o.t1))}this.playAni(this.aniName.aniHurtLianJi1,1),u.AudioMgr.instance.playAttFoot0();var o=this.getData();this.playTime=Math.ceil(60*o.t1);break;case r.hurtXiaTi:this.showRed(),this.setMvDir(),this.cleanPath(),u.AudioMgr.instance.playAttFoot1(),y.MgpUtil.vibrateShort(),this.playAni(this.aniName.aniFeiChu,1),this.setRectbyTime(),this.entity.setLineVelocity(cc.v2(this.mvDir*c.G.randRange(380,420),400));o=this.getData();return this.playTime=Math.ceil(60*o.t1),void g.default.instance.eventManager.addEvent(m.EventType.KXiaTiEnemy,{num:1});case r.hurtShangTi:if(this.state==r.fall)return;this.showRed(),this.setMvDir(),this.cleanPath(),u.AudioMgr.instance.playAttFoot1(),y.MgpUtil.vibrateShort(),this.playAni(this.aniName.aniFeiChu,1),this.setRectbyTime(),this.entity.setLineVelocity(cc.v2(this.mvDir*c.G.randRange(380,420),400));o=this.getData();return void(this.playTime=Math.ceil(60*o.t1));case r.hurtImpact:this.cleanPath(),this.playAni(this.aniName.aniFeiChu,1),this.setRectbyTime(),this.entity.setLineVelocity(cc.v2(300*this.mvDir,300)),u.AudioMgr.instance.playAttFoot0();o=this.getData();return void(this.playTime=Math.ceil(60*o.t1));case r.hurtUppercut:if(this.state==r.hurtLianJi3||this.state==r.hurtQinNa1_3)return;this.showRed(),this.setMvDir(),this.playAni(this.aniName.aniHurtYiJi,1);o=this.getData();this.playTime=Math.ceil(60*o.t1),y.MgpUtil.vibrateShort(),this.entity.lineVelocity.x=0,this.entity.lineVelocity.y=350,this.cleanPath(),u.AudioMgr.instance.playAttHand0();break;case r.elude:this.state=t,this.doElude();break;case r.defense:this.state=t,this.doDefense();break;case r.patrol:this.doPatrol()}this.state=t}},e.prototype.getDir=function(){return this.node.scaleX>0?-1:1},e.prototype.setEffect=function(t){if(this.effect=t,1==this.effect&&!this.entity.isDie){var e=[this.node];h.default.instance.shake.init(e,2,4,.01,this.stopTime,p.ShakeType.kHorReg),h.default.instance.shake.shake()}},e.prototype.update=function(){this.playTime<0||(0==this.playTime&&this.recover(),this.playTime--)},e.prototype.hitHero=function(){this.state!=r.elude?this.state>r.hurt||this.state==r.defense||this.setState(r.attack):this.setState(r.idle)},e.prototype.onCollisionEnter=function(t,i){var n=t.node;if("hero"==n.group&&1001==t.tag){var o=n.getComponent(l.heroAct),a=this.node.x-n.x,s=this.node.y-this.node.height/2-(n.y-n.height/2),h=a<0?1:-1,c=s>0?1:-1,u=(this.node.width+n.width)/2,p=(this.node.height+n.height)/2;this.hitInfo=cc.rect(h,c,u-Math.abs(a),p-Math.abs(s)),this.jumping&&!o.jumping||this.hitHero()}else if("enemy"==n.group){(o=n.getComponent(e)).isBeiShua&&(this.mvDir=o.entity.lineVelocity.x>0?1:-1,this.node.scaleX=this.mvDir*this.originSc,this.setState(r.hurtImpact))}},e.prototype.onCollisionExit=function(t,e){"hero"==t.node.group&&1001==t.tag&&(this.hitInfo=cc.rect(0,0,0,0))},e}(cc.Component);i.enemyAct=w;var x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.entity.lineVelocity.x=0},e.prototype.checkSearchPath=function(){},e.prototype.checkPause=function(){},e.prototype.setState=function(t,e){void 0===e&&(e=!1)},e}(w);i.plotAct=x,cc._RF.pop()},{"../../game_logic":"game_logic","../../util/audio_mgr":"audio_mgr","../../util/effect/shaker":"shaker","../../util/event_mgr":"event_mgr","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../scene/gameScene":"gameScene","../tools/nodePool_control":"nodePool_control","../tools/resource_control":"resource_control","./enemyPoint":"enemyPoint","./findPath":"findPath","./hero":"hero","./lifeBase":"lifeBase"}],event_mgr:[function(t,e,i){"use strict";cc._RF.push(e,"d68deXLU/tCtZX3clTL/tkO","event_mgr"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=t("./structure/hd_map");(function(t){t[t.kNone=0]="kNone",t[t.kAudioResume=1]="kAudioResume",t[t.kAudioPause=2]="kAudioPause",t[t.KLoadResOver=3]="KLoadResOver",t[t.InitSDK=4]="InitSDK",t[t.KGuide=5]="KGuide",t[t.closeTrialPnl=6]="closeTrialPnl",t[t.closeStore=7]="closeStore",t[t.kLoadRoleImg=8]="kLoadRoleImg",t[t.kLoadRD=9]="kLoadRD",t[t.kCloseRevivePnl=10]="kCloseRevivePnl",t[t.KActiveEnemy=11]="KActiveEnemy",t[t.KActiveEnemySucc=12]="KActiveEnemySucc",t[t.KActiveThorn=13]="KActiveThorn",t[t.KAddTime=14]="KAddTime",t[t.KBeatEnemy=15]="KBeatEnemy",t[t.kBeatStickEnemy=16]="kBeatStickEnemy",t[t.kBeatGunEnemy=17]="kBeatGunEnemy",t[t.kBeatShieldenemy=18]="kBeatShieldenemy",t[t.KUseGunBeatEnemy=19]="KUseGunBeatEnemy",t[t.KUseDartsBeatEnemy=20]="KUseDartsBeatEnemy",t[t.KUseBrickBeatEnemy=21]="KUseBrickBeatEnemy",t[t.KUseKnifeBeatEnemy=22]="KUseKnifeBeatEnemy",t[t.KCollectApple=23]="KCollectApple",t[t.KCollectChicken=24]="KCollectChicken",t[t.KCollectCoin=25]="KCollectCoin",t[t.KXiaTiEnemy=26]="KXiaTiEnemy",t[t.KXuliEnemy=27]="KXuliEnemy",t[t.KQNEnemy=28]="KQNEnemy"})(n=i.EventType||(i.EventType={}));var r=function(){function t(){this.type_=n.kNone,this.id_=0,this.sender_=null,this.data_=null}return t.prototype.init=function(t,e,i,n){this.id_=t,this.type_=e,this.sender_=i,this.data_=n},Object.defineProperty(t.prototype,"type",{get:function(){return this.type_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.id_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sender",{get:function(){return this.sender_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.data_},enumerable:!0,configurable:!0}),t}(),a=function(){function t(){this.id_=0,this.callback_=null,this.bExe=!1}return Object.defineProperty(t.prototype,"id",{get:function(){return this.id_},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e){this.id_=t,this.callback_=e},t.prototype.excute=function(t,e){this.bExe=!0,this.callback_&&this.callback_(t,e),this.bExe=!1},t}(),s=function(){function t(){this.baseEvtId_=0,this.baseListenerId_=0,this.listenerMap_=null,this.delMap_=new o.default,this.evtLst_=null,this.bExe_=!1}return t.prototype.init=function(){this.baseEvtId_=0,this.baseListenerId_=0,null==this.listenerMap_&&(this.listenerMap_=new o.default),this.listenerMap_.clear(),null==this.evtLst_&&(this.evtLst_=new Array),this.evtLst_=[],this.bExe_=!1},t.prototype.addEvent=function(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!0),++this.baseEvtId_;var o=new r;if(o.init(this.baseEvtId_,t,e,i),n){var a=this.listenerMap_.get(t);if(null!=a)for(var s=a.length-1;s>=0;--s)a[s].excute(o.sender,o.data)}else this.bExe_=!0,this.evtLst_.push(o)},t.prototype.addListener=function(t,e){++this.baseListenerId_;var i,n=new a;(n.init(this.baseListenerId_,e),this.listenerMap_.containsKey(t))?null!=(i=this.listenerMap_.get(t))&&i.push(n):((i=new Array).push(n),this.listenerMap_.put(t,i));return this.baseListenerId_},t.prototype.removeListener=function(t,e,i){if(void 0===i&&(i=!1),this.listenerMap_.containsKey(t)){var n=this.listenerMap_.get(t);if(null!=n){for(var o=0;o<n.length;++o){if((!n[o].bExe||i)&&n[o].id===e){n.splice(o,1);break}n[o].bExe&&(this.delMap_.put(t,e),this.bExe_=!0)}0==n.length&&this.listenerMap_.remove(t)}}},t.prototype.clear=function(){this.evtLst_=[],this.listenerMap_.clear(),this.delMap_.clear()},t.prototype.excuteEvents=function(){var t=this;if(this.bExe_){for(var e=0;e<this.evtLst_.length;++e){var i=this.evtLst_[e];if(null==i){cc.error("can not find the approriate game event");break}var n=this.listenerMap_.get(i.type);if(n)for(var o=0;o<n.length;++o)n[o].excute(i.sender,i.data);else cc.warn("Can not find the listeners about event ",i.type.toString())}this.delMap_.size()>0&&(this.delMap_.each(function(e,i,n){t.removeListener(i,n)}),this.delMap_.clear()),this.evtLst_=[],this.bExe_=!1}},t.instance=new t,t}();i.default=s,cc._RF.pop()},{"./structure/hd_map":"hd_map"}],export_ui:[function(t,e,i){"use strict";cc._RF.push(e,"86ae40376pJP6sOXzMQ3BP1","export_ui");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.ExportUIInst=i.ExportUI=i.ExportGroup=i.ExportGroupName=i.ExportTmID=i.ExportUIName=i.ExportTransType=void 0;var o,r=t("./base_ui"),a=t("../../util/structure/hd_map"),s=t("../../util/global_def"),h=t("../../HDSDK"),l=t("./tip_ui"),c=t("../../util/storage"),u=t("../../util/audio_mgr"),p=t("../../util/timed_task"),d=t("../../game_logic"),f=t("../../util/mgp_util"),_=t("../game/ExportFriPnl");(function(t){t[t.kNone=0]="kNone",t[t.kPop=1]="kPop",t[t.kFade=2]="kFade",t[t.kSpring=3]="kSpring",t[t.kShake=4]="kShake"})(o=i.ExportTransType||(i.ExportTransType={}));var g=function(){function t(){}return t.kSL1="singleL1",t.kSL2="singleL2",t.KSL3="singleL3",t.kSR1="singleR1",t.kSR2="singleR2",t.kSR3="singleR3",t.kHML1="hmSingleL1",t.kHML2="hmSingleL2",t.kHMHor0="hmHor0",t.kHMHor1="hmHor1",t.kHMHor2="tipScoll",t.KPau0="pau3_0",t.KPau1="pau3_1",t.kRevive="grid",t.KResult="grid1",t.kHT="horTop",t.kEP0="exportGrid0",t.KEPF="pnl",t.kTHT="trailHorTop",t.kSSL1="SSL1",t.kSSL2="SSL2",t.kTSL1="TSL1",t.kTSL2="TSL2",t.kTSR1="TSR1",t.kTSR2="TSR2",t.KGSL1="exportBtn",t}();i.ExportUIName=g;var m=function(){function t(){}return t.kRepository="1152963",t.kRevive="1153064",t.kExportPnl="1153367",t.kStoreHT="1153165",t.kStoreSignles="1153266",t.kTrailHT="1153468",t.kTrailSingles="1153569",t.KHomeSigles="1152660",t.KExprotFri="1158821",t}();i.ExportTmID=m;var y=function(){function t(){}return t.kHS4="homeSingle4",t.kRP4="repositorySingle4",t.kStore2="storeSingle2",t.kTrail4="trailSingle4",t.kHomeAll="homeAll",t.kGS2="gameSingle2",t.kGameAll="gameAll",t}();i.ExportGroupName=y;var v=function(){function t(){}return t.addMembers=function(t,e){this.exportUI_||(this.exportUI_=b.instance);var i=[];this.grpMap_.containsKey(t)&&(i=this.grpMap_.get(t));for(var n=0;n<e.length;++n)i.push(e[n]);i=s.G.uniqueArray(i),this.grpMap_.containsKey(t)||this.grpMap_.put(t,i)},t.showMembers=function(t,e){if(void 0===e&&(e=""),this.exportUI_&&this.grpMap_.containsKey(t)){for(var i=this.grpMap_.get(t),n=0;n<i.length;++n)this.exportUI_.show(i[n],e,!1);0}},t.showMembersTM=function(t,e){if(this.exportUI_&&this.grpMap_.containsKey(t))for(var i=this.grpMap_.get(t),n=0;n<i.length;++n)this.exportUI_.showTM(i[n],e)},t.hideMembers=function(t){if(this.exportUI_&&this.grpMap_.containsKey(t))for(var e=this.grpMap_.get(t),i=0;i<e.length;++i)this.exportUI_.hide(e[i])},t.grpMap_=new a.default,t.exportUI_=null,t}();i.ExportGroup=v;var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.normArr_=[],e.bnrArr_=[],e.navObjMap_=new a.default,e.forceNavDatArr_=[],e.forceFixedNavDatArr_=[],e.usedForceNavIds_=[],e.usedNavIdCntMap_=new a.default,e.singleNavArr_=[],e.singleBnrArr_=[],e.rcShowArr_=[],e.vPage_=null,e.hPage_=null,e.vGrid_=null,e.vFakePage_=null,e.showPageCb_=null,e.hidePageCb_=null,e.bnrShowId_="",e.block_=null,e.blockBg_=null,e.blockClickCb_=null,e.loadQue_=[],e.loadInfoMap_=new a.default,e.loadInfoCompleteMap_=new a.default,e.currLoadInfo_=null,e.tmSingleLoadMap_=new a.default,e.tmSingleLoadRecMap_=new a.default,e.tmSingleLoadDelay_=1,e.tmSingleLoadCnt_=0,e.normDatIdx_=0,e.bnrDatIdx_=0,e.fetchTimer_=0,e.checkTimer_=0,e.preloaderTimer_=0,e.updCheckCnt_=0,e.fetchCheckCnt_=0,e.cx_=0,e.cy_=0,e.bUpdCheck_=!1,e.bFetchedData_=!1,e.bInited_=!1,e.bPreload_=!1,e.bLockShow_=!1,e.bForceFakePage_=!1,e.tmPageDefaultPosId_="",e}return n(e,t),Object.defineProperty(e.prototype,"defaultPageTmID",{set:function(t){this.tmPageDefaultPosId_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normNavDataIndex",{get:function(){return this.normDatIdx_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normNavData",{get:function(){return this.normArr_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getForceNavData",{get:function(){var t=null;if(this.forceNavDatArr_.length>0&&s.G.randRange(0,100)<=d.default.instance.forceNavProb){var e=s.G.randRange(0,this.forceNavDatArr_.length-1);t=this.forceNavDatArr_[e]}return t},enumerable:!1,configurable:!0}),e.prototype.forceNavCancelRecord=function(t){var e=0,i=t.appId;this.usedNavIdCntMap_.containsKey(i)?(e=this.usedNavIdCntMap_.get(i),++e,this.usedNavIdCntMap_.put(i,e)):(this.usedNavIdCntMap_.put(i,1),e=1);var n=0;if(t.extra&&(n=t.extra.force?parseInt(t.extra.force):1),e>=n){for(var o=0;o<this.forceNavDatArr_.length;++o)if(t.appId===this.forceNavDatArr_[o].appId){this.forceNavDatArr_.splice(o,1);break}this.usedForceNavIds_.push(i)}this._saveForceNavIds()},e.prototype.forcePopFakePage=function(t){this.forcePopFakePageTM("",t)},e.prototype.forcePopFakePageTM=function(t,e){this.vFakePage_&&!this.bForceFakePage_&&s.G.randRange(0,100)<=d.default.instance.wxNodeNum?(s.G.isTMSDK?this.vFakePage_.showTM(t):this.vFakePage_.show("\u968f\u673a\u5f3a\u5f39\u5047\u5fae\u4fe1\u9875"),this.bForceFakePage_=!0):(this.bForceFakePage_=!1,e&&e())},Object.defineProperty(e.prototype,"getFixedForceNavDatArr",{get:function(){var t=null;if(this.forceFixedNavDatArr_.length>0){var e=s.G.randRange(0,this.forceFixedNavDatArr_.length-1);t=this.forceFixedNavDatArr_[e]}return t},enumerable:!1,configurable:!0}),e.prototype.forceNavForTMSDK=function(t,e,i){var n=this;s.G.randRange(0,100)<=d.default.instance.config.forceNavProb?wx.tmSDK.getFlowConfig({positionId:t}).then(function(o){if(console.log("[ExportUI TMSDK] force ad pos active: ",t,o.isOpen),o.isOpen&&o.creatives.length>0){var r=o.creatives[s.G.randRange(0,o.creatives.length-1)];n.navigateTM(r.positionId,r.creativeId,null,e,i)}else i&&i()}):i&&i()},e.prototype.init=function(){var t=cc.view.getVisibleSize().height>cc.view.getVisibleSize().width,e=t?"VMainPnl":"HMainPnl",i=fgui.UIPackage.createObject("HDSDK",e).asCom;i&&(this.com_=i,i.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),this.cx_=.5*i.width,this.cy_=.5*i.height,t?(this.vPage_=new nt,this.vGrid_=new ht):this.hPage_=new ot,i.sortingOrder=r.UIHierarchy.kExportCom,r.BaseUI.root.addChild(i),this.block_=i.getChild("block").asCom,this.blockBg_=this.block_.getChild("bg").asImage,this.block_.visible=!1,this.bInited_=!0)},e.prototype.update=function(t){if(this.bInited_){this.bUpdCheck_||(s.G.isTMSDK?this.bUpdCheck_=!0:(this.bFetchedData_||this._fetchChecker(t),this._checkUpdate(t))),s.G.isTMSDK&&(++this.tmSingleLoadCnt_,this.tmSingleLoadCnt_>=this.tmSingleLoadDelay_&&this.tmSingleLoadMap_.size()>0&&(this.tmSingleLoadMap_.each(this._tmLoadCallback.bind(this)),this.tmSingleLoadCnt_=0,this.tmSingleLoadDelay_<21600&&(this.tmSingleLoadDelay_*=2)));for(var e=0;e<this.singleNavArr_.length;++e)if(this.singleNavArr_[e].update(t)){var i=this._getNextNormNavDat();console.log("2222222222222222222",i,this.normArr_,this.normDatIdx_),i&&this.singleNavArr_[e].updateInfo(i)}for(e=0;e<this.singleBnrArr_.length;++e){if(this.singleBnrArr_[e].update(t))(i=this._getNextBnrNavDat())&&this.singleBnrArr_[e].updateInfo(i)}for(e=0;e<this.rcShowArr_.length;++e)this.rcShowArr_[e].update(t);this.vPage_?this.vPage_.update(t):this.hPage_&&this.hPage_.update(t),this.vGrid_&&this.vGrid_.update(t)}},e.prototype.getRelativeXY=function(t){var e=new cc.Vec2;return e=r.BaseUI.root.localToGlobal(t.x,t.y,e),e=this.com_.globalToLocal(e.x,e.y,e)},e.prototype.getCenterXY=function(){return{x:this.cx_,y:this.cy_}},e.prototype.block=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=null),this.block_.visible=!0,this.blockBg_.visible=t,e&&(this.blockClickCb_=e,this.block_.onClick(this._onBlockClick,this))},e.prototype.unblock=function(){this.block_.visible=!1},e.prototype.initPage=function(){this.vPage_?this.vPage_.init(this.normArr_,this.com_):this.hPage_&&this.hPage_.init(this.normArr_,this.bnrArr_,this.com_),this.vGrid_&&this.vGrid_.init(this.normArr_,this.com_)},e.prototype.bindFakeCloseButton=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=!0),this.navObjMap_.containsKey(t))console.warn("[ExportUI bindFakeCloseButton] no need to bind repetitive nav object");else{var n=(e||this.com_).getChild(t);if(n){e&&(n.removeFromParent(),this.com_.addChild(n));var o=new C(n.asCom);if(this.vFakePage_||(this.vFakePage_=new rt,this.vFakePage_.init(this.normNavData,this.com_)),CC_WECHATGAME&&i){var r=f.MgpUtil.convertMenuButtonRect(0,n.height+10);n.setPosition(r.x,r.y),n.setSize(r.w,r.h)}this.navObjMap_.put(t,o)}else console.warn("[ExportUI bindFakeCloseButton] not find component >",t)}},e.prototype.bindMoreGameButton=function(t,e,i,n){if(void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=!0),this.navObjMap_.containsKey(t))console.warn("[ExportUI bindMoreGameButton] no need to bind repetitive nav object");else{var o=(e||this.com_).getChild(t);if(o){e&&n&&(o.removeFromParent(),this.com_.addChild(o));var r=new S(o.asCom);i>0&&r.playTrans(i),this.navObjMap_.put(t,r)}else console.warn("[ExportUI bindMoreGameButton] not find component >",t)}},e.prototype.bindSingle=function(t,e,i,n,r,a,l,c){if(void 0===e&&(e=null),void 0===i&&(i=o.kNone),void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=5),void 0===l&&(l=5),void 0===c&&(c=!0),this.navObjMap_.containsKey(t))console.warn("[ExportUI bindSingle] no need to bind repetitive nav object");else{var u=(e||this.com_).getChild(t);if(u){e&&(u.removeFromParent(),this.com_.addChild(u));var p=new k(u.asCom),d=null;d=s.G.isTMSDK?new h.HDNavData:this._getNextNormNavDat(),p.appendExtraFunc(n,r,i,a,l),d&&(p.init(d),this.navObjMap_.put(t,p),this.singleNavArr_.push(p))}else console.warn("[ExportUI bindSingle] not find component >",t)}},e.prototype.bindSingleEx=function(t,e,i,n,r,a,l,c,u,p){if(void 0===e&&(e=null),void 0===i&&(i=o.kNone),void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=5),void 0===l&&(l=5),void 0===c&&(c="#000000"),void 0===u&&(u=!0),void 0===p&&(p=!1),this.navObjMap_.containsKey(t))console.warn("[ExportUI bindSingleEx] no need to bind repetitive nav object");else{var d=(e||this.com_).getChild(t);if(d){e&&(d.removeFromParent(),this.com_.addChild(d));var f=new A(d.asCom),_=null;(_=s.G.isTMSDK?new h.HDNavData:this._getNextNormNavDat())&&(f.init(_,u,c,p),f.appendExtraFunc(n,r,i,a,l),this.navObjMap_.put(t,f),this.singleNavArr_.push(f))}else console.warn("[ExportUI bindSingleEx] not find component >",t)}},e.prototype.bindBanner=function(t,e,i,n,r,a,s,h){if(void 0===e&&(e=null),void 0===i&&(i=o.kNone),void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=5),void 0===s&&(s=5),void 0===h&&(h=!0),this.navObjMap_.containsKey(t))console.warn("[ExportUI bindBanner] no need to bind repetitive nav object");else{var l=(e||this.com_).getChild(t);if(l){e&&(l.removeFromParent(),this.com_.addChild(l));var c=new D(l.asCom),u=this._getNextBnrNavDat();u&&(c.init(u),c.appendExtraFunc(n,r,i,a,s),this.navObjMap_.put(t,c),this.singleBnrArr_.push(c))}else console.warn("[ExportUI bindBanner] not find component >",t)}},e.prototype.bindButton=function(t,e,i,n,r,a,s){if(void 0===e&&(e=null),void 0===i&&(i=o.kNone),void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=5),void 0===s&&(s=5),this.navObjMap_.containsKey(t))console.warn("[ExportUI bindButton] no need to bind repetitive nav object");else{var h=(e||this.com_).getChild(t);if(h){var l=new j(h.asCom),c=this._getNextNormNavDat();c&&(l.init(c),l.appendExtraFunc(n,r,i,a,s),this.navObjMap_.put(t,l),this.singleNavArr_.push(l))}else console.warn("[ExportUI bindBanner] not find component >",t)}},e.prototype.bindRCScroll=function(t,e,i,n,r,a,s,h,l,c,u,p){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=o.kNone),void 0===s&&(s=null),void 0===h&&(h=null),void 0===l&&(l=5),void 0===c&&(c=!0),void 0===u&&(u=2),void 0===p&&(p=1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindRCScroll] no need to bind repetitive nav object"):this._genRCScroll(t,e,i,n,r,!1,"",a,s,h,l,c,u,!0,!1,p)},e.prototype.bindRCScrollEx=function(t,e,i,n,r,a,s,h,l,c,u,p,d,f,_){void 0===e&&(e=null),void 0===i&&(i=-10),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=""),void 0===s&&(s=o.kNone),void 0===h&&(h=null),void 0===l&&(l=null),void 0===c&&(c=5),void 0===u&&(u=!0),void 0===p&&(p=2),void 0===d&&(d=!0),void 0===f&&(f=1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindRCScroll] no need to bind repetitive nav object"):this._genRCScroll(t,e,i,n,r,!0,a,s,h,l,c,u,p,d,!1,f,_)},e.prototype.bindGuessLike=function(t,e,i,n,r,a,s,h){void 0===e&&(e=null),void 0===i&&(i=10),void 0===n&&(n=0),void 0===r&&(r=""),void 0===a&&(a=null),void 0===s&&(s=null),void 0===h&&(h=2),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindGuessLike] no need to bind repetitive nav object"):this._genRCScroll(t,e,0,i,n,!0,r,o.kNone,a,s,-1,!1,2,!1,!0)},e.prototype.bindVerDualCol=function(t,e,i,n,r,a,s,h,l,c){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=5),void 0===a&&(a=o.kNone),void 0===s&&(s=null),void 0===h&&(h=null),void 0===l&&(l=5),void 0===c&&(c=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindVerDualCol] no need to bind repetitive nav object"):this._genVD(t,e,i,n,!1,"",r,a,s,h,l,c)},e.prototype.bindVerDualColEx=function(t,e,i,n,r,a,s,h,l,c,u){void 0===e&&(e=null),void 0===i&&(i=-15),void 0===n&&(n=0),void 0===r&&(r=""),void 0===a&&(a=5),void 0===s&&(s=o.kNone),void 0===h&&(h=null),void 0===l&&(l=null),void 0===c&&(c=5),void 0===u&&(u=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindVerDualColEx] no need to bind repetitive nav object"):this._genVD(t,e,i,n,!0,r,a,s,h,l,c,u)},e.prototype.bindGrid2x4=function(t,e,i,n,r,a,s,h,l,c,u){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=5),void 0===a&&(a=o.kNone),void 0===s&&(s=null),void 0===h&&(h=null),void 0===l&&(l=5),void 0===c&&(c=!0),void 0===u&&(u=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindGrid2x4] no need to bind repetitive nav object"):this._genGrid(t,e,2,4,i,n,0,!1,"",a,s,h,l,u,c,r)},e.prototype.bindGrid2x5=function(t,e,i,n,r,a,s,h,l,c,u){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=5),void 0===a&&(a=o.kNone),void 0===s&&(s=null),void 0===h&&(h=null),void 0===l&&(l=5),void 0===c&&(c=!0),void 0===u&&(u=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindGrid2x5] no need to bind repetitive nav object"):this._genGrid(t,e,2,5,i,n,0,!1,"",a,s,h,l,u,c,r,!1)},e.prototype.bindGrid2x4Ex=function(t,e,i,n,r,a,s,h,l,c,u,p){void 0===e&&(e=null),void 0===i&&(i=-10),void 0===n&&(n=0),void 0===r&&(r=""),void 0===a&&(a=5),void 0===s&&(s=o.kNone),void 0===h&&(h=null),void 0===l&&(l=null),void 0===c&&(c=5),void 0===u&&(u=!0),void 0===p&&(p=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindGrid2x4Ex] no need to bind repetitive nav object"):this._genGrid(t,e,2,4,i,n,0,!0,r,s,h,l,c,p,u,a)},e.prototype.bindGrid2x3Ex=function(t,e,i,n,r,a,s,h,l,c,u,p,d){void 0===e&&(e=null),void 0===i&&(i=-10),void 0===n&&(n=0),void 0===r&&(r=""),void 0===a&&(a=5),void 0===s&&(s=o.kNone),void 0===h&&(h=null),void 0===l&&(l=null),void 0===c&&(c=5),void 0===u&&(u=!0),void 0===p&&(p=!1),void 0===d&&(d=!0),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindGrid2x4Ex] no need to bind repetitive nav object"):this._genGrid(t,e,2,3,i,n,0,!0,r,s,h,l,c,p,u,a,!0,d)},e.prototype.bindGrid3x3=function(t,e,i,n,r,a,s,h,l,c,u,p){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=5),void 0===a&&(a=o.kNone),void 0===s&&(s=null),void 0===h&&(h=null),void 0===l&&(l=5),void 0===c&&(c=!0),void 0===u&&(u=!1),void 0===p&&(p=1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindGrid3x3] no need to bind repetitive nav object"):this._genGrid(t,e,3,3,i,n,0,!1,"",a,s,h,l,u,c,r,!1,!0,p)},e.prototype.bindGrid3x3Ex=function(t,e,i,n,r,a,s,h,l,c,u,p){void 0===e&&(e=null),void 0===i&&(i=-10),void 0===n&&(n=0),void 0===r&&(r=""),void 0===a&&(a=5),void 0===s&&(s=o.kNone),void 0===h&&(h=null),void 0===l&&(l=null),void 0===c&&(c=5),void 0===u&&(u=!0),void 0===p&&(p=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindGrid3x3Ex] no need to bind repetitive nav object"):this._genGrid(t,e,3,3,i,n,0,!0,r,s,h,l,c,p,u,a)},e.prototype.bindPop3x3=function(t,e,i,n,r,a,s,h,l,c,u){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=5),void 0===a&&(a=o.kNone),void 0===s&&(s=null),void 0===h&&(h=null),void 0===l&&(l=5),void 0===c&&(c=!0),void 0===u&&(u=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindPop3x3] no need to bind repetitive nav object"):this._genGrid(t,e,3,3,i,n,0,!1,"",a,s,h,l,u,c,r,!0)},e.prototype.bindPop3x3Ex=function(t,e,i,n,r,a,s,h,l,c,u,p){void 0===e&&(e=null),void 0===i&&(i=-10),void 0===n&&(n=0),void 0===r&&(r=""),void 0===a&&(a=5),void 0===s&&(s=o.kNone),void 0===h&&(h=null),void 0===l&&(l=null),void 0===c&&(c=5),void 0===u&&(u=!0),void 0===p&&(p=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindPop3x3Ex] no need to bind repetitive nav object"):this._genGrid(t,e,3,3,i,n,0,!0,r,s,h,l,c,p,u,a,!0)},e.prototype.bindPop4x3Ex=function(t,e,i,n,r,a,s,h,l,c,u,p){void 0===e&&(e=null),void 0===i&&(i=-10),void 0===n&&(n=0),void 0===r&&(r=""),void 0===a&&(a=5),void 0===s&&(s=o.kNone),void 0===h&&(h=null),void 0===l&&(l=null),void 0===c&&(c=5),void 0===u&&(u=!0),void 0===p&&(p=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindPop4x3Ex] no need to bind repetitive nav object"):this._genGrid(t,e,4,3,i,n,0,!0,r,s,h,l,c,p,u,a,!0)},e.prototype.bindFoldPage=function(t,e,i,n,r,a,s,h,l,c,u,p,d,f,_){void 0===e&&(e=null),void 0===i&&(i=3),void 0===n&&(n=-10),void 0===r&&(r=0),void 0===a&&(a=null),void 0===s&&(s=null),void 0===h&&(h=1),void 0===l&&(l=!1),void 0===c&&(c=2),void 0===u&&(u=o.kNone),void 0===p&&(p=null),void 0===d&&(d=null),void 0===f&&(f=5),void 0===_&&(_=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindFoldPage] no need to bind repetitive nav object"):this._genFoldPage(t,e,i,n,r,0,!1,"",u,p,d,h,l,f,_,c,a,s)},e.prototype.bindFoldPageEx=function(t,e,i,n,r,a,s,h,l,c,u,p,d,f,_,g){void 0===e&&(e=null),void 0===i&&(i=3),void 0===n&&(n=-10),void 0===r&&(r=0),void 0===a&&(a=""),void 0===s&&(s=null),void 0===h&&(h=null),void 0===l&&(l=1),void 0===c&&(c=!1),void 0===u&&(u=2),void 0===p&&(p=o.kNone),void 0===d&&(d=null),void 0===f&&(f=null),void 0===_&&(_=5),void 0===g&&(g=!1),this.navObjMap_.containsKey(t)?console.warn("[ExportUI bindFoldPage] no need to bind repetitive nav object"):this._genFoldPage(t,e,i,n,r,0,!0,a,p,d,f,l,c,_,g,u,s,h)},e.prototype.show=function(t,e,i){void 0===e&&(e=""),void 0===i&&(i=!0),this.bLockShow_||(1===d.default.instance.export?this._setVisible(t,!0,e,i):this._setVisible(t,!1))},e.prototype.showTM=function(t,e){this.bLockShow_||(CC_WECHATGAME?1===d.default.instance.config.export?this.navObjMap_.containsKey(t)?(console.log("[ExportUI] ",t,e),this.navObjMap_.get(t).showTM(e)):console.warn("[ExportUI ] not found this component",t):this._setVisible(t,!1):this.show(t))},e.prototype.hide=function(t){this._setVisible(t,!1)},e.prototype.hideAll=function(){this.navObjMap_.each(function(t,e,i){i.hide()})},e.prototype.lockShowOpt=function(){this.bLockShow_=!0},e.prototype.unlockShowOpt=function(){this.bLockShow_=!1},e.prototype.addPageCallback=function(t,e){this.showPageCb_=t,this.hidePageCb_=e},e.prototype.clearShowPageCallback=function(){this.showPageCb_=null,this.hidePageCb_=null},e.prototype.setPageBannerID=function(t){this.bnrShowId_=t},e.prototype.clearPageBannerID=function(){this.bnrShowId_=""},e.prototype.getPageBannerID=function(){return this.bnrShowId_},e.prototype.showPage=function(t,e){if(void 0===t&&(t=""),void 0===e&&(e=""),s.G.isTMSDK){if(""==e&&(e=this.tmPageDefaultPosId_),""==this.tmPageDefaultPosId_)return void console.warn("[ExportUI showPage] tm sdk default page id is not existed");this.vPage_?this.vPage_.showTM(e):this.hPage_&&this.hPage_.showTM(e)}else this.vPage_?this.vPage_.show(t):this.hPage_&&this.hPage_.show(t);this.showPageCb_&&this.showPageCb_()},e.prototype.hidePage=function(){this.vPage_?this.vPage_.hide():this.hPage_&&this.hPage_.hide(),this.hidePageCb_&&this.hidePageCb_()},e.prototype.showGridPage=function(t,e){if(void 0===t&&(t=""),void 0===e&&(e=""),s.G.isTMSDK){if(""==e&&(e=this.tmPageDefaultPosId_),""==this.tmPageDefaultPosId_)return void console.warn("[ExportUI showPage] tm sdk default page id is not existed");this.vGrid_?this.vGrid_.showTM(e):this.showPage("",e)}else this.vGrid_?this.vGrid_.show(t):this.showPage(t);this.showPageCb_&&this.showPageCb_()},e.prototype.hideGridPage=function(){this.vGrid_?this.vGrid_.hide():this.hidePage(),this.hidePageCb_&&this.hidePageCb_()},e.prototype.showFakePage=function(t,e){if(void 0===t&&(t=""),void 0===e&&(e=""),s.G.isTMSDK){if(""==e&&(e=this.tmPageDefaultPosId_),""==this.tmPageDefaultPosId_)return void console.warn("[ExportUI showPage] tm sdk default page id is not existed");this.vFakePage_&&this.vFakePage_.showTM(e)}else this.vFakePage_&&this.vFakePage_.show(t);u.AudioMgr.instance.pauseMusic(),this.showPageCb_&&this.showPageCb_()},e.prototype.hideFakePage=function(){this.vFakePage_&&this.vFakePage_.hide(),u.AudioMgr.instance.resumeMusic(),this.hidePageCb_&&this.hidePageCb_()},e.prototype.autoPopFoldPage=function(t){this.navObjMap_.containsKey(t)&&this.navObjMap_.get(t).autoUnfold()},e.prototype.closeFoldPage=function(t){this.navObjMap_.containsKey(t)&&this.navObjMap_.get(t).fold()},e.prototype.uploadLog=function(t,e){},e.prototype.navigate=function(t,e,i){CC_WECHATGAME?h.HDSDK.navigate(t.id,e,i):3===t.type&&l.TipUI.instance.show("\u8df3\u8f6c\u6a21\u62df \u4e8c\u7ef4\u7801\u5c55\u793a "+t.name)},e.prototype.navigateTM=function(t,e,i,n,o){s.G.isTMSDK?(console.log("[ExportUI navigateTM] nav trigger",t,e),wx.tmSDK.flowNavigate({positionId:t,creativeId:e}).then(function(e){if(console.log("[ExportUI navigateTM] nav judgement"),e.navigateMessage){var r=e.navigateMessage.errMsg;-1!==r.indexOf("ok")?(console.log("[ExportUI navigateTM] nav ok",r),n&&n()):(console.log("[ExportUI navigateTM] nav error or cancel",r),o&&o())}i&&i(e.creatives,t)}).catch(function(t){console.log("[ExportUI navigateTM] nav error",t)})):console.log("[ExportUI navigateTM] not wx platform")},e.prototype.addToLoadQueue=function(t){var e=this;if(this.loadInfoMap_.containsKey(t.url)){var i=this.loadInfoMap_.get(t.url);if(this.loadInfoCompleteMap_.containsKey(t.url)){t.completeCallback&&t.completeCallback();for(var n=0;n<i.length;++n)i[n].completeCallback&&i[n].completeCallback();this.loadInfoMap_.put(t.url,[])}else i.push(t)}else{(i=[]).push(t),this.loadInfoMap_.put(t.url,i),this.loadQue_.push(t)}this.currLoadInfo_||(this.currLoadInfo_=this.loadQue_.shift(),this.currLoadInfo_&&cc.loader.load(this.currLoadInfo_.url,null,function(t,i){t||e._loadComplete()}))},e.prototype.addToTmSingleQueue=function(t,e){if(this.tmSingleLoadMap_.containsKey(t)){for(var i=this.tmSingleLoadMap_.get(t),n=!0,o=0;o<i.length;++o)if(""!=e.navData.tmCid&&i[o].navData==e.navData){n=!1;break}n&&i.push(e)}else{(i=[]).push(e),this.tmSingleLoadMap_.put(t,i)}this.tmSingleLoadDelay_=1,this.tmSingleLoadRecMap_.containsKey(t)&&this.tmSingleLoadRecMap_.remove(t)},e.prototype._tmLoadCallback=function(t,e,i){var n=this;this.tmSingleLoadRecMap_.containsKey(e)||(wx.tmSDK.getFlowConfig({positionId:e}).then(function(t){if(t.isOpen){var e=t.creatives;if(e)for(var o=0,r=0;r<i.length;++r)e[r].show_config&&(i[r].navData.img=e[r].show_config.image,i[r].navData.name=e[r].show_config.title),i[r].navData.tmPosId=e[r].positionId,i[r].navData.tmCid=e[r].creativeId,i[r].updateInfo(i[r].navData),i[r].registerTMSDKRefreshCallback(n._tmSdkSingleRefresh.bind(n)),++o>=e.length&&(o=0)}}),this.tmSingleLoadRecMap_.put(e,1))},e.prototype._tmSdkSingleRefresh=function(t,e){if(this.tmSingleLoadMap_.containsKey(e)){var i=this.tmSingleLoadMap_.get(e),n=t;if(n)for(var o=0,r=0;r<i.length;++r)n[r].show_config&&(i[r].navData.img=n[r].show_config.image,i[r].navData.name=n[r].show_config.title),i[r].navData.tmPosId=n[r].positionId,i[r].navData.tmCid=n[r].creativeId,i[r].updateInfo(i[r].navData),++o>=n.length&&(o=0)}else console.warn("[ExportUI _tmSdkSingleRefresh] tm single loading items is not existed",e)},e.prototype._loadComplete=function(){var t=this;if(this.currLoadInfo_&&this.currLoadInfo_.completeCallback){if(this.loadInfoCompleteMap_.put(this.currLoadInfo_.url,1),this.loadInfoMap_.containsKey(this.currLoadInfo_.url)){for(var e=this.loadInfoMap_.get(this.currLoadInfo_.url),i=0;i<e.length;++i)e[i].completeCallback&&e[i].completeCallback();this.loadInfoMap_.put(this.currLoadInfo_.url,[])}this.currLoadInfo_=this.loadQue_.shift(),this.currLoadInfo_&&cc.loader.load(this.currLoadInfo_.url,null,function(e,i){e||t._loadComplete()})}},e.prototype._genRCScroll=function(t,e,i,n,r,a,s,h,l,c,u,p,d,f,_,g,m){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===s&&(s=""),void 0===h&&(h=o.kNone),void 0===l&&(l=null),void 0===c&&(c=null),void 0===u&&(u=5),void 0===p&&(p=!1),void 0===d&&(d=2),void 0===f&&(f=!0),void 0===_&&(_=!1),void 0===g&&(g=1);var y=(e||this.com_).getChild(t);if(y){e&&(y.removeFromParent(),this.com_.addChild(y));var v=y.asCom,b=null;v.width>v.height?((b=_?new U(v):new F(v)).setNameBgVisible(f),b.init(this.normArr_,g,5,i,n,a,p,d,s,r),b.buildSingles(m),b.appendExtraFunc(l,c,h,u)):((b=new z(v)).init(this.normArr_,0,1,i,0,a,p,d,s,r),b.buildSingles(),b.appendExtraFunc(l,c,h,u)),b&&(this.navObjMap_.put(t,b),this.rcShowArr_.push(b))}else console.warn("[ExportUI _genRCScroll] not find component >",t)},e.prototype._genVD=function(t,e,i,n,r,a,s,h,l,c,u,p){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=!1),void 0===a&&(a=""),void 0===s&&(s=5),void 0===h&&(h=o.kNone),void 0===l&&(l=null),void 0===c&&(c=null),void 0===u&&(u=5),void 0===p&&(p=!1);var d=(e||this.com_).getChild(t);if(d){e&&(d.removeFromParent(),this.com_.addChild(d));var f=d.asCom,_=new H(f);_.init(this.normArr_,3,2,i,0,r,p,s,a,n),_.buildSingles(),_.appendExtraFunc(l,c,h,u),this.navObjMap_.put(t,_),this.rcShowArr_.push(_)}else console.warn("[ExportUI _genVD] not find component >",t)},e.prototype._genGrid=function(t,e,i,n,r,a,s,h,l,c,u,p,d,f,_,g,m,y,v){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===h&&(h=!1),void 0===l&&(l=""),void 0===c&&(c=o.kNone),void 0===u&&(u=null),void 0===p&&(p=null),void 0===d&&(d=5),void 0===f&&(f=!1),void 0===_&&(_=!1),void 0===g&&(g=5),void 0===m&&(m=!0),void 0===y&&(y=!0),void 0===v&&(v=1);var b=(e||this.com_).getChild(t);if(b){m&&e&&(b.removeFromParent(),this.com_.addChild(b));var C=b.asCom,S=null;3===i&&3===n?S=m?new Y(C):new q(C):2===i&&4===n?S=new K(C):2===i&&5===n?S=new W(C):2===i&&3===n?S=new X(C):4===i&&3===n&&(S=m?new Q(C):new J(C)),S&&(S.init(this.normArr_,i,n,r,a,h,f,g,l,s,y,v),S.buildSingles(),S.appendExtraFunc(u,p,c,d),_?S.showTitle():S.hideTitle(),this.navObjMap_.put(t,S),this.rcShowArr_.push(S))}else console.warn("[ExportUI _genGrid] not find component >",t)},e.prototype._genFoldPage=function(t,e,i,n,r,a,s,h,l,c,u,p,d,f,_,g,m,y){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===s&&(s=!1),void 0===h&&(h=""),void 0===l&&(l=o.kNone),void 0===c&&(c=null),void 0===u&&(u=null),void 0===p&&(p=1),void 0===d&&(d=!1),void 0===f&&(f=5),void 0===_&&(_=!1),void 0===g&&(g=5),void 0===m&&(m=null),void 0===y&&(y=null);var v=(e||this.com_).getChild(t);if(v){e&&(v.removeFromParent(),this.com_.addChild(v));var b=v.asCom,C=new Z(b);C&&(C.init(this.normArr_,3,i,n,r,s,_,g,h,a,p,d),C.buildSingles(),C.appendExtraFunc(c,u,l,f,m,y),this.navObjMap_.put(t,C),this.rcShowArr_.push(C))}else console.warn("[ExportUI _genFoldPage] not find component >",t)},e.prototype._setVisible=function(t,e,i,n){if(void 0===i&&(i=""),void 0===n&&(n=!1),this.navObjMap_.containsKey(t)){var o=this.navObjMap_.get(t);e?o.show(i,n):o.hide()}else console.warn("[ExportUI setVisible] not found this component",t)},e.prototype._fetchChecker=function(t){this.fetchTimer_-=t,this.fetchTimer_<=0&&(h.HDSDK.isDataExisted?(this._fillData(),this.bFetchedData_=!0,this.bUpdCheck_=!0,this.checkTimer_=3):(this.fetchTimer_=1+2*this.fetchCheckCnt_,++this.fetchCheckCnt_,console.log("[HDSDK UI] fetch data count",this.fetchCheckCnt_)))},e.prototype._checkUpdate=function(t){this.updCheckCnt_<5?(this.checkTimer_-=t,this.checkTimer_<=0&&(h.HDSDK.needUpdateNavData?(this._fillData(),this.bUpdCheck_=!0):(++this.updCheckCnt_,this.checkTimer_=3+5*this.updCheckCnt_))):this.bUpdCheck_=!0},e.prototype._fillData=function(){this.normArr_=this.normArr_.concat(h.HDSDK.getGridArray());var t=h.HDSDK.getLikeArray(),e=[];if(t&&t.length>0){for(var i=0;i<this.normArr_.length;++i)for(var n=this.normArr_[i],o=0;o<t.length;++o)n.sn!=t[o].sn&&n.type!=t[o].type&&e.push(t[o]);e.length>0&&(this.normArr_=this.normArr_.concat(e))}this.normArr_=this.normArr_.concat(h.HDSDK.getQRCodeArray()),this.bnrArr_=this.bnrArr_.concat(h.HDSDK.getBannerArray()),this._filterFoceNavData()},e.prototype._getNextNormNavDat=function(){var t=null;return this.normArr_[this.normDatIdx_]&&(t=this.normArr_[this.normDatIdx_],++this.normDatIdx_,this.normDatIdx_>=this.normArr_.length&&(this.normDatIdx_=0)),t},e.prototype._getNextBnrNavDat=function(){var t=null;return this.bnrArr_[this.bnrDatIdx_]&&(t=this.bnrArr_[this.bnrDatIdx_],++this.bnrDatIdx_,this.bnrDatIdx_>=this.bnrArr_.length&&(this.bnrDatIdx_=0)),t},e.prototype._filterFoceNavData=function(){this.forceNavDatArr_=[],this._readForceNavIds();for(var t=h.HDSDK.getForceNavIds,e=0;e<t.length;++e){var i=h.HDSDK.getForceNavData(t[e]);if(i)if(this.usedForceNavIds_.length>0){for(var n=!1,o=0;o<this.usedForceNavIds_.length;++o)if(i.appId===this.usedForceNavIds_[o]){n=!0;break}n||this.forceNavDatArr_.push(i),this.forceFixedNavDatArr_.push(i)}else this.forceNavDatArr_.push(i),this.forceFixedNavDatArr_.push(i)}},e.prototype._saveForceNavIds=function(){var t=new Date,e={ids:this.usedForceNavIds_,map:this.usedNavIdCntMap_,day:t.getDate()};c.default.writeJSON(c.SaveDef.kForceNav,e)},e.prototype._readForceNavIds=function(){var t=c.default.readJSON(c.SaveDef.kForceNav);t?(new Date).getDate()===t.day?(this.usedForceNavIds_=t.ids,t.map?this.usedNavIdCntMap_.copy(t.map):this.usedNavIdCntMap_.clear()):(this.usedForceNavIds_=[],this.usedNavIdCntMap_.clear()):(this.usedForceNavIds_=[],this.usedNavIdCntMap_.clear())},e.prototype._onBlockClick=function(){this.blockClickCb_&&(this.blockClickCb_(),this.blockClickCb_=null,this.block_.offClick(this._onBlockClick,this))},e.instance=new e,e}(r.BaseUI);i.ExportUI=b,i.ExportUIInst=b.instance;var C=function(){function t(t){this.com_=null,this.log_="",this.tmPosId_="",t&&(this.com_=t,this.com_.onClick(this._onClick,this),this.hide())}return t.prototype.show=function(t){void 0===t&&(t=""),this.com_&&(this.com_.visible=!0)},t.prototype.showTM=function(t){this.tmPosId_=t,this.show()},t.prototype.hide=function(){this.com_&&(this.com_.visible=!1)},t.prototype._onClick=function(){this.com_&&b.instance.showFakePage(this.log_,this.tmPosId_)},t}(),S=function(){function t(t){if(this.com_=null,this.redPnt_=null,this.rotTrans_=null,this.sclTrans_=null,this.showTrans_=null,this.hideTrans_=null,this.lastTrans_=null,this.log_="",this.tmPosId_="",t){this.com_=t;var e=t.getChild("redPnt");e&&(this.redPnt_=e.asCom),this.rotTrans_=t.getTransition("rot"),this.sclTrans_=t.getTransition("scl"),this.showTrans_=t.getTransition("show"),this.hideTrans_=t.getTransition("hide"),t.onClick(this._onClick,this),this.hide()}}return t.prototype.show=function(t){void 0===t&&(t=""),this.com_&&(this.showTrans_&&this.showTrans_.play(),this.com_.visible=!0)},t.prototype.showTM=function(t){this.tmPosId_=t,this.show()},t.prototype.hide=function(){this.com_&&(this.hideTrans_&&this.hideTrans_.play(),this.com_.visible=!1)},t.prototype.playTrans=function(t){this.lastTrans_&&this.lastTrans_.stop(),1===t?(this.rotTrans_.play(null,-1),this.lastTrans_=this.rotTrans_):2===t&&(this.sclTrans_.play(null,-1),this.lastTrans_=this.sclTrans_)},t.prototype._onClick=function(){this.com_&&(s.G.randRange(0,100)<=d.default.instance.config.exportPageTypeProb?i.ExportUIInst.showPage(this.log_,this.tmPosId_):i.ExportUIInst.showGridPage(this.log_,this.tmPosId_))},t}(),w=function(){return function(t,e){this.url="",this.completeCallback=null,this.url=t,this.completeCallback=e}}(),x=140,I=140,P=145,T=180,k=function(){function t(t){this.com_=null,this.grp_=null,this.bgImg_=null,this.iconLdr_=null,this.tag_=null,this.popTrans_=null,this.fadeTrans_=null,this.springTrans_=null,this.tagTrans_=null,this.shakeTrans_=null,this.navDat_=null,this.navSucCb_=null,this.navFailCb_=null,this.tmRefreshCb_=null,this.redPnt_=null,this.origScl_=0,this.transType_=o.kNone,this.infoDura_=-1,this.transDura_=-1,this.updTimer_=0,this.transTimer_=0,this.tagTimer_=0,this.log_="",this.bCancelJumpActive_=!0,t&&(this.com_=t,this.bgImg_=t.getChild("bgImg").asImage,this.iconLdr_=t.getChild("iconLdr").asLoader,this.tag_=t.getChild("tag").asImage,this.grp_=t.getChild("grp").asGroup,this.popTrans_=t.getTransition("pop"),this.fadeTrans_=t.getTransition("fade"),this.springTrans_=t.getTransition("spring"),this.tagTrans_=t.getTransition("tag"),this.shakeTrans_=t.getTransition("shake"),this.redPnt_=t.getChild("redPnt").asCom,this.randShowRedPoint(),this.origScl_=t.width/x,t.onClick(this._onClick,this),t.visible=!1)}return Object.defineProperty(t.prototype,"origScale",{get:function(){return this.origScl_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{set:function(t){this.grp_&&(this.grp_.alpha=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"navData",{get:function(){return this.navDat_},enumerable:!1,configurable:!0}),t.prototype.init=function(t,e,i,n){if(void 0===e&&(e=!0),void 0===i&&(i=""),void 0===n&&(n=!0),this.com_){if(this.iconLdr_.url="ui://CommUI/iconHolder",this.navDat_=t,""!=t.img){var o=new w(t.img,this._onLoadedImg.bind(this));b.instance.addToLoadQueue(o)}this.tag_.visible=1===t.tag,this.bgImg_.visible=e}},t.prototype.appendExtraFunc=function(t,e,i,n,r){void 0===i&&(i=o.kNone),void 0===n&&(n=5),void 0===r&&(r=5),this.navSucCb_=t,this.navFailCb_=e,this.transType_=i,this.infoDura_=n,this.transDura_=r},t.prototype.playTrans=function(t){t===o.kPop&&this.popTrans_?this.popTrans_.play():t===o.kFade&&this.fadeTrans_?this.fadeTrans_.play():t===o.kSpring&&this.springTrans_?this.springTrans_.play():t===o.kShake&&this.shakeTrans_&&this.shakeTrans_.play()},t.prototype.addToParent=function(t,e,i,n,o){void 0===n&&(n=-1),void 0===o&&(o=""),this.com_&&(-1!==n&&this.com_.setSize(x*n,I*n),this.com_.visible=!1,this.com_.x=e,this.com_.y=i,t.addChild(this.com_))},t.prototype.updateInfo=function(t){if(console.log("1111111111111111111111",t),this.com_){if(s.G.isTMSDK){var e=new w(t.img,this._onLoadedImg.bind(this));b.instance.addToLoadQueue(e)}else this.iconLdr_.url=t.img;this.tag_.visible=1===t.tag,this.navDat_=t,this.tagTimer_=0}},t.prototype.moveXY=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.com_&&(this.com_.x+=t,this.com_.y+=e)},t.prototype.adjustXY=function(t,e){this.com_&&this.com_.setPosition(t,e)},t.prototype.adjustSize=function(t){void 0===t&&(t=-1),this.com_&&-1!=t&&(this.com_.setSize(x*t,I*t),this.origScl_=t)},t.prototype.randShowRedPoint=function(){this.redPnt_&&(this.redPnt_.visible=s.G.randRange(0,100)>=70)},t.prototype.show=function(t,e){void 0===t&&(t=""),void 0===e&&(e=!0),this.com_&&(this.com_.visible=!0)},t.prototype.showTM=function(t){i.ExportUIInst.addToTmSingleQueue(t,this),this.com_&&(this.com_.visible=!0)},t.prototype.hide=function(){this.com_&&(this.com_.visible=!1),this.reset()},t.prototype.reset=function(){this.popTrans_.stop(),this.fadeTrans_.stop(),this.springTrans_.stop(),this.transTimer_=0,this.updTimer_=0,this.tagTimer_=0},t.prototype.update=function(t){var e=!1;return this.com_.visible&&(this.transType_!=o.kNone&&-1!==this.transDura_&&(this.transTimer_+=t,this.transTimer_>=this.transDura_&&(this.playTrans(this.transType_),this.transTimer_=0)),-1!=this.infoDura_&&(this.updTimer_+=t,this.updTimer_>=this.infoDura_&&(e=!0,this.updTimer_=0)),this.tag_.visible&&(this.tagTimer_+=t,this.tagTimer_>=5&&(this.tagTrans_.play(),this.tagTimer_=0))),e},t.prototype.clickTrigger=function(){this._onClick()},t.prototype.setCancelJumpActive=function(t){void 0===t&&(t=!0),this.bCancelJumpActive_=t},t.prototype.registerTMSDKRefreshCallback=function(t){s.G.isTMSDK&&(this.tmRefreshCb_=t)},t.prototype._onLoadedImg=function(){this.navDat_&&(this.iconLdr_.url=this.navDat_.img)},t.prototype._tmRefreshCallbackTrigger=function(t,e){this.tmRefreshCb_&&this.tmRefreshCb_(t,e)},t.prototype._onClick=function(){this.navDat_&&(s.G.isTMSDK?i.ExportUIInst.navigateTM(this.navDat_.tmPosId,this.navDat_.tmCid,this._tmRefreshCallbackTrigger.bind(this),this._onNavSucc.bind(this),this._onNavFail.bind(this)):i.ExportUIInst.navigate(this.navDat_,this._onNavSucc.bind(this),this._onNavFail.bind(this)))},t.prototype._onNavSucc=function(){this.navSucCb_&&this.navSucCb_()},t.prototype._onNavFail=function(){_.default.instance.show(),this.navFailCb_&&this.navFailCb_(),this.bCancelJumpActive_&&(s.G.randRange(0,100)<=d.default.instance.config.exportPageTypeProb?i.ExportUIInst.showPage("\u53d6\u6d88\u8df3\u8f6c\u5f39\u51fa\u72ec\u7acb\u9875\u9762"):i.ExportUIInst.showGridPage("\u53d6\u6d88\u8df3\u8f6c\u5f39\u51fa\u72ec\u7acb\u9875\u9762"))},t}(),O=3,A=function(t){function e(e){var i=t.call(this,e)||this;if(i.nameLbl_=null,i.nameBgs_=[],i.curNameBg_=null,i.bNameBg_=!1,e){i.origScl_=e.width/P,i.nameLbl_=e.getChild("nameLbl").asTextField;for(var n=0;n<O;n++){var o=e.getChild("nameBg"+(n+1)).asImage;o&&(i.nameBgs_[n]=o,o.visible=!1)}for(var r=s.G.randRange(0,i.nameBgs_.length-1),a=0;a<i.nameBgs_.length;a++){var h=i.nameBgs_[a];h&&(a===r?(i.curNameBg_=h,i.curNameBg_.visible=!0):h.visible=!1)}}return i}return n(e,t),e.prototype.init=function(e,i,n,o){if(void 0===i&&(i=!0),void 0===n&&(n=""),void 0===o&&(o=!0),this.com_){t.prototype.init.call(this,e,i),this.bNameBg_=o,this.curNameBg_&&(this.curNameBg_.visible=o),this.nameLbl_.text=e.name;var r=o?18:24;if(this.nameLbl_.fontSize=Math.round(r*this.origScl_),""!=n){var a=parseInt(n.substr(0,2),16),s=parseInt(n.substr(2,2),16),h=parseInt(n.substr(2,2),16);this.nameLbl_.color=new cc.Color(a,s,h,255)}}},e.prototype.addToParent=function(t,e,i,n){if(void 0===n&&(n=1),this.com_){-1!==n&&this.com_.setSize(P*n,T*n),this.com_.visible=!1,this.com_.setPosition(e,i),t.addChild(this.com_);var o=this.bNameBg_?18:24;this.nameLbl_.fontSize=Math.round(o*this.origScl_)}},e.prototype.adjustSize=function(t){if(void 0===t&&(t=-1),this.com_&&-1!==t){this.com_.setSize(P*t,T*t);var e=this.bNameBg_?18:24;this.nameLbl_.fontSize=Math.round(e*this.origScl_),this.origScl_=t}},e.prototype.updateInfo=function(e){t.prototype.updateInfo.call(this,e),this.com_&&(this.nameLbl_.text=e.name)},e}(k),B=310,D=function(t){function e(e){var i=t.call(this,e)||this;return i.origScl_=e.width/B,i}return n(e,t),e.prototype.init=function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=""),this.com_){if(this.iconLdr_.url="ui://CommUI/iconHolder",this.navDat_=t,""!=t.img){var n=new w(t.bnrUrl,this._onLoadedImg.bind(this));b.instance.addToLoadQueue(n)}this.tag_.visible=1===t.tag,this.bgImg_.visible=e}},e.prototype.addToParent=function(t,e,i,n,o){void 0===n&&(n=1),void 0===o&&(o=""),this.com_&&(-1!==n&&this.com_.setSize(B*n,120*n),this.com_.visible=!1,this.com_.setPosition(e,i),t.addChild(this.com_))},e.prototype.adjustSize=function(t){void 0===t&&(t=-1),this.com_&&-1!==t&&(this.com_.setSize(B*t,120*t),this.origScl_=t)},e.prototype.updateInfo=function(t){if(this.com_){if(s.G.isTMSDK){var e=new w(t.img,this._onLoadedImg.bind(this));b.instance.addToLoadQueue(e)}else this.iconLdr_.url=t.bnrUrl;this.tag_.visible=1===t.tag,this.navDat_=t,this.tagTimer_=0}},e.prototype._onLoadedImg=function(){this.navDat_&&(this.iconLdr_.url=this.navDat_.bnrUrl)},e}(k),M=240,j=function(t){function e(e){var i=t.call(this,null)||this;return e&&(i.com_=e,i.iconLdr_=e.getChild("iconLdr").asLoader,i.grp_=e.getChild("grp").asGroup,i.popTrans_=e.getTransition("pop"),i.fadeTrans_=e.getTransition("fade"),i.springTrans_=e.getTransition("spring"),i.tagTrans_=e.getTransition("tag"),i.origScl_=e.width/M,e.onClick(i._onClick,i),e.visible=!1),i}return n(e,t),e.prototype.init=function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=""),this.com_&&(this.iconLdr_.url="ui://CommUI/iconHolder",this.navDat_=t,""!=t.img)){var n=new w(t.img,this._onLoadedImg.bind(this));b.instance.addToLoadQueue(n)}},e.prototype.updateInfo=function(t){if(this.com_){if(s.G.isTMSDK){var e=new w(t.img,this._onLoadedImg.bind(this));b.instance.addToLoadQueue(e)}else this.iconLdr_.url=t.img;this.navDat_=t}},e.prototype.addToParent=function(t,e,i,n,o){void 0===n&&(n=1),void 0===o&&(o=""),this.com_&&(-1!==n&&this.com_.setSize(M*n,100*n),this.com_.visible=!1,this.com_.setPosition(e,i),t.addChild(this.com_))},e.prototype.adjustSize=function(t){void 0===t&&(t=-1),this.com_&&-1!==t&&(this.com_.setSize(M*t,100*t),this.origScl_=t)},e.prototype.update=function(t){var e=!1;return this.com_.visible&&(this.transType_!=o.kNone&&-1!==this.transDura_&&(this.transTimer_+=t,this.transTimer_>=this.transDura_&&(this.playTrans(this.transType_),this.transTimer_=0)),-1!=this.infoDura_&&(this.updTimer_+=t,this.updTimer_>=this.infoDura_&&(e=!0,this.updTimer_=0))),e},e}(k),R=function(t){function e(e){var i=t.call(this,null)||this;return i.nameLbl_=null,e&&(i.com_=e,i.iconLdr_=e.getChild("iconLdr").asLoader,i.tag_=e.getChild("tag").asImage,i.nameLbl_=e.getChild("nameLbl").asTextField,e.onClick(i._onClick,i),e.visible=!1),i}return n(e,t),e.prototype.init=function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=""),this.com_){if(this.iconLdr_.url="ui://CommUI/iconHolder",this.navDat_=t,""!=t.img){var n=new w(t.img,this._onLoadedImg.bind(this));b.instance.addToLoadQueue(n)}this.tag_.visible=1===t.tag,this.nameLbl_.text=t.name}},e.prototype.appendExtraFunc=function(t,e,i,n,r){void 0===i&&(i=o.kNone),void 0===n&&(n=5),void 0===r&&(r=5),this.navSucCb_=t,this.navFailCb_=e},e.prototype.playTrans=function(t){},e.prototype.addToParent=function(t,e,i,n,o){void 0===n&&(n=-1),void 0===o&&(o=""),this.com_&&(this.com_.visible=!1,this.com_.setPosition(e,i),t.addChild(this.com_))},e.prototype.updateInfo=function(t){if(this.com_){if(s.G.isTMSDK){var e=new w(t.img,this._onLoadedImg.bind(this));b.instance.addToLoadQueue(e)}else this.iconLdr_.url=t.img;this.tag_.visible=1===t.tag,this.nameLbl_.text=t.name,this.navDat_=t}},e.prototype.moveXY=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0)},e.prototype.adjustXY=function(t,e){},e.prototype.adjustSize=function(t){void 0===t&&(t=-1)},e.prototype.show=function(t,e){void 0===t&&(t=""),void 0===e&&(e=!0),this.com_&&(this.com_.visible=!0)},e.prototype.hide=function(){this.com_&&(this.com_.visible=!1)},e.prototype.reset=function(){},e.prototype.update=function(t){return!1},e.prototype._onLoadedImg=function(){this.navDat_&&(this.iconLdr_.url=this.navDat_.img)},e.prototype._onClick=function(){this.navDat_&&(s.G.isTMSDK?i.ExportUIInst.navigateTM(this.navDat_.tmPosId,this.navDat_.tmCid,this._tmRefreshCallbackTrigger.bind(this),this._onNavSucc.bind(this),this._onNavFail.bind(this)):i.ExportUIInst.navigate(this.navDat_,this._onNavSucc.bind(this),this._onNavFail.bind(this)))},e.prototype._onNavSucc=function(){this.navSucCb_&&this.navSucCb_()},e.prototype._onNavFail=function(){this.navFailCb_&&this.navFailCb_()},e}(k),L=100,N=function(t){function e(e){var i=t.call(this,null)||this;if(i.mask_=null,e){i.com_=e,i.bgImg_=e.getChild("bgImg").asImage;var n=e.getChild("iconLdr");if(n){var o=n;i.iconLdr_=o.getChild("iconLdr").asLoader,i.mask_=o.getChild("mask").asGraph}i.tag_=e.getChild("tag").asImage,i.grp_=e.getChild("grp").asGroup,i.popTrans_=e.getTransition("pop"),i.fadeTrans_=e.getTransition("fade"),i.springTrans_=e.getTransition("spring"),i.tagTrans_=e.getTransition("tag"),i.shakeTrans_=e.getTransition("shake"),i.nameLbl_=e.getChild("nameLbl").asTextField,i.origScl_=e.width/L,e.onClick(i._onClick,i),e.visible=!1}return i}return n(e,t),e.prototype.addToParent=function(t,e,i,n){if(void 0===n&&(n=1),this.com_){-1!==n&&this.com_.setSize(L*n,140*n),this.com_.visible=!1,this.com_.setPosition(e,i),t.addChild(this.com_);var o=this.bNameBg_?18:24;this.nameLbl_.fontSize=Math.round(o*this.origScl_)}},e.prototype.adjustSize=function(t){if(void 0===t&&(t=-1),this.com_&&-1!==t){this.com_.setSize(L*t,140*t);var e=this.bNameBg_?18:24;this.nameLbl_.fontSize=Math.round(e*this.origScl_),this.origScl_=t}},e.prototype.playTrans=function(t){},e}(A),E=function(t){function e(e){var i=t.call(this,e)||this;return i.cntLbl_=null,i.cntLbl_=e.getChild("cntLbl").asTextField,i}return n(e,t),e.prototype.randomCount=function(t){void 0===t&&(t=!0);var e="";e=t?s.G.randRange(90,300).toString():s.G.randRangeF(.5,3).toFixed(2),this.cntLbl_.text=e+"\u4e07\u4eba\u5728\u73a9"},e.prototype.addToParent=function(t,e,i,n){if(void 0===n&&(n=1),this.com_){-1!==n&&this.com_.setSize(P*n,200*n),this.com_.visible=!1,this.com_.setPosition(e,i),t.addChild(this.com_);var o=this.bNameBg_?18:24;this.nameLbl_.fontSize=Math.round(o*this.origScl_)}},e.prototype.adjustSize=function(t){if(void 0===t&&(t=-1),this.com_&&-1!==t){this.com_.setSize(P*t,200*t);var e=this.bNameBg_?18:24;this.nameLbl_.fontSize=Math.round(e*this.origScl_),this.origScl_=t}},e}(A),G=function(){function t(t){var e=this;if(this.com_=null,this.clipArea_=null,this.scrollArea_=null,this.row_=0,this.col_=0,this.rowPitch_=0,this.colPitch_=0,this.wid_=0,this.hgt_=0,this.helpScl_=0,this.origScl_=0,this.moveDist_=0,this.updDura_=0,this.updTimer_=0,this.navItemArr_=[],this.navDatArr_=[],this.navDatIdx_=0,this.log_="",this.nameClr_="",this.bScroll_=!1,this.bName_=!1,this.bFrame_=!1,this.bNameBg_=!0,this.missDownX_=-1,this.missDownY_=-1,this.bMissingClick_=!1,this._firstColl=!0,this.scollNum=0,t){this.com_=t,t.visible=!1;var i=t.getChild("clipFrame");i&&(this.clipArea_=i.asCom,this.clipArea_.on(fgui.Event.SCROLL,this._onScrolling,this),this.clipArea_.on(fgui.Event.SCROLL_END,this._onScrollEnd,this),this.scrollArea_=this.clipArea_,p.TimedTaskInst.add(function(){e.bScroll_=!1},.5),this.wid_=t.width,this.hgt_=t.height)}}return t.prototype.init=function(t,e,i,n,o,r,a,s,h,l){void 0===e&&(e=1),void 0===i&&(i=4),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===s&&(s=2),void 0===h&&(h=""),void 0===l&&(l=0),this.navDatArr_=t,l<0?l=0:l>t.length&&2===e&&3===i&&(this.scrollArea_.scrollPane.touchEffect=!1),this.navDatIdx_=l,this.row_=e,this.col_=i,this.rowPitch_=n,this.colPitch_=o,this.updDura_=s,this.nameClr_=h,this.bName_=r,this.bFrame_=a,this.wid_=this.com_.width,this.hgt_=this.com_.height},t.prototype.addToParent=function(t,e,i,n){void 0===n&&(n=-1),this.com_&&(-1!==n&&(this.com_.setSize(this.wid_*n,this.hgt_*n),this.origScl_=n),this.com_.visible=!1,this.com_.setPosition(e,i),this.buildSingles(),t.addChild(this.com_))},t.prototype.buildSingles=function(t){},t.prototype.appendExtraFunc=function(t,e,i,n){void 0===i&&(i=o.kNone),void 0===n&&(n=5);for(var r=0;r<this.navItemArr_.length;++r)this.navItemArr_[r].appendExtraFunc(t,e,i,-1,s.G.randRange(1,n))},t.prototype.adjustXY=function(t,e){this.com_&&this.com_.setPosition(t,e)},t.prototype.adjustSize=function(t){void 0===t&&(t=-1),this.com_&&-1!=t&&(this.origScl_=t,this.com_.setSize(this.wid_*t,this.hgt_*t))},t.prototype.show=function(t,e){void 0===t&&(t=""),void 0===e&&(e=!1),this.scollNum=0,this.bScroll_=!1,this._firstColl=!0,this.com_&&(this.com_.visible=!0,this.scrollArea_.node.on(cc.Node.EventType.TOUCH_START,this._onDown,this),this.scrollArea_.node.on(cc.Node.EventType.TOUCH_MOVE,this._onMove,this),this.scrollArea_.node.on(cc.Node.EventType.TOUCH_END,this._onUp,this))},t.prototype.showTM=function(t){var e=this;this.scollNum=0,this.bScroll_=!1,this._firstColl=!0,wx.tmSDK.getFlowConfig({positionId:t}).then(function(t){if(t.isOpen){console.log("[RCShow] download data");var i=t.creatives;i&&(e._tmSdkDataProc(i),e.com_&&(e.com_.visible=!0,e.scrollArea_.node.on(cc.Node.EventType.TOUCH_START,e._onDown,e),e.scrollArea_.node.on(cc.Node.EventType.TOUCH_MOVE,e._onMove,e),e.scrollArea_.node.on(cc.Node.EventType.TOUCH_END,e._onUp,e)))}})},t.prototype.hide=function(){this.com_&&(this.com_.visible=!1,this.scrollArea_.node.off(cc.Node.EventType.TOUCH_START,this._onDown,this),this.scrollArea_.node.off(cc.Node.EventType.TOUCH_MOVE,this._onMove,this),this.scrollArea_.node.off(cc.Node.EventType.TOUCH_END,this._onUp,this));for(var t=0;t<this.navItemArr_.length;++t)this.navItemArr_[t].reset();this.updTimer_=0},t.prototype.update=function(t){if(this.com_.visible&&this.navItemArr_.length>0){for(var e=0;e<this.navItemArr_.length;++e)this.navItemArr_[e].update(t);this.bScroll_||(this.updTimer_+=t,this.updTimer_>=this.updDura_&&(s.G.isTMSDK||this._randomInfo(),this.updTimer_=0))}},t.prototype._onDown=function(t){this.bMissingClick_=!0,this._firstColl&&(this._firstColl=!1,this.missDownX_=t.getLocationX(),this.missDownY_=t.getLocationY(),this.bMissingClick_=!1)},t.prototype._onMove=function(t){if(this._firstColl=!1,-1!=this.missDownX_&&-1!=this.missDownY_){var e=Math.abs(t.getLocationX()-this.missDownX_),i=Math.abs(t.getLocationY()-this.missDownY_);if((e>10||i>10)&&!this.bMissingClick_){if(s.G.randRange(0,100)<=d.default.instance.config.fakeBtnClick){var n=t.getLocationX(),o=t.getLocationY();o=cc.view.getVisibleSize().height-o;var r=this.scrollArea_.localToGlobal().x,a=this.scrollArea_.localToGlobal().y,h=this.scrollArea_.width,l=this.scrollArea_.height;if(o>a&&o<a+l&&n>r&&r<r+h){var c=this.scrollArea_.getFirstChildInView();n<r?n=r:n>r+h&&(n=r+h),o<a?o=a:o>a+l&&(o=a+l);var u=h/this.col_,p=l/this.row_,f=Math.floor((n-r)/u),_=Math.floor((o-a)/p),g=this.navItemArr_[c+f+3*_];g&&g.clickTrigger()}}this.bMissingClick_=!0}}},t.prototype._onUp=function(){this._firstColl=!1,this.missDownX_=-1,this.missDownY_=-1,this.bMissingClick_=!0},t.prototype._randomInfo=function(){if(this.navDatArr_.length>0){this.navDatIdx_=s.G.randRange(0,this.navDatArr_.length-1);for(var t=0;t<this.navItemArr_.length;++t){var e=this._getNextNavData();e&&this.navItemArr_[t].updateInfo(e)}}},t.prototype._createSingle=function(t,e,i,n,o){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===o&&(o=1);var r=this._getNextNavData();if(r){var a=this.origScl_*o,s=null;if(i){var h=fgui.UIPackage.createObject("HDSDK","NavItemEx").asCom;(s=new A(h)).init(r,n,this.nameClr_),s.addToParent(this.clipArea_,(e*P+e*this.colPitch_)*a,(t*T+t*this.rowPitch_)*a,a),s.show(),s.registerTMSDKRefreshCallback(this._tmRefreshCallback.bind(this))}else{h=fgui.UIPackage.createObject("HDSDK","NavItem").asCom;(s=new k(h)).init(r,n),s.addToParent(this.clipArea_,(e*x+e*this.colPitch_)*a,(t*I+t*this.rowPitch_)*a,a),s.show(),s.registerTMSDKRefreshCallback(this._tmRefreshCallback.bind(this))}s&&this.navItemArr_.push(s)}},t.prototype._tmRefreshCallback=function(t,e){var i=t;i&&(console.log("[RCShow _tmRefreshCallback]"),this._tmSdkDataProc(i))},t.prototype._tmSdkDataProc=function(t){this.navDatArr_.length!=t.length&&(console.log("[RCShow _tmSdkDataProc] data length different"),this.navDatArr_=[],this.navItemArr_=[],this.scrollArea_.removeChildren());for(var e=0;e<t.length;++e){var i=null;i=this.navItemArr_.length>0&&this.navDatArr_[e]||new h.HDNavData,t[e].show_config&&(i.img=t[e].show_config.image,i.name=t[e].show_config.title),i.tmPosId=t[e].positionId,i.tmCid=t[e].creativeId,this.navDatArr_[e]||this.navDatArr_.push(i)}if(this.navItemArr_.length>0)for(e=0;e<this.navItemArr_.length;++e){(i=this._getNextNavData())&&this.navItemArr_[e].updateInfo(i)}else this.buildSingles()},t.prototype._getNextNavData=function(){var t=null;return this.navDatArr_.length>0&&(t=this.navDatArr_[this.navDatIdx_],++this.navDatIdx_,this.navDatIdx_>=this.navDatArr_.length&&(this.navDatIdx_=0)),t},t.prototype._onScrolling=function(){this.scollNum++,1!=this.scollNum&&this.updTimer_>0&&(this.bScroll_=!0)},t.prototype._onScrollEnd=function(){this.bScroll_=!1,this.updTimer_=0},t.prototype.setNameBgVisible=function(t){void 0===t&&(t=!0),this.bNameBg_=t},t}(),F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,h,l,c,u){void 0===i&&(i=1),void 0===n&&(n=4),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===h&&(h=!1),void 0===l&&(l=2),void 0===c&&(c=""),void 0===u&&(u=0);var p=i;if(this.origScl_=a?this.hgt_/200/p:this.hgt_/160/p,this.helpScl_=this.wid_/580/p,t.prototype.init.call(this,e,p,n,o,r,a,h,l,c,u),this.origScl_>=1&&!s.G.isEqualF(this.origScl_,this.helpScl_))this.helpScl_;else if(this.origScl_<1)this.origScl_;var d=this.bName_?P:x;this.moveDist_=(d+this.colPitch_)*this.origScl_},e.prototype.buildSingles=function(t){if(t&&(this.origScl_*=t),this.navDatArr_.length>0){for(var e=Math.ceil(this.navDatArr_.length/this.row_),i=0;i<this.navDatArr_.length;++i){var n=Math.floor(i/e),o=i%e;this._createSingle(n,o,this.bName_,this.bFrame_)}this.scrollArea_.scrollPane.scrollLeft()}},e.prototype.update=function(t){if(this.com_.visible&&this.navItemArr_.length>0){for(var e=0;e<this.navItemArr_.length;++e)this.navItemArr_[e].update(t);this.bScroll_||(this.updTimer_+=t,this.updTimer_>=this.updDura_&&(this.bScroll_=!0,this.updTimer_=0,1==this.scrollArea_.scrollPane.percX?this.scrollArea_.scrollPane.scrollLeft(this.navItemArr_.length,!0):(this.scrollArea_.scrollPane.scrollStep=this.moveDist_,this.scrollArea_.scrollPane.scrollRight(1,!0))))}},e}(G),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,s,h,l,c){void 0===i&&(i=1),void 0===n&&(n=4),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===h&&(h=2),void 0===l&&(l=""),void 0===c&&(c=0),t.prototype.init.call(this,e,i,n,o,r,a,s,h,l,c),this.moveDist_=(L+this.colPitch_)*this.origScl_},e.prototype._createSingle=function(t,e,i,n,o){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===o&&(o=1);var r=this._getNextNavData();if(r){var a=this.origScl_*o,s=fgui.UIPackage.createObject("HDSDK","NavLikeEx").asCom,h=new N(s);h.init(r,n,this.nameClr_),h.addToParent(this.clipArea_,(e*L+e*this.colPitch_)*a,(140*t+t*this.rowPitch_)*a,a),h.show(),h.registerTMSDKRefreshCallback(this._tmRefreshCallback.bind(this)),h&&this.navItemArr_.push(h)}},e}(F),z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,h,l,c,u){void 0===i&&(i=1),void 0===n&&(n=4),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===h&&(h=!1),void 0===l&&(l=2),void 0===c&&(c=""),void 0===u&&(u=0);var p=n;n>1&&(p=1),this.origScl_=this.wid_/160;var d=a?700:580;this.helpScl_=this.hgt_/d,t.prototype.init.call(this,e,i,p,o,r,a,h,l,c,u);var f=s.G.isEqualF(this.origScl_,this.helpScl_);if(this.origScl_>=1&&!f){var _=10*(2-this.helpScl_);this.clipArea_.height=this.hgt_-2*(10+_)}else if(this.origScl_<1){_=10*((f?1:2)-this.origScl_);this.clipArea_.height=this.hgt_-2*(10+_),this.clipArea_.y+=_}},e.prototype.buildSingles=function(){if(this.navDatArr_.length>0){for(var t=0;t<this.navDatArr_.length;++t)this._createSingle(t,0,this.bName_,this.bFrame_);var e=0;e=this.bName_?(T+this.rowPitch_)*this.origScl_:(I+this.rowPitch_)*this.origScl_,this.scrollArea_.scrollPane.scrollStep=e,this.scrollArea_.scrollPane.scrollUp()}},e.prototype.update=function(t){if(this.com_.visible&&this.navItemArr_.length>0){for(var e=0;e<this.navItemArr_.length;++e)this.navItemArr_[e].update(t);this.bScroll_||(this.updTimer_+=t,this.updTimer_>=this.updDura_&&(this.bScroll_=!0,this.updTimer_=0,1==this.scrollArea_.scrollPane.percX?this.scrollArea_.scrollPane.scrollTop(!0):(this.bName_?this.moveDist_=(T+this.rowPitch_)*this.origScl_:this.moveDist_=(I+this.rowPitch_)*this.origScl_,this.scrollArea_.scrollPane.scrollStep=this.moveDist_,this.scrollArea_.scrollPane.scrollDown(1,!0))))}},e}(G),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,s,h,l,c){void 0===i&&(i=3),void 0===n&&(n=2),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===h&&(h=5),void 0===l&&(l=""),void 0===c&&(c=0);var u=n;(n>2||n<2)&&(u=2);var p=this.wid_/300,d=this.hgt_/(a?530:440);this.origScl_=Math.min(p,d),t.prototype.init.call(this,e,i,u,o,r,a,s,h,l,c)},e.prototype.buildSingles=function(){if(this.navDatArr_.length>0)for(var t=0,e=0,i=0;i<this.navDatArr_.length;++i)this._createSingle(t,e,this.bName_,this.bFrame_),++e>=this.col_&&(++t,e=0)},e}(G),V=function(t){function e(e){var i=t.call(this,e)||this;return i.titleImg_=null,i.bg_=null,i.titleImg_=e.getChild("titleImg").asImage,i.bg_=e.getChild("bg").asImage,i}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,s,h,l,c,u,p){void 0===i&&(i=2),void 0===n&&(n=4),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===h&&(h=5),void 0===l&&(l=""),void 0===c&&(c=0),void 0===u&&(u=!0),void 0===p&&(p=1),t.prototype.init.call(this,e,i,n,o,r,a,s,h,l,c);var d=a?T:I;this.hgt_=(d*i+20+o*(i-1)+60)*this.origScl_,this.bg_&&(this.bg_.visible=u)},e.prototype.show=function(e,i){void 0===e&&(e=""),void 0===i&&(i=!1),t.prototype.show.call(this,e,i),this.clipArea_.scrollPane.scrollTop(!0),this._randomInfo()},e.prototype.showTM=function(e){t.prototype.showTM.call(this,e),this.clipArea_.scrollPane.scrollTop(!0)},e.prototype.showTitle=function(){this.titleImg_&&(this.titleImg_.visible=!0)},e.prototype.hideTitle=function(){this.titleImg_&&(this.titleImg_.visible=!1)},e.prototype.update=function(t){this.bScroll_||(this.updTimer_+=t,this.updTimer_>=this.updDura_&&(this.bScroll_=!0,this.updTimer_=0,1==this.clipArea_.scrollPane.percY?this.clipArea_.scrollPane.scrollTop(!0):(this.clipArea_.scrollPane.scrollStep=(T+$)*tt,this.clipArea_.scrollPane.scrollDown(1,!0))))},e.prototype.buildSingles=function(){if(this.navDatArr_.length>0){var t=this.bName_?T:I,e=this.clipArea_.height-t*this.row_*this.origScl_;if(this.rowPitch_<0){var i=e*this.origScl_/this.row_;this.rowPitch_+=i}else{var n=this.row_-1;n<=0&&(n=1),this.rowPitch_+=e*this.origScl_/n}for(var o=0,r=0,a=0;a<this.navDatArr_.length;++a)this._createSingle(o,r,this.bName_,this.bFrame_),++r>=this.col_&&(++o,r=0)}},e}(G),K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,s,h,l,c){void 0===i&&(i=2),void 0===n&&(n=4),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===h&&(h=5),void 0===l&&(l=""),void 0===c&&(c=0);var u=n;4!==n&&(u=4);var p=i;2!==i&&(p=2);var d=this.wid_/580,f=this.hgt_/(a?430:360);this.origScl_=Math.min(d,f),t.prototype.init.call(this,e,p,u,o,r,a,s,h,l,c)},e}(V),W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,s,h,l,c){void 0===i&&(i=2),void 0===n&&(n=5),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===h&&(h=5),void 0===l&&(l=""),void 0===c&&(c=0);var u=n;5!==n&&(u=5);var p=i;2!==i&&(p=2);var d=this.wid_/720,f=this.hgt_/(a?430:360);this.origScl_=Math.min(d,f),t.prototype.init.call(this,e,p,u,o,r,a,s,h,l,c)},e}(V),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,s,h,l,c,u){void 0===i&&(i=2),void 0===n&&(n=3),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===h&&(h=5),void 0===l&&(l=""),void 0===c&&(c=0),void 0===u&&(u=!0);var p=n;3!==n&&(p=3);var d=i;2!==i&&(d=2);var f=this.wid_/475,_=this.hgt_/(a?440:360);this.origScl_=Math.min(f,_),t.prototype.init.call(this,e,d,p,o,r,a,s,h,l,c,u)},e}(V),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,s,h,l,c,u,p){void 0===i&&(i=3),void 0===n&&(n=3),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===h&&(h=5),void 0===l&&(l=""),void 0===c&&(c=0),void 0===u&&(u=!0),void 0===p&&(p=1);var d=n;3!==n&&(d=3);var f=i;3!==i&&(f=3);this.wid_,this.hgt_;this.origScl_=p,t.prototype.init.call(this,e,f,d,o,r,a,s,h,l,c)},e}(V),Y=function(t){function e(e){var i=t.call(this,e)||this;if(i.block_=null,e){i.block_=e.getChild("block").asCom,i.block_.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height);var n=b.instance.getCenterXY(),o=i.block_.localToGlobal(),r=n.x-o.x,a=n.y-o.y,s=i.block_.x,h=i.block_.y;i.block_.setPosition(s+r,h+a),i.block_.onClick(i._onClick,i)}return i}return n(e,t),e.prototype.show=function(e,i){void 0===e&&(e=""),void 0===i&&(i=!1),t.prototype.show.call(this,e,i),this.block_.visible=!0},e.prototype._onClick=function(){this.block_.visible=!1,this.hide()},e}(q),J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,s,h,l,c){void 0===i&&(i=4),void 0===n&&(n=3),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===h&&(h=5),void 0===l&&(l=""),void 0===c&&(c=0);var u=n;3!==n&&(u=3);var p=i;4!==i&&(p=4);this.wid_,this.hgt_;this.origScl_=1.05,t.prototype.init.call(this,e,p,u,o,r,a,s,h,l,c)},e}(V),Q=function(t){function e(e){var i=t.call(this,e)||this;if(i.block_=null,e){i.block_=e.getChild("block").asCom,i.block_.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height);var n=b.instance.getCenterXY(),o=i.block_.localToGlobal(),r=n.x-o.x,a=n.y-o.y,s=i.block_.x,h=i.block_.y;i.block_.setPosition(s+r,h+a),i.block_.onClick(i._onClick,i)}return i}return n(e,t),e.prototype.show=function(e,i){void 0===e&&(e=""),void 0===i&&(i=!1),t.prototype.show.call(this,e,i),this.block_.visible=!0},e.prototype._onClick=function(){this.block_.visible=!1,this.hide()},e}(J),Z=function(t){function e(e){var i=t.call(this,e)||this;return i.unfoldCallback_=null,i.foldCallback_=null,i.iconScl_=1,i.btnOrigY_=0,i.btnDistY_=0,i.btnDestY_=0,i.foldState_=0,i.bUnfolded_=!1,i.bMirrow_=!1,i.bAuto_=!1,i.autoFoldTimer_=0,e&&(i.foldBtn_=e.getChild("foldBtn").asButton,i.btnTrans_=i.foldBtn_.getTransition("spring"),i.btnCtrl_=i.foldBtn_.getController("arrow"),i.btnOrigY_=i.foldBtn_.y,i.foldBtn_.onClick(i._onClick,i)),i}return n(e,t),e.prototype.init=function(e,i,n,o,r,a,s,h,l,c,u,p){void 0===i&&(i=3),void 0===n&&(n=3),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===h&&(h=5),void 0===l&&(l=""),void 0===c&&(c=0),void 0===u&&(u=1),void 0===p&&(p=!1);var d=n;n<2?d=2:n>3&&(d=3);var f=this.wid_/570,_=this.hgt_/(a?540:440);this.iconScl_=u,1==this.iconScl_?this.origScl_=Math.min(f,_):this.origScl_=1,t.prototype.init.call(this,e,i,d,o,r,a,s,h,l,c),this.bMirrow_=p},e.prototype.appendExtraFunc=function(t,e,i,n,r,a){void 0===i&&(i=o.kNone),void 0===n&&(n=5),void 0===r&&(r=null),void 0===a&&(a=null);for(var h=0;h<this.navItemArr_.length;++h)this.navItemArr_[h].appendExtraFunc(t,e,i,-1,s.G.randRange(1,5));this.foldCallback_=r,this.unfoldCallback_=a},e.prototype.show=function(e,i){void 0===e&&(e=""),void 0===i&&(i=!1),t.prototype.show.call(this,e,i),this.btnTrans_.play(null,-1)},e.prototype.showTM=function(e){t.prototype.showTM.call(this,e),this.btnTrans_.play(null,-1)},e.prototype.hide=function(){t.prototype.hide.call(this),this.btnTrans_.stop()},e.prototype.autoUnfold=function(){this._onClick(),this.bAuto_=!0,this.autoFoldTimer_=0},e.prototype.fold=function(){2==this.foldState_&&this._onClick()},e.prototype.update=function(t){if(this.com_.visible){if(1==this.foldState_)this.moveDist_=this.moveDist_/2,this.bMirrow_?this.com_.x-=this.moveDist_:this.com_.x+=this.moveDist_,Math.abs(this.moveDist_)<=5&&(this.foldState_=2,this.bMirrow_?this.com_.x=this.com_.parent.width-this.com_.width:this.com_.x=0,this.btnCtrl_.selectedIndex=1,this.btnTrans_.stop(),b.instance.block(!0,this._onClick.bind(this)),this.unfoldCallback_&&this.unfoldCallback_());else if(2==this.foldState_){if(this.bAuto_&&(this.autoFoldTimer_+=t,this.autoFoldTimer_>=5&&(this.bAuto_=!1)),this.navItemArr_.length>0){for(var e=0;e<this.navItemArr_.length;++e)this.navItemArr_[e].update(t);this.bScroll_||(this.updTimer_+=t,this.updTimer_>=this.updDura_&&(this.bScroll_=!0,this.updTimer_=0,1==this.clipArea_.scrollPane.percY?this.clipArea_.scrollPane.scrollTop(!0):(this.bName_?this.moveDist_=(T+this.rowPitch_)*this.origScl_:this.moveDist_=(I+this.rowPitch_)*this.origScl_,this.clipArea_.scrollPane.scrollStep=this.moveDist_,this.clipArea_.scrollPane.scrollDown(1,!0))))}}else 3==this.foldState_&&(this.moveDist_=this.moveDist_/2,this.bMirrow_?this.com_.x+=this.moveDist_:this.com_.x-=this.moveDist_,Math.abs(this.moveDist_)<=5&&(this.foldState_=0,this.bMirrow_?this.com_.x=this.com_.parent.width-this.foldBtn_.width:this.com_.x=-this.com_.width+this.foldBtn_.width,this.btnCtrl_.selectedIndex=0,this.btnTrans_.play(null,-1),b.instance.unblock(),this.foldCallback_&&this.foldCallback_()));0!=this.btnDistY_&&(this.btnDistY_=this.btnDistY_/2,this.foldBtn_.y+=this.btnDistY_,Math.abs(this.foldBtn_.y-this.btnDestY_)<=2&&(this.foldBtn_.y=this.btnDestY_,this.btnDistY_=0))}},e.prototype.buildSingles=function(){if(this.navDatArr_.length>0){var t=this.bName_?T:I,e=this.clipArea_.height-t*this.row_*this.origScl_;if(this.rowPitch_<0){var i=e*this.origScl_/this.row_;this.rowPitch_+=i}else{var n=this.row_-1;n<=0&&(n=1),this.rowPitch_+=e*this.origScl_/n}for(var o=0,r=0,a=0;a<this.navDatArr_.length;++a)this._createSingle(o,r,this.bName_,this.bFrame_,this.iconScl_),++r>=this.col_&&(++o,r=0)}},e.prototype._onClick=function(){0!==this.foldState_&&2!==this.foldState_||(this.bUnfolded_?(this.foldState_=3,this.moveDist_=this.com_.width-130,this.btnDistY_=this.btnOrigY_-this.foldBtn_.y,this.btnDestY_=this.btnOrigY_,this.bUnfolded_=!1,this.bAuto_&&(this.bAuto_=!1,this.autoFoldTimer_=0)):(s.G.isTMSDK||this._randomInfo(),this.foldState_=1,this.moveDist_=this.com_.width-130,this.btnDistY_=10-this.btnOrigY_,this.btnDestY_=10,this.bUnfolded_=!0,this.bAuto_&&(this.bAuto_=!1,this.autoFoldTimer_=0)))},e}(G),$=10,tt=1.37,et=!0,it=!0,nt=function(){function t(t){var e=this;if(void 0===t&&(t=!1),this.com_=null,this.topScroll_=null,this.midScroll_=null,this.blockCom_=null,this.closeBtn_=null,this.continueGameBtn_=null,this.showTrans_=null,this.navDatArr_=[],this.topNavIdx_=0,this.midNavIdx_=0,this.topNavItems_=[],this.midNavItems_=[],this.showTransIdx_=0,this.transRandIdxArr_=[],this.showTimer_=0,this.stepTimer_=0,this.bShowItems_=!1,this.midGrids_=0,this.colPitch_=0,this.bName_=!1,this.nameClr_="",this.updTopTimer_=0,this.updMidTimer_=0,this.bTopScroll_=!1,this.bMidScroll_=!1,this.bMidDown_=!0,this.missDownX_=-1,this.missDownY_=-1,this.bMissingClick_=!1,this.bInited_=!1,this.bClicked_=!1,this.bBnrJumping_=!1,this.bBnrJump_=!1,this.bExportMissClick_=!1,this.firstColl_=!1,this.bBnrMissClick_=!1,this.midMoveSpd_=0,!t){this.bExportMissClick_=et,this.bBnrMissClick_=it;var i=fgui.UIPackage.createObject("HDSDK","VerPage");if(i){this.com_=i.asCom,this.com_.visible=!1,i.sortingOrder=r.UIHierarchy.kExportPage;var n=this.com_.getChild("top").asCom;n&&(this.topScroll_=n.getChild("list").asCom,this.topScroll_.on(fgui.Event.SCROLL,this._onTopScrolling,this),this.topScroll_.on(fgui.Event.SCROLL_END,this._onTopScrollEnd,this));var o=this.com_.getChild("scroll");o&&(this.midScroll_=o.asCom,this.midScroll_.on(fgui.Event.SCROLL,this._onMidScrolling,this),this.midScroll_.on(fgui.Event.SCROLL_END,this._onMidScrollEnd,this)),p.TimedTaskInst.add(function(){e.bTopScroll_=!1,e.bMidScroll_=!1},.5),this.blockCom_=this.com_.getChild("block").asCom;var a=this.blockCom_.getChild("bg");a&&(a.visible=!1),this.closeBtn_=this.com_.getChild("closeBtn").asButton,this.continueGameBtn_=this.com_.getChild("continueGameBtn").asButton,this.closeBtn_.onClick(this._onClose,this),this.continueGameBtn_.onClick(this._onContinue,this),this.showTrans_=this.com_.getTransition("show")}}}return t.prototype.init=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=""),this.com_&&!this.bInited_&&(this.com_.setSize(e.width,e.height),e.addChild(this.com_),this.navDatArr_=t,this.bName_=i,this.nameClr_=n,s.G.isTMSDK||this._initIcons(),this.hide(),this.bInited_=!0)},t.prototype.appendExtraFunc=function(t,e,i,n){void 0===i&&(i=o.kNone),void 0===n&&(n=5);for(var r=0;r<this.topNavItems_.length;++r)this.topNavItems_[r].appendExtraFunc(t,e,i,-1,n);for(r=0;r<this.midNavItems_.length;++r)this.midNavItems_[r].appendExtraFunc(t,e,i,-1,n)},t.prototype.update=function(t){if(this.com_.visible)if(this.bShowItems_){if(this.showTimer_+=t,this.stepTimer_+=t,this.stepTimer_>=.03&&this.showTransIdx_<this.midNavItems_.length){if(null!=this.transRandIdxArr_[this.showTransIdx_]){var e=this.transRandIdxArr_[this.showTransIdx_];this.midNavItems_[e]&&this.midNavItems_[e].playTrans(o.kFade)}this.stepTimer_-=.03,++this.showTransIdx_}if(this.showTimer_>=.5){for(var i=0;i<this.midNavItems_.length;++i)i<this.midGrids_&&(this.midNavItems_[i].alpha=1);this.bShowItems_=!1,this.showTimer_=0}}else{for(i=0;i<this.topNavItems_.length;++i)this.topNavItems_[i].update(t);for(i=0;i<this.midNavItems_.length;++i)this.midNavItems_[i].update(t);this.bTopScroll_||(this.updTopTimer_+=t,this.updTopTimer_>=2&&(this.bTopScroll_=!0,this.updTopTimer_=0,1==this.topScroll_.scrollPane.percX?this.topScroll_.scrollPane.scrollLeft(this.topNavItems_.length,!0):(this.topScroll_.scrollPane.scrollStep=.86*x+12,this.topScroll_.scrollPane.scrollRight(1,!0)))),this.bMidScroll_||this.bClicked_||(this.updMidTimer_+=t,this.updMidTimer_>=1&&(1==this.midScroll_.scrollPane.percY?(this.midMoveSpd_=0,this.midScroll_.scrollPane.scrollTop(!0),this.updMidTimer_=0):(this.midMoveSpd_+=2,this.midScroll_.scrollPane.setPosY(this.midMoveSpd_,!0))))}},t.prototype.show=function(t){if(void 0===t&&(t=""),this.com_&&!this.com_.visible){this.midMoveSpd_=0,this.bClicked_=!1,this.bBnrJumping_=!1,this.bBnrJump_=this.bBnrMissClick_,this.bBnrJump_&&(this.bBnrJumping_=!0),this.com_.visible=!0,this.bExportMissClick_&&(this.com_.node.on(cc.Node.EventType.TOUCH_START,this._onDown,this),this.com_.node.on(cc.Node.EventType.TOUCH_MOVE,this._onMove,this),this.com_.node.on(cc.Node.EventType.TOUCH_END,this._onUp,this)),this.closeBtn_&&(this.closeBtn_.visible=!this.bBnrJump_),this.transRandIdxArr_.sort(function(t,e){return Math.random()>.5?-1:1});for(var e=0;e<this.topNavItems_.length;++e)this.topNavItems_[e].show(t,!1);this.midNavIdx_=s.G.randRange(0,this.midNavItems_.length-1);for(e=0;e<this.midNavItems_.length;++e)if(e<this.midGrids_&&(this.midNavItems_[e].alpha=0),this.midNavItems_[e].show(t,!1),!s.G.isTMSDK){var i=this._getNextMidNavData();i&&this.midNavItems_[e].updateInfo(i)}this.midScroll_.scrollPane.scrollTop(!1),this.blockCom_.visible=!0,this.showTrans_?this.showTrans_.play(this._onShowOver.bind(this),1,0,2):this._onShowOver(),this.showTimer_=0,this.showTransIdx_=0,this.bShowItems_=!0,b.instance.uploadLog(t,"\u5c55\u793a")}},t.prototype.showTM=function(t){var e=this;wx.tmSDK.getFlowConfig({positionId:t}).then(function(t){if(t.isOpen){console.log("[VPageShow showTM] download data");var i=t.creatives;i&&(e._tmSdkDataProc(i),e.show())}})},t.prototype.hide=function(){this.com_&&(this.com_.visible=!1,this.bExportMissClick_&&(this.com_.node.off(cc.Node.EventType.TOUCH_START,this._onDown,this),this.com_.node.off(cc.Node.EventType.TOUCH_MOVE,this._onMove,this),this.com_.node.off(cc.Node.EventType.TOUCH_END,this._onUp,this))),this.showTrans_&&this.showTrans_.stop()},t.prototype._initIcons=function(){for(var t=0;t<this.navDatArr_.length;++t)this._createTopSingle(0,t,this.topScroll_);this.topScroll_.scrollPane.scrollLeft(),this.colPitch_=(this.midScroll_.width-3*P*tt)/2,this.midGrids_=9;var e=this.navDatArr_.length>this.midGrids_?this.navDatArr_.length:this.midGrids_,i=0,n=0;for(t=0;t<e;++t)this._createMidSingle(i,n,this.midScroll_),t<this.midGrids_&&(this.transRandIdxArr_[t]=t),++n>=3&&(++i,n=0)},t.prototype._tmSdkDataProc=function(t){this.navDatArr_.length!=t.length&&(console.log("[RCShow _tmSdkDataProc] data length different"),this.navDatArr_=[],this.topNavItems_=[],this.midNavItems_=[],this.topScroll_.removeChildren(),this.midScroll_.removeChildren());for(var e=0;e<t.length;++e){var i=null;i=this.topNavItems_.length>0&&this.navDatArr_[e]||new h.HDNavData,t[e].show_config&&(i.img=t[e].show_config.image,i.name=t[e].show_config.title),i.tmPosId=t[e].positionId,i.tmCid=t[e].creativeId,this.navDatArr_[e]||this.navDatArr_.push(i)}if(this.topNavItems_.length>0||this.midNavItems_.length>0){for(e=0;e<this.topNavItems_.length;++e){(i=this._getNextTopNavData())&&this.topNavItems_[e].updateInfo(i)}for(e=0;e<this.midNavItems_.length;++e){(i=this._getNextMidNavData())&&this.midNavItems_[e].updateInfo(i)}}else this._initIcons()},t.prototype._tmRefreshCallback=function(t,e){var i=t;i&&(console.log("[VPageShow _tmRefreshCallback]"),this._tmSdkDataProc(i))},t.prototype._onTopScrolling=function(){this.updTopTimer_>0&&(this.bTopScroll_=!0)},t.prototype._onTopScrollEnd=function(){this.bTopScroll_=!1,this.updTopTimer_=0},t.prototype._onMidScrolling=function(){},t.prototype._onMidScrollEnd=function(){},t.prototype._onShowOver=function(){this.blockCom_.visible=!1},t.prototype._onClose=function(){b.instance.hidePage()},t.prototype._onContinue=function(){this.bBnrMissClick_?this.bBnrJump_&&""!=i.ExportUIInst.getPageBannerID()&&this.bBnrJumping_||i.ExportUIInst.hidePage():b.instance.hidePage()},t.prototype._onDown=function(t){this.missDownX_=t.getLocationX(),this.missDownY_=t.getLocationY(),this.bMissingClick_=!1,this.bClicked_=!0},t.prototype._onMove=function(t){if(-1!=this.missDownX_&&-1!=this.missDownY_){var e=Math.abs(t.getLocationX()-this.missDownX_),i=Math.abs(t.getLocationY()-this.missDownY_);if((e>10||i>10)&&!this.bMissingClick_){if(s.G.randRange(0,100)<=d.default.instance.config.fakeBtnClick){var n=t.getLocationX(),o=t.getLocationY(),r=this.topScroll_.localToGlobal().x,a=this.topScroll_.localToGlobal().y,h=this.topScroll_.width,l=this.topScroll_.height,c=this.midScroll_.localToGlobal().x,u=this.midScroll_.localToGlobal().y,p=this.midScroll_.width,f=this.midScroll_.height;if(o<u&&o>a){var _=this.topScroll_.getFirstChildInView();n<r?n=r:n>r+h&&(n=r+h),o<a?o=a:o>a+l&&(o=a+l);var g=h/4,m=Math.floor((n-r)/g);(y=this.topNavItems_[_+m])&&y.clickTrigger()}else if(o>u&&o<u+f){_=this.midScroll_.getFirstChildInView();n<c?n=c:n>c+p&&(n=c+p),o<u?o=u:o>u+f&&(o=u+f);g=p/3;var y,v=f/3,b=(m=Math.floor((n-c)/g),Math.floor((o-u)/v));(y=this.midNavItems_[_+m+3*b])&&y.clickTrigger()}}this.bMissingClick_=!0}}},t.prototype._onUp=function(){this.bMissingClick_=!0,this.missDownX_=-1,this.missDownY_=-1},t.prototype._createTopSingle=function(t,e,i){var n=this._getNextTopNavData();if(n){var o=null;if(this.bName_){var r=fgui.UIPackage.createObject("HDSDK","NavItemEx").asCom;(o=new A(r)).init(n,!0,this.nameClr_),o.setCancelJumpActive(!1),o.addToParent(i,e*P*.86+12*e,0,.86),o.show(),o.registerTMSDKRefreshCallback(this._tmRefreshCallback.bind(this))}else{r=fgui.UIPackage.createObject("HDSDK","NavItem").asCom;(o=new k(r)).init(n,!0),o.setCancelJumpActive(!1),o.addToParent(i,e*x*.86+12*e,0,.86),o.show(),o.registerTMSDKRefreshCallback(this._tmRefreshCallback.bind(this))}o&&this.topNavItems_.push(o)}},t.prototype._createMidSingle=function(t,e,i){var n=this._getNextMidNavData();if(n){var r=fgui.UIPackage.createObject("HDSDK","NavItemEx").asCom,a=new A(r);a.init(n,!0),a.setCancelJumpActive(!1),a.addToParent(i,e*P*tt+e*this.colPitch_,(t*T+t*$)*tt,tt),a.appendExtraFunc(null,null,1===n.tag?o.kSpring:o.kNone),a.show(),a.registerTMSDKRefreshCallback(this._tmRefreshCallback.bind(this)),this.midNavItems_.push(a)}},t.prototype._getNextTopNavData=function(){var t=null;return this.navDatArr_.length>0&&(t=this.navDatArr_[this.topNavIdx_],++this.topNavIdx_,this.topNavIdx_>=this.navDatArr_.length&&(this.topNavIdx_=0)),t},t.prototype._getNextMidNavData=function(){var t=null;return this.navDatArr_.length>0&&(t=this.navDatArr_[this.midNavIdx_],++this.midNavIdx_,this.midNavIdx_>=this.navDatArr_.length&&(this.midNavIdx_=0)),t},t}(),ot=function(){function t(){var t=this;this.com_=null,this.topScroll_=null,this.midScroll_=null,this.bnrScroll_=null,this.blockCom_=null,this.closeBtn_=null,this.prevBtn_=null,this.nextBtn_=null,this.tabGrp_=null,this.tabCtrl_=null,this.navDatArr_=[],this.bnrDatArr_=[],this.topNavIdx_=0,this.midNavIdx_=0,this.bnrNavIdx_=0,this.topNavItems_=[],this.midNavItems_=[],this.bnrNavItems_=[],this.showTransIdx_=0,this.transRandIdxArr_=[],this.showTimer_=0,this.stepTimer_=0,this.bShowItems_=!1,this.colPitch_=0,this.bName_=!1,this.nameClr_="",this.updTopTimer_=0,this.updMidTimer_=0,this.updBnrTimer_=0,this.bTopScroll_=!1,this.bMidScroll_=!1,this.bBnrScroll_=!1,this.bMidDown_=!0,this.bInited_=!1;var e=fgui.UIPackage.createObject("HDSDK","HorPage");if(e){this.com_=e.asCom,this.com_.visible=!1,e.sortingOrder=r.UIHierarchy.kExportPage;var i=this.com_.getChild("bnrShow").asCom;i&&(this.topScroll_=i.getChild("horScroll").asCom,this.topScroll_.on(fgui.Event.SCROLL,this._onTopScrolling,this),this.topScroll_.on(fgui.Event.SCROLL_END,this._onTopScrollEnd,this),this.bnrScroll_=i.getChild("verScroll").asCom,this.bnrScroll_.on(fgui.Event.SCROLL,this._onBnrScrolling,this),this.bnrScroll_.on(fgui.Event.SCROLL_END,this._onBnrScrollEnd,this));var n=this.com_.getChild("scroll");n&&(this.midScroll_=n.asCom,this.midScroll_.on(fgui.Event.SCROLL,this._onMidScrolling,this),this.midScroll_.on(fgui.Event.SCROLL_END,this._onMidScrollEnd,this)),p.TimedTaskInst.add(function(){t.bBnrScroll_=!1,t.bMidScroll_=!1,t.bTopScroll_=!1},.5),this.blockCom_=this.com_.getChild("block").asCom;var o=this.blockCom_.getChild("bg");o&&(o.visible=!1),this.closeBtn_=this.com_.getChild("closeBtn").asButton,this.closeBtn_.onClick(this._onClose,this),this.prevBtn_=this.com_.getChild("prevBtn").asButton,this.prevBtn_.onClick(this._onPrev,this),this.nextBtn_=this.com_.getChild("nextBtn").asButton,this.nextBtn_.onClick(this._onNext,this),this.tabCtrl_=this.com_.getController("tab"),this.tabGrp_=this.com_.getChild("TabGrp").asGroup}}return t.prototype.init=function(t,e,i,n,o){void 0===n&&(n=!1),void 0===o&&(o=""),this.com_&&!this.bInited_&&(this.com_.setSize(i.width,i.height),i.addChild(this.com_),this.navDatArr_=t,this.bnrDatArr_=e,e.length<4?(this.prevBtn_.visible=!1,this.nextBtn_.visible=!1,this.tabGrp_.visible=!1):(this.prevBtn_.visible=!0,this.nextBtn_.visible=!0,this.tabGrp_.visible=!0),this.bName_=n,this.nameClr_=o,s.G.isTMSDK||this._initIcons(),this.hide(),this.bInited_=!0)},t.prototype.appendExtraFunc=function(t,e,i,n){void 0===i&&(i=o.kNone),void 0===n&&(n=5);for(var r=0;r<this.topNavItems_.length;++r)this.topNavItems_[r].appendExtraFunc(t,e,i,-1,n);for(r=0;r<this.midNavItems_.length;++r)this.midNavItems_[r].appendExtraFunc(t,e,i,-1,n);for(r=0;r<this.bnrNavItems_.length;++r)this.bnrNavItems_[r].appendExtraFunc(t,e,i,-1,n)},t.prototype.update=function(t){if(this.com_.visible)if(this.bShowItems_){if(this.showTimer_+=t,this.stepTimer_+=t,this.stepTimer_>=.02&&this.showTransIdx_<this.midNavItems_.length){if(null!=this.transRandIdxArr_[this.showTransIdx_]){var e=this.transRandIdxArr_[this.showTransIdx_];this.midNavItems_[e]&&this.midNavItems_[e].playTrans(o.kFade)}this.stepTimer_-=.02,++this.showTransIdx_}if(this.showTimer_>=.4){for(var i=0;i<this.midNavItems_.length;++i)i<15&&(this.midNavItems_[i].alpha=1);this.bShowItems_=!1,this.showTimer_=0,this.blockCom_.visible=!1}}else if(1===this.tabCtrl_.selectedIndex){for(i=0;i<this.topNavItems_.length;++i)this.topNavItems_[i].update(t);this.bTopScroll_||(this.updTopTimer_+=t,this.updTopTimer_>=2&&(this.bTopScroll_=!0,this.updTopTimer_=0,1==this.topScroll_.scrollPane.percX?this.topScroll_.scrollPane.scrollLeft(this.topNavItems_.length,!0):(this.topScroll_.scrollPane.scrollStep=x+20,this.topScroll_.scrollPane.scrollRight(1,!0))));for(i=0;i<this.bnrNavItems_.length;++i)this.bnrNavItems_[i].update(t);this.bBnrScroll_||(this.updBnrTimer_+=t,this.updBnrTimer_>=2&&(this.bBnrScroll_=!0,this.updBnrTimer_=0,1==this.bnrScroll_.scrollPane.percY?this.bnrScroll_.scrollPane.scrollTop(!0):(this.bnrScroll_.scrollPane.scrollStep=140,this.bnrScroll_.scrollPane.scrollDown(1,!0))))}else{for(i=0;i<this.midNavItems_.length;++i)this.midNavItems_[i].update(t);this.bMidScroll_||(this.updMidTimer_+=t,this.updMidTimer_>=2&&(this.bMidScroll_=!0,this.updMidTimer_=0,1==this.midScroll_.scrollPane.percY?this.midScroll_.scrollPane.scrollTop(!0):(this.midScroll_.scrollPane.scrollStep=200,this.midScroll_.scrollPane.scrollDown(1,!0))))}},t.prototype.show=function(t){if(void 0===t&&(t=""),this.com_&&!this.com_.visible){this.com_.visible=!0,this.transRandIdxArr_.sort(function(t,e){return Math.random()>.5?-1:1});for(var e=0;e<this.topNavItems_.length;++e)this.topNavItems_[e].show(t,!1);this.midNavIdx_=s.G.randRange(0,this.midNavItems_.length-1);for(e=0;e<this.midNavItems_.length;++e){e<15&&(this.midNavItems_[e].alpha=0),this.midNavItems_[e].show(t,!1);var i=this._getNextMidNavData();i&&this.midNavItems_[e].updateInfo(i)}this.midScroll_.scrollPane.scrollTop(!1),this.blockCom_.visible=!0,this.showTimer_=0,this.showTransIdx_=0,this.bShowItems_=!0,this.tabCtrl_.selectedIndex=0,b.instance.uploadLog(t,"\u5c55\u793a")}},t.prototype.showTM=function(t){var e=this;wx.tmSDK.getFlowConfig({positionId:t}).then(function(t){if(t.isOpen){console.log("[HPageShow] download data");var i=t.creatives;i&&(e._tmSdkDataProc(i),e.show())}})},t.prototype.hide=function(){this.com_&&(this.com_.visible=!1)},t.prototype._tmSdkDataProc=function(t){this.navDatArr_.length!=t.length&&(console.log("[HPageShow _tmSdkDataProc] data length different"),this.navDatArr_=[],this.midNavItems_=[],this.midScroll_.removeChildren());for(var e=0;e<t.length;++e){var i=null;i=this.topNavItems_.length>0&&this.navDatArr_[e]||new h.HDNavData,t[e].show_config&&(i.img=t[e].show_config.image,i.name=t[e].show_config.title),i.tmPosId=t[e].positionId,i.tmCid=t[e].creativeId,this.navDatArr_[e]||this.navDatArr_.push(i)}if(this.midNavItems_.length>0)for(e=0;e<this.midNavItems_.length;++e){(i=this._getNextMidNavData())&&this.midNavItems_[e].updateInfo(i)}else this._initIcons()},t.prototype._tmRefreshCallback=function(t,e){var i=t;i&&(console.log("[HPageShow _tmRefreshCallback]"),this._tmSdkDataProc(i))},t.prototype._initIcons=function(){this.colPitch_=(this.midScroll_.width-5*P*1)/4;for(var t=this.navDatArr_.length>15?this.navDatArr_.length:15,e=0,i=0,n=0;n<t;++n)this._createMidSingle(e,i,this.midScroll_),n<15&&(this.transRandIdxArr_[n]=n),++i>=5&&(++e,i=0);if(!s.G.isTMSDK){for(n=0;n<this.navDatArr_.length;++n)this._createTopSingle(0,n,this.topScroll_);this.topScroll_.scrollPane.scrollLeft(),e=0,i=0;for(n=0;n<this.bnrDatArr_.length;++n)this._createBnrSingle(e,i,this.bnrScroll_),++i>=2&&(++e,i=0)}},t.prototype._onTopScrolling=function(){this.updTopTimer_>0&&(this.bTopScroll_=!0)},t.prototype._onTopScrollEnd=function(){this.bTopScroll_=!1,this.updTopTimer_=0},t.prototype._onMidScrolling=function(){this.updMidTimer_>0&&(this.bMidScroll_=!0)},t.prototype._onMidScrollEnd=function(){this.bMidScroll_=!1,this.updMidTimer_=0},t.prototype._onBnrScrolling=function(){this.updBnrTimer_>0&&(this.bBnrScroll_=!0)},t.prototype._onBnrScrollEnd=function(){this.bBnrScroll_=!1,this.updBnrTimer_=0},t.prototype._onShowOver=function(){this.blockCom_.visible=!1},t.prototype._onClose=function(){b.instance.hidePage()},t.prototype._onPrev=function(){var t=this.tabCtrl_.selectedIndex;--t,this.tabCtrl_.selectedIndex=t<0?1:t},t.prototype._onNext=function(){var t=this.tabCtrl_.selectedIndex;++t,this.tabCtrl_.selectedIndex=t>1?0:t},t.prototype._createTopSingle=function(t,e,i){var n=this._getNextTopNavData();if(n){var o=null;if(this.bName_){var r=fgui.UIPackage.createObject("HDSDK","NavItemEx").asCom;(o=new A(r)).init(n,!0,this.nameClr_),o.setCancelJumpActive(!1),o.addToParent(i,e*P*.86+12*e,0,.86),o.show()}else{r=fgui.UIPackage.createObject("HDSDK","NavItem").asCom;(o=new k(r)).init(n,!0),o.setCancelJumpActive(!1),o.addToParent(i,e*x*.86+12*e,0,.86),o.show()}o&&this.topNavItems_.push(o)}},t.prototype._createMidSingle=function(t,e,i){var n=this._getNextMidNavData();if(n){var r=fgui.UIPackage.createObject("HDSDK","NavItemEx").asCom,a=new A(r);a.init(n,!0),a.setCancelJumpActive(!1),a.addToParent(i,e*P*1+e*this.colPitch_,1*(t*T+20*t),1),a.appendExtraFunc(null,null,1===n.tag?o.kSpring:o.kNone),a.show(),a.registerTMSDKRefreshCallback(this._tmRefreshCallback.bind(this)),this.midNavItems_.push(a)}},t.prototype._createBnrSingle=function(t,e,i){var n=this._getNextBnrNavData();if(n){var r=fgui.UIPackage.createObject("HDSDK","NavBnr").asCom,a=new D(r);a.init(n,!0),a.setCancelJumpActive(!1),a.addToParent(i,e*B+60*e,120*t+20*t,1),a.appendExtraFunc(null,null,1===n.tag?o.kSpring:o.kNone),a.show(),this.bnrNavItems_.push(a)}},t.prototype._getNextTopNavData=function(){var t=null;return this.navDatArr_.length>0&&(t=this.navDatArr_[this.topNavIdx_],++this.topNavIdx_,this.topNavIdx_>=this.navDatArr_.length&&(this.topNavIdx_=0)),t},t.prototype._getNextMidNavData=function(){var t=null;return this.navDatArr_.length>0&&(t=this.navDatArr_[this.midNavIdx_],++this.midNavIdx_,this.midNavIdx_>=this.navDatArr_.length&&(this.midNavIdx_=0)),t},t.prototype._getNextBnrNavData=function(){var t=null;return this.bnrDatArr_.length>0&&(t=this.bnrDatArr_[this.bnrNavIdx_],++this.bnrNavIdx_,this.bnrNavIdx_>=this.bnrDatArr_.length&&(this.bnrNavIdx_=0)),t},t}(),rt=function(){function t(){this.com_=null,this.lst_=null,this.closeBtn_=null,this.platCtrl_=null,this.navDatArr_=[],this.topNavIdx_=0,this.navItems_=[],this.missDownY_=0,this.bMissingClick_=!1,this.bInited_=!1;var t=fgui.UIPackage.createObject("HDSDK","VFakePage");if(t){if(this.com_=t.asCom,this.com_.visible=!1,t.sortingOrder=r.UIHierarchy.kExportPage,this.platCtrl_=this.com_.getController("plat"),CC_WECHATGAME)"ios"==f.MgpUtil.sdkInfo.platform?this.platCtrl_.selectedIndex=0:this.platCtrl_.selectedIndex=1;var e=this.com_.getChild("content").asCom;e&&(this.lst_=e.getChild("list").asList),this.closeBtn_=this.com_.getChild("closeBtn").asButton,this.closeBtn_.onClick(this._onClose,this)}}return t.prototype.init=function(t,e){this.com_&&!this.bInited_&&(this.com_.setSize(e.width,e.height),e.addChild(this.com_),this.navDatArr_=t,s.G.isTMSDK||(this.lst_.defaultItem="ui://HDSDK/NavFake",this.lst_.itemRenderer=this._onLstRenderItem.bind(this),this.lst_.numItems=this.navDatArr_.length),this.hide(),this.bInited_=!0)},t.prototype.appendExtraFunc=function(t,e){for(var i=0;i<this.navItems_.length;++i)this.navItems_[i].appendExtraFunc(t,e,o.kNone,-1,-1)},t.prototype.show=function(t){if(void 0===t&&(t=""),this.com_&&!this.com_.visible){this.com_.visible=!0,this.com_.node.on(cc.Node.EventType.TOUCH_START,this._onDown,this,!0),this.com_.node.on(cc.Node.EventType.TOUCH_MOVE,this._onMove,this,!0),this.com_.node.on(cc.Node.EventType.TOUCH_END,this._onUp,this,!0);for(var e=0;e<this.navItems_.length;++e)this.navItems_[e].show(t,!1);b.instance.uploadLog(t,"\u5c55\u793a")}},t.prototype.showTM=function(t){var e=this;wx.tmSDK.getFlowConfig({positionId:t}).then(function(t){if(t.isOpen){console.log("[VFakePage] download data");var i=t.creatives;i&&(e._tmSdkDataProc(i),e.show())}})},t.prototype.hide=function(){if(this.com_){this.com_.visible=!1,this.com_.node.off(cc.Node.EventType.TOUCH_START,this._onDown,this,!0),this.com_.node.off(cc.Node.EventType.TOUCH_MOVE,this._onMove,this,!0),this.com_.node.off(cc.Node.EventType.TOUCH_END,this._onUp,this,!0);for(var t=0;t<this.navItems_.length;++t)this.navItems_[t].hide()}},t.prototype._tmSdkDataProc=function(t){this.navDatArr_.length!=t.length&&(console.log("[VFakePage _tmSdkDataProc] data length different"),this.navDatArr_=[],this.navItems_=[],this.lst_.removeChildren());for(var e=0;e<t.length;++e){var i=null;i=this.navItems_.length>0&&this.navDatArr_[e]||new h.HDNavData,t[e].show_config&&(i.img=t[e].show_config.image,i.name=t[e].show_config.title),i.tmPosId=t[e].positionId,i.tmCid=t[e].creativeId,this.navDatArr_[e]||this.navDatArr_.push(i)}if(this.navItems_.length>0)for(e=0;e<this.navItems_.length;++e){(i=this._getNextNavData())&&this.navItems_[e].updateInfo(i)}else this.lst_.defaultItem="ui://HDSDK/NavFake",this.lst_.itemRenderer=this._onLstRenderItem.bind(this),this.lst_.numItems=this.navDatArr_.length},t.prototype._tmRefreshCallback=function(t,e){var i=t;i&&(console.log("[VFakePage _tmRefreshCallback]"),this._tmSdkDataProc(i))},t.prototype._onLstRenderItem=function(t,e){var i=this._getNextNavData();if(i){var n=new R(e.asCom);n.init(i),n.setCancelJumpActive(!1),n.registerTMSDKRefreshCallback(this._tmRefreshCallback.bind(this)),this.navItems_.push(n)}},t.prototype._onDown=function(t){this.missDownY_=t.getLocationY(),this.bMissingClick_=!1},t.prototype._onMove=function(t){if(Math.abs(t.getLocationY()-this.missDownY_)>10&&!this.bMissingClick_){if(s.G.randRange(0,100)<d.default.instance.config.fakeBtnClick){var e=this.lst_.getFirstChildInView(),i=t.getLocationY(),n=this.lst_.localToGlobal().y,o=this.lst_.height;if(i>n){var r=o/7,a=Math.floor((i-n)/r),h=this.navItems_[e+a];h&&h.clickTrigger()}}this.bMissingClick_=!0}},t.prototype._onUp=function(){this.bMissingClick_=!0},t.prototype._onClose=function(){i.ExportUIInst.hideFakePage()},t.prototype._getNextNavData=function(){var t=null;return this.navDatArr_.length>0&&(t=this.navDatArr_[this.topNavIdx_],++this.topNavIdx_,this.topNavIdx_>=this.navDatArr_.length&&(this.topNavIdx_=0)),t},t}(),at=!0,st=!0,ht=function(t){function e(){var e=t.call(this,!0)||this;e.topShowTransIdx_=0,e.topTransRandIdxArr_=[],e.topGrids_=0,e.bExportMissClick_=at,e.bBnrMissClick_=st;var i=fgui.UIPackage.createObject("HDSDK","VGridPage");if(i){e.com_=i.asCom,e.com_.visible=!1,i.sortingOrder=r.UIHierarchy.kExportPage;var n=e.com_.getChild("topScroll").asCom;n&&(e.topScroll_=n.asCom,e.topScroll_.on(fgui.Event.SCROLL,e._onTopScrolling,e),e.topScroll_.on(fgui.Event.SCROLL_END,e._onTopScrollEnd,e));var o=e.com_.getChild("midScroll");o&&(e.midScroll_=o.asCom,e.midScroll_.on(fgui.Event.SCROLL,e._onMidScrolling,e),e.midScroll_.on(fgui.Event.SCROLL_END,e._onMidScrollEnd,e)),e.blockCom_=e.com_.getChild("block").asCom;var a=e.blockCom_.getChild("bg");a&&(a.visible=!1),e.continueGameBtn_=e.com_.getChild("continueGameBtn").asButton,e.continueGameBtn_.onClick(e._onContinue,e)}return e}return n(e,t),e.prototype.init=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=""),this.com_&&!this.bInited_&&(this.com_.setSize(e.width,e.height),e.addChild(this.com_),this.navDatArr_=t,this.bName_=i,this.nameClr_=n,s.G.isTMSDK||this._initIcons(),this.hide(),this.bInited_=!0)},e.prototype.update=function(t){if(this.com_&&this.com_.visible)if(this.bShowItems_){if(this.showTimer_+=t,this.stepTimer_+=t,this.stepTimer_>=.03){if(this.topShowTransIdx_<this.topNavItems_.length){if(null!=this.topTransRandIdxArr_[this.topShowTransIdx_]){var e=this.topTransRandIdxArr_[this.topShowTransIdx_];this.topNavItems_[e]&&this.topNavItems_[e].playTrans(o.kFade)}++this.topShowTransIdx_}if(this.showTransIdx_<this.midNavItems_.length){if(null!=this.transRandIdxArr_[this.showTransIdx_]){e=this.transRandIdxArr_[this.showTransIdx_];this.midNavItems_[e]&&this.midNavItems_[e].playTrans(o.kFade)}++this.showTransIdx_}this.stepTimer_-=.03}if(this.showTimer_>=.5){for(var i=0;i<this.topNavItems_.length;++i)i<this.topGrids_&&(this.topNavItems_[i].alpha=1);for(i=0;i<this.midNavItems_.length;++i)i<this.midGrids_&&(this.midNavItems_[i].alpha=1);this.bShowItems_=!1,this.showTimer_=0}}else{for(i=0;i<this.topNavItems_.length;++i)this.topNavItems_[i].update(t);for(i=0;i<this.midNavItems_.length;++i)this.midNavItems_[i].update(t)}},e.prototype.show=function(e){if(void 0===e&&(e=""),this.com_&&!this.com_.visible){this.topTransRandIdxArr_.sort(function(t,e){return Math.random()>.5?-1:1}),this.topNavIdx_=s.G.randRange(0,this.topNavItems_.length-1);for(var i=0;i<this.topNavItems_.length;++i){i<this.topGrids_&&(this.topNavItems_[i].alpha=0),this.topNavItems_[i].show(e,!1);var n=this._getNextTopNavData();n&&this.topNavItems_[i].updateInfo(n)}this.topShowTransIdx_=0}t.prototype.show.call(this,e)},e.prototype._createTopSingle=function(t,e,i){var n=this._getNextTopNavData();if(n){var r=fgui.UIPackage.createObject("HDSDK","NavItemCnt").asCom,a=new E(r);a.init(n,!1,"#000000",!1),a.setCancelJumpActive(!1),a.randomCount(!0),a.addToParent(i,e*P*1+e*this.colPitch_,1*(200*t+0*t),1),a.appendExtraFunc(null,null,o.kShake,-1,s.G.randRange(3,10)),a.show(),a.registerTMSDKRefreshCallback(this._tmRefreshCallback.bind(this)),this.topNavItems_.push(a)}},e.prototype._createMidSingle=function(t,e,i){var n=this._getNextMidNavData();if(n){var r=fgui.UIPackage.createObject("HDSDK","NavItemCnt").asCom,a=new E(r);a.init(n,!1,"#0000000",!1),a.setCancelJumpActive(!1),a.randomCount(!1),a.addToParent(i,e*P*1+e*this.colPitch_,1*(200*t+0*t),1),a.appendExtraFunc(null,null,o.kShake,-1,s.G.randRange(3,10)),a.show(),a.registerTMSDKRefreshCallback(this._tmRefreshCallback.bind(this)),this.midNavItems_.push(a)}},e.prototype._initIcons=function(){this.colPitch_=(this.midScroll_.width-4*P*1)/3,this.topGrids_=12;for(var t=this.navDatArr_.length>this.topGrids_?this.navDatArr_.length:this.topGrids_,e=0,i=0,n=0;n<t;++n)this._createTopSingle(e,i,this.topScroll_),n<this.topGrids_&&(this.topTransRandIdxArr_[n]=n),++i>=4&&(++e,i=0);this.colPitch_=(this.midScroll_.width-4*P*1)/3,this.midGrids_=8;var o=this.navDatArr_.length>this.midGrids_?this.navDatArr_.length:this.midGrids_;e=0,i=0;for(n=0;n<o;++n)this._createMidSingle(e,i,this.midScroll_),n<this.midGrids_&&(this.transRandIdxArr_[n]=n),++i>=4&&(++e,i=0)},e.prototype._onContinue=function(){this.bBnrMissClick_&&this.bBnrJump_&&""!=i.ExportUIInst.getPageBannerID()&&this.bBnrJumping_||i.ExportUIInst.hideGridPage()},e}(nt);cc._RF.pop()},{"../../HDSDK":"HDSDK","../../game_logic":"game_logic","../../util/audio_mgr":"audio_mgr","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../../util/storage":"storage","../../util/structure/hd_map":"hd_map","../../util/timed_task":"timed_task","../game/ExportFriPnl":"ExportFriPnl","./base_ui":"base_ui","./tip_ui":"tip_ui"}],fairygui:[function(t,e,i){"use strict";cc._RF.push(e,"208fb/gLfJKJrOwjIeUEAFN","fairygui"),window.fgui={},window.fairygui=window.fgui,window.__extends=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),function(t){var e=function(){function e(){}return e.prototype.createObject=function(e,i){if(this._node)throw"Already running";var n=t.UIPackage.getByName(e);if(!n)throw new Error("package not found: "+e);var o=n.getItemByName(i);if(!o)throw new Error("resource not found: "+i);this.internalCreateObject(o)},e.prototype.createObjectFromURL=function(e){if(this._node)throw"Already running";var i=t.UIPackage.getItemByURL(e);if(!i)throw new Error("resource not found: "+e);this.internalCreateObject(i)},e.prototype.cancel=function(){this._node&&(this._node.destroy(),this._node=null)},e.prototype.internalCreateObject=function(t){this._node=new cc.Node("[AsyncCreating:"+t.name+"]"),this._node.parent=cc.director.getScene(),this._node.on("#",this.completed,this),this._node.addComponent(i).init(t)},e.prototype.completed=function(t){this.cancel(),this.callback&&this.callback(t)},e}();t.AsyncOperation=e;var i=function(e){function i(){var t=e.call(this)||this;return t._itemList=new Array,t._objectPool=new Array,t}return __extends(i,e),i.prototype.init=function(t){this._itemList.length=0,this._objectPool.length=0;var e={pi:t,type:t.objectType};e.childCount=this.collectComponentChildren(t),this._itemList.push(e),this._index=0},i.prototype.onDestroy=function(){this._itemList.length=0;var t=this._objectPool.length;if(t>0){for(var e=0;e<t;e++)this._objectPool[e].dispose();this._objectPool.length=0}},i.prototype.collectComponentChildren=function(e){var i,n,o,r,a,s,h=e.rawData;h.seek(0,2);var l=h.readShort();for(o=0;o<l;o++){r=h.readShort(),a=h.position,h.seek(a,0);var c=h.readByte(),u=h.readS(),p=h.readS();h.position=a,null!=u?(i={pi:n=null!=(s=null!=p?t.UIPackage.getById(p):e.owner)?s.getItemById(u):null,type:c},n&&n.type==t.PackageItemType.Component&&(i.childCount=this.collectComponentChildren(n))):(i={type:c},c==t.ObjectType.List&&(i.listItemCount=this.collectListChildren(h))),this._itemList.push(i),h.position=a+r}return l},i.prototype.collectListChildren=function(e){e.seek(e.position,8);var i,n,o,r,a,s=0,h=e.readS(),l=e.readShort();for(i=0;i<l;i++)n=e.readShort(),n+=e.position,null==(o=e.readS())&&(o=h),o&&(r=t.UIPackage.getItemByURL(o))&&(a={pi:r,type:r.objectType},r.type==t.PackageItemType.Component&&(a.childCount=this.collectComponentChildren(r)),this._itemList.push(a),s++),e.position=n;return s},i.prototype.update=function(){for(var e,i,n,o,r=t.ToolSet.getTime(),a=t.UIConfig.frameTimeForAsyncUIConstruction,s=this._itemList.length;this._index<s;){if((i=this._itemList[this._index]).pi)e=t.UIObjectFactory.newObject(i.pi),this._objectPool.push(e),t.UIPackage._constructing++,i.pi.type==t.PackageItemType.Component?(n=this._objectPool.length-i.childCount-1,e.constructFromResource2(this._objectPool,n),this._objectPool.splice(n,i.childCount)):e.constructFromResource(),t.UIPackage._constructing--;else if(e=t.UIObjectFactory.newObject(i.type),this._objectPool.push(e),i.type==t.ObjectType.List&&i.listItemCount>0){for(n=this._objectPool.length-i.listItemCount-1,o=0;o<i.listItemCount;o++)e.itemPool.returnObject(this._objectPool[o+n]);this._objectPool.splice(n,i.listItemCount)}if(this._index++,this._index%5==0&&t.ToolSet.getTime()-r>=a)return}var h=this._objectPool[0];this._itemList.length=0,this._objectPool.length=0,this.node.emit("#",h)},i}(cc.Component)}(fgui||(fgui={})),function(t){var e=0,i=function(i){function n(){var t=i.call(this)||this;return t._pageIds=[],t._pageNames=[],t._selectedIndex=-1,t._previousIndex=-1,t}return __extends(n,i),n.prototype.dispose=function(){},Object.defineProperty(n.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){if(this._selectedIndex!=e){if(e>this._pageIds.length-1)throw"index out of bounds: "+e;this.changing=!0,this._previousIndex=this._selectedIndex,this._selectedIndex=e,this.parent.applyController(this),this.emit(t.Event.STATUS_CHANGED,this),this.changing=!1}},enumerable:!1,configurable:!0}),n.prototype.onChanged=function(e,i){this.on(t.Event.STATUS_CHANGED,e,i)},n.prototype.offChanged=function(e,i){this.off(t.Event.STATUS_CHANGED,e,i)},n.prototype.setSelectedIndex=function(t){if(this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this.changing=!0,this._previousIndex=this._selectedIndex,this._selectedIndex=t,this.parent.applyController(this),this.changing=!1}},Object.defineProperty(n.prototype,"previsousIndex",{get:function(){return this._previousIndex},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selectedPage",{get:function(){return-1==this._selectedIndex?null:this._pageNames[this._selectedIndex]},set:function(t){var e=this._pageNames.indexOf(t);-1==e&&(e=0),this.selectedIndex=e},enumerable:!1,configurable:!0}),n.prototype.setSelectedPage=function(t){var e=this._pageNames.indexOf(t);-1==e&&(e=0),this.setSelectedIndex(e)},Object.defineProperty(n.prototype,"previousPage",{get:function(){return-1==this._previousIndex?null:this._pageNames[this._previousIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageCount",{get:function(){return this._pageIds.length},enumerable:!1,configurable:!0}),n.prototype.getPageName=function(t){return this._pageNames[t]},n.prototype.addPage=function(t){void 0===t&&(t=""),this.addPageAt(t,this._pageIds.length)},n.prototype.addPageAt=function(t,i){var n=""+e++;i==this._pageIds.length?(this._pageIds.push(n),this._pageNames.push(t)):(this._pageIds.splice(i,0,n),this._pageNames.splice(i,0,t))},n.prototype.removePage=function(t){var e=this._pageNames.indexOf(t);-1!=e&&(this._pageIds.splice(e,1),this._pageNames.splice(e,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this.parent.applyController(this))},n.prototype.removePageAt=function(t){this._pageIds.splice(t,1),this._pageNames.splice(t,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this.parent.applyController(this)},n.prototype.clearPages=function(){this._pageIds.length=0,this._pageNames.length=0,-1!=this._selectedIndex?this.selectedIndex=-1:this.parent.applyController(this)},n.prototype.hasPage=function(t){return-1!=this._pageNames.indexOf(t)},n.prototype.getPageIndexById=function(t){return this._pageIds.indexOf(t)},n.prototype.getPageIdByName=function(t){var e=this._pageNames.indexOf(t);return-1!=e?this._pageIds[e]:null},n.prototype.getPageNameById=function(t){var e=this._pageIds.indexOf(t);return-1!=e?this._pageNames[e]:null},n.prototype.getPageId=function(t){return this._pageIds[t]},Object.defineProperty(n.prototype,"selectedPageId",{get:function(){return-1==this._selectedIndex?null:this._pageIds[this._selectedIndex]},set:function(t){var e=this._pageIds.indexOf(t);this.selectedIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"oppositePageId",{set:function(t){this._pageIds.indexOf(t)>0?this.selectedIndex=0:this._pageIds.length>1&&(this.selectedIndex=1)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"previousPageId",{get:function(){return-1==this._previousIndex?null:this._pageIds[this._previousIndex]},enumerable:!1,configurable:!0}),n.prototype.runActions=function(){if(this._actions)for(var t=this._actions.length,e=0;e<t;e++)this._actions[e].run(this,this.previousPageId,this.selectedPageId)},n.prototype.setup=function(e){var i,n,o=e.position;e.seek(o,0),this.name=e.readS(),e.readBool()&&(this.autoRadioGroupDepth=!0),e.seek(o,1);var r=e.readShort();for(i=0;i<r;i++)this._pageIds.push(e.readS()),this._pageNames.push(e.readS());var a=0;if(e.version>=2)switch(e.readByte()){case 1:a=e.readShort();break;case 2:-1==(a=this._pageNames.indexOf(t.UIPackage.branch))&&(a=0);break;case 3:-1==(a=this._pageNames.indexOf(t.UIPackage.getVar(e.readS())))&&(a=0)}if(e.seek(o,2),(r=e.readShort())>0)for(this._actions||(this._actions=new Array),i=0;i<r;i++){n=e.readShort(),n+=e.position;var s=t.ControllerAction.createAction(e.readByte());s.setup(e),this._actions.push(s),e.position=n}this.parent&&this._pageIds.length>0?this._selectedIndex=a:this._selectedIndex=-1},n}(cc.EventTarget);t.Controller=i}(fgui||(fgui={})),function(t){var e=function(){function e(){this._agent=new t.GLoader,this._agent.draggable=!0,this._agent.touchable=!1,this._agent.setSize(100,100),this._agent.setPivot(.5,.5,!0),this._agent.align=t.AlignType.Center,this._agent.verticalAlign=t.VertAlignType.Middle,this._agent.sortingOrder=1e6,this._agent.on(t.Event.DRAG_END,this.onDragEnd,this)}return Object.defineProperty(e,"inst",{get:function(){return e._inst||(e._inst=new e),e._inst},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragAgent",{get:function(){return this._agent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragging",{get:function(){return null!=this._agent.parent},enumerable:!1,configurable:!0}),e.prototype.startDrag=function(e,i,n,o){if(!this._agent.parent){this._sourceData=n,this._agent.url=i,t.GRoot.inst.addChild(this._agent);var r=t.GRoot.inst.getTouchPosition(o);r=t.GRoot.inst.globalToLocal(r.x,r.y),this._agent.setPosition(r.x,r.y),this._agent.startDrag(o)}},e.prototype.cancel=function(){this._agent.parent&&(this._agent.stopDrag(),t.GRoot.inst.removeChild(this._agent),this._sourceData=null)},e.prototype.onDragEnd=function(){if(this._agent.parent){t.GRoot.inst.removeChild(this._agent);var e=this._sourceData;this._sourceData=null;for(var i=t.GRoot.inst.touchTarget;i;){if(i.node.hasEventListener(t.Event.DROP))return i.requestFocus(),void i.node.emit(t.Event.DROP,i,e);i=i.parent}}},e}();t.DragDropManager=e}(fgui||(fgui={})),function(t){(function(t){t[t.Common=0]="Common",t[t.Check=1]="Check",t[t.Radio=2]="Radio"})(t.ButtonMode||(t.ButtonMode={})),function(t){t[t.None=0]="None",t[t.Both=1]="Both",t[t.Height=2]="Height",t[t.Shrink=3]="Shrink"}(t.AutoSizeType||(t.AutoSizeType={})),function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"}(t.AlignType||(t.AlignType={})),function(t){t[t.Top=0]="Top",t[t.Middle=1]="Middle",t[t.Bottom=2]="Bottom"}(t.VertAlignType||(t.VertAlignType={})),function(t){t[t.None=0]="None",t[t.Scale=1]="Scale",t[t.ScaleMatchHeight=2]="ScaleMatchHeight",t[t.ScaleMatchWidth=3]="ScaleMatchWidth",t[t.ScaleFree=4]="ScaleFree",t[t.ScaleNoBorder=5]="ScaleNoBorder"}(t.LoaderFillType||(t.LoaderFillType={})),function(t){t[t.SingleColumn=0]="SingleColumn",t[t.SingleRow=1]="SingleRow",t[t.FlowHorizontal=2]="FlowHorizontal",t[t.FlowVertical=3]="FlowVertical",t[t.Pagination=4]="Pagination"}(t.ListLayoutType||(t.ListLayoutType={})),function(t){t[t.Single=0]="Single",t[t.Multiple=1]="Multiple",t[t.Multiple_SingleClick=2]="Multiple_SingleClick",t[t.None=3]="None"}(t.ListSelectionMode||(t.ListSelectionMode={})),function(t){t[t.Visible=0]="Visible",t[t.Hidden=1]="Hidden",t[t.Scroll=2]="Scroll"}(t.OverflowType||(t.OverflowType={})),function(t){t[t.Image=0]="Image",t[t.MovieClip=1]="MovieClip",t[t.Sound=2]="Sound",t[t.Component=3]="Component",t[t.Atlas=4]="Atlas",t[t.Font=5]="Font",t[t.Swf=6]="Swf",t[t.Misc=7]="Misc",t[t.Unknown=8]="Unknown",t[t.Spine=9]="Spine",t[t.DragonBones=10]="DragonBones"}(t.PackageItemType||(t.PackageItemType={})),function(t){t[t.Image=0]="Image",t[t.MovieClip=1]="MovieClip",t[t.Swf=2]="Swf",t[t.Graph=3]="Graph",t[t.Loader=4]="Loader",t[t.Group=5]="Group",t[t.Text=6]="Text",t[t.RichText=7]="RichText",t[t.InputText=8]="InputText",t[t.Component=9]="Component",t[t.List=10]="List",t[t.Label=11]="Label",t[t.Button=12]="Button",t[t.ComboBox=13]="ComboBox",t[t.ProgressBar=14]="ProgressBar",t[t.Slider=15]="Slider",t[t.ScrollBar=16]="ScrollBar",t[t.Tree=17]="Tree",t[t.Loader3D=18]="Loader3D"}(t.ObjectType||(t.ObjectType={})),function(t){t[t.Percent=0]="Percent",t[t.ValueAndMax=1]="ValueAndMax",t[t.Value=2]="Value",t[t.Max=3]="Max"}(t.ProgressTitleType||(t.ProgressTitleType={})),function(t){t[t.Default=0]="Default",t[t.Visible=1]="Visible",t[t.Auto=2]="Auto",t[t.Hidden=3]="Hidden"}(t.ScrollBarDisplayType||(t.ScrollBarDisplayType={})),function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical",t[t.Both=2]="Both"}(t.ScrollType||(t.ScrollType={})),function(t){t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Both=3]="Both"}(t.FlipType||(t.FlipType={})),function(t){t[t.Ascent=0]="Ascent",t[t.Descent=1]="Descent",t[t.Arch=2]="Arch"}(t.ChildrenRenderOrder||(t.ChildrenRenderOrder={})),function(t){t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical"}(t.GroupLayoutType||(t.GroupLayoutType={})),function(t){t[t.Auto=0]="Auto",t[t.Up=1]="Up",t[t.Down=2]="Down"}(t.PopupDirection||(t.PopupDirection={})),function(t){t[t.Left_Left=0]="Left_Left",t[t.Left_Center=1]="Left_Center",t[t.Left_Right=2]="Left_Right",t[t.Center_Center=3]="Center_Center",t[t.Right_Left=4]="Right_Left",t[t.Right_Center=5]="Right_Center",t[t.Right_Right=6]="Right_Right",t[t.Top_Top=7]="Top_Top",t[t.Top_Middle=8]="Top_Middle",t[t.Top_Bottom=9]="Top_Bottom",t[t.Middle_Middle=10]="Middle_Middle",t[t.Bottom_Top=11]="Bottom_Top",t[t.Bottom_Middle=12]="Bottom_Middle",t[t.Bottom_Bottom=13]="Bottom_Bottom",t[t.Width=14]="Width",t[t.Height=15]="Height",t[t.LeftExt_Left=16]="LeftExt_Left",t[t.LeftExt_Right=17]="LeftExt_Right",t[t.RightExt_Left=18]="RightExt_Left",t[t.RightExt_Right=19]="RightExt_Right",t[t.TopExt_Top=20]="TopExt_Top",t[t.TopExt_Bottom=21]="TopExt_Bottom",t[t.BottomExt_Top=22]="BottomExt_Top",t[t.BottomExt_Bottom=23]="BottomExt_Bottom",t[t.Size=24]="Size"}(t.RelationType||(t.RelationType={})),function(t){t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Radial90=3]="Radial90",t[t.Radial180=4]="Radial180",t[t.Radial360=5]="Radial360"}(t.FillMethod||(t.FillMethod={})),function(t){t[t.Top=0]="Top",t[t.Bottom=1]="Bottom",t[t.Left=2]="Left",t[t.Right=3]="Right"}(t.FillOrigin||(t.FillOrigin={})),function(t){t[t.Text=0]="Text",t[t.Icon=1]="Icon",t[t.Color=2]="Color",t[t.OutlineColor=3]="OutlineColor",t[t.Playing=4]="Playing",t[t.Frame=5]="Frame",t[t.DeltaTime=6]="DeltaTime",t[t.TimeScale=7]="TimeScale",t[t.FontSize=8]="FontSize",t[t.Selected=9]="Selected"}(t.ObjectPropID||(t.ObjectPropID={}))}(fgui||(fgui={})),function(t){var e=function(){function e(){if(this._x=0,this._y=0,this._alpha=1,this._visible=!0,this._touchable=!0,this._skewX=0,this._skewY=0,this._sortingOrder=0,this._internalVisible=!0,this.sourceWidth=0,this.sourceHeight=0,this.initWidth=0,this.initHeight=0,this.minWidth=0,this.minHeight=0,this.maxWidth=0,this.maxHeight=0,this._width=0,this._height=0,this._rawWidth=0,this._rawHeight=0,this._sizePercentInGroup=0,this._node=new cc.Node,-1==e._defaultGroupIndex){e._defaultGroupIndex=0;for(var i=cc.game.groupList,n=i.length,o=0;o<n;o++)if(i[o].toLowerCase()==t.UIConfig.defaultUIGroup.toLowerCase()){e._defaultGroupIndex=o;break}}this._node.$gobj=this,this._node.groupIndex=e._defaultGroupIndex,this._node.setAnchorPoint(0,1),this._node.on(cc.Node.EventType.ANCHOR_CHANGED,this.handleAnchorChanged,this),this._id=this._node.uuid,this._name="",this._relations=new t.Relations(this),this._gears=new Array(10),this._blendMode=t.BlendMode.Normal,this._partner=this._node.addComponent(h)}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this.setPosition(t,this._y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this.setPosition(this._x,t)},enumerable:!1,configurable:!0}),e.prototype.setPosition=function(n,r){if(this._x!=n||this._y!=r){var a=n-this._x,s=r-this._y;this._x=n,this._y=r,this.handlePositionChanged(),this instanceof t.GGroup&&this.moveChildren(a,s),this.updateGear(1),!this._parent||this._parent instanceof t.GList||(this._parent.setBoundsChangedFlag(),this._group&&this._group.setBoundsChangedFlag(!0),this._node.emit(t.Event.XY_CHANGED,this)),e.draggingObject!=this||i||this.localToGlobalRect(0,0,this._width,this._height,o)}},Object.defineProperty(e.prototype,"xMin",{get:function(){return this._pivotAsAnchor?this._x-this._width*this.node.anchorX:this._x},set:function(t){this._pivotAsAnchor?this.setPosition(t+this._width*this.node.anchorX,this._y):this.setPosition(t,this._y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return this._pivotAsAnchor?this._y-this._height*(1-this.node.anchorY):this._y},set:function(t){this._pivotAsAnchor?this.setPosition(this._x,t+this._height*(1-this.node.anchorY)):this.setPosition(this._x,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pixelSnapping",{get:function(){return this._pixelSnapping},set:function(t){this._pixelSnapping!=t&&(this._pixelSnapping=t,this.handlePositionChanged())},enumerable:!1,configurable:!0}),e.prototype.center=function(e){var i;i=this._parent?this.parent:this.root,this.setPosition((i.width-this._width)/2,(i.height-this._height)/2),e&&(this.addRelation(i,t.RelationType.Center_Center),this.addRelation(i,t.RelationType.Middle_Middle))},Object.defineProperty(e.prototype,"width",{get:function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._width},set:function(t){this.setSize(t,this._rawHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._height},set:function(t){this.setSize(this._rawWidth,t)},enumerable:!1,configurable:!0}),e.prototype.setSize=function(e,i,n){if(this._rawWidth!=e||this._rawHeight!=i){this._rawWidth=e,this._rawHeight=i,e<this.minWidth&&(e=this.minWidth),i<this.minHeight&&(i=this.minHeight),this.maxWidth>0&&e>this.maxWidth&&(e=this.maxWidth),this.maxHeight>0&&i>this.maxHeight&&(i=this.maxHeight);var o=e-this._width,r=i-this._height;this._width=e,this._height=i,this.handleSizeChanged(),0==this.node.anchorX&&1==this.node.anchorY||this._pivotAsAnchor||n?this.handlePositionChanged():this.setPosition(this.x-this.node.anchorX*o,this.y-(1-this.node.anchorY)*r),this instanceof t.GGroup&&this.resizeChildren(o,r),this.updateGear(2),this._parent&&(this._relations.onOwnerSizeChanged(o,r,this._pivotAsAnchor||!n),this._parent.setBoundsChangedFlag(),this._group&&this._group.setBoundsChangedFlag()),this._node.emit(t.Event.SIZE_CHANGED,this)}},e.prototype.makeFullScreen=function(){this.setSize(t.GRoot.inst.width,t.GRoot.inst.height)},e.prototype.ensureSizeCorrect=function(){},Object.defineProperty(e.prototype,"actualWidth",{get:function(){return this.width*Math.abs(this._node.scaleX)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualHeight",{get:function(){return this.height*Math.abs(this._node.scaleY)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._node.scaleX},set:function(t){this.setScale(t,this._node.scaleY)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._node.scaleY},set:function(t){this.setScale(this._node.scaleX,t)},enumerable:!1,configurable:!0}),e.prototype.setScale=function(t,e){this._node.scaleX==t&&this._node.scaleY==e||(this._node.setScale(t,e),this.updateGear(2))},Object.defineProperty(e.prototype,"skewX",{get:function(){return this._skewX},set:function(t){this.setSkew(t,this._skewY)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skewY",{get:function(){return this._skewY},set:function(t){this.setSkew(this._skewX,t)},enumerable:!1,configurable:!0}),e.prototype.setSkew=function(t,e){this._skewX==t&&this._skewY==e||(this._skewX=t,this._skewY=e,this._node.skewX=t,this._node.skewY=e)},Object.defineProperty(e.prototype,"pivotX",{get:function(){return this.node.anchorX},set:function(t){this.node.anchorX=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivotY",{get:function(){return 1-this.node.anchorY},set:function(t){this.node.anchorY=1-t},enumerable:!1,configurable:!0}),e.prototype.setPivot=function(t,e,i){this.node.anchorX!=t||this.node.anchorY!=1-e?(this._pivotAsAnchor=i,this.node.setAnchorPoint(t,1-e)):this._pivotAsAnchor!=i&&(this._pivotAsAnchor=i,this.handlePositionChanged())},Object.defineProperty(e.prototype,"pivotAsAnchor",{get:function(){return this._pivotAsAnchor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"touchable",{get:function(){return this._touchable},set:function(t){this._touchable!=t&&(this._touchable=t,this.updateGear(3))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grayed",{get:function(){return this._grayed},set:function(t){this._grayed!=t&&(this._grayed=t,this.handleGrayedChanged(),this.updateGear(3))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return!this._grayed&&this._touchable},set:function(t){this.grayed=!t,this.touchable=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return-this._node.angle},set:function(t){t=-t,this._node.angle!=t&&(this._node.angle=t,this.updateGear(3))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha!=e&&(this._alpha=e,this._node.opacity=255*this._alpha,this instanceof t.GGroup&&this.handleAlphaChanged(),this.updateGear(3))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible!=t&&(this._visible=t,this.handleVisibleChanged(),this._group&&this._group.excludeInvisibles&&this._group.setBoundsChangedFlag())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_finalVisible",{get:function(){return this._visible&&this._internalVisible&&(!this._group||this._group._finalVisible)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalVisible3",{get:function(){return this._visible&&this._internalVisible},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sortingOrder",{get:function(){return this._sortingOrder},set:function(t){if(t<0&&(t=0),this._sortingOrder!=t){var e=this._sortingOrder;this._sortingOrder=t,this._parent&&this._parent.childSortingOrderChanged(this,e,this._sortingOrder)}},enumerable:!1,configurable:!0}),e.prototype.requestFocus=function(){},Object.defineProperty(e.prototype,"tooltips",{get:function(){return this._tooltips},set:function(e){this._tooltips&&(this._node.off(t.Event.ROLL_OVER,this.onRollOver,this),this._node.off(t.Event.ROLL_OUT,this.onRollOut,this)),this._tooltips=e,this._tooltips&&(this._node.on(t.Event.ROLL_OVER,this.onRollOver,this),this._node.on(t.Event.ROLL_OUT,this.onRollOut,this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this._blendMode!=e&&(this._blendMode=e,t.BlendModeUtils.apply(this._node,e))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onStage",{get:function(){return this._node&&this._node.activeInHierarchy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resourceURL",{get:function(){return this.packageItem?"ui://"+this.packageItem.owner.id+this.packageItem.id:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"group",{get:function(){return this._group},set:function(t){this._group!=t&&(this._group&&this._group.setBoundsChangedFlag(),this._group=t,this._group&&this._group.setBoundsChangedFlag())},enumerable:!1,configurable:!0}),e.prototype.getGear=function(e){var i=this._gears[e];return i||(this._gears[e]=i=t.GearBase.create(this,e)),i},e.prototype.updateGear=function(t){if(!this._underConstruct&&!this._gearLocked){var e=this._gears[t];e&&e.controller&&e.updateState()}},e.prototype.checkGearController=function(t,e){return this._gears[t]&&this._gears[t].controller==e},e.prototype.updateGearFromRelations=function(t,e,i){this._gears[t]&&this._gears[t].updateFromRelations(e,i)},e.prototype.addDisplayLock=function(){var t=this._gears[0];if(t&&t.controller){var e=t.addLock();return this.checkGearDisplay(),e}return 0},e.prototype.releaseDisplayLock=function(t){var e=this._gears[0];e&&e.controller&&(e.releaseLock(t),this.checkGearDisplay())},e.prototype.checkGearDisplay=function(){if(!this._handlingController){var t=null==this._gears[0]||this._gears[0].connected;this._gears[8]&&(t=this._gears[8].evaluate(t)),t!=this._internalVisible&&(this._internalVisible=t,this.handleVisibleChanged(),this._group&&this._group.excludeInvisibles&&this._group.setBoundsChangedFlag())}},Object.defineProperty(e.prototype,"gearXY",{get:function(){return this.getGear(1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gearSize",{get:function(){return this.getGear(2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gearLook",{get:function(){return this.getGear(3)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relations",{get:function(){return this._relations},enumerable:!1,configurable:!0}),e.prototype.addRelation=function(t,e,i){this._relations.add(t,e,i)},e.prototype.removeRelation=function(t,e){this._relations.remove(t,e)},Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),e.prototype.removeFromParent=function(){this._parent&&this._parent.removeChild(this)},e.prototype.findParent=function(){if(this._parent)return this._parent;for(var t=this._node.parent;t;){var e=t.$gobj;if(e)return e;t=t.parent}return null},Object.defineProperty(e.prototype,"root",{get:function(){if(this instanceof t.GRoot)return this;for(var e=this._parent;e;){if(e instanceof t.GRoot)return e;e=e.parent}return t.GRoot.inst},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asCom",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asButton",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asLabel",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asProgress",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asTextField",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asRichTextField",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asTextInput",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asLoader",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asList",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asTree",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asGraph",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asGroup",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asSlider",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asComboBox",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asImage",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asMovieClip",{get:function(){return this},enumerable:!1,configurable:!0}),e.cast=function(t){return t.$gobj},Object.defineProperty(e.prototype,"text",{get:function(){return null},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return null},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"treeNode",{get:function(){return this._treeNode},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var t=this._node;if(t){this.removeFromParent(),this._relations.dispose(),this._node=null,t.destroy();for(var e=0;e<10;e++){var i=this._gears[e];i&&i.dispose()}}},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.onUpdate=function(){},e.prototype.onDestroy=function(){},e.prototype.onClick=function(e,i){this._node.on(t.Event.CLICK,e,i)},e.prototype.offClick=function(e,i){this._node.off(t.Event.CLICK,e,i)},e.prototype.clearClick=function(){this._node.off(t.Event.CLICK)},e.prototype.hasClickListener=function(){return this._node.hasEventListener(t.Event.CLICK)},e.prototype.on=function(e,i,n){e!=t.Event.DISPLAY&&e!=t.Event.UNDISPLAY||(this._partner._emitDisplayEvents=!0),this._node.on(e,i,n)},e.prototype.off=function(t,e,i){this._node.off(t,e,i)},Object.defineProperty(e.prototype,"draggable",{get:function(){return this._draggable},set:function(t){this._draggable!=t&&(this._draggable=t,this.initDrag())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragBounds",{get:function(){return this._dragBounds},set:function(t){this._dragBounds=t},enumerable:!1,configurable:!0}),e.prototype.startDrag=function(t){this._node.activeInHierarchy&&this.dragBegin(t)},e.prototype.stopDrag=function(){this.dragEnd()},Object.defineProperty(e.prototype,"dragging",{get:function(){return e.draggingObject==this},enumerable:!1,configurable:!0}),e.prototype.localToGlobal=function(e,i,n){return e=e||0,i=i||0,(n=n||new cc.Vec2).x=e,n.y=i,n.y=-n.y,this._pivotAsAnchor||(n.x-=this.node.anchorX*this._width,n.y+=(1-this.node.anchorY)*this._height),this._node.convertToWorldSpaceAR(n,n),n.y=t.GRoot.inst.height-n.y,n},e.prototype.globalToLocal=function(e,i,n){return e=e||0,i=i||0,(n=n||new cc.Vec2).x=e,n.y=t.GRoot.inst.height-i,this._node.convertToNodeSpaceAR(n,n),this._pivotAsAnchor||(n.x+=this._node.anchorX*this._width,n.y-=(1-this._node.anchorY)*this._height),n.y=-n.y,n},e.prototype.localToGlobalRect=function(t,e,i,n,o){t=t||0,e=e||0,i=i||0,n=n||0,o=o||new cc.Rect;var r=this.localToGlobal(t,e);return o.x=r.x,o.y=r.y,r=this.localToGlobal(t+i,e+n,r),o.xMax=r.x,o.yMax=r.y,o},e.prototype.globalToLocalRect=function(t,e,i,n,o){t=t||0,e=e||0,i=i||0,n=n||0,o=o||new cc.Rect;var r=this.globalToLocal(t,e);return o.x=r.x,o.y=r.y,r=this.globalToLocal(t+i,e+n,r),o.xMax=r.x,o.yMax=r.y,o},e.prototype.handleControllerChanged=function(t){this._handlingController=!0;for(var e=0;e<10;e++){var i=this._gears[e];i&&i.controller==t&&i.apply()}this._handlingController=!1,this.checkGearDisplay()},e.prototype.handleAnchorChanged=function(){this.handlePositionChanged()},e.prototype.handlePositionChanged=function(){var t=this._x,e=-this._y;this._pivotAsAnchor||(t+=this.node.anchorX*this._width,e-=(1-this.node.anchorY)*this._height),this._pixelSnapping&&(t=Math.round(t),e=Math.round(e)),this._node.setPosition(t,e)},e.prototype.handleSizeChanged=function(){this._node.setContentSize(this._width,this._height)},e.prototype.handleGrayedChanged=function(){},e.prototype.handleVisibleChanged=function(){this._node.active=this._finalVisible,this instanceof t.GGroup&&this.handleVisibleChanged(),this._parent&&this._parent.setBoundsChangedFlag()},e.prototype.hitTest=function(t,e){return null==e&&(e=!0),!e||!this._touchDisabled&&this._touchable&&this._node.activeInHierarchy?(this._hitTestPt||(this._hitTestPt=new cc.Vec2),this.globalToLocal(t.x,t.y,this._hitTestPt),this._pivotAsAnchor&&(this._hitTestPt.x+=this.node.anchorX*this._width,this._hitTestPt.y+=(1-this.node.anchorY)*this._height),this._hitTest(this._hitTestPt,t)):null},e.prototype._hitTest=function(t,e){return t.x>=0&&t.y>=0&&t.x<this._width&&t.y<this._height?this:null},e.prototype.getProp=function(e){switch(e){case t.ObjectPropID.Text:return this.text;case t.ObjectPropID.Icon:return this.icon;case t.ObjectPropID.Color:case t.ObjectPropID.OutlineColor:return null;case t.ObjectPropID.Playing:return!1;case t.ObjectPropID.Frame:case t.ObjectPropID.DeltaTime:return 0;case t.ObjectPropID.TimeScale:return 1;case t.ObjectPropID.FontSize:return 0;case t.ObjectPropID.Selected:return!1;default:return}},e.prototype.setProp=function(e,i){switch(e){case t.ObjectPropID.Text:this.text=i;break;case t.ObjectPropID.Icon:this.icon=i}},e.prototype.constructFromResource=function(){},e.prototype.setup_beforeAdd=function(t,e){var i,n;t.seek(e,0),t.skip(5),this._id=t.readS(),this._name=t.readS(),i=t.readInt(),n=t.readInt(),this.setPosition(i,n),t.readBool()&&(this.initWidth=t.readInt(),this.initHeight=t.readInt(),this.setSize(this.initWidth,this.initHeight,!0)),t.readBool()&&(this.minWidth=t.readInt(),this.maxWidth=t.readInt(),this.minHeight=t.readInt(),this.maxHeight=t.readInt()),t.readBool()&&(i=t.readFloat(),n=t.readFloat(),this.setScale(i,n)),t.readBool()&&(i=t.readFloat(),n=t.readFloat(),this.setSkew(i,n)),t.readBool()&&(i=t.readFloat(),n=t.readFloat(),this.setPivot(i,n,t.readBool())),1!=(i=t.readFloat())&&(this.alpha=i),0!=(i=t.readFloat())&&(this.rotation=i),t.readBool()||(this.visible=!1),t.readBool()||(this.touchable=!1),t.readBool()&&(this.grayed=!0),this.blendMode=t.readByte();t.readByte();var o=t.readS();null!=o&&(this.data=o)},e.prototype.setup_afterAdd=function(t,e){t.seek(e,1);var i=t.readS();null!=i&&(this.tooltips=i);var n=t.readShort();n>=0&&(this.group=this.parent.getChildAt(n)),t.seek(e,2);for(var o=t.readShort(),r=0;r<o;r++){var a=t.readShort();a+=t.position,this.getGear(t.readByte()).setup(t),t.position=a}},e.prototype.onRollOver=function(){this.root.showTooltips(this.tooltips)},e.prototype.onRollOut=function(){this.root.hideTooltips()},e.prototype.initDrag=function(){this._draggable?(this.on(t.Event.TOUCH_BEGIN,this.onTouchBegin_0,this),this.on(t.Event.TOUCH_MOVE,this.onTouchMove_0,this),this.on(t.Event.TOUCH_END,this.onTouchEnd_0,this)):(this.off(t.Event.TOUCH_BEGIN,this.onTouchBegin_0,this),this.off(t.Event.TOUCH_MOVE,this.onTouchMove_0,this),this.off(t.Event.TOUCH_END,this.onTouchEnd_0,this))},e.prototype.dragBegin=function(i){if(e.draggingObject){var r=e.draggingObject;r.stopDrag(),e.draggingObject=null,r._node.emit(t.Event.DRAG_END)}void 0==i&&(i=t.GRoot.inst.inputProcessor.getAllTouches()[0]),n.set(t.GRoot.inst.getTouchPosition(i)),this.localToGlobalRect(0,0,this._width,this._height,o),e.draggingObject=this,this._dragTesting=!0,t.GRoot.inst.inputProcessor.addTouchMonitor(i,this),this.on(t.Event.TOUCH_MOVE,this.onTouchMove_0,this),this.on(t.Event.TOUCH_END,this.onTouchEnd_0,this)},e.prototype.dragEnd=function(){e.draggingObject==this&&(this._dragTesting=!1,e.draggingObject=null),s=!1},e.prototype.onTouchBegin_0=function(t){null==this._dragStartPos&&(this._dragStartPos=new cc.Vec2),this._dragStartPos.set(t.pos),this._dragTesting=!0,t.captureTouch()},e.prototype.onTouchMove_0=function(h){if(e.draggingObject!=this&&this._draggable&&this._dragTesting){var l=t.UIConfig.touchDragSensitivity;if(this._dragStartPos&&Math.abs(this._dragStartPos.x-h.pos.x)<l&&Math.abs(this._dragStartPos.y-h.pos.y)<l)return;this._dragTesting=!1,s=!0,this._node.emit(t.Event.DRAG_START,h),s&&this.dragBegin(h.touchId)}if(e.draggingObject==this){var c=h.pos.x-n.x+o.x,u=h.pos.y-n.y+o.y;if(this._dragBounds){var p=t.GRoot.inst.localToGlobalRect(this._dragBounds.x,this._dragBounds.y,this._dragBounds.width,this._dragBounds.height,a);c<p.x?c=p.x:c+o.width>p.xMax&&(c=p.xMax-o.width)<p.x&&(c=p.x),u<p.y?u=p.y:u+o.height>p.yMax&&(u=p.yMax-o.height)<p.y&&(u=p.y)}i=!0;var d=this.parent.globalToLocal(c,u,r);this.setPosition(Math.round(d.x),Math.round(d.y)),i=!1,this._node.emit(t.Event.DRAG_MOVE,h)}},e.prototype.onTouchEnd_0=function(i){e.draggingObject==this&&(e.draggingObject=null,this._node.emit(t.Event.DRAG_END,i))},e._defaultGroupIndex=-1,e}();t.GObject=e;var i,n=new cc.Vec2,o=new cc.Rect,r=new cc.Vec2,a=new cc.Rect,s=!1,h=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._emitDisplayEvents=!1,t}return __extends(i,e),i.prototype.callLater=function(t,e){cc.director.getScheduler().isScheduled(t,this)||this.scheduleOnce(t,e)},i.prototype.onClickLink=function(e,i){this.node.emit(t.Event.LINK,i,e)},i.prototype.onEnable=function(){this.node.$gobj.onEnable(),this._emitDisplayEvents&&this.node.emit(t.Event.DISPLAY)},i.prototype.onDisable=function(){this.node.$gobj.onDisable(),this._emitDisplayEvents&&this.node.emit(t.Event.UNDISPLAY)},i.prototype.update=function(t){this.node.$gobj.onUpdate(t)},i.prototype.onDestroy=function(){this.node.$gobj.onDestroy()},i}(cc.Component);t.GObjectPartner=h}(fgui||(fgui={})),function(t){var e=function(e){function n(){var i=e.call(this)||this;return i._sortingChildCount=0,i._childrenRenderOrder=t.ChildrenRenderOrder.Ascent,i._apexIndex=0,i._node.name="GComponent",i._children=new Array,i._controllers=new Array,i._transitions=new Array,i._margin=new t.Margin,i._alignOffset=new cc.Vec2,i._container=new cc.Node("Container"),i._container.setAnchorPoint(0,1),i._node.addChild(i._container),i}return __extends(n,e),n.prototype.dispose=function(){var t,i;for(i=this._transitions.length,t=0;t<i;++t){this._transitions[t].dispose()}for(i=this._controllers.length,t=0;t<i;++t){this._controllers[t].dispose()}for(this._scrollPane&&this._scrollPane.destroy(),t=(i=this._children.length)-1;t>=0;--t){var n=this._children[t];n._parent=null,n.dispose()}this._boundsChanged=!1,e.prototype.dispose.call(this)},Object.defineProperty(n.prototype,"displayListContainer",{get:function(){return this._container},enumerable:!1,configurable:!0}),n.prototype.addChild=function(t){return this.addChildAt(t,this._children.length),t},n.prototype.addChildAt=function(t,e){if(!t)throw"child is null";var i=this._children.length;if(e>=0&&e<=i){if(t.parent==this)this.setChildIndex(t,e);else{t.removeFromParent(),t._parent=this;var n=this._children.length;0!=t.sortingOrder?(this._sortingChildCount++,e=this.getInsertPosForSortingChild(t)):this._sortingChildCount>0&&e>n-this._sortingChildCount&&(e=n-this._sortingChildCount),e==n?this._children.push(t):this._children.splice(e,0,t),this.onChildAdd(t,e),this.setBoundsChangedFlag()}return t}throw"Invalid child index"},n.prototype.getInsertPosForSortingChild=function(t){var e=this._children.length,i=0;for(i=0;i<e;i++){var n=this._children[i];if(n!=t&&t.sortingOrder<n.sortingOrder)break}return i},n.prototype.removeChild=function(t,e){var i=this._children.indexOf(t);return-1!=i&&this.removeChildAt(i,e),t},n.prototype.removeChildAt=function(e,i){if(e>=0&&e<this.numChildren){var n=this._children[e];return n._parent=null,0!=n.sortingOrder&&this._sortingChildCount--,this._children.splice(e,1),n.group=null,this._container.removeChild(n.node),this._childrenRenderOrder==t.ChildrenRenderOrder.Arch&&this._partner.callLater(this.buildNativeDisplayList),i?n.dispose():n.node.parent=null,this.setBoundsChangedFlag(),n}throw"Invalid child index"},n.prototype.removeChildren=function(t,e,i){void 0==t&&(t=0),void 0==e&&(e=-1),(e<0||e>=this.numChildren)&&(e=this.numChildren-1);for(var n=t;n<=e;++n)this.removeChildAt(t,i)},n.prototype.getChildAt=function(t){if(t>=0&&t<this.numChildren)return this._children[t];throw"Invalid child index"},n.prototype.getChild=function(t){for(var e=this._children.length,i=0;i<e;++i)if(this._children[i].name==t)return this._children[i];return null},n.prototype.getChildByPath=function(t){for(var e,i=t.split("."),o=i.length,r=this,a=0;a<o&&(e=r.getChild(i[a]));++a)if(a!=o-1){if(!(e instanceof n)){e=null;break}r=e}return e},n.prototype.getVisibleChild=function(t){for(var e=this._children.length,i=0;i<e;++i){var n=this._children[i];if(n._finalVisible&&n.name==t)return n}return null},n.prototype.getChildInGroup=function(t,e){for(var i=this._children.length,n=0;n<i;++n){var o=this._children[n];if(o.group==e&&o.name==t)return o}return null},n.prototype.getChildById=function(t){for(var e=this._children.length,i=0;i<e;++i)if(this._children[i]._id==t)return this._children[i];return null},n.prototype.getChildIndex=function(t){return this._children.indexOf(t)},n.prototype.setChildIndex=function(t,e){var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";if(0==t.sortingOrder){var n=this._children.length;this._sortingChildCount>0&&e>n-this._sortingChildCount-1&&(e=n-this._sortingChildCount-1),this._setChildIndex(t,i,e)}},n.prototype.setChildIndexBefore=function(t,e){var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";if(0!=t.sortingOrder)return i;var n=this._children.length;return this._sortingChildCount>0&&e>n-this._sortingChildCount-1&&(e=n-this._sortingChildCount-1),i<e?this._setChildIndex(t,i,e-1):this._setChildIndex(t,i,e)},n.prototype._setChildIndex=function(e,i,n){var o=this._children.length;return n>o&&(n=o),i==n?i:(this._children.splice(i,1),this._children.splice(n,0,e),this._childrenRenderOrder==t.ChildrenRenderOrder.Ascent?e.node.setSiblingIndex(n):this._childrenRenderOrder==t.ChildrenRenderOrder.Descent?e.node.setSiblingIndex(o-n):this._partner.callLater(this.buildNativeDisplayList),this.setBoundsChangedFlag(),n)},n.prototype.swapChildren=function(t,e){var i=this._children.indexOf(t),n=this._children.indexOf(e);if(-1==i||-1==n)throw"Not a child of this container";this.swapChildrenAt(i,n)},n.prototype.swapChildrenAt=function(t,e){var i=this._children[t],n=this._children[e];this.setChildIndex(i,e),this.setChildIndex(n,t)},Object.defineProperty(n.prototype,"numChildren",{get:function(){return this._children.length},enumerable:!1,configurable:!0}),n.prototype.isAncestorOf=function(t){if(null==t)return!1;for(var e=t.parent;e;){if(e==this)return!0;e=e.parent}return!1},n.prototype.addController=function(t){this._controllers.push(t),t.parent=this,this.applyController(t)},n.prototype.getControllerAt=function(t){return this._controllers[t]},n.prototype.getController=function(t){for(var e=this._controllers.length,i=0;i<e;++i){var n=this._controllers[i];if(n.name==t)return n}return null},n.prototype.removeController=function(t){var e=this._controllers.indexOf(t);if(-1==e)throw"controller not exists";t.parent=null,this._controllers.splice(e,1);for(var i=this._children.length,n=0;n<i;n++){this._children[n].handleControllerChanged(t)}},Object.defineProperty(n.prototype,"controllers",{get:function(){return this._controllers},enumerable:!1,configurable:!0}),n.prototype.onChildAdd=function(e,i){if(e.node.parent=this._container,e.node.active=e._finalVisible,!this._buildingDisplayList){var n=this._children.length;this._childrenRenderOrder==t.ChildrenRenderOrder.Ascent?e.node.setSiblingIndex(i):this._childrenRenderOrder==t.ChildrenRenderOrder.Descent?e.node.setSiblingIndex(n-i):this._partner.callLater(this.buildNativeDisplayList)}},n.prototype.buildNativeDisplayList=function(e){if(isNaN(e)){var i=this._children.length;if(0!=i)switch(this._childrenRenderOrder){case t.ChildrenRenderOrder.Ascent:for(var n=0,o=0;o<i;o++)this._children[o].node.setSiblingIndex(n++);break;case t.ChildrenRenderOrder.Descent:for(n=0,o=i-1;o>=0;o--)this._children[o].node.setSiblingIndex(n++);break;case t.ChildrenRenderOrder.Arch:for(n=0,o=0;o<this._apexIndex;o++)this._children[o].node.setSiblingIndex(n++);for(o=i-1;o>=this._apexIndex;o--)this._children[o].node.setSiblingIndex(n++)}}else{this.node.$gobj.buildNativeDisplayList()}},n.prototype.applyController=function(t){this._applyingController=t;for(var e=this._children.length,i=0;i<e;i++)this._children[i].handleControllerChanged(t);this._applyingController=null,t.runActions()},n.prototype.applyAllControllers=function(){for(var t=this._controllers.length,e=0;e<t;++e)this.applyController(this._controllers[e])},n.prototype.adjustRadioGroupDepth=function(e,i){var n,o,r=this._children.length,a=-1,s=-1;for(n=0;n<r;n++)(o=this._children[n])==e?a=n:o instanceof t.GButton&&o.relatedController==i&&n>s&&(s=n);a<s&&(this._applyingController&&this._children[s].handleControllerChanged(this._applyingController),this.swapChildrenAt(a,s))},n.prototype.getTransitionAt=function(t){return this._transitions[t]},n.prototype.getTransition=function(t){for(var e=this._transitions.length,i=0;i<e;++i){var n=this._transitions[i];if(n.name==t)return n}return null},n.prototype.isChildInView=function(t){return this._rectMask?t.x+t.width>=0&&t.x<=this.width&&t.y+t.height>=0&&t.y<=this.height:!this._scrollPane||this._scrollPane.isChildInView(t)},n.prototype.getFirstChildInView=function(){for(var t=this._children.length,e=0;e<t;++e){var i=this._children[e];if(this.isChildInView(i))return e}return-1},Object.defineProperty(n.prototype,"scrollPane",{get:function(){return this._scrollPane},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"opaque",{get:function(){return this._opaque},set:function(t){this._opaque=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"margin",{get:function(){return this._margin},set:function(t){this._margin.copy(t),this.handleSizeChanged()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"childrenRenderOrder",{get:function(){return this._childrenRenderOrder},set:function(t){this._childrenRenderOrder!=t&&(this._childrenRenderOrder=t,this.buildNativeDisplayList())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"apexIndex",{get:function(){return this._apexIndex},set:function(e){this._apexIndex!=e&&(this._apexIndex=e,this._childrenRenderOrder==t.ChildrenRenderOrder.Arch&&this.buildNativeDisplayList())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mask",{get:function(){return this._maskContent},set:function(t){this.setMask(t,!1)},enumerable:!1,configurable:!0}),n.prototype.setMask=function(e,i){if(this._maskContent&&(this._maskContent.node.off(cc.Node.EventType.POSITION_CHANGED,this.onMaskContentChanged,this),this._maskContent.node.off(cc.Node.EventType.SIZE_CHANGED,this.onMaskContentChanged,this),this._maskContent.node.off(cc.Node.EventType.SCALE_CHANGED,this.onMaskContentChanged,this),this._maskContent.node.off(cc.Node.EventType.ANCHOR_CHANGED,this.onMaskContentChanged,this),this._maskContent.visible=!0),this._maskContent=e,this._maskContent){if(!(e instanceof t.GImage||e instanceof t.GGraph))return;if(!this._customMask){var n=new cc.Node("Mask");n.parent=this._node,this._scrollPane?this._container.parent.parent=n:this._container.parent=n,this._customMask=n.addComponent(cc.Mask)}e.visible=!1,e.node.on(cc.Node.EventType.POSITION_CHANGED,this.onMaskContentChanged,this),e.node.on(cc.Node.EventType.SIZE_CHANGED,this.onMaskContentChanged,this),e.node.on(cc.Node.EventType.SCALE_CHANGED,this.onMaskContentChanged,this),e.node.on(cc.Node.EventType.ANCHOR_CHANGED,this.onMaskContentChanged,this),this._customMask.inverted=i,this._node.activeInHierarchy?this.onMaskReady():this.on(t.Event.DISPLAY,this.onMaskReady,this),this.onMaskContentChanged(),this._scrollPane?this._scrollPane.adjustMaskContainer():this._container.setPosition(0,0)}else this._customMask&&(this._scrollPane?this._container.parent.parent=this._node:this._container.parent=this._node,this._customMask.node.destroy(),this._customMask=null,this._scrollPane?this._scrollPane.adjustMaskContainer():this._container.setPosition(this._pivotCorrectX,this._pivotCorrectY))},n.prototype.onMaskReady=function(){this.off(t.Event.DISPLAY,this.onMaskReady,this),this._maskContent instanceof t.GImage?(this._customMask.type=cc.Mask.Type.IMAGE_STENCIL,this._customMask.alphaThreshold=1e-4,this._customMask.spriteFrame=this._maskContent._content.spriteFrame):this._maskContent instanceof t.GGraph&&(2==this._maskContent.type?this._customMask.type=cc.Mask.Type.ELLIPSE:this._customMask.type=cc.Mask.Type.RECT)},n.prototype.onMaskContentChanged=function(){var t=this._customMask.node,e=this._maskContent.node,i=e.width*e.scaleX,n=e.height*e.scaleY;t.setContentSize(i,n);var o=e.x-e.anchorX*i,r=e.y-e.anchorY*n;t.setAnchorPoint(-o/t.width,-r/t.height),t.setPosition(this._pivotCorrectX,this._pivotCorrectY)},Object.defineProperty(n.prototype,"_pivotCorrectX",{get:function(){return-this.pivotX*this._width+this._margin.left},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_pivotCorrectY",{get:function(){return this.pivotY*this._height-this._margin.top},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"baseUserData",{get:function(){var t=this.packageItem.rawData;return t.seek(0,4),t.readS()},enumerable:!1,configurable:!0}),n.prototype.setupScroll=function(e){this._scrollPane=this._node.addComponent(t.ScrollPane),this._scrollPane.setup(e)},n.prototype.setupOverflow=function(e){e==t.OverflowType.Hidden&&(this._rectMask=this._container.addComponent(cc.Mask)),this._margin.isNone||this.handleSizeChanged()},n.prototype.handleAnchorChanged=function(){e.prototype.handleAnchorChanged.call(this),this._customMask?this._customMask.node.setPosition(this._pivotCorrectX,this._pivotCorrectY):this._scrollPane?this._scrollPane.adjustMaskContainer():this._container.setPosition(this._pivotCorrectX+this._alignOffset.x,this._pivotCorrectY-this._alignOffset.y)},n.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._customMask?this._customMask.node.setPosition(this._pivotCorrectX,this._pivotCorrectY):this._scrollPane||this._container.setPosition(this._pivotCorrectX,this._pivotCorrectY),this._scrollPane?this._scrollPane.onOwnerSizeChanged():this._container.setContentSize(this.viewWidth,this.viewHeight)},n.prototype.handleGrayedChanged=function(){var t=this.getController("grayed");if(t)t.selectedIndex=this.grayed?1:0;else for(var e=this.grayed,i=this._children.length,n=0;n<i;++n)this._children[n].grayed=e},n.prototype.handleControllerChanged=function(t){e.prototype.handleControllerChanged.call(this,t),this._scrollPane&&this._scrollPane.handleControllerChanged(t)},n.prototype._hitTest=function(e,n){if(this._customMask&&(i.set(n),i.y=t.GRoot.inst.height-n.y,!(this._customMask._hitTest(i)||!1)))return null;if(this.hitArea){if(!this.hitArea.hitTest(e,n))return null}else if(this._rectMask){i.set(e),i.x+=this._container.x,i.y+=this._container.y;var o=this._container.getContentSize();if(i.x<0||i.y<0||i.x>=o.width||i.y>=o.height)return null}if(this._scrollPane){var r=this._scrollPane.hitTest(e,n);if(!r)return null;if(r!=this)return r}for(var a=null,s=this._children.length-1;s>=0;s--){var h=this._children[s];if(this._maskContent!=h&&!h._touchDisabled&&(a=h.hitTest(n)))break}return!a&&this._opaque&&(this.hitArea||e.x>=0&&e.y>=0&&e.x<this._width&&e.y<this._height)&&(a=this),a},n.prototype.setBoundsChangedFlag=function(){(this._scrollPane||this._trackBounds)&&(this._boundsChanged||(this._boundsChanged=!0,this._partner.callLater(this.refresh)))},n.prototype.refresh=function(t){if(isNaN(t)){if(this._boundsChanged){var e=this._children.length;if(e>0)for(var i=0;i<e;i++){this._children[i].ensureSizeCorrect()}this.updateBounds()}}else this.node.$gobj.refresh()},n.prototype.ensureBoundsCorrect=function(){var t=this._children.length;if(t>0)for(var e=0;e<t;e++){this._children[e].ensureSizeCorrect()}this._boundsChanged&&this.updateBounds()},n.prototype.updateBounds=function(){var t=0,e=0,i=0,n=0,o=this._children.length;if(o>0){t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY;var r=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=0,h=0;for(h=0;h<o;h++){var l=this._children[h];(s=l.x)<t&&(t=s),(s=l.y)<e&&(e=s),(s=l.x+l.actualWidth)>r&&(r=s),(s=l.y+l.actualHeight)>a&&(a=s)}i=r-t,n=a-e}this.setBounds(t,e,i,n)},n.prototype.setBounds=function(t,e,i,n){void 0===n&&(n=0),this._boundsChanged=!1,this._scrollPane&&this._scrollPane.setContentSize(Math.round(t+i),Math.round(e+n))},Object.defineProperty(n.prototype,"viewWidth",{get:function(){return this._scrollPane?this._scrollPane.viewWidth:this.width-this._margin.left-this._margin.right},set:function(t){this._scrollPane?this._scrollPane.viewWidth=t:this.width=t+this._margin.left+this._margin.right},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewHeight",{get:function(){return this._scrollPane?this._scrollPane.viewHeight:this.height-this._margin.top-this._margin.bottom},set:function(t){this._scrollPane?this._scrollPane.viewHeight=t:this.height=t+this._margin.top+this._margin.bottom},enumerable:!1,configurable:!0}),n.prototype.getSnappingPosition=function(t,e,i){i||(i=new cc.Vec2);var n=this._children.length;if(0==n)return i.x=0,i.y=0,i;this.ensureBoundsCorrect();var o=null,r=null,a=0;if(0!=e){for(;a<n;a++)if(e<(o=this._children[a]).y){if(0==a){e=0;break}e=e<(r=this._children[a-1]).y+r.actualHeight/2?r.y:o.y;break}a==n&&(e=o.y)}if(0!=t){for(a>0&&a--;a<n;a++)if(t<(o=this._children[a]).x){if(0==a){t=0;break}t=t<(r=this._children[a-1]).x+r.actualWidth/2?r.x:o.x;break}a==n&&(t=o.x)}return i.x=t,i.y=e,i},n.prototype.childSortingOrderChanged=function(t,e,i){if(void 0===i&&(i=0),0==i)this._sortingChildCount--,this.setChildIndex(t,this._children.length);else{0==e&&this._sortingChildCount++;var n=this._children.indexOf(t),o=this.getInsertPosForSortingChild(t);n<o?this._setChildIndex(t,n,o-1):this._setChildIndex(t,n,o)}},n.prototype.constructFromResource=function(){this.constructFromResource2(null,0)},n.prototype.constructFromResource2=function(e,i){var n,o,r,a,s,h,l,c,u=this.packageItem.getBranch();u.decoded||(u.decoded=!0,t.TranslationHelper.translateComponent(u));var p=u.rawData;p.seek(0,0),this._underConstruct=!0,this.sourceWidth=p.readInt(),this.sourceHeight=p.readInt(),this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),p.readBool()&&(this.minWidth=p.readInt(),this.maxWidth=p.readInt(),this.minHeight=p.readInt(),this.maxHeight=p.readInt()),p.readBool()&&(s=p.readFloat(),h=p.readFloat(),this.setPivot(s,h,p.readBool())),p.readBool()&&(this._margin.top=p.readInt(),this._margin.bottom=p.readInt(),this._margin.left=p.readInt(),this._margin.right=p.readInt());var d=p.readByte();if(d==t.OverflowType.Scroll){var f=p.position;p.seek(0,7),this.setupScroll(p),p.position=f}else this.setupOverflow(d);p.readBool()&&p.skip(8),this._buildingDisplayList=!0,p.seek(0,1);var _,g=p.readShort();for(n=0;n<g;n++){a=p.readShort(),a+=p.position;var m=new t.Controller;this._controllers.push(m),m.parent=this,m.setup(p),p.position=a}p.seek(0,2);var y=p.readShort();for(n=0;n<y;n++){if(o=p.readShort(),r=p.position,e)_=e[i+n];else{p.seek(r,0);var v,b=p.readByte(),C=p.readS(),S=p.readS(),w=null;if(null!=C)w=(v=null!=S?t.UIPackage.getById(S):u.owner)?v.getItemById(C):null;w?(_=t.UIObjectFactory.newObject(w)).constructFromResource():_=t.UIObjectFactory.newObject(b)}_._underConstruct=!0,_.setup_beforeAdd(p,r),_._parent=this,_.node.parent=this._container,this._children.push(_),p.position=r+o}for(p.seek(0,3),this.relations.setup(p,!0),p.seek(0,2),p.skip(2),n=0;n<y;n++)a=p.readShort(),a+=p.position,p.seek(p.position,3),this._children[n].relations.setup(p,!1),p.position=a;for(p.seek(0,2),p.skip(2),n=0;n<y;n++)a=p.readShort(),a+=p.position,(_=this._children[n]).setup_afterAdd(p,p.position),_._underConstruct=!1,p.position=a;p.seek(0,4),p.skip(2),this.opaque=p.readBool();var x=p.readShort();-1!=x&&this.setMask(this.getChildAt(x),p.readBool());var I=p.readS();l=p.readInt(),c=p.readInt(),null!=I?(w=u.owner.getItemById(I))&&w.hitTestData&&(this.hitArea=new t.PixelHitTest(w.hitTestData,l,c)):0!=l&&-1!=c&&(this.hitArea=new t.ChildHitArea(this.getChildAt(c))),p.seek(0,5);var P=p.readShort();for(n=0;n<P;n++){a=p.readShort(),a+=p.position;var T=new t.Transition(this);T.setup(p),this._transitions.push(T),p.position=a}this.applyAllControllers(),this._buildingDisplayList=!1,this._underConstruct=!1,this.buildNativeDisplayList(),this.setBoundsChangedFlag(),u.objectType!=t.ObjectType.Component&&this.constructExtension(p),this.onConstruct()},n.prototype.constructExtension=function(t){},n.prototype.onConstruct=function(){},n.prototype.setup_afterAdd=function(t,i){e.prototype.setup_afterAdd.call(this,t,i),t.seek(i,4);var n=t.readShort();-1!=n&&this._scrollPane&&(this._scrollPane.pageController=this._parent.getControllerAt(n));for(var o=t.readShort(),r=0;r<o;r++){var a=this.getController(t.readS()),s=t.readS();a&&(a.selectedPageId=s)}if(t.version>=2)for(o=t.readShort(),r=0;r<o;r++){var h=t.readS(),l=t.readShort(),c=t.readS(),u=this.getChildByPath(h);u&&u.setProp(l,c)}},n.prototype.onEnable=function(){for(var t=this._transitions.length,e=0;e<t;++e)this._transitions[e].onEnable()},n.prototype.onDisable=function(){for(var t=this._transitions.length,e=0;e<t;++e)this._transitions[e].onDisable()},n}(t.GObject);t.GComponent=e;var i=new cc.Vec2}(fgui||(fgui={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._node.name="GButton",i._mode=t.ButtonMode.Common,i._title="",i._icon="",i._sound=t.UIConfig.buttonSound,i._soundVolumeScale=t.UIConfig.buttonSoundVolumeScale,i._changeStateOnClick=!0,i._downEffect=0,i._downEffectValue=.8,i}return __extends(i,e),Object.defineProperty(i.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selectedIcon",{get:function(){return this._selectedIcon},set:function(t){this._selectedIcon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,this._iconObject&&(this._iconObject.icon=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this._title},set:function(t){this._title=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title),this.updateGear(6)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.title},set:function(t){this.title=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selectedTitle",{get:function(){return this._selectedTitle},set:function(t){this._selectedTitle=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"titleColor",{get:function(){var t=this.getTextField();return t?t.color:cc.Color.BLACK},set:function(t){var e=this.getTextField();e&&(e.color=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"titleFontSize",{get:function(){var t=this.getTextField();return t?t.fontSize:0},set:function(t){var e=this.getTextField();e&&(e.fontSize=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"sound",{get:function(){return this._sound},set:function(t){this._sound=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"soundVolumeScale",{get:function(){return this._soundVolumeScale},set:function(t){this._soundVolumeScale=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selected",{get:function(){return this._selected},set:function(e){if(this._mode!=t.ButtonMode.Common&&this._selected!=e){if(this._selected=e,this.setCurrentState(),this._selectedTitle&&this._titleObject&&(this._titleObject.text=this._selected?this._selectedTitle:this._title),this._selectedIcon){var i=this._selected?this._selectedIcon:this._icon;this._iconObject&&(this._iconObject.icon=i)}this._relatedController&&this._parent&&!this._parent._buildingDisplayList&&(this._selected?(this._relatedController.selectedPageId=this._relatedPageId,this._relatedController.autoRadioGroupDepth&&this._parent.adjustRadioGroupDepth(this,this._relatedController)):this._mode==t.ButtonMode.Check&&this._relatedController.selectedPageId==this._relatedPageId&&(this._relatedController.oppositePageId=this._relatedPageId))}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"mode",{get:function(){return this._mode},set:function(e){this._mode!=e&&(e==t.ButtonMode.Common&&(this.selected=!1),this._mode=e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"relatedController",{get:function(){return this._relatedController},set:function(t){this._relatedController=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"relatedPageId",{get:function(){return this._relatedPageId},set:function(t){this._relatedPageId=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"changeStateOnClick",{get:function(){return this._changeStateOnClick},set:function(t){this._changeStateOnClick=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"linkedPopup",{get:function(){return this._linkedPopup},set:function(t){this._linkedPopup=t},enumerable:!1,configurable:!0}),i.prototype.getTextField=function(){return this._titleObject instanceof t.GTextField?this._titleObject:this._titleObject instanceof t.GLabel||this._titleObject instanceof i?this._titleObject.getTextField():null},i.prototype.fireClick=function(){t.GRoot.inst.inputProcessor.simulateClick(this)},i.prototype.setState=function(e){if(this._buttonController&&(this._buttonController.selectedPage=e),1==this._downEffect){var n=this.numChildren;if(e==i.DOWN||e==i.SELECTED_OVER||e==i.SELECTED_DISABLED){this._downColor||(this._downColor=new cc.Color);var o=255*this._downEffectValue;this._downColor.r=this._downColor.g=this._downColor.b=o;for(var r=0;r<n;r++){void 0==(a=this.getChildAt(r)).color||a instanceof t.GTextField||(a.color=this._downColor)}}else for(r=0;r<n;r++){var a;void 0==(a=this.getChildAt(r)).color||a instanceof t.GTextField||(a.color=cc.Color.WHITE)}}else 2==this._downEffect&&(e==i.DOWN||e==i.SELECTED_OVER||e==i.SELECTED_DISABLED?this._downScaled||(this._downScaled=!0,this.setScale(this.scaleX*this._downEffectValue,this.scaleY*this._downEffectValue)):this._downScaled&&(this._downScaled=!1,this.setScale(this.scaleX/this._downEffectValue,this.scaleY/this._downEffectValue)))},i.prototype.setCurrentState=function(){this.grayed&&this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this._selected?this.setState(i.SELECTED_DISABLED):this.setState(i.DISABLED):this._selected?this.setState(this._over?i.SELECTED_OVER:i.DOWN):this.setState(this._over?i.OVER:i.UP)},i.prototype.handleControllerChanged=function(t){e.prototype.handleControllerChanged.call(this,t),this._relatedController==t&&(this.selected=this._relatedPageId==t.selectedPageId)},i.prototype.handleGrayedChanged=function(){this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this.grayed?this._selected&&this._buttonController.hasPage(i.SELECTED_DISABLED)?this.setState(i.SELECTED_DISABLED):this.setState(i.DISABLED):this._selected?this.setState(i.DOWN):this.setState(i.UP):e.prototype.handleGrayedChanged.call(this)},i.prototype.getProp=function(i){switch(i){case t.ObjectPropID.Color:return this.titleColor;case t.ObjectPropID.OutlineColor:var n=this.getTextField();return n?n.strokeColor:0;case t.ObjectPropID.FontSize:return this.titleFontSize;case t.ObjectPropID.Selected:return this.selected;default:return e.prototype.getProp.call(this,i)}},i.prototype.setProp=function(i,n){switch(i){case t.ObjectPropID.Color:this.titleColor=n;break;case t.ObjectPropID.OutlineColor:var o=this.getTextField();o&&(o.strokeColor=n);break;case t.ObjectPropID.FontSize:this.titleFontSize=n;break;case t.ObjectPropID.Selected:this.selected=n;break;default:e.prototype.setProp.call(this,i,n)}},i.prototype.constructExtension=function(e){e.seek(0,6),this._mode=e.readByte();var n=e.readS();n&&(this._sound=n),this._soundVolumeScale=e.readFloat(),this._downEffect=e.readByte(),this._downEffectValue=e.readFloat(),2==this._downEffect&&this.setPivot(.5,.5,this.pivotAsAnchor),this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),this._titleObject&&(this._title=this._titleObject.text),this._iconObject&&(this._icon=this._iconObject.icon),this._mode==t.ButtonMode.Common&&this.setState(i.UP),this._node.on(t.Event.TOUCH_BEGIN,this.onTouchBegin_1,this),this._node.on(t.Event.TOUCH_END,this.onTouchEnd_1,this),this._node.on(t.Event.ROLL_OVER,this.onRollOver_1,this),this._node.on(t.Event.ROLL_OUT,this.onRollOut_1,this),this._node.on(t.Event.CLICK,this.onClick_1,this)},i.prototype.setup_afterAdd=function(t,i){var n,o;(e.prototype.setup_afterAdd.call(this,t,i),t.seek(i,6))&&(t.readByte()==this.packageItem.objectType&&(null!=(n=t.readS())&&(this.title=n),null!=(n=t.readS())&&(this.selectedTitle=n),null!=(n=t.readS())&&(this.icon=n),null!=(n=t.readS())&&(this.selectedIcon=n),t.readBool()&&(this.titleColor=t.readColor()),0!=(o=t.readInt())&&(this.titleFontSize=o),(o=t.readShort())>=0&&(this._relatedController=this.parent.getControllerAt(o)),this._relatedPageId=t.readS(),null!=(n=t.readS())&&(this._sound=n),t.readBool()&&(this._soundVolumeScale=t.readFloat()),this.selected=t.readBool()))},i.prototype.onRollOver_1=function(){this._buttonController&&this._buttonController.hasPage(i.OVER)&&(this._over=!0,this._down||this.grayed&&this._buttonController.hasPage(i.DISABLED)||this.setState(this._selected?i.SELECTED_OVER:i.OVER))},i.prototype.onRollOut_1=function(){this._buttonController&&this._buttonController.hasPage(i.OVER)&&(this._over=!1,this._down||this.grayed&&this._buttonController.hasPage(i.DISABLED)||this.setState(this._selected?i.DOWN:i.UP))},i.prototype.onTouchBegin_1=function(e){e.button==cc.Event.EventMouse.BUTTON_LEFT&&(this._down=!0,e.captureTouch(),this._mode==t.ButtonMode.Common&&(this.grayed&&this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this.setState(i.SELECTED_DISABLED):this.setState(i.DOWN)),this._linkedPopup&&(this._linkedPopup instanceof t.Window?this._linkedPopup.toggleStatus():this.root.togglePopup(this._linkedPopup,this)))},i.prototype.onTouchEnd_1=function(e){if(e.button==cc.Event.EventMouse.BUTTON_LEFT&&this._down){if(this._down=!1,null==this._node)return;this._mode==t.ButtonMode.Common?this.grayed&&this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this.setState(i.DISABLED):this._over?this.setState(i.OVER):this.setState(i.UP):this._over||null==this._buttonController||this._buttonController.selectedPage!=i.OVER&&this._buttonController.selectedPage!=i.SELECTED_OVER||this.setCurrentState()}},i.prototype.onClick_1=function(){if(this._sound){var e=t.UIPackage.getItemByURL(this._sound);if(e){var i=e.owner.getItemAsset(e);i&&t.GRoot.inst.playOneShotSound(i,this._soundVolumeScale)}}this._mode==t.ButtonMode.Check?this._changeStateOnClick&&(this.selected=!this._selected,this._node.emit(t.Event.STATUS_CHANGED,this)):this._mode==t.ButtonMode.Radio?this._changeStateOnClick&&!this._selected&&(this.selected=!0,this._node.emit(t.Event.STATUS_CHANGED,this)):this._relatedController&&(this._relatedController.selectedPageId=this._relatedPageId)},i.UP="up",i.DOWN="down",i.OVER="over",i.SELECTED_OVER="selectedOver",i.DISABLED="disabled",i.SELECTED_DISABLED="selectedDisabled",i}(t.GComponent);t.GButton=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._visibleItemCount=0,i._selectedIndex=0,i._popupDirection=t.PopupDirection.Auto,i._node.name="GComboBox",i._visibleItemCount=t.UIConfig.defaultComboBoxVisibleItemCount,i._itemsUpdated=!0,i._selectedIndex=-1,i._items=[],i._values=[],i}return __extends(i,e),Object.defineProperty(i.prototype,"text",{get:function(){return this._titleObject?this._titleObject.text:null},set:function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"icon",{get:function(){return this._iconObject?this._iconObject.icon:null},set:function(t){this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"titleColor",{get:function(){var t=this.getTextField();return t?t.color:cc.Color.BLACK},set:function(t){var e=this.getTextField();e&&(e.color=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"titleFontSize",{get:function(){var t=this.getTextField();return t?t.fontSize:0},set:function(t){var e=this.getTextField();e&&(e.fontSize=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"visibleItemCount",{get:function(){return this._visibleItemCount},set:function(t){this._visibleItemCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"popupDirection",{get:function(){return this._popupDirection},set:function(t){this._popupDirection=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"items",{get:function(){return this._items},set:function(t){t?this._items=t.concat():this._items.length=0,this._items.length>0?(this._selectedIndex>=this._items.length?this._selectedIndex=this._items.length-1:-1==this._selectedIndex&&(this._selectedIndex=0),this.text=this._items[this._selectedIndex],this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",this._icons&&(this.icon=null),this._selectedIndex=-1),this._itemsUpdated=!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"icons",{get:function(){return this._icons},set:function(t){this._icons=t,this._icons&&-1!=this._selectedIndex&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"values",{get:function(){return this._values},set:function(t){t?this._values=t.concat():this._values.length=0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this._selectedIndex>=0&&this._selectedIndex<this._items.length?(this.text=this._items[this._selectedIndex],this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",this._icons&&(this.icon=null)),this.updateSelectionController())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this._values[this._selectedIndex]},set:function(t){var e=this._values.indexOf(t);-1==e&&null==t&&(e=this._values.indexOf("")),this.selectedIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selectionController",{get:function(){return this._selectionController},set:function(t){this._selectionController=t},enumerable:!1,configurable:!0}),i.prototype.getTextField=function(){return this._titleObject instanceof t.GTextField?this._titleObject:this._titleObject instanceof t.GLabel||this._titleObject instanceof t.GButton?this._titleObject.getTextField():null},i.prototype.setState=function(t){this._buttonController&&(this._buttonController.selectedPage=t)},i.prototype.getProp=function(i){switch(i){case t.ObjectPropID.Color:return this.titleColor;case t.ObjectPropID.OutlineColor:var n=this.getTextField();return n?n.strokeColor:0;case t.ObjectPropID.FontSize:return(n=this.getTextField())?n.fontSize:0;default:return e.prototype.getProp.call(this,i)}},i.prototype.setProp=function(i,n){switch(i){case t.ObjectPropID.Color:this.titleColor=n;break;case t.ObjectPropID.OutlineColor:var o=this.getTextField();o&&(o.strokeColor=n);break;case t.ObjectPropID.FontSize:(o=this.getTextField())&&(o.fontSize=n);break;default:e.prototype.setProp.call(this,i,n)}},i.prototype.constructExtension=function(e){var i;if(this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),i=e.readS()){var n=t.UIPackage.createObjectFromURL(i);if(!(n instanceof t.GComponent))return void console.error("\u4e0b\u62c9\u6846\u5fc5\u987b\u4e3a\u5143\u4ef6");if(this.dropdown=n,this.dropdown.name="this.dropdown",this._list=this.dropdown.getChild("list"),null==this._list)return void console.error(this.resourceURL+": \u4e0b\u62c9\u6846\u7684\u5f39\u51fa\u5143\u4ef6\u91cc\u5fc5\u987b\u5305\u542b\u540d\u4e3alist\u7684\u5217\u8868");this._list.on(t.Event.CLICK_ITEM,this.onClickItem,this),this._list.addRelation(this.dropdown,t.RelationType.Width),this._list.removeRelation(this.dropdown,t.RelationType.Height),this.dropdown.addRelation(this._list,t.RelationType.Height),this.dropdown.removeRelation(this._list,t.RelationType.Width),this.dropdown.on(t.Event.UNDISPLAY,this.onPopupClosed,this)}this._node.on(t.Event.TOUCH_BEGIN,this.onTouchBegin_1,this),this._node.on(t.Event.TOUCH_END,this.onTouchEnd_1,this),this._node.on(t.Event.ROLL_OVER,this.onRollOver_1,this),this._node.on(t.Event.ROLL_OUT,this.onRollOut_1,this)},i.prototype.handleControllerChanged=function(t){e.prototype.handleControllerChanged.call(this,t),this._selectionController==t&&(this.selectedIndex=t.selectedIndex)},i.prototype.updateSelectionController=function(){if(this._selectionController&&!this._selectionController.changing&&this._selectedIndex<this._selectionController.pageCount){var t=this._selectionController;this._selectionController=null,t.selectedIndex=this._selectedIndex,this._selectionController=t}},i.prototype.dispose=function(){this.dropdown&&(this.dropdown.dispose(),this.dropdown=null),e.prototype.dispose.call(this)},i.prototype.setup_afterAdd=function(t,i){if(e.prototype.setup_afterAdd.call(this,t,i),t.seek(i,6)&&t.readByte()==this.packageItem.objectType){var n,o,r,a,s=t.readShort();for(n=0;n<s;n++)r=t.readShort(),r+=t.position,this._items[n]=t.readS(),this._values[n]=t.readS(),null!=(a=t.readS())&&(null==this._icons&&(this._icons=new Array),this._icons[n]=a),t.position=r;null!=(a=t.readS())?(this.text=a,this._selectedIndex=this._items.indexOf(a)):this._items.length>0?(this._selectedIndex=0,this.text=this._items[0]):this._selectedIndex=-1,null!=(a=t.readS())&&(this.icon=a),t.readBool()&&(this.titleColor=t.readColor()),(o=t.readInt())>0&&(this._visibleItemCount=o),this._popupDirection=t.readByte(),(o=t.readShort())>=0&&(this._selectionController=this.parent.getControllerAt(o))}},i.prototype.showDropdown=function(){if(this._itemsUpdated){this._itemsUpdated=!1,this._list.removeChildrenToPool();for(var e=this._items.length,i=0;i<e;i++){var n=this._list.addItemFromPool();n.name=i<this._values.length?this._values[i]:"",n.text=this._items[i],n.icon=this._icons&&i<this._icons.length?this._icons[i]:null}this._list.resizeToFit(this._visibleItemCount)}this._list.selectedIndex=-1,this.dropdown.width=this.width,this._list.ensureBoundsCorrect(),this.root.togglePopup(this.dropdown,this,this._popupDirection),this.dropdown.parent&&this.setState(t.GButton.DOWN)},i.prototype.onPopupClosed=function(){this._over?this.setState(t.GButton.OVER):this.setState(t.GButton.UP)},i.prototype.onClickItem=function(t){var e=this,i=this._list.getChildIndex(t);this._partner.callLater(function(t){e.onClickItem2(i)},.1)},i.prototype.onClickItem2=function(e){this.dropdown.parent instanceof t.GRoot&&this.dropdown.parent.hidePopup(),this._selectedIndex=-1,this.selectedIndex=e,this._node.emit(t.Event.STATUS_CHANGED,this)},i.prototype.onRollOver_1=function(){this._over=!0,this._down||this.dropdown&&this.dropdown.parent||this.setState(t.GButton.OVER)},i.prototype.onRollOut_1=function(){this._over=!1,this._down||this.dropdown&&this.dropdown.parent||this.setState(t.GButton.UP)},i.prototype.onTouchBegin_1=function(e){e.button==cc.Event.EventMouse.BUTTON_LEFT&&(e.initiator instanceof t.GTextInput&&e.initiator.editable||(this._down=!0,e.captureTouch(),this.dropdown&&this.showDropdown()))},i.prototype.onTouchEnd_1=function(e){e.button==cc.Event.EventMouse.BUTTON_LEFT&&this._down&&(this._down=!1,this.dropdown&&!this.dropdown.parent&&(this._over?this.setState(t.GButton.OVER):this.setState(t.GButton.UP)))},i}(t.GComponent);t.GComboBox=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._type=0,t._lineSize=0,t._node.name="GGraph",t._lineSize=1,t._lineColor=new cc.Color,t._fillColor=new cc.Color(255,255,255,255),t._content=t._node.addComponent(cc.Graphics),t}return __extends(i,e),i.prototype.drawRect=function(t,e,i,n){this._type=1,this._lineSize=t,this._lineColor.set(e),this._fillColor.set(i),this._cornerRadius=n,this.updateGraph()},i.prototype.drawEllipse=function(t,e,i){this._type=2,this._lineSize=t,this._lineColor.set(e),this._fillColor.set(i),this.updateGraph()},i.prototype.drawRegularPolygon=function(t,e,i,n,o,r){this._type=4,this._lineSize=t,this._lineColor.set(e),this._fillColor.set(i),this._sides=n,this._startAngle=o||0,this._distances=r,this.updateGraph()},i.prototype.drawPolygon=function(t,e,i,n){this._type=3,this._lineSize=t,this._lineColor.set(e),this._fillColor.set(i),this._polygonPoints=n,this.updateGraph()},Object.defineProperty(i.prototype,"distances",{get:function(){return this._distances},set:function(t){this._distances=t,3==this._type&&this.updateGraph()},enumerable:!1,configurable:!0}),i.prototype.clearGraphics=function(){this._type=0,this._hasContent&&(this._content.clear(),this._hasContent=!1)},Object.defineProperty(i.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this._fillColor},set:function(t){this._fillColor.set(t),0!=this._type&&this.updateGraph()},enumerable:!1,configurable:!0}),i.prototype.updateGraph=function(){var t=this._content;this._hasContent&&(this._hasContent=!1,t.clear());var e=this._width,i=this._height;if(0!=e&&0!=i){var n=-this.pivotX*this._width,o=this.pivotY*this._height,r=this._lineSize/2;if(t.lineWidth=this._lineSize,t.strokeColor=this._lineColor,t.fillColor=this._fillColor,1==this._type)this._cornerRadius?t.roundRect(n+r,-i+o+r,e-this._lineSize,i-this._lineSize,this._cornerRadius[0]):t.rect(n+r,-i+o+r,e-this._lineSize,i-this._lineSize);else if(2==this._type)t.ellipse(e/2+n,-i/2+o,e/2-r,i/2-r);else if(3==this._type)this.drawPath(t,this._polygonPoints,n,o);else if(4==this._type){this._polygonPoints||(this._polygonPoints=[]);var a=Math.min(e,i)/2-r;this._polygonPoints.length=0;for(var s,h=cc.misc.degreesToRadians(this._startAngle),l=2*Math.PI/this._sides,c=0;c<this._sides;c++){this._distances?(s=this._distances[c],isNaN(s)&&(s=1)):s=1;var u=a+a*s*Math.cos(h),p=a+a*s*Math.sin(h);this._polygonPoints.push(u,p),h+=l}this.drawPath(t,this._polygonPoints,n,o)}0!=r&&t.stroke(),0!=this._fillColor.a&&t.fill(),this._hasContent=!0}},i.prototype.drawPath=function(t,e,i,n){var o=e.length;t.moveTo(e[0]+i,-e[1]+n);for(var r=2;r<o;r+=2)t.lineTo(e[r]+i,-e[r+1]+n);t.lineTo(e[0]+i,-e[1]+n)},i.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),0!=this._type&&this.updateGraph()},i.prototype.handleAnchorChanged=function(){e.prototype.handleAnchorChanged.call(this),0!=this._type&&this.updateGraph()},i.prototype.getProp=function(i){return i==t.ObjectPropID.Color?this.color:e.prototype.getProp.call(this,i)},i.prototype.setProp=function(i,n){i==t.ObjectPropID.Color?this.color=n:e.prototype.setProp.call(this,i,n)},i.prototype._hitTest=function(t){if(t.x>=0&&t.y>=0&&t.x<this._width&&t.y<this._height){if(3==this._type){var e=this._polygonPoints,i=e.length/2,n=void 0,o=i-1,r=!1;this._width,this._height;for(n=0;n<i;++n){var a=e[2*n],s=e[2*n+1],h=e[2*o],l=e[2*o+1];(s<t.y&&l>=t.y||l<t.y&&s>=t.y)&&(a<=t.x||h<=t.x)&&a+(t.y-s)/(l-s)*(h-a)<t.x&&(r=!r),o=n}return r?this:null}return this}return null},i.prototype.setup_beforeAdd=function(t,i){if(e.prototype.setup_beforeAdd.call(this,t,i),t.seek(i,5),this._type=t.readByte(),0!=this._type){var n,o;if(this._lineSize=t.readInt(),this._lineColor.set(t.readColor(!0)),this._fillColor.set(t.readColor(!0)),t.readBool())for(this._cornerRadius=new Array(4),n=0;n<4;n++)this._cornerRadius[n]=t.readFloat();if(3==this._type)for(o=t.readShort(),this._polygonPoints=[],this._polygonPoints.length=o,n=0;n<o;n++)this._polygonPoints[n]=t.readFloat();else if(4==this._type&&(this._sides=t.readShort(),this._startAngle=t.readFloat(),(o=t.readShort())>0))for(this._distances=[],n=0;n<o;n++)this._distances[n]=t.readFloat();this.updateGraph()}},i}(t.GObject);t.GGraph=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._layout=0,t._lineGap=0,t._columnGap=0,t._mainGridIndex=-1,t._mainGridMinSize=50,t._mainChildIndex=-1,t._totalSize=0,t._numChildren=0,t._updating=0,t._node.name="GGroup",t._touchDisabled=!0,t}return __extends(i,e),i.prototype.dispose=function(){this._boundsChanged=!1,e.prototype.dispose.call(this)},Object.defineProperty(i.prototype,"layout",{get:function(){return this._layout},set:function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineGap",{get:function(){return this._lineGap},set:function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"columnGap",{get:function(){return this._columnGap},set:function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"excludeInvisibles",{get:function(){return this._excludeInvisibles},set:function(t){this._excludeInvisibles!=t&&(this._excludeInvisibles=t,this.setBoundsChangedFlag())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoSizeDisabled",{get:function(){return this._autoSizeDisabled},set:function(t){this._autoSizeDisabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"mainGridMinSize",{get:function(){return this._mainGridMinSize},set:function(t){this._mainGridMinSize!=t&&(this._mainGridMinSize=t,this.setBoundsChangedFlag())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"mainGridIndex",{get:function(){return this._mainGridIndex},set:function(t){this._mainGridIndex!=t&&(this._mainGridIndex=t,this.setBoundsChangedFlag())},enumerable:!1,configurable:!0}),i.prototype.setBoundsChangedFlag=function(e){void 0===e&&(e=!1),0==this._updating&&this._parent&&(e||(this._percentReady=!1),this._boundsChanged||(this._boundsChanged=!0,this._layout!=t.GroupLayoutType.None&&this._partner.callLater(this._ensureBoundsCorrect)))},i.prototype._ensureBoundsCorrect=function(){this.node.$gobj.ensureBoundsCorrect()},i.prototype.ensureSizeCorrect=function(){null!=this._parent&&this._boundsChanged&&0!=this._layout&&(this._boundsChanged=!1,this._autoSizeDisabled?this.resizeChildren(0,0):(this.handleLayout(),this.updateBounds()))},i.prototype.ensureBoundsCorrect=function(){null!=this._parent&&this._boundsChanged&&(this._boundsChanged=!1,0==this._layout?this.updateBounds():this._autoSizeDisabled?this.resizeChildren(0,0):(this.handleLayout(),this.updateBounds()))},i.prototype.updateBounds=function(){this._partner.unschedule(this._ensureBoundsCorrect);var t,e,i,n=this._parent.numChildren,o=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,h=!0;for(t=0;t<n;t++)(e=this._parent.getChildAt(t)).group!=this||this._excludeInvisibles&&!e.internalVisible3||((i=e.xMin)<o&&(o=i),(i=e.yMin)<r&&(r=i),(i=e.xMin+e.width)>a&&(a=i),(i=e.yMin+e.height)>s&&(s=i),h=!1);var l=0,c=0;h||(this._updating|=1,this.setPosition(o,r),this._updating&=2,l=a-o,c=s-r),0==(2&this._updating)?(this._updating|=2,this.setSize(l,c),this._updating&=1):(this._updating&=1,this.resizeChildren(this._width-l,this._height-c))},i.prototype.handleLayout=function(){var e,i,n;if(this._updating|=1,this._layout==t.GroupLayoutType.Horizontal){var o=this.x;for(n=this._parent.numChildren,i=0;i<n;i++)(e=this._parent.getChildAt(i)).group==this&&(this._excludeInvisibles&&!e.internalVisible3||(e.xMin=o,0!=e.width&&(o+=e.width+this._columnGap)))}else if(this._layout==t.GroupLayoutType.Vertical){var r=this.y;for(n=this._parent.numChildren,i=0;i<n;i++)(e=this._parent.getChildAt(i)).group==this&&(this._excludeInvisibles&&!e.internalVisible3||(e.yMin=r,0!=e.height&&(r+=e.height+this._lineGap)))}this._updating&=2},i.prototype.moveChildren=function(t,e){if(0==(1&this._updating)&&null!=this._parent){this._updating|=1;var i,n,o=this._parent.numChildren;for(i=0;i<o;i++)(n=this._parent.getChildAt(i)).group==this&&n.setPosition(n.x+t,n.y+e);this._updating&=2}},i.prototype.resizeChildren=function(e,i){if(this._layout!=t.GroupLayoutType.None&&0==(2&this._updating)&&null!=this._parent)if(this._updating|=2,!this._boundsChanged||(this._boundsChanged=!1,this._autoSizeDisabled)){var n,o,r=this._parent.numChildren;if(!this._percentReady){this._percentReady=!0,this._numChildren=0,this._totalSize=0,this._mainChildIndex=-1;var a=0;for(n=0;n<r;n++)(o=this._parent.getChildAt(n)).group==this&&(this._excludeInvisibles&&!o.internalVisible3||(a==this._mainGridIndex&&(this._mainChildIndex=n),this._numChildren++,1==this._layout?this._totalSize+=o.width:this._totalSize+=o.height),a++);for(-1!=this._mainChildIndex&&(1==this._layout?(o=this._parent.getChildAt(this._mainChildIndex),this._totalSize+=this._mainGridMinSize-o.width,o._sizePercentInGroup=this._mainGridMinSize/this._totalSize):(o=this._parent.getChildAt(this._mainChildIndex),this._totalSize+=this._mainGridMinSize-o.height,o._sizePercentInGroup=this._mainGridMinSize/this._totalSize)),n=0;n<r;n++)(o=this._parent.getChildAt(n)).group==this&&n!=this._mainChildIndex&&(this._totalSize>0?o._sizePercentInGroup=(1==this._layout?o.width:o.height)/this._totalSize:o._sizePercentInGroup=0)}var s=0,h=1,l=!1;if(1==this._layout){s=this.width-(this._numChildren-1)*this._columnGap,-1!=this._mainChildIndex&&s>=this._totalSize&&((o=this._parent.getChildAt(this._mainChildIndex)).setSize(s-(this._totalSize-this._mainGridMinSize),o._rawHeight+i,!0),s-=o.width,h-=o._sizePercentInGroup,l=!0);var c=this.x;for(n=0;n<r;n++)(o=this._parent.getChildAt(n)).group==this&&(!this._excludeInvisibles||o.internalVisible3?(l&&n==this._mainChildIndex||(o.setSize(Math.round(o._sizePercentInGroup/h*s),o._rawHeight+i,!0),h-=o._sizePercentInGroup,s-=o.width),o.xMin=c,0!=o.width&&(c+=o.width+this._columnGap)):o.setSize(o._rawWidth,o._rawHeight+i,!0))}else{s=this.height-(this._numChildren-1)*this._lineGap,-1!=this._mainChildIndex&&s>=this._totalSize&&((o=this._parent.getChildAt(this._mainChildIndex)).setSize(o._rawWidth+e,s-(this._totalSize-this._mainGridMinSize),!0),s-=o.height,h-=o._sizePercentInGroup,l=!0);var u=this.y;for(n=0;n<r;n++)(o=this._parent.getChildAt(n)).group==this&&(!this._excludeInvisibles||o.internalVisible3?(l&&n==this._mainChildIndex||(o.setSize(o._rawWidth+e,Math.round(o._sizePercentInGroup/h*s),!0),h-=o._sizePercentInGroup,s-=o.height),o.yMin=u,0!=o.height&&(u+=o.height+this._lineGap)):o.setSize(o._rawWidth+e,o._rawHeight,!0))}this._updating&=1}else this.updateBounds()},i.prototype.handleAlphaChanged=function(){if(!this._underConstruct)for(var t=this._parent.numChildren,e=0;e<t;e++){var i=this._parent.getChildAt(e);i.group==this&&(i.alpha=this.alpha)}},i.prototype.handleVisibleChanged=function(){if(this._parent)for(var t=this._parent.numChildren,e=0;e<t;e++){var i=this._parent.getChildAt(e);i.group==this&&i.handleVisibleChanged()}},i.prototype.setup_beforeAdd=function(t,i){e.prototype.setup_beforeAdd.call(this,t,i),t.seek(i,5),this._layout=t.readByte(),this._lineGap=t.readInt(),this._columnGap=t.readInt(),t.version>=2&&(this._excludeInvisibles=t.readBool(),this._autoSizeDisabled=t.readBool(),this._mainChildIndex=t.readInt())},i.prototype.setup_afterAdd=function(t,i){e.prototype.setup_afterAdd.call(this,t,i),this.visible||this.handleVisibleChanged()},i}(t.GObject);t.GGroup=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._node.name="GImage",i._touchDisabled=!0,i._content=i._node.addComponent(t.Image),i._content.sizeMode=cc.Sprite.SizeMode.CUSTOM,i._content.trim=!1,i}return __extends(i,e),Object.defineProperty(i.prototype,"color",{get:function(){return this._node.color},set:function(t){this._node.color.equals(t)||(this._node.color=t,this.updateGear(4))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"flip",{get:function(){return this._content.flip},set:function(t){this._content.flip=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillMethod",{get:function(){return this._content.fillMethod},set:function(t){this._content.fillMethod=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillOrigin",{get:function(){return this._content.fillOrigin},set:function(t){this._content.fillOrigin=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillClockwise",{get:function(){return this._content.fillClockwise},set:function(t){this._content.fillClockwise=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillAmount",{get:function(){return this._content.fillAmount},set:function(t){this._content.fillAmount=t},enumerable:!1,configurable:!0}),i.prototype.constructFromResource=function(){var t=this.packageItem.getBranch();this.sourceWidth=t.width,this.sourceHeight=t.height,this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),(t=t.getHighResolution()).load(),t.scale9Grid?this._content.type=cc.Sprite.Type.SLICED:t.scaleByTile&&(this._content.type=cc.Sprite.Type.TILED),this._content.spriteFrame=t.asset},i.prototype.handleGrayedChanged=function(){this._content.grayed=this._grayed},i.prototype.getProp=function(i){return i==t.ObjectPropID.Color?this.color:e.prototype.getProp.call(this,i)},i.prototype.setProp=function(i,n){i==t.ObjectPropID.Color?this.color=n:e.prototype.setProp.call(this,i,n)},i.prototype.setup_beforeAdd=function(t,i){e.prototype.setup_beforeAdd.call(this,t,i),t.seek(i,5),t.readBool()&&(this.color=t.readColor()),this._content.flip=t.readByte(),this._content.fillMethod=t.readByte(),0!=this._content.fillMethod&&(this._content.fillOrigin=t.readByte(),this._content.fillClockwise=t.readBool(),this._content.fillAmount=t.readFloat())},i}(t.GObject);t.GImage=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._node.name="GLabel",t}return __extends(i,e),Object.defineProperty(i.prototype,"icon",{get:function(){if(this._iconObject)return this._iconObject.icon},set:function(t){this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this._titleObject?this._titleObject.text:null},set:function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.title},set:function(t){this.title=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"titleColor",{get:function(){var t=this.getTextField();return t?t.color:cc.Color.WHITE},set:function(t){var e=this.getTextField();e&&(e.color=t),this.updateGear(4)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"titleFontSize",{get:function(){var t=this.getTextField();return t?t.fontSize:0},set:function(t){var e=this.getTextField();e&&(e.fontSize=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"editable",{get:function(){return!!(this._titleObject&&this._titleObject instanceof t.GTextInput)&&this._titleObject.editable},set:function(e){this._titleObject&&this._titleObject instanceof t.GTextInput&&(this._titleObject.editable=e)},enumerable:!1,configurable:!0}),i.prototype.getTextField=function(){return this._titleObject instanceof t.GTextField?this._titleObject:this._titleObject instanceof i||this._titleObject instanceof t.GButton?this._titleObject.getTextField():null},i.prototype.getProp=function(i){switch(i){case t.ObjectPropID.Color:return this.titleColor;case t.ObjectPropID.OutlineColor:var n=this.getTextField();return n?n.strokeColor:0;case t.ObjectPropID.FontSize:return this.titleFontSize;default:return e.prototype.getProp.call(this,i)}},i.prototype.setProp=function(i,n){switch(i){case t.ObjectPropID.Color:this.titleColor=n;break;case t.ObjectPropID.OutlineColor:var o=this.getTextField();o&&(o.strokeColor=n);break;case t.ObjectPropID.FontSize:this.titleFontSize=n;break;default:e.prototype.setProp.call(this,i,n)}},i.prototype.constructExtension=function(t){this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon")},i.prototype.setup_afterAdd=function(i,n){if(e.prototype.setup_afterAdd.call(this,i,n),i.seek(n,6)&&i.readByte()==this.packageItem.objectType){var o;null!=(o=i.readS())&&(this.title=o),null!=(o=i.readS())&&(this.icon=o),i.readBool()&&(this.titleColor=i.readColor());var r=i.readInt();if(0!=r&&(this.titleFontSize=r),i.readBool()){var a=this.getTextField();a instanceof t.GTextInput?(null!=(o=i.readS())&&(a.promptText=o),null!=(o=i.readS())&&(a.restrict=o),0!=(r=i.readInt())&&(a.maxLength=r),r=i.readInt(),i.readBool()&&(a.password=!0)):i.skip(13)}}},i}(t.GComponent);t.GLabel=e}(fgui||(fgui={})),function(t){var e=function(e){function n(){var i=e.call(this)||this;return i.scrollItemToViewOnClick=!0,i.foldInvisibleItems=!1,i._lineCount=0,i._columnCount=0,i._lineGap=0,i._columnGap=0,i._lastSelectedIndex=0,i._numItems=0,i._realNumItems=0,i._firstIndex=0,i._curLineItemCount=0,i._curLineItemCount2=0,i._virtualListChanged=0,i.itemInfoVer=0,i._node.name="GList",i._trackBounds=!0,i._pool=new t.GObjectPool,i._layout=t.ListLayoutType.SingleColumn,i._autoResizeItem=!0,i._lastSelectedIndex=-1,i._selectionMode=t.ListSelectionMode.Single,i.opaque=!0,i._align=t.AlignType.Left,i._verticalAlign=t.VertAlignType.Top,i}return __extends(n,e),n.prototype.dispose=function(){this._pool.clear(),e.prototype.dispose.call(this)},Object.defineProperty(n.prototype,"layout",{get:function(){return this._layout},set:function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lineCount",{get:function(){return this._lineCount},set:function(t){this._lineCount!=t&&(this._lineCount=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnCount",{get:function(){return this._columnCount},set:function(t){this._columnCount!=t&&(this._columnCount=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lineGap",{get:function(){return this._lineGap},set:function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnGap",{get:function(){return this._columnGap},set:function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"align",{get:function(){return this._align},set:function(t){this._align!=t&&(this._align=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"virtualItemSize",{get:function(){return this._itemSize},set:function(t){this._virtual&&(null==this._itemSize&&(this._itemSize=new cc.Size(0,0)),this._itemSize.width=t.width,this._itemSize.height=t.height,this.setVirtualListChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"defaultItem",{get:function(){return this._defaultItem},set:function(t){this._defaultItem=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoResizeItem",{get:function(){return this._autoResizeItem},set:function(t){this._autoResizeItem!=t&&(this._autoResizeItem=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selectionMode",{get:function(){return this._selectionMode},set:function(t){this._selectionMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selectionController",{get:function(){return this._selectionController},set:function(t){this._selectionController=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"itemPool",{get:function(){return this._pool},enumerable:!1,configurable:!0}),n.prototype.getFromPool=function(t){t||(t=this._defaultItem);var e=this._pool.getObject(t);return e&&(e.visible=!0),e},n.prototype.returnToPool=function(t){this._pool.returnObject(t)},n.prototype.addChildAt=function(i,n){return e.prototype.addChildAt.call(this,i,n),i instanceof t.GButton&&(i.selected=!1,i.changeStateOnClick=!1),i.on(t.Event.CLICK,this.onClickItem,this),i},n.prototype.addItem=function(e){return e||(e=this._defaultItem),this.addChild(t.UIPackage.createObjectFromURL(e))},n.prototype.addItemFromPool=function(t){return this.addChild(this.getFromPool(t))},n.prototype.removeChildAt=function(i,n){var o=e.prototype.removeChildAt.call(this,i,n);return o.off(t.Event.CLICK,this.onClickItem,this),o},n.prototype.removeChildToPoolAt=function(t){var i=e.prototype.removeChildAt.call(this,t);this.returnToPool(i)},n.prototype.removeChildToPool=function(t){e.prototype.removeChild.call(this,t),this.returnToPool(t)},n.prototype.removeChildrenToPool=function(t,e){void 0==t&&(t=0),void 0==e&&(e=-1),(e<0||e>=this._children.length)&&(e=this._children.length-1);for(var i=t;i<=e;++i)this.removeChildToPoolAt(t)},Object.defineProperty(n.prototype,"selectedIndex",{get:function(){var e;if(this._virtual)for(e=0;e<this._realNumItems;e++){var i=this._virtualItems[e];if(i.obj instanceof t.GButton&&i.obj.selected||!i.obj&&i.selected)return this._loop?e%this._numItems:e}else{var n=this._children.length;for(e=0;e<n;e++){var o=this._children[e];if(o instanceof t.GButton&&o.selected)return e}}return-1},set:function(e){e>=0&&e<this.numItems?(this._selectionMode!=t.ListSelectionMode.Single&&this.clearSelection(),this.addSelection(e)):this.clearSelection()},enumerable:!1,configurable:!0}),n.prototype.getSelection=function(e){var i;if(e||(e=new Array),this._virtual)for(i=0;i<this._realNumItems;i++){var n=this._virtualItems[i];if(n.obj instanceof t.GButton&&n.obj.selected||!n.obj&&n.selected){var o=i;if(this._loop&&(o=i%this._numItems,-1!=e.indexOf(o)))continue;e.push(o)}}else{var r=this._children.length;for(i=0;i<r;i++){var a=this._children[i];a instanceof t.GButton&&a.selected&&e.push(i)}}return e},n.prototype.addSelection=function(e,i){if(this._selectionMode!=t.ListSelectionMode.None){var n;if(this.checkVirtualList(),this._selectionMode==t.ListSelectionMode.Single&&this.clearSelection(),i&&this.scrollToView(e),this._lastSelectedIndex=e,this._virtual){var o=this._virtualItems[e];o.obj&&(n=o.obj),o.selected=!0}else n=this.getChildAt(e);n instanceof t.GButton&&!n.selected&&(n.selected=!0,this.updateSelectionController(e))}},n.prototype.removeSelection=function(e){if(this._selectionMode!=t.ListSelectionMode.None){var i;if(this._virtual){var n=this._virtualItems[e];n.obj&&(i=n.obj),n.selected=!1}else i=this.getChildAt(e);i instanceof t.GButton&&(i.selected=!1)}},n.prototype.clearSelection=function(){var e;if(this._virtual)for(e=0;e<this._realNumItems;e++){var i=this._virtualItems[e];i.obj instanceof t.GButton&&(i.obj.selected=!1),i.selected=!1}else{var n=this._children.length;for(e=0;e<n;e++){var o=this._children[e];o instanceof t.GButton&&(o.selected=!1)}}},n.prototype.clearSelectionExcept=function(e){var i;if(this._virtual)for(i=0;i<this._realNumItems;i++){var n=this._virtualItems[i];n.obj!=e&&(n.obj instanceof t.GButton&&(n.obj.selected=!1),n.selected=!1)}else{var o=this._children.length;for(i=0;i<o;i++){var r=this._children[i];r instanceof t.GButton&&r!=e&&(r.selected=!1)}}},n.prototype.selectAll=function(){this.checkVirtualList();var e,i=-1;if(this._virtual)for(e=0;e<this._realNumItems;e++){var n=this._virtualItems[e];n.obj instanceof t.GButton&&!n.obj.selected&&(n.obj.selected=!0,i=e),n.selected=!0}else{var o=this._children.length;for(e=0;e<o;e++){var r=this._children[e];r instanceof t.GButton&&!r.selected&&(r.selected=!0,i=e)}}-1!=i&&this.updateSelectionController(i)},n.prototype.selectNone=function(){this.clearSelection()},n.prototype.selectReverse=function(){this.checkVirtualList();var e,i=-1;if(this._virtual)for(e=0;e<this._realNumItems;e++){var n=this._virtualItems[e];n.obj instanceof t.GButton&&(n.obj.selected=!n.obj.selected,n.obj.selected&&(i=e)),n.selected=!n.selected}else{var o=this._children.length;for(e=0;e<o;e++){var r=this._children[e];r instanceof t.GButton&&(r.selected=!r.selected,r.selected&&(i=e))}}-1!=i&&this.updateSelectionController(i)},n.prototype.handleArrowKey=function(e){var i=this.selectedIndex;if(-1!=i)switch(e){case 1:if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowVertical)--i>=0&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination){for(var n=this._children[i],o=0,r=i-1;r>=0;r--){var a=this._children[r];if(a.y!=n.y){n=a;break}o++}for(;r>=0;r--)if((a=this._children[r]).y!=n.y){this.clearSelection(),this.addSelection(r+o+1,!0);break}}break;case 3:if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination)++i<this._children.length&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowVertical){n=this._children[i],o=0;var s=this._children.length;for(r=i+1;r<s;r++){if((a=this._children[r]).x!=n.x){n=a;break}o++}for(;r<s;r++)if((a=this._children[r]).x!=n.x){this.clearSelection(),this.addSelection(r-o-1,!0);break}}break;case 5:if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowVertical)++i<this._children.length&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination){for(n=this._children[i],o=0,s=this._children.length,r=i+1;r<s;r++){if((a=this._children[r]).y!=n.y){n=a;break}o++}for(;r<s;r++)if((a=this._children[r]).y!=n.y){this.clearSelection(),this.addSelection(r-o-1,!0);break}}break;case 7:if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination)--i>=0&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowVertical){for(n=this._children[i],o=0,r=i-1;r>=0;r--){if((a=this._children[r]).x!=n.x){n=a;break}o++}for(;r>=0;r--)if((a=this._children[r]).x!=n.x){this.clearSelection(),this.addSelection(r+o+1,!0);break}}}},n.prototype.onClickItem=function(e){if(!this._scrollPane||!this._scrollPane.isDragged){var i=t.GObject.cast(e.currentTarget);this.setSelectionOnEvent(i,e),this._scrollPane&&this.scrollItemToViewOnClick&&this._scrollPane.scrollToView(i,!0),this.dispatchItemEvent(i,e)}},n.prototype.dispatchItemEvent=function(e,i){this._node.emit(t.Event.CLICK_ITEM,e,i)},n.prototype.setSelectionOnEvent=function(e,i){if(e instanceof t.GButton&&this._selectionMode!=t.ListSelectionMode.None){var n=!1,o=this.childIndexToItemIndex(this.getChildIndex(e));if(this._selectionMode==t.ListSelectionMode.Single)e.selected||(this.clearSelectionExcept(e),e.selected=!0);else if(i.isShiftDown){if(!e.selected)if(-1!=this._lastSelectedIndex){var r,a=Math.min(this._lastSelectedIndex,o),s=Math.max(this._lastSelectedIndex,o);if(s=Math.min(s,this.numItems-1),this._virtual)for(r=a;r<=s;r++){var h=this._virtualItems[r];h.obj instanceof t.GButton&&(h.obj.selected=!0),h.selected=!0}else for(r=a;r<=s;r++){var l=this.getChildAt(r);l instanceof t.GButton&&(l.selected=!0)}n=!0}else e.selected=!0}else i.isCtrlDown||this._selectionMode==t.ListSelectionMode.Multiple_SingleClick?e.selected=!e.selected:e.selected?this.clearSelectionExcept(e):(this.clearSelectionExcept(e),e.selected=!0);n||(this._lastSelectedIndex=o),e.selected&&this.updateSelectionController(o)}},n.prototype.resizeToFit=function(e,i){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===i&&(i=0),this.ensureBoundsCorrect();var n=this.numItems;if(e>n&&(e=n),this._virtual){var o=Math.ceil(e/this._curLineItemCount);this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this.viewHeight=o*this._itemSize.height+Math.max(0,o-1)*this._lineGap:this.viewWidth=o*this._itemSize.width+Math.max(0,o-1)*this._columnGap}else if(0==e)this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this.viewHeight=i:this.viewWidth=i;else{for(var r=e-1,a=null;r>=0&&(a=this.getChildAt(r),this.foldInvisibleItems&&!a.visible);)r--;if(r<0)this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this.viewHeight=i:this.viewWidth=i;else{var s=0;this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?((s=a.y+a.height)<i&&(s=i),this.viewHeight=s):((s=a.x+a.width)<i&&(s=i),this.viewWidth=s)}}},n.prototype.getMaxItemWidth=function(){for(var t=this._children.length,e=0,i=0;i<t;i++){var n=this.getChildAt(i);n.width>e&&(e=n.width)}return e},n.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0)},n.prototype.handleControllerChanged=function(t){e.prototype.handleControllerChanged.call(this,t),this._selectionController==t&&(this.selectedIndex=t.selectedIndex)},n.prototype.updateSelectionController=function(t){if(this._selectionController&&!this._selectionController.changing&&t<this._selectionController.pageCount){var e=this._selectionController;this._selectionController=null,e.selectedIndex=t,this._selectionController=e}},n.prototype.getSnappingPosition=function(n,o,r){var a,s;return this._virtual?(r=r||new cc.Vec2,this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?(a=o,i=o,s=this.getIndexOnPos1(!1),o=i,s<this._virtualItems.length&&a-o>this._virtualItems[s].height/2&&s<this._realNumItems&&(o+=this._virtualItems[s].height+this._lineGap)):this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical?(a=n,i=n,s=this.getIndexOnPos2(!1),n=i,s<this._virtualItems.length&&a-n>this._virtualItems[s].width/2&&s<this._realNumItems&&(n+=this._virtualItems[s].width+this._columnGap)):(a=n,i=n,s=this.getIndexOnPos3(!1),n=i,s<this._virtualItems.length&&a-n>this._virtualItems[s].width/2&&s<this._realNumItems&&(n+=this._virtualItems[s].width+this._columnGap)),r.x=n,r.y=o,r):e.prototype.getSnappingPosition.call(this,n,o,r)},n.prototype.scrollToView=function(e,i,n){if(this._virtual){if(0==this._numItems)return;if(this.checkVirtualList(),e>=this._virtualItems.length)throw"Invalid child index: "+e+">"+this._virtualItems.length;var o;this._loop&&(e=Math.floor(this._firstIndex/this._numItems)*this._numItems+e);var r,a=this._virtualItems[e],s=0;if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal){for(r=this._curLineItemCount-1;r<e;r+=this._curLineItemCount)s+=this._virtualItems[r].height+this._lineGap;o=new cc.Rect(0,s,this._itemSize.width,a.height)}else if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical){for(r=this._curLineItemCount-1;r<e;r+=this._curLineItemCount)s+=this._virtualItems[r].width+this._columnGap;o=new cc.Rect(s,0,a.width,this._itemSize.height)}else{var h=e/(this._curLineItemCount*this._curLineItemCount2);o=new cc.Rect(h*this.viewWidth+e%this._curLineItemCount*(a.width+this._columnGap),e/this._curLineItemCount%this._curLineItemCount2*(a.height+this._lineGap),a.width,a.height)}this._scrollPane&&this._scrollPane.scrollToView(o,i,n)}else{var l=this.getChildAt(e);l&&(this._scrollPane?this._scrollPane.scrollToView(l,i,n):this.parent&&this.parent.scrollPane&&this.parent.scrollPane.scrollToView(l,i,n))}},n.prototype.getFirstChildInView=function(){return this.childIndexToItemIndex(e.prototype.getFirstChildInView.call(this))},n.prototype.childIndexToItemIndex=function(e){if(!this._virtual)return e;if(this._layout==t.ListLayoutType.Pagination){for(var i=this._firstIndex;i<this._realNumItems;i++)if(this._virtualItems[i].obj&&--e<0)return i;return e}return e+=this._firstIndex,this._loop&&this._numItems>0&&(e%=this._numItems),e},n.prototype.itemIndexToChildIndex=function(e){if(!this._virtual)return e;if(this._layout==t.ListLayoutType.Pagination)return this.getChildIndex(this._virtualItems[e].obj);if(this._loop&&this._numItems>0){var i=this._firstIndex%this._numItems;e>=i?e-=i:e=this._numItems-i+e}else e-=this._firstIndex;return e},n.prototype.setVirtual=function(){this._setVirtual(!1)},n.prototype.setVirtualAndLoop=function(){this._setVirtual(!0)},n.prototype._setVirtual=function(e){if(!this._virtual){if(!this._scrollPane)throw"Virtual list must be scrollable!";if(e){if(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.FlowVertical)throw"Loop list is not supported for FlowHorizontal or FlowVertical layout!";this._scrollPane.bouncebackEffect=!1}if(this._virtual=!0,this._loop=e,this._virtualItems=new Array,this.removeChildrenToPool(),null==this._itemSize){this._itemSize=new cc.Size(0,0);var i=this.getFromPool(null);if(!i)throw"Virtual List must have a default list item resource.";this._itemSize.width=i.width,this._itemSize.height=i.height,this.returnToPool(i)}this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?(this._scrollPane.scrollStep=this._itemSize.height,this._loop&&(this._scrollPane._loop=2)):(this._scrollPane.scrollStep=this._itemSize.width,this._loop&&(this._scrollPane._loop=1)),this._node.on(t.Event.SCROLL,this.__scrolled,this),this.setVirtualListChangedFlag(!0)}},Object.defineProperty(n.prototype,"numItems",{get:function(){return this._virtual?this._numItems:this._children.length},set:function(t){if(this._virtual){if(null==this.itemRenderer)throw"Set itemRenderer first!";this._numItems=t,this._loop?this._realNumItems=6*this._numItems:this._realNumItems=this._numItems;var e=this._virtualItems.length;if(this._realNumItems>e)for(o=e;o<this._realNumItems;o++){var i={width:this._itemSize.width,height:this._itemSize.height,updateFlag:0};this._virtualItems.push(i)}else for(o=this._realNumItems;o<e;o++)this._virtualItems[o].selected=!1;0!=this._virtualListChanged&&this._partner.unschedule(this._refreshVirtualList),this._refreshVirtualList()}else{var n=this._children.length;if(t>n)for(var o=n;o<t;o++)null==this.itemProvider?this.addItemFromPool():this.addItemFromPool(this.itemProvider(o));else this.removeChildrenToPool(t,n);if(null!=this.itemRenderer)for(o=0;o<t;o++)this.itemRenderer(o,this.getChildAt(o))}},enumerable:!1,configurable:!0}),n.prototype.refreshVirtualList=function(){this.setVirtualListChangedFlag(!1)},n.prototype.checkVirtualList=function(){0!=this._virtualListChanged&&(this._refreshVirtualList(),this._partner.unschedule(this._refreshVirtualList))},n.prototype.setVirtualListChangedFlag=function(t){t?this._virtualListChanged=2:0==this._virtualListChanged&&(this._virtualListChanged=1),this._partner.callLater(this._refreshVirtualList)},n.prototype._refreshVirtualList=function(e){if(isNaN(e)){var i=2==this._virtualListChanged;this._virtualListChanged=0,this._eventLocked=!0,i&&(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.SingleRow?this._curLineItemCount=1:this._layout==t.ListLayoutType.FlowHorizontal?this._columnCount>0?this._curLineItemCount=this._columnCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.width+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):this._layout==t.ListLayoutType.FlowVertical?this._lineCount>0?this._curLineItemCount=this._lineCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.height+this._lineGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):(this._columnCount>0?this._curLineItemCount=this._columnCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.width+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)),this._lineCount>0?this._curLineItemCount2=this._lineCount:(this._curLineItemCount2=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.height+this._lineGap)),this._curLineItemCount2<=0&&(this._curLineItemCount2=1))));var n=0,o=0;if(this._realNumItems>0){var r,a=Math.ceil(this._realNumItems/this._curLineItemCount)*this._curLineItemCount,s=Math.min(this._curLineItemCount,this._realNumItems);if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal){for(r=0;r<a;r+=this._curLineItemCount)n+=this._virtualItems[r].height+this._lineGap;if(n>0&&(n-=this._lineGap),this._autoResizeItem)o=this._scrollPane.viewWidth;else{for(r=0;r<s;r++)o+=this._virtualItems[r].width+this._columnGap;o>0&&(o-=this._columnGap)}}else if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical){for(r=0;r<a;r+=this._curLineItemCount)o+=this._virtualItems[r].width+this._columnGap;if(o>0&&(o-=this._columnGap),this._autoResizeItem)n=this._scrollPane.viewHeight;else{for(r=0;r<s;r++)n+=this._virtualItems[r].height+this._lineGap;n>0&&(n-=this._lineGap)}}else{o=Math.ceil(a/(this._curLineItemCount*this._curLineItemCount2))*this.viewWidth,n=this.viewHeight}}this.handleAlign(o,n),this._scrollPane.setContentSize(o,n),this._eventLocked=!1,this.handleScroll(!0)}else{this.node.$gobj._refreshVirtualList()}},n.prototype.__scrolled=function(t){this.handleScroll(!1)},n.prototype.getIndexOnPos1=function(t){if(this._realNumItems<this._curLineItemCount)return i=0,0;var e,n,o;if(this.numChildren>0&&!t){if((n=this.getChildAt(0).y)>i){for(e=this._firstIndex-this._curLineItemCount;e>=0;e-=this._curLineItemCount)if((n-=this._virtualItems[e].height+this._lineGap)<=i)return i=n,e;return i=0,0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if((o=n+this._virtualItems[e].height+this._lineGap)>i)return i=n,e;n=o}return i=n,this._realNumItems-this._curLineItemCount}for(n=0,e=0;e<this._realNumItems;e+=this._curLineItemCount){if((o=n+this._virtualItems[e].height+this._lineGap)>i)return i=n,e;n=o}return i=n,this._realNumItems-this._curLineItemCount},n.prototype.getIndexOnPos2=function(t){if(this._realNumItems<this._curLineItemCount)return i=0,0;var e,n,o;if(this.numChildren>0&&!t){if((n=this.getChildAt(0).x)>i){for(e=this._firstIndex-this._curLineItemCount;e>=0;e-=this._curLineItemCount)if((n-=this._virtualItems[e].width+this._columnGap)<=i)return i=n,e;return i=0,0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if((o=n+this._virtualItems[e].width+this._columnGap)>i)return i=n,e;n=o}return i=n,this._realNumItems-this._curLineItemCount}for(n=0,e=0;e<this._realNumItems;e+=this._curLineItemCount){if((o=n+this._virtualItems[e].width+this._columnGap)>i)return i=n,e;n=o}return i=n,this._realNumItems-this._curLineItemCount},n.prototype.getIndexOnPos3=function(t){if(this._realNumItems<this._curLineItemCount)return i=0,0;var e,n,o=this.viewWidth,r=Math.floor(i/o),a=r*(this._curLineItemCount*this._curLineItemCount2),s=r*o;for(e=0;e<this._curLineItemCount;e++){if((n=s+this._virtualItems[a+e].width+this._columnGap)>i)return i=s,a+e;s=n}return i=s,a+this._curLineItemCount-1},n.prototype.handleScroll=function(e){if(!this._eventLocked){if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal){for(var i=0;this.handleScroll1(e);)if(e=!1,++i>20){console.log("FairyGUI: list will never be filled as the item renderer function always returns a different size.");break}this.handleArchOrder1()}else if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical){for(i=0;this.handleScroll2(e);)if(e=!1,++i>20){console.log("FairyGUI: list will never be filled as the item renderer function always returns a different size.");break}this.handleArchOrder2()}else this.handleScroll3(e);this._boundsChanged=!1}},n.prototype.handleScroll1=function(e){var n=this._scrollPane.scrollingPosY,o=n+this._scrollPane.viewHeight,r=o==this._scrollPane.contentHeight;i=n;var a=this.getIndexOnPos1(e);if(n=i,a==this._firstIndex&&!e)return!1;var s=this._firstIndex;this._firstIndex=a;var h,l,c,u,p,d=a,f=s>a,_=this.numChildren,g=s+_-1,m=f?g:s,y=0,v=n,b=0,C=0,S=this.defaultItem,w=(this._scrollPane.viewWidth-this._columnGap*(this._curLineItemCount-1))/this._curLineItemCount;for(this.itemInfoVer++;d<this._realNumItems&&(r||v<o);){if((l=this._virtualItems[d]).obj&&!e||(null!=this.itemProvider&&(null==(S=this.itemProvider(d%this._numItems))&&(S=this._defaultItem),S=t.UIPackage.normalizeURL(S)),l.obj&&l.obj.resourceURL!=S&&(l.obj instanceof t.GButton&&(l.selected=l.obj.selected),this.removeChildToPool(l.obj),l.obj=null)),l.obj)h=e;else{if(f){for(p=m;p>=s;p--)if((c=this._virtualItems[p]).obj&&c.updateFlag!=this.itemInfoVer&&c.obj.resourceURL==S){c.obj instanceof t.GButton&&(c.selected=c.obj.selected),l.obj=c.obj,c.obj=null,p==m&&m--;break}}else for(p=m;p<=g;p++)if((c=this._virtualItems[p]).obj&&c.updateFlag!=this.itemInfoVer&&c.obj.resourceURL==S){c.obj instanceof t.GButton&&(c.selected=c.obj.selected),l.obj=c.obj,c.obj=null,p==m&&m++;break}l.obj?this.setChildIndex(l.obj,f?d-a:this.numChildren):(l.obj=this._pool.getObject(S),f?this.addChildAt(l.obj,d-a):this.addChild(l.obj)),l.obj instanceof t.GButton&&(l.obj.selected=l.selected),h=!0}h&&(this._autoResizeItem&&(this._layout==t.ListLayoutType.SingleColumn||this._columnCount>0)&&l.obj.setSize(w,l.obj.height,!0),this.itemRenderer(d%this._numItems,l.obj),d%this._curLineItemCount==0&&(b+=Math.ceil(l.obj.height)-l.height,d==a&&s>a&&(C=Math.ceil(l.obj.height)-l.height)),l.width=Math.ceil(l.obj.width),l.height=Math.ceil(l.obj.height)),l.updateFlag=this.itemInfoVer,l.obj.setPosition(y,v),d==a&&(o+=l.height),y+=l.width+this._columnGap,d%this._curLineItemCount==this._curLineItemCount-1&&(y=0,v+=l.height+this._lineGap),d++}for(u=0;u<_;u++)(l=this._virtualItems[s+u]).updateFlag!=this.itemInfoVer&&l.obj&&(l.obj instanceof t.GButton&&(l.selected=l.obj.selected),this.removeChildToPool(l.obj),l.obj=null);for(_=this._children.length,u=0;u<_;u++){var x=this._virtualItems[a+u].obj;this._children[u]!=x&&this.setChildIndex(x,u)}return 0==b&&0==C||this._scrollPane.changeContentSizeOnScrolling(0,b,0,C),d>0&&this.numChildren>0&&this._container.y<=0&&this.getChildAt(0).y>-this._container.y},n.prototype.handleScroll2=function(e){var n=this._scrollPane.scrollingPosX,o=n+this._scrollPane.viewWidth,r=n==this._scrollPane.contentWidth;i=n;var a=this.getIndexOnPos2(e);if(n=i,a==this._firstIndex&&!e)return!1;var s=this._firstIndex;this._firstIndex=a;var h,l,c,u,p,d=a,f=s>a,_=this.numChildren,g=s+_-1,m=f?g:s,y=n,v=0,b=0,C=0,S=this.defaultItem,w=(this._scrollPane.viewHeight-this._lineGap*(this._curLineItemCount-1))/this._curLineItemCount;for(this.itemInfoVer++;d<this._realNumItems&&(r||y<o);){if((l=this._virtualItems[d]).obj&&!e||(null!=this.itemProvider&&(null==(S=this.itemProvider(d%this._numItems))&&(S=this._defaultItem),S=t.UIPackage.normalizeURL(S)),l.obj&&l.obj.resourceURL!=S&&(l.obj instanceof t.GButton&&(l.selected=l.obj.selected),this.removeChildToPool(l.obj),l.obj=null)),l.obj)h=e;else{if(f){for(p=m;p>=s;p--)if((c=this._virtualItems[p]).obj&&c.updateFlag!=this.itemInfoVer&&c.obj.resourceURL==S){c.obj instanceof t.GButton&&(c.selected=c.obj.selected),l.obj=c.obj,c.obj=null,p==m&&m--;break}}else for(p=m;p<=g;p++)if((c=this._virtualItems[p]).obj&&c.updateFlag!=this.itemInfoVer&&c.obj.resourceURL==S){c.obj instanceof t.GButton&&(c.selected=c.obj.selected),l.obj=c.obj,c.obj=null,p==m&&m++;break}l.obj?this.setChildIndex(l.obj,f?d-a:this.numChildren):(l.obj=this._pool.getObject(S),f?this.addChildAt(l.obj,d-a):this.addChild(l.obj)),l.obj instanceof t.GButton&&(l.obj.selected=l.selected),h=!0}h&&(this._autoResizeItem&&(this._layout==t.ListLayoutType.SingleRow||this._lineCount>0)&&l.obj.setSize(l.obj.width,w,!0),this.itemRenderer(d%this._numItems,l.obj),d%this._curLineItemCount==0&&(b+=Math.ceil(l.obj.width)-l.width,d==a&&s>a&&(C=Math.ceil(l.obj.width)-l.width)),l.width=Math.ceil(l.obj.width),l.height=Math.ceil(l.obj.height)),l.updateFlag=this.itemInfoVer,l.obj.setPosition(y,v),d==a&&(o+=l.width),v+=l.height+this._lineGap,d%this._curLineItemCount==this._curLineItemCount-1&&(v=0,y+=l.width+this._columnGap),d++}for(u=0;u<_;u++)(l=this._virtualItems[s+u]).updateFlag!=this.itemInfoVer&&l.obj&&(l.obj instanceof t.GButton&&(l.selected=l.obj.selected),this.removeChildToPool(l.obj),l.obj=null);for(_=this._children.length,u=0;u<_;u++){var x=this._virtualItems[a+u].obj;this._children[u]!=x&&this.setChildIndex(x,u)}return 0==b&&0==C||this._scrollPane.changeContentSizeOnScrolling(b,0,C,0),d>0&&this.numChildren>0&&this._container.x<=0&&this.getChildAt(0).x>-this._container.x},n.prototype.handleScroll3=function(e){var n=this._scrollPane.scrollingPosX;i=n;var o=this.getIndexOnPos3(e);if(n=i,o!=this._firstIndex||e){var r=this._firstIndex;this._firstIndex=o;var a,s,h,l,c,u=r,p=this._virtualItems.length,d=this._curLineItemCount*this._curLineItemCount2,f=o%this._curLineItemCount,_=this.viewWidth,g=Math.floor(o/d)*d,m=g+2*d,y=this._defaultItem,v=(this._scrollPane.viewWidth-this._columnGap*(this._curLineItemCount-1))/this._curLineItemCount,b=(this._scrollPane.viewHeight-this._lineGap*(this._curLineItemCount2-1))/this._curLineItemCount2;for(this.itemInfoVer++,s=g;s<m;s++)if(!(s>=this._realNumItems)){if(c=s%this._curLineItemCount,s-g<d){if(c<f)continue}else if(c>f)continue;(h=this._virtualItems[s]).updateFlag=this.itemInfoVer}var C=null,S=0;for(s=g;s<m;s++)if(!(s>=this._realNumItems)&&(h=this._virtualItems[s]).updateFlag==this.itemInfoVer){if(h.obj)a=e,S=-1,C=h.obj;else{for(;u<p;){if((l=this._virtualItems[u]).obj&&l.updateFlag!=this.itemInfoVer){l.obj instanceof t.GButton&&(l.selected=l.obj.selected),h.obj=l.obj,l.obj=null;break}u++}-1==S&&(S=this.getChildIndex(C)+1),h.obj?S=this.setChildIndexBefore(h.obj,S):(null!=this.itemProvider&&(null==(y=this.itemProvider(s%this._numItems))&&(y=this._defaultItem),y=t.UIPackage.normalizeURL(y)),h.obj=this._pool.getObject(y),this.addChildAt(h.obj,S)),S++,h.obj instanceof t.GButton&&(h.obj.selected=h.selected),a=!0}a&&(this._autoResizeItem&&(this._curLineItemCount==this._columnCount&&this._curLineItemCount2==this._lineCount?h.obj.setSize(v,b,!0):this._curLineItemCount==this._columnCount?h.obj.setSize(v,h.obj.height,!0):this._curLineItemCount2==this._lineCount&&h.obj.setSize(h.obj.width,b,!0)),this.itemRenderer(s%this._numItems,h.obj),h.width=Math.ceil(h.obj.width),h.height=Math.ceil(h.obj.height))}var w=g/d*_,x=w,I=0,P=0;for(s=g;s<m;s++)s>=this._realNumItems||((h=this._virtualItems[s]).updateFlag==this.itemInfoVer&&h.obj.setPosition(x,I),h.height>P&&(P=h.height),s%this._curLineItemCount==this._curLineItemCount-1?(x=w,I+=P+this._lineGap,P=0,s==g+d-1&&(x=w+=_,I=0)):x+=h.width+this._columnGap);for(s=u;s<p;s++)(h=this._virtualItems[s]).updateFlag!=this.itemInfoVer&&h.obj&&(h.obj instanceof t.GButton&&(h.selected=h.obj.selected),this.removeChildToPool(h.obj),h.obj=null)}},n.prototype.handleArchOrder1=function(){if(this._childrenRenderOrder==t.ChildrenRenderOrder.Arch){for(var e=this._scrollPane.posY+this.viewHeight/2,i=Number.POSITIVE_INFINITY,n=0,o=0,r=this.numChildren,a=0;a<r;a++){var s=this.getChildAt(a);this.foldInvisibleItems&&!s.visible||(n=Math.abs(e-s.y-s.height/2))<i&&(i=n,o=a)}this.apexIndex=o}},n.prototype.handleArchOrder2=function(){if(this._childrenRenderOrder==t.ChildrenRenderOrder.Arch){for(var e=this._scrollPane.posX+this.viewWidth/2,i=Number.POSITIVE_INFINITY,n=0,o=0,r=this.numChildren,a=0;a<r;a++){var s=this.getChildAt(a);this.foldInvisibleItems&&!s.visible||(n=Math.abs(e-s.x-s.width/2))<i&&(i=n,o=a)}this.apexIndex=o}},n.prototype.handleAlign=function(e,i){var n=0,o=0;i<this.viewHeight&&(this._verticalAlign==t.VertAlignType.Middle?o=Math.floor((this.viewHeight-i)/2):this._verticalAlign==t.VertAlignType.Bottom&&(o=this.viewHeight-i)),e<this.viewWidth&&(this._align==t.AlignType.Center?n=Math.floor((this.viewWidth-e)/2):this._align==t.AlignType.Right&&(n=this.viewWidth-e)),n==this._alignOffset.x&&o==this._alignOffset.y||(this._alignOffset.x=n,this._alignOffset.y=o,this._scrollPane?this._scrollPane.adjustMaskContainer():this._container.setPosition(this._pivotCorrectX+this._alignOffset.x,this._pivotCorrectY-this._alignOffset.y))},n.prototype.updateBounds=function(){if(!this._virtual){var e,i,n=0,o=0,r=0,a=0,s=0,h=0,l=0,c=0,u=0,p=this._children.length,d=this.viewWidth,f=this.viewHeight,_=0,g=0,m=0;if(this._layout==t.ListLayoutType.SingleColumn){for(e=0;e<p;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(0!=o&&(o+=this._lineGap),i.y=o,this._autoResizeItem&&i.setSize(d,i.height,!0),o+=Math.ceil(i.height),i.width>r&&(r=i.width));if((h=o)<=f&&this._autoResizeItem&&this._scrollPane&&this._scrollPane._displayInDemand&&this._scrollPane.vtScrollBar)for(d+=this._scrollPane.vtScrollBar.width,e=0;e<p;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(i.setSize(d,i.height,!0),i.width>r&&(r=i.width));s=Math.ceil(r)}else if(this._layout==t.ListLayoutType.SingleRow){for(e=0;e<p;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(0!=n&&(n+=this._columnGap),i.x=n,this._autoResizeItem&&i.setSize(i.width,f,!0),n+=Math.ceil(i.width),i.height>a&&(a=i.height));if((s=n)<=d&&this._autoResizeItem&&this._scrollPane&&this._scrollPane._displayInDemand&&this._scrollPane.hzScrollBar)for(f+=this._scrollPane.hzScrollBar.height,e=0;e<p;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(i.setSize(i.width,f,!0),i.height>a&&(a=i.height));h=Math.ceil(a)}else if(this._layout==t.ListLayoutType.FlowHorizontal)if(this._autoResizeItem&&this._columnCount>0){for(e=0;e<p;e++)if(i=this.getChildAt(e),(!this.foldInvisibleItems||i.visible)&&(_+=i.sourceWidth,++l==this._columnCount||e==p-1)){for(m=(d-_-(l-1)*this._columnGap)/_,n=0,l=g;l<=e;l++)i=this.getChildAt(l),this.foldInvisibleItems&&!i.visible||(i.setPosition(n,o),l<e?(i.setSize(i.sourceWidth+Math.round(i.sourceWidth*m),i.height,!0),n+=Math.ceil(i.width)+this._columnGap):i.setSize(d-n,i.height,!0),i.height>a&&(a=i.height));o+=Math.ceil(a)+this._lineGap,a=0,l=0,g=e+1,_=0}h=o+Math.ceil(a),s=d}else{for(e=0;e<p;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(0!=n&&(n+=this._columnGap),(0!=this._columnCount&&l>=this._columnCount||0==this._columnCount&&n+i.width>d&&0!=a)&&(n=0,o+=Math.ceil(a)+this._lineGap,a=0,l=0),i.setPosition(n,o),(n+=Math.ceil(i.width))>r&&(r=n),i.height>a&&(a=i.height),l++);h=o+Math.ceil(a),s=Math.ceil(r)}else if(this._layout==t.ListLayoutType.FlowVertical)if(this._autoResizeItem&&this._lineCount>0){for(e=0;e<p;e++)if(i=this.getChildAt(e),(!this.foldInvisibleItems||i.visible)&&(_+=i.sourceHeight,++l==this._lineCount||e==p-1)){for(m=(f-_-(l-1)*this._lineGap)/_,o=0,l=g;l<=e;l++)i=this.getChildAt(l),this.foldInvisibleItems&&!i.visible||(i.setPosition(n,o),l<e?(i.setSize(i.width,i.sourceHeight+Math.round(i.sourceHeight*m),!0),o+=Math.ceil(i.height)+this._lineGap):i.setSize(i.width,f-o,!0),i.width>r&&(r=i.width));n+=Math.ceil(r)+this._columnGap,r=0,l=0,g=e+1,_=0}s=n+Math.ceil(r),h=f}else{for(e=0;e<p;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(0!=o&&(o+=this._lineGap),(0!=this._lineCount&&l>=this._lineCount||0==this._lineCount&&o+i.height>f&&0!=r)&&(o=0,n+=Math.ceil(r)+this._columnGap,r=0,l=0),i.setPosition(n,o),(o+=Math.ceil(i.height))>a&&(a=o),i.width>r&&(r=i.width),l++);s=n+Math.ceil(r),h=Math.ceil(a)}else{var y;if(this._autoResizeItem&&this._lineCount>0&&(y=Math.floor((f-(this._lineCount-1)*this._lineGap)/this._lineCount)),this._autoResizeItem&&this._columnCount>0){for(e=0;e<p;e++)if(i=this.getChildAt(e),(!this.foldInvisibleItems||i.visible)&&(0==l&&(0!=this._lineCount&&u>=this._lineCount||0==this._lineCount&&o+(this._lineCount>0?y:i.height)>f)&&(c++,o=0,u=0),_+=i.sourceWidth,++l==this._columnCount||e==p-1)){for(m=(d-_-(l-1)*this._columnGap)/_,n=0,l=g;l<=e;l++)i=this.getChildAt(l),this.foldInvisibleItems&&!i.visible||(i.setPosition(c*d+n,o),l<e?(i.setSize(i.sourceWidth+Math.round(i.sourceWidth*m),this._lineCount>0?y:i.height,!0),n+=Math.ceil(i.width)+this._columnGap):i.setSize(d-n,this._lineCount>0?y:i.height,!0),i.height>a&&(a=i.height));o+=Math.ceil(a)+this._lineGap,a=0,l=0,g=e+1,_=0,u++}}else for(e=0;e<p;e++)i=this.getChildAt(e),this.foldInvisibleItems&&!i.visible||(0!=n&&(n+=this._columnGap),this._autoResizeItem&&this._lineCount>0&&i.setSize(i.width,y,!0),(0!=this._columnCount&&l>=this._columnCount||0==this._columnCount&&n+i.width>d&&0!=a)&&(n=0,o+=Math.ceil(a)+this._lineGap,a=0,l=0,u++,(0!=this._lineCount&&u>=this._lineCount||0==this._lineCount&&o+i.height>f&&0!=r)&&(c++,o=0,u=0)),i.setPosition(c*d+n,o),(n+=Math.ceil(i.width))>r&&(r=n),i.height>a&&(a=i.height),l++);h=c>0?f:o+Math.ceil(a),s=(c+1)*d}this.handleAlign(s,h),this.setBounds(0,0,s,h)}},n.prototype.setup_beforeAdd=function(i,n){e.prototype.setup_beforeAdd.call(this,i,n),i.seek(n,5),this._layout=i.readByte(),this._selectionMode=i.readByte(),this._align=i.readByte(),this._verticalAlign=i.readByte(),this._lineGap=i.readShort(),this._columnGap=i.readShort(),this._lineCount=i.readShort(),this._columnCount=i.readShort(),this._autoResizeItem=i.readBool(),this._childrenRenderOrder=i.readByte(),this._apexIndex=i.readShort(),i.readBool()&&(this._margin.top=i.readInt(),this._margin.bottom=i.readInt(),this._margin.left=i.readInt(),this._margin.right=i.readInt());var o=i.readByte();if(o==t.OverflowType.Scroll){var r=i.position;i.seek(n,7),this.setupScroll(i),i.position=r}else this.setupOverflow(o);i.readBool()&&i.skip(8),i.version>=2&&(this.scrollItemToViewOnClick=i.readBool(),this.foldInvisibleItems=i.readBool()),i.seek(n,8),this._defaultItem=i.readS(),this.readItems(i)},n.prototype.readItems=function(t){var e,i,n,o;for(e=t.readShort(),i=0;i<e;i++)if(n=t.readShort(),n+=t.position,null!=(o=t.readS())||(o=this.defaultItem)){var r=this.getFromPool(o);r&&(this.addChild(r),this.setupItem(t,r)),t.position=n}else t.position=n},n.prototype.setupItem=function(e,i){var n,o,r;if(null!=(n=e.readS())&&(i.text=n),null!=(n=e.readS())&&i instanceof t.GButton&&(i.selectedTitle=n),null!=(n=e.readS())&&(i.icon=n),null!=(n=e.readS())&&i instanceof t.GButton&&(i.selectedIcon=n),null!=(n=e.readS())&&(i.name=n),i instanceof t.GComponent){for(o=e.readShort(),r=0;r<o;r++){var a=i.getController(e.readS());n=e.readS(),a&&(a.selectedPageId=n)}if(e.version>=2)for(o=e.readShort(),r=0;r<o;r++){var s=e.readS(),h=e.readShort(),l=e.readS(),c=i.getChildByPath(s);c&&c.setProp(h,l)}}},n.prototype.setup_afterAdd=function(t,i){e.prototype.setup_afterAdd.call(this,t,i),t.seek(i,6);var n=t.readShort();-1!=n&&(this._selectionController=this.parent.getControllerAt(n))},n}(t.GComponent);t.GList=e;var i=0}(fgui||(fgui={})),function(t){var e=function(){function e(){this._count=0,this._pool={}}return e.prototype.clear=function(){for(var t in this._pool)for(var e=this._pool[t],i=e.length,n=0;n<i;n++)e[n].dispose();this._pool={},this._count=0},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),e.prototype.getObject=function(e){if(null==(e=t.UIPackage.normalizeURL(e)))return null;var i=this._pool[e];return i&&i.length?(this._count--,i.shift()):t.UIPackage.createObjectFromURL(e)},e.prototype.returnObject=function(t){var e=t.resourceURL;if(e){var i=this._pool[e];null==i&&(i=new Array,this._pool[e]=i),this._count++,i.push(t)}},e}();t.GObjectPool=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._frame=0,i._node.name="GLoader",i._playing=!0,i._url="",i._fill=t.LoaderFillType.None,i._align=t.AlignType.Left,i._verticalAlign=t.VertAlignType.Top,i._showErrorSign=!0,i._color=new cc.Color(255,255,255,255),i._container=new cc.Node("Image"),i._container.setAnchorPoint(0,1),i._node.addChild(i._container),i._content=i._container.addComponent(t.MovieClip),i._content.sizeMode=cc.Sprite.SizeMode.CUSTOM,i._content.trim=!1,i._content.setPlaySettings(),i}return __extends(i,e),i.prototype.dispose=function(){null==this._contentItem&&this._content.spriteFrame&&this.freeExternal(this._content.spriteFrame),this._content2&&this._content2.dispose(),e.prototype.dispose.call(this)},Object.defineProperty(i.prototype,"url",{get:function(){return this._url},set:function(t){this._url!=t&&(this._url=t,this.loadContent(),this.updateGear(7))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"icon",{get:function(){return this._url},set:function(t){this.url=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"align",{get:function(){return this._align},set:function(t){this._align!=t&&(this._align=t,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this._fill},set:function(t){this._fill!=t&&(this._fill=t,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"shrinkOnly",{get:function(){return this._shrinkOnly},set:function(t){this._shrinkOnly!=t&&(this._shrinkOnly=t,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoSize",{get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"playing",{get:function(){return this._playing},set:function(e){this._playing!=e&&(this._playing=e,this._content instanceof t.MovieClip&&(this._content.playing=e),this.updateGear(5))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame!=e&&(this._frame=e,this._content instanceof t.MovieClip&&(this._content.frame=e),this.updateGear(5))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this._color},set:function(t){this._color.equals(t)||(this._color.set(t),this.updateGear(4),this._container.color=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillMethod",{get:function(){return this._content.fillMethod},set:function(t){this._content.fillMethod=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillOrigin",{get:function(){return this._content.fillOrigin},set:function(t){this._content.fillOrigin=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillClockwise",{get:function(){return this._content.fillClockwise},set:function(t){this._content.fillClockwise=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillAmount",{get:function(){return this._content.fillAmount},set:function(t){this._content.fillAmount=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"showErrorSign",{get:function(){return this._showErrorSign},set:function(t){this._showErrorSign=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"component",{get:function(){return this._content2},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"texture",{get:function(){return this._content.spriteFrame},set:function(t){this.url=null,this._content.spriteFrame=t,this._content.type=cc.Sprite.Type.SIMPLE,null!=t?(this.sourceWidth=t.getRect().width,this.sourceHeight=t.getRect().height):this.sourceWidth=this.sourceHeight=0,this.updateLayout()},enumerable:!1,configurable:!0}),i.prototype.loadContent=function(){this.clearContent(),this._url&&(t.ToolSet.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())},i.prototype.loadFromPackage=function(e){if(this._contentItem=t.UIPackage.getItemByURL(e),this._contentItem)if(this._contentItem=this._contentItem.getBranch(),this.sourceWidth=this._contentItem.width,this.sourceHeight=this._contentItem.height,this._contentItem=this._contentItem.getHighResolution(),this._contentItem.load(),this._autoSize&&this.setSize(this.sourceWidth,this.sourceHeight),this._contentItem.type==t.PackageItemType.Image)this._contentItem.asset?(this._content.spriteFrame=this._contentItem.asset,0==this._content.fillMethod&&(this._contentItem.scale9Grid?this._content.type=cc.Sprite.Type.SLICED:this._contentItem.scaleByTile?this._content.type=cc.Sprite.Type.TILED:this._content.type=cc.Sprite.Type.SIMPLE),this.updateLayout()):this.setErrorState();else if(this._contentItem.type==t.PackageItemType.MovieClip)this._content.interval=this._contentItem.interval,this._content.swing=this._contentItem.swing,this._content.repeatDelay=this._contentItem.repeatDelay,this._content.frames=this._contentItem.frames,this.updateLayout();else if(this._contentItem.type==t.PackageItemType.Component){var i=t.UIPackage.createObjectFromURL(e);i?i instanceof t.GComponent?(this._content2=i,this._container.addChild(this._content2.node),this.updateLayout()):(i.dispose(),this.setErrorState()):this.setErrorState()}else this.setErrorState();else this.setErrorState()},i.prototype.loadExternal=function(){t.ToolSet.startsWith(this._url,"http://")||t.ToolSet.startsWith(this._url,"https://")||t.ToolSet.startsWith(this._url,"/")?cc.assetManager.loadRemote(this._url,this.onLoaded.bind(this)):cc.resources.load(this._url,cc.Asset,this.onLoaded.bind(this))},i.prototype.onLoaded=function(t,e){this._url&&cc.isValid(this._node)&&(t&&console.warn(t),e instanceof cc.SpriteFrame?this.onExternalLoadSuccess(e):e instanceof cc.Texture2D&&this.onExternalLoadSuccess(new cc.SpriteFrame(e)))},i.prototype.freeExternal=function(t){},i.prototype.onExternalLoadSuccess=function(t){this._content.spriteFrame=t,this._content.type=cc.Sprite.Type.SIMPLE,this.sourceWidth=t.getRect().width,this.sourceHeight=t.getRect().height,this._autoSize&&this.setSize(this.sourceWidth,this.sourceHeight),this.updateLayout()},i.prototype.onExternalLoadFailed=function(){this.setErrorState()},i.prototype.setErrorState=function(){this._showErrorSign&&(null==this._errorSign&&null!=t.UIConfig.loaderErrorSign&&(this._errorSign=i._errorSignPool.getObject(t.UIConfig.loaderErrorSign)),this._errorSign&&(this._errorSign.setSize(this.width,this.height),this._container.addChild(this._errorSign.node)))},i.prototype.clearErrorState=function(){this._errorSign&&(this._container.removeChild(this._errorSign.node),i._errorSignPool.returnObject(this._errorSign),this._errorSign=null)},i.prototype.updateLayout=function(){if(null!=this._content2||null!=this._content){var e=this.sourceWidth,i=this.sourceHeight,n=-this.pivotX*this._width,o=this.pivotY*this._height;if(!this._autoSize||(this._updatingLayout=!0,0==e&&(e=50),0==i&&(i=30),this.setSize(e,i),this._updatingLayout=!1,this._container.setContentSize(this._width,this._height),this._container.setPosition(n,o),this._content2&&(this._content2.setPosition(n+this._width*this.pivotX,o-this._height*this.pivotY),this._content2.setScale(1,1)),e!=this._width||i!=this._height)){var r,a,s=1,h=1;this._fill!=t.LoaderFillType.None&&(s=this.width/this.sourceWidth,h=this.height/this.sourceHeight,1==s&&1==h||(this._fill==t.LoaderFillType.ScaleMatchHeight?s=h:this._fill==t.LoaderFillType.ScaleMatchWidth?h=s:this._fill==t.LoaderFillType.Scale?s>h?s=h:h=s:this._fill==t.LoaderFillType.ScaleNoBorder&&(s>h?h=s:s=h),this._shrinkOnly&&(s>1&&(s=1),h>1&&(h=1)),e=this.sourceWidth*s,i=this.sourceHeight*h)),this._container.setContentSize(e,i),this._content2&&(this._content2.setPosition(n+this._width*this.pivotX,o-this._height*this.pivotY),this._content2.setScale(s,h)),r=this._align==t.AlignType.Left?0:this._align==t.AlignType.Center?Math.floor((this._width-e)/2):this._width-e,a=-(a=this._verticalAlign==t.VertAlignType.Top?0:this._verticalAlign==t.VertAlignType.Middle?Math.floor((this._height-i)/2):this._height-i),this._container.setPosition(n+r,o+a)}}else this._autoSize&&(this._updatingLayout=!0,this.setSize(50,30),this._updatingLayout=!1)},i.prototype.clearContent=function(){if(this.clearErrorState(),!this._contentItem){var t=this._content.spriteFrame;t&&this.freeExternal(t)}this._content2&&(this._container.removeChild(this._content2.node),this._content2.dispose(),this._content2=null),this._content.frames=null,this._content.spriteFrame=null,this._contentItem=null},i.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._updatingLayout||this.updateLayout()},i.prototype.handleAnchorChanged=function(){e.prototype.handleAnchorChanged.call(this),this._updatingLayout||this.updateLayout()},i.prototype.handleGrayedChanged=function(){this._content.grayed=this._grayed},i.prototype._hitTest=function(t,e){if(this._content2){var i=this._content2.hitTest(e);if(i)return i}return t.x>=0&&t.y>=0&&t.x<this._width&&t.y<this._height?this:null},i.prototype.getProp=function(i){switch(i){case t.ObjectPropID.Color:return this.color;case t.ObjectPropID.Playing:return this.playing;case t.ObjectPropID.Frame:return this.frame;case t.ObjectPropID.TimeScale:return this._content.timeScale;default:return e.prototype.getProp.call(this,i)}},i.prototype.setProp=function(i,n){switch(i){case t.ObjectPropID.Color:this.color=n;break;case t.ObjectPropID.Playing:this.playing=n;break;case t.ObjectPropID.Frame:this.frame=n;break;case t.ObjectPropID.TimeScale:this._content.timeScale=n;break;case t.ObjectPropID.DeltaTime:this._content.advance(n);break;default:e.prototype.setProp.call(this,i,n)}},i.prototype.setup_beforeAdd=function(t,i){e.prototype.setup_beforeAdd.call(this,t,i),t.seek(i,5),this._url=t.readS(),this._align=t.readByte(),this._verticalAlign=t.readByte(),this._fill=t.readByte(),this._shrinkOnly=t.readBool(),this._autoSize=t.readBool(),this._showErrorSign=t.readBool(),this._playing=t.readBool(),this._frame=t.readInt(),t.readBool()&&(this.color=t.readColor()),this._content.fillMethod=t.readByte(),0!=this._content.fillMethod&&(this._content.fillOrigin=t.readByte(),this._content.fillClockwise=t.readBool(),this._content.fillAmount=t.readFloat()),this._url&&this.loadContent()},i._errorSignPool=new t.GObjectPool,i}(t.GObject);t.GLoader=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._frame=0,i._node.name="GLoader3D",i._playing=!0,i._url="",i._fill=t.LoaderFillType.None,i._align=t.AlignType.Left,i._verticalAlign=t.VertAlignType.Top,i._color=new cc.Color(255,255,255,255),i._container=new cc.Node("Wrapper"),i._container.setAnchorPoint(0,1),i._node.addChild(i._container),i}return __extends(i,e),i.prototype.dispose=function(){e.prototype.dispose.call(this)},Object.defineProperty(i.prototype,"url",{get:function(){return this._url},set:function(t){this._url!=t&&(this._url=t,this.loadContent(),this.updateGear(7))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"icon",{get:function(){return this._url},set:function(t){this.url=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"align",{get:function(){return this._align},set:function(t){this._align!=t&&(this._align=t,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this._fill},set:function(t){this._fill!=t&&(this._fill=t,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"shrinkOnly",{get:function(){return this._shrinkOnly},set:function(t){this._shrinkOnly!=t&&(this._shrinkOnly=t,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoSize",{get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"playing",{get:function(){return this._playing},set:function(t){this._playing!=t&&(this._playing=t,this.updateGear(5),this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame!=t&&(this._frame=t,this.updateGear(5),this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"animationName",{get:function(){return this._animationName},set:function(t){this._animationName!=t&&(this._animationName=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"skinName",{get:function(){return this._skinName},set:function(t){this._skinName!=t&&(this._skinName=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop!=t&&(this._loop=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this._color},set:function(t){this._color.equals(t)||(this._color.set(t),this.updateGear(4),this._content&&(this._content.node.color=t))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"content",{get:function(){},enumerable:!1,configurable:!0}),i.prototype.loadContent=function(){this.clearContent(),this._url&&(t.ToolSet.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())},i.prototype.loadFromPackage=function(e){this._contentItem=t.UIPackage.getItemByURL(e),this._contentItem&&(this._contentItem=this._contentItem.getBranch(),this.sourceWidth=this._contentItem.width,this.sourceHeight=this._contentItem.height,this._contentItem=this._contentItem.getHighResolution(),this._autoSize&&this.setSize(this.sourceWidth,this.sourceHeight),this._contentItem.type!=t.PackageItemType.Spine&&this._contentItem.type!=t.PackageItemType.DragonBones||this._contentItem.owner.getItemAssetAsync(this._contentItem,this.onLoaded.bind(this)))},i.prototype.onLoaded=function(e,i){this._contentItem==i&&(e&&console.warn(e),this._contentItem.asset&&(this._contentItem.type==t.PackageItemType.Spine?this.setSpine(this._contentItem.asset,this._contentItem.skeletonAnchor):this._contentItem.type==t.PackageItemType.DragonBones&&this.setDragonBones(this._contentItem.asset,this._contentItem.atlasAsset,this._contentItem.skeletonAnchor)))},i.prototype.setSpine=function(t,e,i){this.url=null;var n=new cc.Node;n.color=this._color,this._container.addChild(n),n.setPosition(e.x,-e.y),this._content=n.addComponent(sp.Skeleton),this._content.premultipliedAlpha=i,this._content.skeletonData=t,this.onChangeSpine(),this.updateLayout()},i.prototype.setDragonBones=function(t,e,i,n){this.url=null;var o=new cc.Node;o.color=this._color,this._container.addChild(o),o.setPosition(i.x,-i.y),this._content=o.addComponent(dragonBones.ArmatureDisplay),this._content.premultipliedAlpha=n,this._content.dragonAsset=t,this._content.dragonAtlasAsset=e;var r=t.init(dragonBones.CCFactory.getInstance(),e._uuid),a=this._content._factory.getDragonBonesData(r);this._content.armatureName=a.armatureNames[0],this.onChangeDragonBones(),this.updateLayout()},i.prototype.onChange=function(){this.onChangeSpine(),this.onChangeDragonBones()},i.prototype.onChangeSpine=function(){if(this._content instanceof sp.Skeleton){if(this._animationName){var e=this._content.getCurrent(0);(!e||e.animation.name!=this._animationName||e.isComplete()&&!e.loop)&&(this._content.defaultAnimation=this._animationName,e=this._content.setAnimation(0,this._animationName,this._loop)),this._playing?this._content.paused=!1:(this._content.paused=!0,e.trackTime=t.ToolSet.lerp(0,e.animationEnd-e.animationStart,this._frame/100))}else this._content.clearTrack(0);var i=this._skinName||this._content.skeletonData.getRuntimeData().skins[0].name;this._content._skeleton.skin!=i&&this._content.setSkin(i)}},i.prototype.onChangeDragonBones=function(){this._content instanceof dragonBones.ArmatureDisplay&&(this._animationName?this._playing?this._content.playAnimation(this._animationName,this._loop?0:1):this._content.armature().animation.gotoAndStopByFrame(this._animationName,this._frame):this._content.armature().animation.reset())},i.prototype.loadExternal=function(){t.ToolSet.startsWith(this._url,"http://")||t.ToolSet.startsWith(this._url,"https://")||t.ToolSet.startsWith(this._url,"/")?cc.assetManager.loadRemote(this._url,sp.SkeletonData,this.onLoaded2.bind(this)):cc.resources.load(this._url,sp.SkeletonData,this.onLoaded2.bind(this))},i.prototype.onLoaded2=function(t,e){this._url&&cc.isValid(this._node)&&t&&console.warn(t)},i.prototype.updateLayout=function(){var e=this.sourceWidth,i=this.sourceHeight,n=-this.pivotX*this._width,o=this.pivotY*this._height;if(this._autoSize&&(this._updatingLayout=!0,0==e&&(e=50),0==i&&(i=30),this.setSize(e,i),this._updatingLayout=!1,e==this._width&&i==this._height))return this._container.setScale(1,1),void this._container.setPosition(n,o);var r,a,s=1,h=1;this._fill!=t.LoaderFillType.None&&(s=this.width/this.sourceWidth,h=this.height/this.sourceHeight,1==s&&1==h||(this._fill==t.LoaderFillType.ScaleMatchHeight?s=h:this._fill==t.LoaderFillType.ScaleMatchWidth?h=s:this._fill==t.LoaderFillType.Scale?s>h?s=h:h=s:this._fill==t.LoaderFillType.ScaleNoBorder&&(s>h?h=s:s=h),this._shrinkOnly&&(s>1&&(s=1),h>1&&(h=1)),e=this.sourceWidth*s,i=this.sourceHeight*h)),this._container.setScale(s,h),r=this._align==t.AlignType.Left?0:this._align==t.AlignType.Center?Math.floor((this._width-e)/2):this._width-e,a=-(a=this._verticalAlign==t.VertAlignType.Top?0:this._verticalAlign==t.VertAlignType.Middle?Math.floor((this._height-i)/2):this._height-i),this._container.setPosition(n+r,o+a)},i.prototype.clearContent=function(){this._contentItem=null,this._content&&(this._content.node.destroy(),this._content=null)},i.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._updatingLayout||this.updateLayout()},i.prototype.handleAnchorChanged=function(){e.prototype.handleAnchorChanged.call(this),this._updatingLayout||this.updateLayout()},i.prototype.handleGrayedChanged=function(){},i.prototype.getProp=function(i){switch(i){case t.ObjectPropID.Color:return this.color;case t.ObjectPropID.Playing:return this.playing;case t.ObjectPropID.Frame:return this.frame;case t.ObjectPropID.TimeScale:return 1;default:return e.prototype.getProp.call(this,i)}},i.prototype.setProp=function(i,n){switch(i){case t.ObjectPropID.Color:this.color=n;break;case t.ObjectPropID.Playing:this.playing=n;break;case t.ObjectPropID.Frame:this.frame=n;break;case t.ObjectPropID.TimeScale:case t.ObjectPropID.DeltaTime:break;default:e.prototype.setProp.call(this,i,n)}},i.prototype.setup_beforeAdd=function(t,i){e.prototype.setup_beforeAdd.call(this,t,i),t.seek(i,5),this._url=t.readS(),this._align=t.readByte(),this._verticalAlign=t.readByte(),this._fill=t.readByte(),this._shrinkOnly=t.readBool(),this._autoSize=t.readBool(),this._animationName=t.readS(),this._skinName=t.readS(),this._playing=t.readBool(),this._frame=t.readInt(),this._loop=t.readBool(),t.readBool()&&(this.color=t.readColor()),this._url&&this.loadContent()},i}(t.GObject);t.GLoader3D=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._node.name="GMovieClip",i._touchDisabled=!0,i._content=i._node.addComponent(t.MovieClip),i._content.sizeMode=cc.Sprite.SizeMode.CUSTOM,i._content.trim=!1,i._content.setPlaySettings(),i}return __extends(i,e),Object.defineProperty(i.prototype,"color",{get:function(){return this._node.color},set:function(t){this._node.color.equals(t)||(this._node.color=t,this.updateGear(4))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"playing",{get:function(){return this._content.playing},set:function(t){this._content.playing!=t&&(this._content.playing=t,this.updateGear(5))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"frame",{get:function(){return this._content.frame},set:function(t){this._content.frame!=t&&(this._content.frame=t,this.updateGear(5))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"timeScale",{get:function(){return this._content.timeScale},set:function(t){this._content.timeScale=t},enumerable:!1,configurable:!0}),i.prototype.rewind=function(){this._content.rewind()},i.prototype.syncStatus=function(t){this._content.syncStatus(t._content)},i.prototype.advance=function(t){this._content.advance(t)},i.prototype.setPlaySettings=function(t,e,i,n,o,r){this._content.setPlaySettings(t,e,i,n,o,r)},i.prototype.handleGrayedChanged=function(){this._content.grayed=this._grayed},i.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._content.sizeMode=cc.Sprite.SizeMode.CUSTOM},i.prototype.getProp=function(i){switch(i){case t.ObjectPropID.Color:return this.color;case t.ObjectPropID.Playing:return this.playing;case t.ObjectPropID.Frame:return this.frame;case t.ObjectPropID.TimeScale:return this.timeScale;default:return e.prototype.getProp.call(this,i)}},i.prototype.setProp=function(i,n){switch(i){case t.ObjectPropID.Color:this.color=n;break;case t.ObjectPropID.Playing:this.playing=n;break;case t.ObjectPropID.Frame:this.frame=n;break;case t.ObjectPropID.TimeScale:this.timeScale=n;break;case t.ObjectPropID.DeltaTime:this.advance(n);break;default:e.prototype.setProp.call(this,i,n)}},i.prototype.constructFromResource=function(){var t=this.packageItem.getBranch();this.sourceWidth=t.width,this.sourceHeight=t.height,this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),(t=t.getHighResolution()).load(),this._content.interval=t.interval,this._content.swing=t.swing,this._content.repeatDelay=t.repeatDelay,this._content.frames=t.frames,this._content.smoothing=t.smoothing},i.prototype.setup_beforeAdd=function(t,i){e.prototype.setup_beforeAdd.call(this,t,i),t.seek(i,5),t.readBool()&&(this.color=t.readColor()),t.readByte(),this._content.frame=t.readInt(),this._content.playing=t.readBool()},i}(t.GObject);t.GMovieClip=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._min=0,i._max=0,i._value=0,i._barMaxWidth=0,i._barMaxHeight=0,i._barMaxWidthDelta=0,i._barMaxHeightDelta=0,i._barStartX=0,i._barStartY=0,i._node.name="GProgressBar",i._titleType=t.ProgressTitleType.Percent,i._value=50,i._max=100,i}return __extends(i,e),Object.defineProperty(i.prototype,"titleType",{get:function(){return this._titleType},set:function(t){this._titleType!=t&&(this._titleType=t,this.update(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"min",{get:function(){return this._min},set:function(t){this._min!=t&&(this._min=t,this.update(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"max",{get:function(){return this._max},set:function(t){this._max!=t&&(this._max=t,this.update(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this._value},set:function(e){this._value!=e&&(t.GTween.kill(this,!1,this.update),this._value=e,this.update(e))},enumerable:!1,configurable:!0}),i.prototype.tweenValue=function(e,i){var n,o=t.GTween.getTween(this,this.update);return o?(n=o.value.x,o.kill()):n=this._value,this._value=e,t.GTween.to(n,this._value,i).setTarget(this,this.update).setEase(t.EaseType.Linear)},i.prototype.update=function(e){var i=t.ToolSet.clamp01((e-this._min)/(this._max-this._min));if(this._titleObject)switch(this._titleType){case t.ProgressTitleType.Percent:this._titleObject.text=Math.floor(100*i)+"%";break;case t.ProgressTitleType.ValueAndMax:this._titleObject.text=Math.floor(e)+"/"+Math.floor(this._max);break;case t.ProgressTitleType.Value:this._titleObject.text=""+Math.floor(e);break;case t.ProgressTitleType.Max:this._titleObject.text=""+Math.floor(this._max)}var n=this.width-this._barMaxWidthDelta,o=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this.setFillAmount(this._barObjectH,1-i)||(this._barObjectH.width=Math.round(n*i),this._barObjectH.x=this._barStartX+(n-this._barObjectH.width))),this._barObjectV&&(this.setFillAmount(this._barObjectV,1-i)||(this._barObjectV.height=Math.round(o*i),this._barObjectV.y=this._barStartY+(o-this._barObjectV.height)))):(this._barObjectH&&(this.setFillAmount(this._barObjectH,i)||(this._barObjectH.width=Math.round(n*i))),this._barObjectV&&(this.setFillAmount(this._barObjectV,i)||(this._barObjectV.height=Math.round(o*i)))),this._aniObject&&this._aniObject.setProp(t.ObjectPropID.Frame,Math.floor(100*i))},i.prototype.setFillAmount=function(e,i){return(e instanceof t.GImage||e instanceof t.GLoader)&&e.fillMethod!=t.FillMethod.None&&(e.fillAmount=i,!0)},i.prototype.constructExtension=function(t){t.seek(0,6),this._titleType=t.readByte(),this._reverse=t.readBool(),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y)},i.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update(this._value)},i.prototype.setup_afterAdd=function(t,i){e.prototype.setup_afterAdd.call(this,t,i),t.seek(i,6)&&t.readByte()==this.packageItem.objectType?(this._value=t.readInt(),this._max=t.readInt(),t.version>=2&&(this._min=t.readInt()),this.update(this._value)):this.update(this._value)},i}(t.GComponent);t.GProgressBar=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._fontSize=0,t._leading=0,t._node.name="GTextField",t._touchDisabled=!0,t._text="",t._color=new cc.Color(255,255,255,255),t.createRenderer(),t.fontSize=12,t.leading=3,t.singleLine=!1,t._sizeDirty=!1,t._node.on(cc.Node.EventType.SIZE_CHANGED,t.onLabelSizeChanged,t),t}return __extends(i,e),i.prototype.createRenderer=function(){this._label=this._node.addComponent(cc.Label),this.autoSize=t.AutoSizeType.Both},Object.defineProperty(i.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t,null==this._text&&(this._text=""),this.updateGear(6),this.markSizeChanged(),this.updateText()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"font",{get:function(){return this._font},set:function(e){if(this._font!=e||!e){this._font=e,this.markSizeChanged();var i=e||t.UIConfig.defaultFont;if(t.ToolSet.startsWith(i,"ui://")){var n=t.UIPackage.getItemByURL(i);i=n?n.owner.getItemAsset(n):t.UIConfig.defaultFont}this._realFont=i,this.updateFont()}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){t<0||this._fontSize!=t&&(this._fontSize=t,this.markSizeChanged(),this.updateFontSize())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this._color},set:function(t){this._color.equals(t)||(this._color.set(t),this.updateGear(4),this.updateFontColor())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"align",{get:function(){return this._label?this._label.horizontalAlign:0},set:function(t){this._label&&(this._label.horizontalAlign=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"verticalAlign",{get:function(){return this._label?this._label.verticalAlign:0},set:function(t){this._label&&(this._label.verticalAlign=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!=t&&(this._leading=t,this.markSizeChanged(),this.updateFontSize())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"letterSpacing",{get:function(){return this._label?this._label.spacingX:0},set:function(t){this._label&&this._label.spacingX!=t&&(this.markSizeChanged(),this._label.spacingX=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"underline",{get:function(){return!!this._label&&this._label.enableUnderline},set:function(t){this._label&&(this._label.enableUnderline=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"bold",{get:function(){return!!this._label&&this._label.enableBold},set:function(t){this._label&&(this._label.enableBold=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"italic",{get:function(){return!!this._label&&this._label.enableItalic},set:function(t){this._label&&(this._label.enableItalic=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"singleLine",{get:function(){return!!this._label&&!this._label.enableWrapText},set:function(t){this._label&&(this._label.enableWrapText=!t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this._outline&&this._outline.enabled?this._outline.width:0},set:function(t){0==t?this._outline&&(this._outline.enabled=!1):(this._outline?this._outline.enabled=!0:(this._outline=this._node.addComponent(cc.LabelOutline),this.updateStrokeColor()),this._outline.width=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(t){this._strokeColor&&this._strokeColor.equals(t)||(this._strokeColor||(this._strokeColor=new cc.Color),this._strokeColor.set(t),this.updateGear(4),this.updateStrokeColor())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"shadowOffset",{get:function(){return this._shadowOffset},set:function(t){this._shadowOffset&&this._shadowOffset.equals(t)||(this._shadowOffset||(this._shadowOffset=new cc.Vec2),this._shadowOffset.set(t),0!=this._shadowOffset.x||0!=this._shadowOffset.y?(this._shadow?this._shadow.enabled=!0:(this._shadow=this._node.addComponent(cc.LabelShadow),this.updateShadowColor()),this._shadow.offset.x=t.x,this._shadow.offset.y=-t.y):this._shadow&&(this._shadow.enabled=!1))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"shadowColor",{get:function(){return this._shadowColor},set:function(t){this._shadowColor&&this._shadowColor.equals(t)||(this._shadowColor||(this._shadowColor=new cc.Color),this._shadowColor.set(t),this.updateShadowColor())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"ubbEnabled",{get:function(){return this._ubbEnabled},set:function(t){this._ubbEnabled!=t&&(this._ubbEnabled=t,this.markSizeChanged(),this.updateText())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoSize",{get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this.markSizeChanged(),this.updateOverflow())},enumerable:!1,configurable:!0}),i.prototype.parseTemplate=function(t){for(var e,i,n,o,r=0,a="";-1!=(e=t.indexOf("{",r));)if(e>0&&92==t.charCodeAt(e-1))a+=t.substring(r,e-1),a+="{",r=e+1;else{if(a+=t.substring(r,e),r=e,-1==(e=t.indexOf("}",r)))break;e!=r+1?(-1!=(i=(n=t.substring(r+1,e)).indexOf("="))?a+=null==(o=this._templateVars[n.substring(0,i)])?n.substring(i+1):o:null!=(o=this._templateVars[n])&&(a+=o),r=e+1):(a+=t.substr(r,2),r=e+1)}return r<t.length&&(a+=t.substr(r)),a},Object.defineProperty(i.prototype,"templateVars",{get:function(){return this._templateVars},set:function(t){null==this._templateVars&&null==t||(this._templateVars=t,this.flushVars())},enumerable:!1,configurable:!0}),i.prototype.setVar=function(t,e){return this._templateVars||(this._templateVars={}),this._templateVars[t]=e,this},i.prototype.flushVars=function(){this.markSizeChanged(),this.updateText()},Object.defineProperty(i.prototype,"textWidth",{get:function(){return this.ensureSizeCorrect(),this._node.width},enumerable:!1,configurable:!0}),i.prototype.ensureSizeCorrect=function(){this._sizeDirty&&(this._label._forceUpdateRenderData?this._label._forceUpdateRenderData():this._label._updateRenderData(!0),this._sizeDirty=!1)},i.prototype.updateText=function(){var e=this._text;this._templateVars&&(e=this.parseTemplate(e)),this._ubbEnabled&&(e=t.UBBParser.inst.parse(t.ToolSet.encodeHTML(e),!0)),this._label.string=e},i.prototype.assignFont=function(e,i){if(i instanceof cc.Font)e.font=i;else{var n=t.getFontByName(i);n?e.font=n:(e.fontFamily=i,e.useSystemFont=!0)}},i.prototype.assignFontColor=function(e,i){var n=e.font;n instanceof cc.BitmapFont&&!n._fntConfig.canTint&&(i=cc.Color.WHITE),this._grayed&&(i=t.ToolSet.toGrayed(i)),e.node.color=i},i.prototype.updateFont=function(){this.assignFont(this._label,this._realFont)},i.prototype.updateFontColor=function(){this.assignFontColor(this._label,this._color)},i.prototype.updateStrokeColor=function(){this._outline&&(this._strokeColor||(this._strokeColor=new cc.Color),this._grayed?this._outline.color=t.ToolSet.toGrayed(this._strokeColor):this._outline.color=this._strokeColor)},i.prototype.updateShadowColor=function(){this._shadow&&(this._shadowColor||(this._shadowColor=new cc.Color),this._grayed?this._shadow.color=t.ToolSet.toGrayed(this._shadowColor):this._shadow.color=this._shadowColor)},i.prototype.updateFontSize=function(){var t=this._label.font;if(t instanceof cc.BitmapFont){var e=t._fntConfig;e.resizable?this._label.fontSize=this._fontSize:this._label.fontSize=e.fontSize,this._label.lineHeight=e.fontSize+(this._leading+4)*e.fontSize/this._label.fontSize}else this._label.fontSize=this._fontSize,this._label.lineHeight=this._fontSize+this._leading},i.prototype.updateOverflow=function(){this._autoSize==t.AutoSizeType.Both?this._label.overflow=cc.Label.Overflow.NONE:this._autoSize==t.AutoSizeType.Height?(this._label.overflow=cc.Label.Overflow.RESIZE_HEIGHT,this._node.width=this._width):this._autoSize==t.AutoSizeType.Shrink?(this._label.overflow=cc.Label.Overflow.SHRINK,this._node.setContentSize(this._width,this._height)):(this._label.overflow=cc.Label.Overflow.CLAMP,this._node.setContentSize(this._width,this._height))},i.prototype.markSizeChanged=function(){this._underConstruct||this._autoSize!=t.AutoSizeType.Both&&this._autoSize!=t.AutoSizeType.Height||this._sizeDirty||(this._node.emit(t.Event.SIZE_DELAY_CHANGE,this),this._sizeDirty=!0)},i.prototype.onLabelSizeChanged=function(){this._sizeDirty=!1,this._underConstruct||this._autoSize!=t.AutoSizeType.Both&&this._autoSize!=t.AutoSizeType.Height||(this._updatingSize=!0,this.setSize(this._node.width,this._node.height),this._updatingSize=!1)},i.prototype.handleSizeChanged=function(){this._updatingSize||(this._autoSize==t.AutoSizeType.None||this._autoSize==t.AutoSizeType.Shrink?this._node.setContentSize(this._width,this._height):this._autoSize==t.AutoSizeType.Height&&(this._node.width=this._width))},i.prototype.handleGrayedChanged=function(){this.updateFontColor(),this.updateStrokeColor()},i.prototype.getProp=function(i){switch(i){case t.ObjectPropID.Color:return this.color;case t.ObjectPropID.OutlineColor:return this.strokeColor;case t.ObjectPropID.FontSize:return this.fontSize;default:return e.prototype.getProp.call(this,i)}},i.prototype.setProp=function(i,n){switch(i){case t.ObjectPropID.Color:this.color=n;break;case t.ObjectPropID.OutlineColor:this.strokeColor=n;break;case t.ObjectPropID.FontSize:this.fontSize=n;break;default:e.prototype.setProp.call(this,i,n)}},i.prototype.setup_beforeAdd=function(t,i){if(e.prototype.setup_beforeAdd.call(this,t,i),t.seek(i,5),this.font=t.readS(),this.fontSize=t.readShort(),this.color=t.readColor(),this.align=t.readByte(),this.verticalAlign=t.readByte(),this.leading=t.readShort(),this.letterSpacing=t.readShort(),this._ubbEnabled=t.readBool(),this.autoSize=t.readByte(),this.underline=t.readBool(),this.italic=t.readBool(),this.bold=t.readBool(),this.singleLine=t.readBool(),t.readBool()&&(this.strokeColor=t.readColor(),this.stroke=t.readFloat()),t.readBool()){this.shadowColor=t.readColor();var n=t.readFloat(),o=t.readFloat();this.shadowOffset=new cc.Vec2(n,o)}t.readBool()&&(this._templateVars={})},i.prototype.setup_afterAdd=function(t,i){e.prototype.setup_afterAdd.call(this,t,i),t.seek(i,6);var n=t.readS();null!=n&&(this.text=n)},i}(t.GObject);t.GTextField=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.getSpriteFrame=function(i){var n=t.UIPackage.getItemByURL(i);if(n){if(n.load(),n.type==t.PackageItemType.Image)return n.asset;if(n.type==t.PackageItemType.MovieClip)return n.frames[0].texture}return e.prototype.getSpriteFrame.call(this,i)},i}(cc.SpriteAtlas);t.RichTextImageAtlas=e;var i=function(i){function n(){var e=i.call(this)||this;return e._node.name="GRichTextField",e._touchDisabled=!1,e.linkUnderline=t.UIConfig.linkUnderline,e}return __extends(n,i),n.prototype.createRenderer=function(){this._richText=this._node.addComponent(cc.RichText),this._richText.handleTouchEvent=!1,this.autoSize=t.AutoSizeType.None,this._richText.imageAtlas=n.imageAtlas},Object.defineProperty(n.prototype,"align",{get:function(){return this._richText.horizontalAlign},set:function(t){this._richText.horizontalAlign=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"underline",{get:function(){return this._underline},set:function(t){this._underline!=t&&(this._underline=t,this.updateText())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bold",{get:function(){return this._bold},set:function(t){this._bold!=t&&(this._bold=t,this.updateText())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"italic",{get:function(){return this._italics},set:function(t){this._italics!=t&&(this._italics=t,this.updateText())},enumerable:!1,configurable:!0}),n.prototype.markSizeChanged=function(){},n.prototype.updateText=function(){var e=this._text;this._templateVars&&(e=this.parseTemplate(e)),this._ubbEnabled&&(t.UBBParser.inst.linkUnderline=this.linkUnderline,t.UBBParser.inst.linkColor=this.linkColor,e=t.UBBParser.inst.parse(t.ToolSet.encodeHTML(e))),this._bold&&(e="<b>"+e+"</b>"),this._italics&&(e="<i>"+e+"</i>"),this._underline&&(e="<u>"+e+"</u>");var i=this._color;this._grayed&&(i=t.ToolSet.toGrayed(i)),e="<color="+i.toHEX("#rrggbb")+">"+e+"</color>",this._autoSize==t.AutoSizeType.Both?(0!=this._richText.maxWidth&&(this._richText.maxWidth=0),this._richText.string=e,0!=this.maxWidth&&this._node.width>this.maxWidth&&(this._richText.maxWidth=this.maxWidth)):this._richText.string=e},n.prototype.updateFont=function(){this.assignFont(this._richText,this._realFont)},n.prototype.updateFontColor=function(){this.assignFontColor(this._richText,this._color)},n.prototype.updateFontSize=function(){var t=this._fontSize,e=this._richText.font;e instanceof cc.BitmapFont&&(e._fntConfig.resizable||(t=e._fntConfig.fontSize)),this._richText.fontSize=t,this._richText.lineHeight=t+this._leading},n.prototype.updateOverflow=function(){this._autoSize==t.AutoSizeType.Both?this._richText.maxWidth=0:this._richText.maxWidth=this._width},n.prototype.handleSizeChanged=function(){this._updatingSize||this._autoSize!=t.AutoSizeType.Both&&(this._richText.maxWidth=this._width)},n.imageAtlas=new e,n}(t.GTextField);t.GRichTextField=i}(fgui||(fgui={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._node.name="GRoot",i.opaque=!1,i._volumeScale=1,i._popupStack=new Array,i._justClosedPopups=new Array,i._modalLayer=new t.GGraph,i._modalLayer.setSize(i.width,i.height),i._modalLayer.drawRect(0,cc.Color.TRANSPARENT,t.UIConfig.modalLayerColor),i._modalLayer.addRelation(i,t.RelationType.Size),i._thisOnResized=i.onWinResize.bind(i),i._inputProcessor=i.node.addComponent(t.InputProcessor),i._inputProcessor._captureCallback=i.onTouchBegin_1,cc.view.on("canvas-resize",i._thisOnResized),i.onWinResize(),i}return __extends(i,e),Object.defineProperty(i,"inst",{get:function(){if(!i._inst)throw"Call GRoot.create first!";return i._inst},enumerable:!1,configurable:!0}),i.create=function(){return i._inst=new i,i._inst.node.parent=cc.director.getScene(),i._inst},i.prototype.onDestroy=function(){cc.view.off("canvas-resize",this._thisOnResized),this==i._inst&&(i._inst=null)},i.prototype.getTouchPosition=function(t){return this._inputProcessor.getTouchPosition(t)},Object.defineProperty(i.prototype,"touchTarget",{get:function(){return this._inputProcessor.getTouchTarget()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"inputProcessor",{get:function(){return this._inputProcessor},enumerable:!1,configurable:!0}),i.prototype.showWindow=function(t){this.addChild(t),t.requestFocus(),t.x>this.width?t.x=this.width-t.width:t.x+t.width<0&&(t.x=0),t.y>this.height?t.y=this.height-t.height:t.y+t.height<0&&(t.y=0),this.adjustModalLayer()},i.prototype.hideWindow=function(t){t.hide()},i.prototype.hideWindowImmediately=function(t){t.parent==this&&this.removeChild(t),this.adjustModalLayer()},i.prototype.bringToFront=function(e){var i,n=this.numChildren;for(i=this._modalLayer.parent&&!e.modal?this.getChildIndex(this._modalLayer)-1:n-1;i>=0;i--){var o=this.getChildAt(i);if(o==e)return;if(o instanceof t.Window)break}i>=0&&this.setChildIndex(e,i)},i.prototype.showModalWait=function(e){null!=t.UIConfig.globalModalWaiting&&(null==this._modalWaitPane&&(this._modalWaitPane=t.UIPackage.createObjectFromURL(t.UIConfig.globalModalWaiting)),this._modalWaitPane.setSize(this.width,this.height),this._modalWaitPane.addRelation(this,t.RelationType.Size),this.addChild(this._modalWaitPane),this._modalWaitPane.text=e)},i.prototype.closeModalWait=function(){this._modalWaitPane&&this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane)},i.prototype.closeAllExceptModals=function(){for(var e=this._children.slice(),i=e.length,n=0;n<i;n++){var o=e[n];o instanceof t.Window&&!o.modal&&o.hide()}},i.prototype.closeAllWindows=function(){for(var e=this._children.slice(),i=e.length,n=0;n<i;n++){var o=e[n];o instanceof t.Window&&o.hide()}},i.prototype.getTopWindow=function(){for(var e=this.numChildren-1;e>=0;e--){var i=this.getChildAt(e);if(i instanceof t.Window)return i}return null},Object.defineProperty(i.prototype,"modalLayer",{get:function(){return this._modalLayer},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hasModalWindow",{get:function(){return null!=this._modalLayer.parent},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"modalWaiting",{get:function(){return this._modalWaitPane&&this._modalWaitPane.node.activeInHierarchy},enumerable:!1,configurable:!0}),i.prototype.getPopupPosition=function(e,i,n,o){var r=o||new cc.Vec2,a=0,s=0;if(i){r=i.localToGlobal();var h=i.localToGlobal(i.width,i.height);a=h.x-r.x,s=h.y-r.y}else r=this.getTouchPosition(),r=this.globalToLocal(r.x,r.y);return r.x+e.width>this.width&&(r.x=r.x+a-e.width),r.y+=s,((void 0===n||n===t.PopupDirection.Auto)&&r.y+e.height>this.height||!1===n||n===t.PopupDirection.Up)&&(r.y=r.y-s-e.height-1,r.y<0&&(r.y=0,r.x+=a/2)),r},i.prototype.showPopup=function(t,e,i){if(this._popupStack.length>0){var n=this._popupStack.indexOf(t);if(-1!=n)for(var o=this._popupStack.length-1;o>=n;o--)this.removeChild(this._popupStack.pop())}if(this._popupStack.push(t),e)for(var r=e;r;){if(r.parent==this){t.sortingOrder<r.sortingOrder&&(t.sortingOrder=r.sortingOrder);break}r=r.parent}this.addChild(t),this.adjustModalLayer();var a=this.getPopupPosition(t,e,i);t.setPosition(a.x,a.y)},i.prototype.togglePopup=function(t,e,i){-1==this._justClosedPopups.indexOf(t)&&this.showPopup(t,e,i)},i.prototype.hidePopup=function(t){if(t){var e=this._popupStack.indexOf(t);if(-1!=e)for(var i=this._popupStack.length-1;i>=e;i--)this.closePopup(this._popupStack.pop())}else{for(i=this._popupStack.length-1;i>=0;i--)this.closePopup(this._popupStack[i]);this._popupStack.length=0}},Object.defineProperty(i.prototype,"hasAnyPopup",{get:function(){return 0!=this._popupStack.length},enumerable:!1,configurable:!0}),i.prototype.closePopup=function(e){e.parent&&(e instanceof t.Window?e.hide():this.removeChild(e))},i.prototype.showTooltips=function(e){if(null==this._defaultTooltipWin){var i=t.UIConfig.tooltipsWin;if(!i)return void console.error("UIConfig.tooltipsWin not defined");this._defaultTooltipWin=t.UIPackage.createObjectFromURL(i)}this._defaultTooltipWin.text=e,this.showTooltipsWin(this._defaultTooltipWin)},i.prototype.showTooltipsWin=function(t){this.hideTooltips(),this._tooltipWin=t;var e=this.getTouchPosition();e.x+=10,e.y+=20,this.globalToLocal(e.x,e.y,e),e.x+this._tooltipWin.width>this.width&&(e.x=e.x-this._tooltipWin.width-1,e.x<0&&(e.x=10)),e.y+this._tooltipWin.height>this.height&&(e.y=e.y-this._tooltipWin.height-1,e.y<0&&(e.y=10)),this._tooltipWin.setPosition(e.x,e.y),this.addChild(this._tooltipWin)},i.prototype.hideTooltips=function(){this._tooltipWin&&(this._tooltipWin.parent&&this.removeChild(this._tooltipWin),this._tooltipWin=null)},Object.defineProperty(i.prototype,"volumeScale",{get:function(){return this._volumeScale},set:function(t){this._volumeScale=t},enumerable:!1,configurable:!0}),i.prototype.playOneShotSound=function(t,e){void 0===e&&(e=1),cc.audioEngine.play(t,!1,this._volumeScale*e)},i.prototype.adjustModalLayer=function(){var e=this.numChildren;this._modalWaitPane&&this._modalWaitPane.parent&&this.setChildIndex(this._modalWaitPane,e-1);for(var i=e-1;i>=0;i--){var n=this.getChildAt(i);if(n instanceof t.Window&&n.modal)return void(null==this._modalLayer.parent?this.addChildAt(this._modalLayer,i):this.setChildIndexBefore(this._modalLayer,i))}this._modalLayer.parent&&this.removeChild(this._modalLayer)},i.prototype.onTouchBegin_1=function(t){if(this._tooltipWin&&this.hideTooltips(),this._justClosedPopups.length=0,this._popupStack.length>0){for(var e=t.initiator;e&&e!=this;){var i=this._popupStack.indexOf(e);if(-1!=i){for(var n=this._popupStack.length-1;n>i;n--){var o=this._popupStack.pop();this.closePopup(o),this._justClosedPopups.push(o)}return}e=e.findParent()}for(n=this._popupStack.length-1;n>=0;n--)o=this._popupStack[n],this.closePopup(o),this._justClosedPopups.push(o);this._popupStack.length=0}},i.prototype.onWinResize=function(){var t=cc.view.getCanvasSize();t.width/=cc.view.getScaleX(),t.height/=cc.view.getScaleY();var e=cc.view.getViewportRect().origin;e.x=e.x/cc.view.getScaleX(),e.y=e.y/cc.view.getScaleY(),this.setSize(t.width,t.height),this._node.setPosition(-e.x,this._height-e.y),this.updateContentScaleLevel()},i.prototype.handlePositionChanged=function(){},i.prototype.updateContentScaleLevel=function(){var t=Math.max(cc.view.getScaleX(),cc.view.getScaleY());i.contentScaleLevel=t>=3.5?3:t>=2.5?2:t>=1.5?1:0},i.contentScaleLevel=0,i}(t.GComponent);t.GRoot=e}(fgui||(fgui={})),function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._node.name="GScrollBar",t._dragOffset=new cc.Vec2,t._scrollPerc=0,t}return __extends(n,e),n.prototype.setScrollPane=function(t,e){this._target=t,this._vertical=e},n.prototype.setDisplayPerc=function(t){this._vertical?(this._fixedGripSize||(this._grip.height=Math.floor(t*this._bar.height)),this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc):(this._fixedGripSize||(this._grip.width=Math.floor(t*this._bar.width)),this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc),this._grip.visible=0!=t&&1!=t},n.prototype.setScrollPerc=function(t){this._scrollPerc=t,this._vertical?this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc:this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc},Object.defineProperty(n.prototype,"minSize",{get:function(){return this._vertical?(this._arrowButton1?this._arrowButton1.height:0)+(this._arrowButton2?this._arrowButton2.height:0):(this._arrowButton1?this._arrowButton1.width:0)+(this._arrowButton2?this._arrowButton2.width:0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"gripDragging",{get:function(){return this._gripDragging},enumerable:!1,configurable:!0}),n.prototype.constructExtension=function(e){e.seek(0,6),this._fixedGripSize=e.readBool(),this._grip=this.getChild("grip"),this._grip?(this._bar=this.getChild("bar"),this._bar?(this._arrowButton1=this.getChild("arrow1"),this._arrowButton2=this.getChild("arrow2"),this._grip.on(t.Event.TOUCH_BEGIN,this.onGripTouchDown,this),this._grip.on(t.Event.TOUCH_MOVE,this.onGripTouchMove,this),this._grip.on(t.Event.TOUCH_END,this.onGripTouchEnd,this),this._arrowButton1&&this._arrowButton1.on(t.Event.TOUCH_BEGIN,this.onClickArrow1,this),this._arrowButton2&&this._arrowButton2.on(t.Event.TOUCH_BEGIN,this.onClickArrow2,this),this.on(t.Event.TOUCH_BEGIN,this.onBarTouchBegin,this)):console.error("\u9700\u8981\u5b9a\u4e49bar")):console.error("\u9700\u8981\u5b9a\u4e49grip")},n.prototype.onGripTouchDown=function(t){t.stopPropagation(),t.captureTouch(),this._gripDragging=!0,this._target.updateScrollBarVisible(),this.globalToLocal(t.pos.x,t.pos.y,this._dragOffset),this._dragOffset.x-=this._grip.x,this._dragOffset.y-=this._grip.y},n.prototype.onGripTouchMove=function(t){if(this.onStage){var e=this.globalToLocal(t.pos.x,t.pos.y,i);if(this._vertical){var n=e.y-this._dragOffset.y;this._target.setPercY((n-this._bar.y)/(this._bar.height-this._grip.height),!1)}else{var o=e.x-this._dragOffset.x;this._target.setPercX((o-this._bar.x)/(this._bar.width-this._grip.width),!1)}}},n.prototype.onGripTouchEnd=function(t){this.onStage&&(this._gripDragging=!1,this._target.updateScrollBarVisible())},n.prototype.onClickArrow1=function(t){t.stopPropagation(),this._vertical?this._target.scrollUp():this._target.scrollLeft()},n.prototype.onClickArrow2=function(t){t.stopPropagation(),this._vertical?this._target.scrollDown():this._target.scrollRight()},n.prototype.onBarTouchBegin=function(t){var e=this._grip.globalToLocal(t.pos.x,t.pos.y,i);this._vertical?e.y<0?this._target.scrollUp(4):this._target.scrollDown(4):e.x<0?this._target.scrollLeft(4):this._target.scrollRight(4)},n}(t.GComponent);t.GScrollBar=e;var i=new cc.Vec2}(fgui||(fgui={})),function(t){var e=function(e){function n(){var i=e.call(this)||this;return i._min=0,i._max=0,i._value=0,i._barMaxWidth=0,i._barMaxHeight=0,i._barMaxWidthDelta=0,i._barMaxHeightDelta=0,i._clickPercent=0,i._barStartX=0,i._barStartY=0,i.changeOnClick=!0,i.canDrag=!0,i._node.name="GSlider",i._titleType=t.ProgressTitleType.Percent,i._value=50,i._max=100,i._clickPos=new cc.Vec2,i}return __extends(n,e),Object.defineProperty(n.prototype,"titleType",{get:function(){return this._titleType},set:function(t){this._titleType=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"wholeNumbers",{get:function(){return this._wholeNumbers},set:function(t){this._wholeNumbers!=t&&(this._wholeNumbers=t,this.update())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"min",{get:function(){return this._min},set:function(t){this._min!=t&&(this._min=t,this.update())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"max",{get:function(){return this._max},set:function(t){this._max!=t&&(this._max=t,this.update())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this._value},set:function(t){this._value!=t&&(this._value=t,this.update())},enumerable:!1,configurable:!0}),n.prototype.update=function(){this.updateWithPercent((this._value-this._min)/(this._max-this._min))},n.prototype.updateWithPercent=function(e,i){if(e=t.ToolSet.clamp01(e),i){var n=t.ToolSet.clamp(this._min+(this._max-this._min)*e,this._min,this._max);this._wholeNumbers&&(n=Math.round(n),e=t.ToolSet.clamp01((n-this._min)/(this._max-this._min))),n!=this._value&&(this._value=n,this._node.emit(t.Event.STATUS_CHANGED,this))}if(this._titleObject)switch(this._titleType){case t.ProgressTitleType.Percent:this._titleObject.text=Math.floor(100*e)+"%";break;case t.ProgressTitleType.ValueAndMax:this._titleObject.text=this._value+"/"+this._max;break;case t.ProgressTitleType.Value:this._titleObject.text=""+this._value;break;case t.ProgressTitleType.Max:this._titleObject.text=""+this._max}var o=this.width-this._barMaxWidthDelta,r=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this._barObjectH.width=Math.round(o*e),this._barObjectH.x=this._barStartX+(o-this._barObjectH.width)),this._barObjectV&&(this._barObjectV.height=Math.round(r*e),this._barObjectV.y=this._barStartY+(r-this._barObjectV.height))):(this._barObjectH&&(this._barObjectH.width=Math.round(o*e)),this._barObjectV&&(this._barObjectV.height=Math.round(r*e)))},n.prototype.constructExtension=function(e){e.seek(0,6),this._titleType=e.readByte(),this._reverse=e.readBool(),e.version>=2&&(this._wholeNumbers=e.readBool(),this.changeOnClick=e.readBool()),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._gripObject=this.getChild("grip"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y),this._gripObject&&(this._gripObject.on(t.Event.TOUCH_BEGIN,this.onGripTouchBegin,this),this._gripObject.on(t.Event.TOUCH_MOVE,this.onGripTouchMove,this)),this._node.on(t.Event.TOUCH_BEGIN,this.onBarTouchBegin,this)},n.prototype.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update()},n.prototype.setup_afterAdd=function(t,i){e.prototype.setup_afterAdd.call(this,t,i),t.seek(i,6)&&t.readByte()==this.packageItem.objectType?(this._value=t.readInt(),this._max=t.readInt(),t.version>=2&&(this._min=t.readInt()),this.update()):this.update()},n.prototype.onGripTouchBegin=function(e){this.canDrag=!0,e.stopPropagation(),e.captureTouch(),this._clickPos=this.globalToLocal(e.pos.x,e.pos.y),this._clickPercent=t.ToolSet.clamp01((this._value-this._min)/(this._max-this._min))},n.prototype.onGripTouchMove=function(t){if(this.canDrag){var e,n=this.globalToLocal(t.pos.x,t.pos.y,i),o=n.x-this._clickPos.x,r=n.y-this._clickPos.y;this._reverse&&(o=-o,r=-r),e=this._barObjectH?this._clickPercent+o/this._barMaxWidth:this._clickPercent+r/this._barMaxHeight,this.updateWithPercent(e,!0)}},n.prototype.onBarTouchBegin=function(e){if(this.changeOnClick){var n=this._gripObject.globalToLocal(e.pos.x,e.pos.y,i),o=t.ToolSet.clamp01((this._value-this._min)/(this._max-this._min)),r=0;null!=this._barObjectH&&(r=(n.x-this._gripObject.width/2)/this._barMaxWidth),null!=this._barObjectV&&(r=(n.y-this._gripObject.height/2)/this._barMaxHeight),this._reverse?o-=r:o+=r,this.updateWithPercent(o,!0)}},n}(t.GComponent);t.GSlider=e;var i=new cc.Vec2}(fgui||(fgui={})),function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._node.name="GTextInput",t._touchDisabled=!1,t}return __extends(n,e),n.prototype.createRenderer=function(){this._editBox=this._node.addComponent(i),this._editBox.maxLength=-1,this._editBox._updateTextLabel(),this._node.on("text-changed",this.onTextChanged,this),this.on(t.Event.TOUCH_END,this.onTouchEnd1,this),this.autoSize=t.AutoSizeType.None},Object.defineProperty(n.prototype,"editable",{get:function(){return this._editBox.enabled},set:function(t){this._editBox.enabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxLength",{get:function(){return this._editBox.maxLength},set:function(t){0==t&&(t=-1),this._editBox.maxLength=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"promptText",{get:function(){return this._promptText},set:function(e){this._promptText=e;var i=!this._editBox.placeholderLabel;if(this._editBox._updatePlaceholderLabel(),i&&this.assignFont(this._editBox.placeholderLabel,this._realFont),this._editBox.placeholderLabel.string=t.UBBParser.inst.parse(this._promptText,!0),t.UBBParser.inst.lastColor){var n=this._editBox.placeholderLabel.node.color;n||(n=new cc.Color),n.fromHEX(t.UBBParser.inst.lastColor),this.assignFontColor(this._editBox.placeholderLabel,n)}else this.assignFontColor(this._editBox.placeholderLabel,this._color);t.UBBParser.inst.lastSize?this._editBox.placeholderLabel.fontSize=parseInt(t.UBBParser.inst.lastSize):this._editBox.placeholderLabel.fontSize=this._fontSize},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"restrict",{get:function(){return""},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"password",{get:function(){return this._editBox.inputFlag==cc.EditBox.InputFlag.PASSWORD},set:function(t){this._editBox.inputFlag=t?cc.EditBox.InputFlag.PASSWORD:cc.EditBox.InputFlag.DEFAULT},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"align",{get:function(){return this._editBox.textLabel.horizontalAlign},set:function(t){this._editBox.textLabel.horizontalAlign=t,this._editBox.placeholderLabel&&(this._editBox.placeholderLabel.horizontalAlign=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this._editBox.textLabel.verticalAlign},set:function(t){this._editBox.textLabel.verticalAlign=t,this._editBox.placeholderLabel&&(this._editBox.placeholderLabel.verticalAlign=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"singleLine",{get:function(){return this._editBox.inputMode!=cc.EditBox.InputMode.ANY},set:function(t){this._editBox.inputMode=t?cc.EditBox.InputMode.SINGLE_LINE:cc.EditBox.InputMode.ANY},enumerable:!1,configurable:!0}),n.prototype.requestFocus=function(){this._editBox.focus()},n.prototype.markSizeChanged=function(){},n.prototype.updateText=function(){var e=this._text;this._templateVars&&(e=this.parseTemplate(e)),this._ubbEnabled&&(e=t.UBBParser.inst.parse(t.ToolSet.encodeHTML(e),!0)),this._editBox.string=e},n.prototype.updateFont=function(){this.assignFont(this._editBox.textLabel,this._realFont),this._editBox.placeholderLabel&&this.assignFont(this._editBox.placeholderLabel,this._realFont)},n.prototype.updateFontColor=function(){this.assignFontColor(this._editBox.textLabel,this._color)},n.prototype.updateFontSize=function(){this._editBox.textLabel.fontSize=this._fontSize,this._editBox.textLabel.lineHeight=this._fontSize+this._leading,this._editBox.placeholderLabel&&(this._editBox.placeholderLabel.fontSize=this._editBox.textLabel.fontSize)},n.prototype.updateOverflow=function(){},n.prototype.onTextChanged=function(){this._text=this._editBox.string},n.prototype.onTouchEnd1=function(t){this._editBox.openKeyboard(t.touch)},n.prototype.setup_beforeAdd=function(t,i){e.prototype.setup_beforeAdd.call(this,t,i),t.seek(i,4);var n=t.readS();null!=n&&(this.promptText=n),null!=(n=t.readS())&&(this.restrict=n);var o=t.readInt();if(0!=o&&(this.maxLength=o),o=t.readInt(),t.readBool()&&(this.password=!0),this._editBox.placeholderLabel){var r=this._editBox.textLabel.horizontalAlign;this._editBox.placeholderLabel.horizontalAlign=r;var a=this._editBox.textLabel.verticalAlign;this._editBox.placeholderLabel.verticalAlign=a}},n}(t.GTextField);t.GTextInput=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._registerEvent=function(){},e.prototype._syncSize=function(){var t=this.node.getContentSize();this._impl.setSize(t.width,t.height),this.textLabel&&this.textLabel.node.setContentSize(t.width,t.height),this.placeholderLabel&&this.placeholderLabel.node.setContentSize(t.width,t.height)},e.prototype.openKeyboard=function(t){var e=this._impl;e&&e.beginEditing()},e}(cc.EditBox)}(fgui||(fgui={})),function(t){var e=function(e){function n(){var i=e.call(this)||this;return i._indent=15,i._rootNode=new t.GTreeNode(!0),i._rootNode._setTree(i),i._rootNode.expanded=!0,i}return __extends(n,e),Object.defineProperty(n.prototype,"rootNode",{get:function(){return this._rootNode},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"indent",{get:function(){return this._indent},set:function(t){this._indent=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"clickToExpand",{get:function(){return this._clickToExpand},set:function(t){this._clickToExpand=t},enumerable:!1,configurable:!0}),n.prototype.getSelectedNode=function(){return-1!=this.selectedIndex?this.getChildAt(this.selectedIndex)._treeNode:null},n.prototype.getSelectedNodes=function(t){t||(t=new Array),i.length=0,e.prototype.getSelection.call(this,i);for(var n=i.length,o=new Array,r=0;r<n;r++){var a=this.getChildAt(i[r])._treeNode;o.push(a)}return o},n.prototype.selectNode=function(t,e){for(var i=t.parent;i&&i!=this._rootNode;)i.expanded=!0,i=i.parent;t._cell&&this.addSelection(this.getChildIndex(t._cell),e)},n.prototype.unselectNode=function(t){t._cell&&this.removeSelection(this.getChildIndex(t._cell))},n.prototype.expandAll=function(t){t||(t=this._rootNode),t.expanded=!0;for(var e=t.numChildren,i=0;i<e;i++){var n=t.getChildAt(i);n.isFolder&&this.expandAll(n)}},n.prototype.collapseAll=function(t){t||(t=this._rootNode),t!=this._rootNode&&(t.expanded=!1);for(var e=t.numChildren,i=0;i<e;i++){var n=t.getChildAt(i);n.isFolder&&this.collapseAll(n)}},n.prototype.createCell=function(e){var i=this.getFromPool(e._resURL);if(!(i instanceof t.GComponent))throw new Error("cannot create tree node object.");i._treeNode=e,e._cell=i;var n,o=i.getChild("indent");o&&(o.width=(e.level-1)*this._indent),(n=i.getController("expanded"))&&(n.on(t.Event.STATUS_CHANGED,this.__expandedStateChanged,this),n.selectedIndex=e.expanded?1:0),(n=i.getController("leaf"))&&(n.selectedIndex=e.isFolder?0:1),e.isFolder&&e._cell.on(t.Event.TOUCH_BEGIN,this.__cellMouseDown,this),this.treeNodeRender&&this.treeNodeRender(e,i)},n.prototype._afterInserted=function(t){t._cell||this.createCell(t);var e=this.getInsertIndexForNode(t);this.addChildAt(t._cell,e),this.treeNodeRender&&this.treeNodeRender(t,t._cell),t.isFolder&&t.expanded&&this.checkChildren(t,e)},n.prototype.getInsertIndexForNode=function(t){var e=t.getPrevSibling();null==e&&(e=t.parent);for(var i=this.getChildIndex(e._cell)+1,n=t.level,o=this.numChildren,r=i;r<o;r++){if(this.getChildAt(r)._treeNode.level<=n)break;i++}return i},n.prototype._afterRemoved=function(t){this.removeNode(t)},n.prototype._afterExpanded=function(t){if(t!=this._rootNode){if(null!=this.treeNodeWillExpand&&this.treeNodeWillExpand(t,!0),null!=t._cell){this.treeNodeRender&&this.treeNodeRender(t,t._cell);var e=t._cell.getController("expanded");e&&(e.selectedIndex=1),t._cell.parent&&this.checkChildren(t,this.getChildIndex(t._cell))}}else this.checkChildren(this._rootNode,0)},n.prototype._afterCollapsed=function(t){if(t!=this._rootNode){if(this.treeNodeWillExpand&&this.treeNodeWillExpand(t,!1),null!=t._cell){this.treeNodeRender&&this.treeNodeRender(t,t._cell);var e=t._cell.getController("expanded");e&&(e.selectedIndex=0),t._cell.parent&&this.hideFolderNode(t)}}else this.checkChildren(this._rootNode,0)},n.prototype._afterMoved=function(t){var e,i=this.getChildIndex(t._cell);e=t.isFolder?this.getFolderEndIndex(i,t.level):i+1;var n,o,r=this.getInsertIndexForNode(t),a=e-i;if(r<i)for(n=0;n<a;n++)o=this.getChildAt(i+n),this.setChildIndex(o,r+n);else for(n=0;n<a;n++)o=this.getChildAt(i),this.setChildIndex(o,r)},n.prototype.getFolderEndIndex=function(t,e){for(var i=this.numChildren,n=t+1;n<i;n++){if(this.getChildAt(n)._treeNode.level<=e)return n}return i},n.prototype.checkChildren=function(t,e){for(var i=t.numChildren,n=0;n<i;n++){e++;var o=t.getChildAt(n);null==o._cell&&this.createCell(o),o._cell.parent||this.addChildAt(o._cell,e),o.isFolder&&o.expanded&&(e=this.checkChildren(o,e))}return e},n.prototype.hideFolderNode=function(t){for(var e=t.numChildren,i=0;i<e;i++){var n=t.getChildAt(i);n._cell&&this.removeChild(n._cell),n.isFolder&&n.expanded&&this.hideFolderNode(n)}},n.prototype.removeNode=function(t){if(t._cell&&(t._cell.parent&&this.removeChild(t._cell),this.returnToPool(t._cell),t._cell._treeNode=null,t._cell=null),t.isFolder)for(var e=t.numChildren,i=0;i<e;i++){var n=t.getChildAt(i);this.removeNode(n)}},n.prototype.__cellMouseDown=function(e){var i=t.GObject.cast(e.currentTarget)._treeNode;this._expandedStatusInEvt=i.expanded},n.prototype.__expandedStateChanged=function(t){t.parent._treeNode.expanded=1==t.selectedIndex},n.prototype.dispatchItemEvent=function(t,i){if(0!=this._clickToExpand){var n=t._treeNode;n&&this._expandedStatusInEvt==n.expanded&&(2==this._clickToExpand||(n.expanded=!n.expanded))}e.prototype.dispatchItemEvent.call(this,t,i)},n.prototype.setup_beforeAdd=function(t,i){e.prototype.setup_beforeAdd.call(this,t,i),t.seek(i,9),this._indent=t.readInt(),this._clickToExpand=t.readByte()},n.prototype.readItems=function(e){var i,n,o,r,a,s,h,l=0;for(i=e.readShort(),n=0;n<i;n++)if(o=e.readShort(),o+=e.position,null!=(r=e.readS())||(r=this.defaultItem)){a=e.readBool(),h=e.readByte();var c=new t.GTreeNode(a,r);if(c.expanded=!0,0==n)this._rootNode.addChild(c);else if(h>l)s.addChild(c);else if(h<l){for(var u=h;u<=l;u++)s=s.parent;s.addChild(c)}else s.parent.addChild(c);s=c,l=h,this.setupItem(e,c.cell),e.position=o}else e.position=o},n}(t.GList);t.GTree=e;var i=new Array}(fgui||(fgui={})),function(t){var e=function(){function t(t,e){this._level=0,this._resURL=e,t&&(this._children=new Array)}return Object.defineProperty(t.prototype,"expanded",{get:function(){return this._expanded},set:function(t){null!=this._children&&this._expanded!=t&&(this._expanded=t,this._tree&&(this._expanded?this._tree._afterExpanded(this):this._tree._afterCollapsed(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFolder",{get:function(){return null!=this._children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._cell?this._cell.text:null},set:function(t){this._cell&&(this._cell.text=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"icon",{get:function(){return this._cell?this._cell.icon:null},set:function(t){this._cell&&(this._cell.icon=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),t.prototype._setLevel=function(t){this._level=t},t.prototype.addChild=function(t){return this.addChildAt(t,this._children.length),t},t.prototype.addChildAt=function(t,e){if(!t)throw new Error("child is null");var i=this._children.length;if(e>=0&&e<=i){if(t._parent==this)this.setChildIndex(t,e);else t._parent&&t._parent.removeChild(t),e==this._children.length?this._children.push(t):this._children.splice(e,0,t),t._parent=this,t._level=this._level+1,t._setTree(this._tree),(this._tree&&this==this._tree.rootNode||this._cell&&this._cell.parent&&this._expanded)&&this._tree._afterInserted(t);return t}throw new RangeError("Invalid child index")},t.prototype.removeChild=function(t){var e=this._children.indexOf(t);return-1!=e&&this.removeChildAt(e),t},t.prototype.removeChildAt=function(t){if(t>=0&&t<this.numChildren){var e=this._children[t];return this._children.splice(t,1),e._parent=null,this._tree&&(e._setTree(null),this._tree._afterRemoved(e)),e}throw"Invalid child index"},t.prototype.removeChildren=function(t,e){t=t||0,null==e&&(e=-1),(e<0||e>=this.numChildren)&&(e=this.numChildren-1);for(var i=t;i<=e;++i)this.removeChildAt(t)},t.prototype.getChildAt=function(t){if(t>=0&&t<this.numChildren)return this._children[t];throw"Invalid child index"},t.prototype.getChildIndex=function(t){return this._children.indexOf(t)},t.prototype.getPrevSibling=function(){if(null==this._parent)return null;var t=this._parent._children.indexOf(this);return t<=0?null:this._parent._children[t-1]},t.prototype.getNextSibling=function(){if(null==this._parent)return null;var t=this._parent._children.indexOf(this);return t<0||t>=this._parent._children.length-1?null:this._parent._children[t+1]},t.prototype.setChildIndex=function(t,e){var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";var n=this._children.length;e<0?e=0:e>n&&(e=n),i!=e&&(this._children.splice(i,1),this._children.splice(e,0,t),(this._tree&&this==this._tree.rootNode||this._cell&&this._cell.parent&&this._expanded)&&this._tree._afterMoved(t))},t.prototype.swapChildren=function(t,e){var i=this._children.indexOf(t),n=this._children.indexOf(e);if(-1==i||-1==n)throw"Not a child of this container";this.swapChildrenAt(i,n)},t.prototype.swapChildrenAt=function(t,e){var i=this._children[t],n=this._children[e];this.setChildIndex(i,e),this.setChildIndex(n,t)},Object.defineProperty(t.prototype,"numChildren",{get:function(){return this._children.length},enumerable:!1,configurable:!0}),t.prototype.expandToRoot=function(){for(var t=this;t;)t.expanded=!0,t=t.parent},Object.defineProperty(t.prototype,"tree",{get:function(){return this._tree},enumerable:!1,configurable:!0}),t.prototype._setTree=function(t){if(this._tree=t,this._tree&&this._tree.treeNodeWillExpand&&this._expanded&&this._tree.treeNodeWillExpand(this,!0),this._children)for(var e=this._children.length,i=0;i<e;i++){var n=this._children[i];n._level=this._level+1,n._setTree(t)}},t}();t.GTreeNode=e}(fgui||(fgui={})),function(t){var e=function(){function t(){this.left=0,this.right=0,this.top=0,this.bottom=0}return t.prototype.copy=function(t){this.top=t.top,this.bottom=t.bottom,this.left=t.left,this.right=t.right},t.prototype.isNone=function(){return 0==this.left&&0==this.right&&0==this.top&&0==this.bottom},t}();t.Margin=e}(fgui||(fgui={})),function(t){var e=function(){function e(){this.width=0,this.height=0}return e.prototype.load=function(){return this.owner.getItemAsset(this)},e.prototype.getBranch=function(){if(this.branches&&-1!=this.owner._branchIndex){var t=this.branches[this.owner._branchIndex];if(t)return this.owner.getItemById(t)}return this},e.prototype.getHighResolution=function(){if(this.highResolution&&t.GRoot.contentScaleLevel>0){var e=this.highResolution[t.GRoot.contentScaleLevel-1];if(e)return this.owner.getItemById(e)}return this},e.prototype.toString=function(){return this.name},e}();t.PackageItem=e}(fgui||(fgui={})),function(t){var e=function(){function e(e){if(!e&&!(e=t.UIConfig.popupMenu))throw"UIConfig.popupMenu not defined";this._contentPane=t.UIPackage.createObjectFromURL(e),this._contentPane.on(t.Event.DISPLAY,this.onDisplay,this),this._list=this._contentPane.getChild("list"),this._list.removeChildrenToPool(),this._list.addRelation(this._contentPane,t.RelationType.Width),this._list.removeRelation(this._contentPane,t.RelationType.Height),this._contentPane.addRelation(this._list,t.RelationType.Height),this._list.on(t.Event.CLICK_ITEM,this.onClickItem,this)}return e.prototype.dispose=function(){this._contentPane.dispose()},e.prototype.addItem=function(t,e){var i=this._list.addItemFromPool();i.title=t,i.data=e,i.grayed=!1;var n=i.getController("checked");return n&&(n.selectedIndex=0),i},e.prototype.addItemAt=function(t,e,i){var n=this._list.getFromPool();this._list.addChildAt(n,e),n.title=t,n.data=i,n.grayed=!1;var o=n.getController("checked");return o&&(o.selectedIndex=0),n},e.prototype.addSeperator=function(){if(null==t.UIConfig.popupMenu_seperator)throw"UIConfig.popupMenu_seperator not defined";this.list.addItemFromPool(t.UIConfig.popupMenu_seperator)},e.prototype.getItemName=function(t){return this._list.getChildAt(t).name},e.prototype.setItemText=function(t,e){this._list.getChild(t).title=e},e.prototype.setItemVisible=function(t,e){var i=this._list.getChild(t);i.visible!=e&&(i.visible=e,this._list.setBoundsChangedFlag())},e.prototype.setItemGrayed=function(t,e){this._list.getChild(t).grayed=e},e.prototype.setItemCheckable=function(t,e){var i=this._list.getChild(t).getController("checked");i&&(e?0==i.selectedIndex&&(i.selectedIndex=1):i.selectedIndex=0)},e.prototype.setItemChecked=function(t,e){var i=this._list.getChild(t).getController("checked");i&&(i.selectedIndex=e?2:1)},e.prototype.isItemChecked=function(t){var e=this._list.getChild(t).getController("checked");return!!e&&2==e.selectedIndex},e.prototype.removeItem=function(t){var e=this._list.getChild(t);if(e){var i=this._list.getChildIndex(e);return this._list.removeChildToPoolAt(i),!0}return!1},e.prototype.clearItems=function(){this._list.removeChildrenToPool()},Object.defineProperty(e.prototype,"itemCount",{get:function(){return this._list.numChildren},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contentPane",{get:function(){return this._contentPane},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this._list},enumerable:!1,configurable:!0}),e.prototype.show=function(e,i){void 0===e&&(e=null),(null!=e?e.root:t.GRoot.inst).showPopup(this.contentPane,e instanceof t.GRoot?null:e,i)},e.prototype.onClickItem=function(t,e){var i=this;this._list._partner.callLater(function(n){i.onClickItem2(t,e)},.1)},e.prototype.onClickItem2=function(e,i){if(e instanceof t.GButton)if(e.grayed)this._list.selectedIndex=-1;else{var n=e.getController("checked");n&&0!=n.selectedIndex&&(1==n.selectedIndex?n.selectedIndex=2:n.selectedIndex=1),this._contentPane.parent.hidePopup(this.contentPane),e.data instanceof Function&&e.data(e,i)}},e.prototype.onDisplay=function(){this._list.selectedIndex=-1,this._list.resizeToFit(1e5,10)},e}();t.PopupMenu=e}(fgui||(fgui={})),function(t){var e=function(){function e(t){this._owner=t,this._defs=new Array}return Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this._target!=t&&(this._target&&this.releaseRefTarget(this._target),this._target=t,this._target&&this.addRefTarget(this._target))},enumerable:!1,configurable:!0}),e.prototype.add=function(e,i){if(e==t.RelationType.Size)return this.add(t.RelationType.Width,i),void this.add(t.RelationType.Height,i);for(var n=this._defs.length,o=0;o<n;o++){if(this._defs[o].type==e)return}this.internalAdd(e,i)},e.prototype.internalAdd=function(e,n){if(e==t.RelationType.Size)return this.internalAdd(t.RelationType.Width,n),void this.internalAdd(t.RelationType.Height,n);var o=new i;o.percent=n,o.type=e,o.axis=e<=t.RelationType.Right_Right||e==t.RelationType.Width||e>=t.RelationType.LeftExt_Left&&e<=t.RelationType.RightExt_Right?0:1,this._defs.push(o)},e.prototype.remove=function(e){if(e==t.RelationType.Size)return this.remove(t.RelationType.Width),void this.remove(t.RelationType.Height);for(var i=this._defs.length,n=0;n<i;n++)if(this._defs[n].type==e){this._defs.splice(n,1);break}},e.prototype.copyFrom=function(t){this.target=t.target,this._defs.length=0;for(var e=t._defs.length,n=0;n<e;n++){var o=t._defs[n],r=new i;r.copyFrom(o),this._defs.push(r)}},e.prototype.dispose=function(){this._target&&(this.releaseRefTarget(this._target),this._target=null)},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0==this._defs.length},enumerable:!1,configurable:!0}),e.prototype.applyOnSelfResized=function(e,i,n){for(var o=this._owner.x,r=this._owner.y,a=this._defs.length,s=0;s<a;s++){switch(this._defs[s].type){case t.RelationType.Center_Center:this._owner.x-=(.5-(n?this._owner.pivotX:0))*e;break;case t.RelationType.Right_Center:case t.RelationType.Right_Left:case t.RelationType.Right_Right:this._owner.x-=(1-(n?this._owner.pivotX:0))*e;break;case t.RelationType.Middle_Middle:this._owner.y-=(.5-(n?this._owner.pivotY:0))*i;break;case t.RelationType.Bottom_Middle:case t.RelationType.Bottom_Top:case t.RelationType.Bottom_Bottom:this._owner.y-=(1-(n?this._owner.pivotY:0))*i}}if((o!=this._owner.x||r!=this._owner.y)&&(o=this._owner.x-o,r=this._owner.y-r,this._owner.updateGearFromRelations(1,o,r),this._owner.parent)){var h=this._owner.parent._transitions.length;if(h>0)for(s=0;s<h;++s)this._owner.parent._transitions[s].updateFromRelations(this._owner.id,o,r)}},e.prototype.applyOnXYChanged=function(e,i,n){var o;switch(e.type){case t.RelationType.Left_Left:case t.RelationType.Left_Center:case t.RelationType.Left_Right:case t.RelationType.Center_Center:case t.RelationType.Right_Left:case t.RelationType.Right_Center:case t.RelationType.Right_Right:this._owner.x+=i;break;case t.RelationType.Top_Top:case t.RelationType.Top_Middle:case t.RelationType.Top_Bottom:case t.RelationType.Middle_Middle:case t.RelationType.Bottom_Top:case t.RelationType.Bottom_Middle:case t.RelationType.Bottom_Bottom:this._owner.y+=n;break;case t.RelationType.Width:case t.RelationType.Height:break;case t.RelationType.LeftExt_Left:case t.RelationType.LeftExt_Right:this._owner!=this._target.parent?(o=this._owner.xMin,this._owner.width=this._owner._rawWidth-i,this._owner.xMin=o+i):this._owner.width=this._owner._rawWidth-i;break;case t.RelationType.RightExt_Left:case t.RelationType.RightExt_Right:this._owner!=this._target.parent?(o=this._owner.xMin,this._owner.width=this._owner._rawWidth+i,this._owner.xMin=o):this._owner.width=this._owner._rawWidth+i;break;case t.RelationType.TopExt_Top:case t.RelationType.TopExt_Bottom:this._owner!=this._target.parent?(o=this._owner.yMin,this._owner.height=this._owner._rawHeight-n,this._owner.yMin=o+n):this._owner.height=this._owner._rawHeight-n;break;case t.RelationType.BottomExt_Top:case t.RelationType.BottomExt_Bottom:this._owner!=this._target.parent?(o=this._owner.yMin,this._owner.height=this._owner._rawHeight+n,this._owner.yMin=o):this._owner.height=this._owner._rawHeight+n}},e.prototype.applyOnSizeChanged=function(e){var i,n,o=0,r=0,a=0;switch(0==e.axis?(this._target!=this._owner.parent&&(o=this._target.x,this._target.pivotAsAnchor&&(r=this._target.pivotX)),e.percent?0!=this._targetWidth&&(a=this._target._width/this._targetWidth):a=this._target._width-this._targetWidth):(this._target!=this._owner.parent&&(o=this._target.y,this._target.pivotAsAnchor&&(r=this._target.pivotY)),e.percent?0!=this._targetHeight&&(a=this._target._height/this._targetHeight):a=this._target._height-this._targetHeight),e.type){case t.RelationType.Left_Left:e.percent?this._owner.xMin=o+(this._owner.xMin-o)*a:0!=r&&(this._owner.x+=a*-r);break;case t.RelationType.Left_Center:e.percent?this._owner.xMin=o+(this._owner.xMin-o)*a:this._owner.x+=a*(.5-r);break;case t.RelationType.Left_Right:e.percent?this._owner.xMin=o+(this._owner.xMin-o)*a:this._owner.x+=a*(1-r);break;case t.RelationType.Center_Center:e.percent?this._owner.xMin=o+(this._owner.xMin+.5*this._owner._rawWidth-o)*a-.5*this._owner._rawWidth:this._owner.x+=a*(.5-r);break;case t.RelationType.Right_Left:e.percent?this._owner.xMin=o+(this._owner.xMin+this._owner._rawWidth-o)*a-this._owner._rawWidth:0!=r&&(this._owner.x+=a*-r);break;case t.RelationType.Right_Center:e.percent?this._owner.xMin=o+(this._owner.xMin+this._owner._rawWidth-o)*a-this._owner._rawWidth:this._owner.x+=a*(.5-r);break;case t.RelationType.Right_Right:e.percent?this._owner.xMin=o+(this._owner.xMin+this._owner._rawWidth-o)*a-this._owner._rawWidth:this._owner.x+=a*(1-r);break;case t.RelationType.Top_Top:e.percent?this._owner.yMin=o+(this._owner.yMin-o)*a:0!=r&&(this._owner.y+=a*-r);break;case t.RelationType.Top_Middle:e.percent?this._owner.yMin=o+(this._owner.yMin-o)*a:this._owner.y+=a*(.5-r);break;case t.RelationType.Top_Bottom:e.percent?this._owner.yMin=o+(this._owner.yMin-o)*a:this._owner.y+=a*(1-r);break;case t.RelationType.Middle_Middle:e.percent?this._owner.yMin=o+(this._owner.yMin+.5*this._owner._rawHeight-o)*a-.5*this._owner._rawHeight:this._owner.y+=a*(.5-r);break;case t.RelationType.Bottom_Top:e.percent?this._owner.yMin=o+(this._owner.yMin+this._owner._rawHeight-o)*a-this._owner._rawHeight:0!=r&&(this._owner.y+=a*-r);break;case t.RelationType.Bottom_Middle:e.percent?this._owner.yMin=o+(this._owner.yMin+this._owner._rawHeight-o)*a-this._owner._rawHeight:this._owner.y+=a*(.5-r);break;case t.RelationType.Bottom_Bottom:e.percent?this._owner.yMin=o+(this._owner.yMin+this._owner._rawHeight-o)*a-this._owner._rawHeight:this._owner.y+=a*(1-r);break;case t.RelationType.Width:i=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-this._target.initWidth:this._owner._rawWidth-this._targetWidth,e.percent&&(i*=a),this._target==this._owner.parent?this._owner.pivotAsAnchor?(n=this._owner.xMin,this._owner.setSize(this._target._width+i,this._owner._rawHeight,!0),this._owner.xMin=n):this._owner.setSize(this._target._width+i,this._owner._rawHeight,!0):this._owner.width=this._target._width+i;break;case t.RelationType.Height:i=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-this._target.initHeight:this._owner._rawHeight-this._targetHeight,e.percent&&(i*=a),this._target==this._owner.parent?this._owner.pivotAsAnchor?(n=this._owner.yMin,this._owner.setSize(this._owner._rawWidth,this._target._height+i,!0),this._owner.yMin=n):this._owner.setSize(this._owner._rawWidth,this._target._height+i,!0):this._owner.height=this._target._height+i;break;case t.RelationType.LeftExt_Left:n=this._owner.xMin,i=e.percent?o+(n-o)*a-n:a*-r,this._owner.width=this._owner._rawWidth-i,this._owner.xMin=n+i;break;case t.RelationType.LeftExt_Right:n=this._owner.xMin,i=e.percent?o+(n-o)*a-n:a*(1-r),this._owner.width=this._owner._rawWidth-i,this._owner.xMin=n+i;break;case t.RelationType.RightExt_Left:n=this._owner.xMin,i=e.percent?o+(n+this._owner._rawWidth-o)*a-(n+this._owner._rawWidth):a*-r,this._owner.width=this._owner._rawWidth+i,this._owner.xMin=n;break;case t.RelationType.RightExt_Right:n=this._owner.xMin,e.percent?this._owner==this._target.parent?this._owner._underConstruct?this._owner.width=o+this._target._width-this._target._width*r+(this._owner.sourceWidth-o-this._target.initWidth+this._target.initWidth*r)*a:this._owner.width=o+(this._owner._rawWidth-o)*a:(i=o+(n+this._owner._rawWidth-o)*a-(n+this._owner._rawWidth),this._owner.width=this._owner._rawWidth+i,this._owner.xMin=n):this._owner==this._target.parent?this._owner._underConstruct?this._owner.width=this._owner.sourceWidth+(this._target._width-this._target.initWidth)*(1-r):this._owner.width=this._owner._rawWidth+a*(1-r):(i=a*(1-r),this._owner.width=this._owner._rawWidth+i,this._owner.xMin=n);break;case t.RelationType.TopExt_Top:n=this._owner.yMin,i=e.percent?o+(n-o)*a-n:a*-r,this._owner.height=this._owner._rawHeight-i,this._owner.yMin=n+i;break;case t.RelationType.TopExt_Bottom:n=this._owner.yMin,i=e.percent?o+(n-o)*a-n:a*(1-r),this._owner.height=this._owner._rawHeight-i,this._owner.yMin=n+i;break;case t.RelationType.BottomExt_Top:n=this._owner.yMin,i=e.percent?o+(n+this._owner._rawHeight-o)*a-(n+this._owner._rawHeight):a*-r,this._owner.height=this._owner._rawHeight+i,this._owner.yMin=n;break;case t.RelationType.BottomExt_Bottom:n=this._owner.yMin,e.percent?this._owner==this._target.parent?this._owner._underConstruct?this._owner.height=o+this._target._height-this._target._height*r+(this._owner.sourceHeight-o-this._target.initHeight+this._target.initHeight*r)*a:this._owner.height=o+(this._owner._rawHeight-o)*a:(i=o+(n+this._owner._rawHeight-o)*a-(n+this._owner._rawHeight),this._owner.height=this._owner._rawHeight+i,this._owner.yMin=n):this._owner==this._target.parent?this._owner._underConstruct?this._owner.height=this._owner.sourceHeight+(this._target._height-this._target.initHeight)*(1-r):this._owner.height=this._owner._rawHeight+a*(1-r):(i=a*(1-r),this._owner.height=this._owner._rawHeight+i,this._owner.yMin=n)}},e.prototype.addRefTarget=function(e){e!=this._owner.parent&&e.on(t.Event.XY_CHANGED,this.__targetXYChanged,this),e.on(t.Event.SIZE_CHANGED,this.__targetSizeChanged,this),e.on(t.Event.SIZE_DELAY_CHANGE,this.__targetSizeWillChange,this),this._targetX=this._target.x,this._targetY=this._target.y,this._targetWidth=this._target._width,this._targetHeight=this._target._height},e.prototype.releaseRefTarget=function(e){e.node&&(e.off(t.Event.XY_CHANGED,this.__targetXYChanged,this),e.off(t.Event.SIZE_CHANGED,this.__targetSizeChanged,this),e.off(t.Event.SIZE_DELAY_CHANGE,this.__targetSizeWillChange,this))},e.prototype.__targetXYChanged=function(t){if(null!=this._owner.relations.handling||null!=this._owner.group&&this._owner.group._updating)return this._targetX=this._target.x,void(this._targetY=this._target.y);this._owner.relations.handling=this._target;for(var e=this._owner.x,i=this._owner.y,n=this._target.x-this._targetX,o=this._target.y-this._targetY,r=this._defs.length,a=0;a<r;a++){var s=this._defs[a];this.applyOnXYChanged(s,n,o)}if(this._targetX=this._target.x,this._targetY=this._target.y,(e!=this._owner.x||i!=this._owner.y)&&(e=this._owner.x-e,i=this._owner.y-i,this._owner.updateGearFromRelations(1,e,i),this._owner.parent)){var h=this._owner.parent._transitions.length;if(h>0)for(a=0;a<h;++a)this._owner.parent._transitions[a].updateFromRelations(this._owner.id,e,i)}this._owner.relations.handling=null},e.prototype.__targetSizeChanged=function(t){if(null==this._owner.relations.handling){this._owner.relations.handling=this._target;for(var e=this._owner.x,i=this._owner.y,n=this._owner._rawWidth,o=this._owner._rawHeight,r=this._defs.length,a=0;a<r;a++){var s=this._defs[a];this.applyOnSizeChanged(s)}if(this._targetWidth=this._target._width,this._targetHeight=this._target._height,(e!=this._owner.x||i!=this._owner.y)&&(e=this._owner.x-e,i=this._owner.y-i,this._owner.updateGearFromRelations(1,e,i),this._owner.parent)){var h=this._owner.parent._transitions.length;if(h>0)for(a=0;a<h;++a)this._owner.parent._transitions[a].updateFromRelations(this._owner.id,e,i)}n==this._owner._rawWidth&&o==this._owner._rawHeight||(n=this._owner._rawWidth-n,o=this._owner._rawHeight-o,this._owner.updateGearFromRelations(2,n,o)),this._owner.relations.handling=null}},e.prototype.__targetSizeWillChange=function(t){this._owner.relations.sizeDirty=!0},e}();t.RelationItem=e;var i=function(){function t(){}return t.prototype.copyFrom=function(t){this.percent=t.percent,this.type=t.type,this.axis=t.axis},t}();t.RelationDef=i}(fgui||(fgui={})),function(t){var e=function(){function e(t){this._owner=t,this._items=new Array}return e.prototype.add=function(e,i,n){for(var o=this._items.length,r=0;r<o;r++){var a=this._items[r];if(a.target==e)return void a.add(i,n)}var s=new t.RelationItem(this._owner);s.target=e,s.add(i,n),this._items.push(s)},e.prototype.remove=function(t,e){e=e||0;for(var i=this._items.length,n=0;n<i;){var o=this._items[n];o.target==t?(o.remove(e),o.isEmpty?(o.dispose(),this._items.splice(n,1),i--):n++):n++}},e.prototype.contains=function(t){for(var e=this._items.length,i=0;i<e;i++){if(this._items[i].target==t)return!0}return!1},e.prototype.clearFor=function(t){for(var e=this._items.length,i=0;i<e;){var n=this._items[i];n.target==t?(n.dispose(),this._items.splice(i,1),e--):i++}},e.prototype.clearAll=function(){for(var t=this._items.length,e=0;e<t;e++){this._items[e].dispose()}this._items.length=0},e.prototype.copyFrom=function(e){this.clearAll();for(var i=e._items,n=i.length,o=0;o<n;o++){var r=i[o],a=new t.RelationItem(this._owner);a.copyFrom(r),this._items.push(a)}},e.prototype.dispose=function(){this.clearAll()},e.prototype.onOwnerSizeChanged=function(t,e,i){if(0!=this._items.length)for(var n=this._items.length,o=0;o<n;o++){this._items[o].applyOnSelfResized(t,e,i)}},e.prototype.ensureRelationsSizeCorrect=function(){if(0!=this._items.length){this.sizeDirty=!1;for(var t=this._items.length,e=0;e<t;e++){this._items[e].target.ensureSizeCorrect()}}},Object.defineProperty(e.prototype,"empty",{get:function(){return 0==this._items.length},enumerable:!1,configurable:!0}),e.prototype.setup=function(e,i){for(var n,o=e.readByte(),r=0;r<o;r++){var a=e.readShort();n=-1==a?this._owner.parent:i?this._owner.getChildAt(a):this._owner.parent.getChildAt(a);var s=new t.RelationItem(this._owner);s.target=n,this._items.push(s);for(var h=e.readByte(),l=0;l<h;l++){var c=e.readByte(),u=e.readBool();s.internalAdd(c,u)}}},e}();t.Relations=e}(fgui||(fgui={})),function(t){var e=function(e){function u(){var t=null!==e&&e.apply(this,arguments)||this;return t._aniFlag=0,t}return __extends(u,e),u.prototype.setup=function(e){var i=this._owner=this.node.$gobj;this._maskContainer=new cc.Node("ScrollPane"),this._maskContainer.setAnchorPoint(0,1),this._maskContainer.parent=i.node,this._container=i._container,this._container.parent=this._maskContainer,this._scrollBarMargin=new t.Margin,this._mouseWheelEnabled=!0,this._xPos=0,this._yPos=0,this._aniFlag=0,this._tweening=0,this._footerLockedSize=0,this._headerLockedSize=0,this._viewSize=new cc.Vec2,this._contentSize=new cc.Vec2,this._pageSize=new cc.Vec2(1,1),this._overlapSize=new cc.Vec2,this._tweenTime=new cc.Vec2,this._tweenStart=new cc.Vec2,this._tweenDuration=new cc.Vec2,this._tweenChange=new cc.Vec2,this._velocity=new cc.Vec2,this._containerPos=new cc.Vec2,this._beginTouchPos=new cc.Vec2,this._lastTouchPos=new cc.Vec2,this._lastTouchGlobalPos=new cc.Vec2,this._scrollStep=t.UIConfig.defaultScrollStep,this._mouseWheelStep=2*this._scrollStep,this._decelerationRate=t.UIConfig.defaultScrollDecelerationRate,i.on(t.Event.TOUCH_BEGIN,this.onTouchBegin,this),i.on(t.Event.TOUCH_MOVE,this.onTouchMove,this),i.on(t.Event.TOUCH_END,this.onTouchEnd,this),i.on(t.Event.MOUSE_WHEEL,this.onMouseWheel,this),this._scrollType=e.readByte();var n=e.readByte(),o=e.readInt();e.readBool()&&(this._scrollBarMargin.top=e.readInt(),this._scrollBarMargin.bottom=e.readInt(),this._scrollBarMargin.left=e.readInt(),this._scrollBarMargin.right=e.readInt());var r=e.readS(),a=e.readS(),s=e.readS(),h=e.readS();if(0!=(1&o)&&(this._displayOnLeft=!0),0!=(2&o)&&(this._snapToItem=!0),0!=(4&o)&&(this._displayInDemand=!0),0!=(8&o)&&(this._pageMode=!0),this._touchEffect=!!(16&o)||!(32&o)&&t.UIConfig.defaultScrollTouchEffect,this._bouncebackEffect=!!(64&o)||!(128&o)&&t.UIConfig.defaultScrollBounceEffect,0!=(256&o)&&(this._inertiaDisabled=!0),0==(512&o)&&this._maskContainer.addComponent(cc.Mask),0!=(1024&o)&&(this._floating=!0),0!=(2048&o)&&(this._dontClipMargin=!0),n==t.ScrollBarDisplayType.Default&&(n=t.UIConfig.defaultScrollBarDisplay),n!=t.ScrollBarDisplayType.Hidden){var l;if(this._scrollType==t.ScrollType.Both||this._scrollType==t.ScrollType.Vertical)if(l=r||t.UIConfig.verticalScrollBar){if(this._vtScrollBar=t.UIPackage.createObjectFromURL(l),!this._vtScrollBar)throw"cannot create scrollbar from "+l;this._vtScrollBar.setScrollPane(this,!0),this._vtScrollBar.node.parent=i.node}if(this._scrollType==t.ScrollType.Both||this._scrollType==t.ScrollType.Horizontal)if(l=a||t.UIConfig.horizontalScrollBar){if(this._hzScrollBar=t.UIPackage.createObjectFromURL(l),!this._hzScrollBar)throw"cannot create scrollbar from "+l;this._hzScrollBar.setScrollPane(this,!1),this._hzScrollBar.node.parent=i.node}n==t.ScrollBarDisplayType.Auto&&(this._scrollBarDisplayAuto=!0),this._scrollBarDisplayAuto&&(this._vtScrollBar&&(this._vtScrollBar.node.active=!1),this._hzScrollBar&&(this._hzScrollBar.node.active=!1),i.on(t.Event.ROLL_OVER,this.onRollOver,this),i.on(t.Event.ROLL_OUT,this.onRollOut,this))}if(s){if(this._header=t.UIPackage.createObjectFromURL(s),null==this._header)throw"cannot create scrollPane header from "+s;this._maskContainer.insertChild(this._header.node,0)}if(h){if(this._footer=t.UIPackage.createObjectFromURL(h),null==this._footer)throw"cannot create scrollPane footer from "+h;this._maskContainer.insertChild(this._footer.node,0)}this._refreshBarAxis=this._scrollType==t.ScrollType.Both||this._scrollType==t.ScrollType.Vertical?"y":"x",this.setSize(i.width,i.height)},u.prototype.onDestroy=function(){delete this._pageController,this._hzScrollBar&&this._hzScrollBar.dispose(),this._vtScrollBar&&this._vtScrollBar.dispose(),this._header&&this._header.dispose(),this._footer&&this._footer.dispose()},u.prototype.hitTest=function(t,e){var i;return this._vtScrollBar&&(i=this._vtScrollBar.hitTest(e))?i:this._hzScrollBar&&(i=this._hzScrollBar.hitTest(e))?i:this._header&&this._header.node.activeInHierarchy&&(i=this._header.hitTest(e))?i:this._footer&&this._footer.node.activeInHierarchy&&(i=this._footer.hitTest(e))?i:t.x>=this._owner.margin.left&&t.y>=this._owner.margin.top&&t.x<this._owner.margin.left+this._viewSize.x&&t.y<this._owner.margin.top+this._viewSize.y?this._owner:null},Object.defineProperty(u.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"hzScrollBar",{get:function(){return this._hzScrollBar},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"vtScrollBar",{get:function(){return this._vtScrollBar},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"header",{get:function(){return this._header},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"footer",{get:function(){return this._footer},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"bouncebackEffect",{get:function(){return this._bouncebackEffect},set:function(t){this._bouncebackEffect=t},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"touchEffect",{get:function(){return this._touchEffect},set:function(t){this._touchEffect=t},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"scrollStep",{get:function(){return this._scrollStep},set:function(e){this._scrollStep=e,0==this._scrollStep&&(this._scrollStep=t.UIConfig.defaultScrollStep),this._mouseWheelStep=2*this._scrollStep},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"decelerationRate",{get:function(){return this._decelerationRate},set:function(t){this._decelerationRate=t},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"snapToItem",{get:function(){return this._snapToItem},set:function(t){this._snapToItem=t},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"mouseWheelEnabled",{get:function(){return this._mouseWheelEnabled},set:function(t){this._mouseWheelEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isDragged",{get:function(){return this._dragged},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"percX",{get:function(){return 0==this._overlapSize.x?0:this._xPos/this._overlapSize.x},set:function(t){this.setPercX(t,!1)},enumerable:!1,configurable:!0}),u.prototype.setPercX=function(e,i){this._owner.ensureBoundsCorrect(),this.setPosX(this._overlapSize.x*t.ToolSet.clamp01(e),i)},Object.defineProperty(u.prototype,"percY",{get:function(){return 0==this._overlapSize.y?0:this._yPos/this._overlapSize.y},set:function(t){this.setPercY(t,!1)},enumerable:!1,configurable:!0}),u.prototype.setPercY=function(e,i){this._owner.ensureBoundsCorrect(),this.setPosY(this._overlapSize.y*t.ToolSet.clamp01(e),i)},Object.defineProperty(u.prototype,"posX",{get:function(){return this._xPos},set:function(t){this.setPosX(t,!1)},enumerable:!1,configurable:!0}),u.prototype.setPosX=function(e,i){this._owner.ensureBoundsCorrect(),1==this._loop&&(e=this.loopCheckingNewPos(e,"x")),(e=t.ToolSet.clamp(e,0,this._overlapSize.x))!=this._xPos&&(this._xPos=e,this.posChanged(i))},Object.defineProperty(u.prototype,"posY",{get:function(){return this._yPos},set:function(t){this.setPosY(t,!1)},enumerable:!1,configurable:!0}),u.prototype.setPosY=function(e,i){this._owner.ensureBoundsCorrect(),1==this._loop&&(e=this.loopCheckingNewPos(e,"y")),(e=t.ToolSet.clamp(e,0,this._overlapSize.y))!=this._yPos&&(this._yPos=e,this.posChanged(i))},Object.defineProperty(u.prototype,"contentWidth",{get:function(){return this._contentSize.x},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"contentHeight",{get:function(){return this._contentSize.y},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"viewWidth",{get:function(){return this._viewSize.x},set:function(t){t=t+this._owner.margin.left+this._owner.margin.right,this._vtScrollBar&&!this._floating&&(t+=this._vtScrollBar.width),this._owner.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"viewHeight",{get:function(){return this._viewSize.y},set:function(t){t=t+this._owner.margin.top+this._owner.margin.bottom,this._hzScrollBar&&!this._floating&&(t+=this._hzScrollBar.height),this._owner.height=t},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"currentPageX",{get:function(){if(!this._pageMode)return 0;var t=Math.floor(this._xPos/this._pageSize.x);return this._xPos-t*this._pageSize.x>.5*this._pageSize.x&&t++,t},set:function(t){this.setCurrentPageX(t,!1)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"currentPageY",{get:function(){if(!this._pageMode)return 0;var t=Math.floor(this._yPos/this._pageSize.y);return this._yPos-t*this._pageSize.y>.5*this._pageSize.y&&t++,t},set:function(t){this.setCurrentPageY(t,!1)},enumerable:!1,configurable:!0}),u.prototype.setCurrentPageX=function(t,e){this._pageMode&&(this._owner.ensureBoundsCorrect(),this._overlapSize.x>0&&this.setPosX(t*this._pageSize.x,e))},u.prototype.setCurrentPageY=function(t,e){this._pageMode&&(this._owner.ensureBoundsCorrect(),this._overlapSize.y>0&&this.setPosY(t*this._pageSize.y,e))},Object.defineProperty(u.prototype,"isBottomMost",{get:function(){return this._yPos==this._overlapSize.y||0==this._overlapSize.y},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isRightMost",{get:function(){return this._xPos==this._overlapSize.x||0==this._overlapSize.x},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"pageController",{get:function(){return this._pageController},set:function(t){this._pageController=t},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"scrollingPosX",{get:function(){return t.ToolSet.clamp(-this._container.x,0,this._overlapSize.x)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"scrollingPosY",{get:function(){return t.ToolSet.clamp(- -this._container.y,0,this._overlapSize.y)},enumerable:!1,configurable:!0}),u.prototype.scrollTop=function(t){this.setPercY(0,t)},u.prototype.scrollBottom=function(t){this.setPercY(1,t)},u.prototype.scrollUp=function(t,e){void 0==t&&(t=1),this._pageMode?this.setPosY(this._yPos-this._pageSize.y*t,e):this.setPosY(this._yPos-this._scrollStep*t,e)},u.prototype.scrollDown=function(t,e){void 0==t&&(t=1),this._pageMode?this.setPosY(this._yPos+this._pageSize.y*t,e):this.setPosY(this._yPos+this._scrollStep*t,e)},u.prototype.scrollLeft=function(t,e){void 0==t&&(t=1),this._pageMode?this.setPosX(this._xPos-this._pageSize.x*t,e):this.setPosX(this._xPos-this._scrollStep*t,e)},u.prototype.scrollRight=function(t,e){void 0==t&&(t=1),this._pageMode?this.setPosX(this._xPos+this._pageSize.x*t,e):this.setPosX(this._xPos+this._scrollStep*t,e)},u.prototype.scrollToView=function(e,i,n){var o;if(this._owner.ensureBoundsCorrect(),this._needRefresh&&this.refresh(),e instanceof t.GObject?e.parent!=this._owner?(e.parent.localToGlobalRect(e.x,e.y,e.width,e.height,s),o=this._owner.globalToLocalRect(s.x,s.y,s.width,s.height,s)):((o=s).x=e.x,o.y=e.y,o.width=e.width,o.height=e.height):o=e,this._overlapSize.y>0){var r=this._yPos+this._viewSize.y;n||o.y<=this._yPos||o.height>=this._viewSize.y?this._pageMode?this.setPosY(Math.floor(o.y/this._pageSize.y)*this._pageSize.y,i):this.setPosY(o.y,i):o.y+o.height>r&&(this._pageMode?this.setPosY(Math.floor(o.y/this._pageSize.y)*this._pageSize.y,i):o.height<=this._viewSize.y/2?this.setPosY(o.y+2*o.height-this._viewSize.y,i):this.setPosY(o.y+o.height-this._viewSize.y,i))}if(this._overlapSize.x>0){var a=this._xPos+this._viewSize.x;n||o.x<=this._xPos||o.width>=this._viewSize.x?this._pageMode?this.setPosX(Math.floor(o.x/this._pageSize.x)*this._pageSize.x,i):this.setPosX(o.x,i):o.x+o.width>a&&(this._pageMode?this.setPosX(Math.floor(o.x/this._pageSize.x)*this._pageSize.x,i):o.width<=this._viewSize.x/2?this.setPosX(o.x+2*o.width-this._viewSize.x,i):this.setPosX(o.x+o.width-this._viewSize.x,i))}!i&&this._needRefresh&&this.refresh()},u.prototype.isChildInView=function(t){if(this._overlapSize.y>0){var e=t.y+-this._container.y;if(e<-t.height||e>this._viewSize.y)return!1}return!(this._overlapSize.x>0&&((e=t.x+this._container.x)<-t.width||e>this._viewSize.x))},u.prototype.cancelDragging=function(){u.draggingPane==this&&(u.draggingPane=null),i=0,this._dragged=!1},u.prototype.lockHeader=function(t){if(this._headerLockedSize!=t){var e=this._container.x,i=-this._container.y,n="x"==this._refreshBarAxis?e:i;this._headerLockedSize=t,!this._refreshEventDispatching&&n>=0&&(this._tweenStart.x=e,this._tweenStart.y=i,this._tweenChange.set(cc.Vec2.ZERO),this._tweenChange[this._refreshBarAxis]=this._headerLockedSize-this._tweenStart[this._refreshBarAxis],this._tweenDuration.x=this._tweenDuration.y=o,this.startTween(2))}},u.prototype.lockFooter=function(t){if(this._footerLockedSize!=t){var e=this._container.x,i=-this._container.y,n="x"==this._refreshBarAxis?e:i;if(this._footerLockedSize=t,!this._refreshEventDispatching&&n<=-this._overlapSize[this._refreshBarAxis]){this._tweenStart.x=e,this._tweenStart.y=i,this._tweenChange.set(cc.Vec2.ZERO);var r=this._overlapSize[this._refreshBarAxis];0==r?r=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):r+=this._footerLockedSize,this._tweenChange[this._refreshBarAxis]=-r-this._tweenStart[this._refreshBarAxis],this._tweenDuration.x=this._tweenDuration.y=o,this.startTween(2)}}},u.prototype.onOwnerSizeChanged=function(){this.setSize(this._owner.width,this._owner.height),this.posChanged(!1)},u.prototype.handleControllerChanged=function(e){this._pageController==e&&(this._scrollType==t.ScrollType.Horizontal?this.setCurrentPageX(e.selectedIndex,!0):this.setCurrentPageY(e.selectedIndex,!0))},u.prototype.updatePageController=function(){var e;if(this._pageController&&!this._pageController.changing&&(e=this._scrollType==t.ScrollType.Horizontal?this.currentPageX:this.currentPageY)<this._pageController.pageCount){var i=this._pageController;this._pageController=null,i.selectedIndex=e,this._pageController=i}},u.prototype.adjustMaskContainer=function(){var t=0;this._displayOnLeft&&this._vtScrollBar&&!this._floating&&(t=this._vtScrollBar.width);var e=this._owner;this._dontClipMargin?this._maskContainer.setAnchorPoint((e.margin.left+e._alignOffset.x)/e.width,1-(e.margin.top+e._alignOffset.y)/e.height):this._maskContainer.setAnchorPoint(e._alignOffset.x/this._viewSize.x,1-e._alignOffset.y/this._viewSize.y),e._customMask?this._maskContainer.setPosition(t+e._alignOffset.x,-e._alignOffset.y):this._maskContainer.setPosition(e._pivotCorrectX+t+e._alignOffset.x,e._pivotCorrectY-e._alignOffset.y)},u.prototype.setSize=function(t,e){this._hzScrollBar&&(this._hzScrollBar.y=e-this._hzScrollBar.height,this._vtScrollBar?(this._hzScrollBar.width=t-this._vtScrollBar.width-this._scrollBarMargin.left-this._scrollBarMargin.right,this._displayOnLeft?this._hzScrollBar.x=this._scrollBarMargin.left+this._vtScrollBar.width:this._hzScrollBar.x=this._scrollBarMargin.left):(this._hzScrollBar.width=t-this._scrollBarMargin.left-this._scrollBarMargin.right,this._hzScrollBar.x=this._scrollBarMargin.left)),this._vtScrollBar&&(this._displayOnLeft||(this._vtScrollBar.x=t-this._vtScrollBar.width),this._hzScrollBar?this._vtScrollBar.height=e-this._hzScrollBar.height-this._scrollBarMargin.top-this._scrollBarMargin.bottom:this._vtScrollBar.height=e-this._scrollBarMargin.top-this._scrollBarMargin.bottom,this._vtScrollBar.y=this._scrollBarMargin.top),this._viewSize.x=t,this._viewSize.y=e,this._hzScrollBar&&!this._floating&&(this._viewSize.y-=this._hzScrollBar.height),this._vtScrollBar&&!this._floating&&(this._viewSize.x-=this._vtScrollBar.width),this._viewSize.x-=this._owner.margin.left+this._owner.margin.right,this._viewSize.y-=this._owner.margin.top+this._owner.margin.bottom,this._viewSize.x=Math.max(1,this._viewSize.x),this._viewSize.y=Math.max(1,this._viewSize.y),this._pageSize.x=this._viewSize.x,this._pageSize.y=this._viewSize.y,this.adjustMaskContainer(),this.handleSizeChanged()},u.prototype.setContentSize=function(t,e){this._contentSize.x==t&&this._contentSize.y==e||(this._contentSize.x=t,this._contentSize.y=e,this.handleSizeChanged())},u.prototype.changeContentSizeOnScrolling=function(t,e,i,n){var o=this._xPos==this._overlapSize.x,r=this._yPos==this._overlapSize.y;this._contentSize.x+=t,this._contentSize.y+=e,this.handleSizeChanged(),1==this._tweening?(0!=t&&o&&this._tweenChange.x<0&&(this._xPos=this._overlapSize.x,this._tweenChange.x=-this._xPos-this._tweenStart.x),0!=e&&r&&this._tweenChange.y<0&&(this._yPos=this._overlapSize.y,this._tweenChange.y=-this._yPos-this._tweenStart.y)):2==this._tweening?(0!=i&&(this._container.x-=i,this._tweenStart.x-=i,this._xPos=-this._container.x),0!=n&&(this._container.y+=n,this._tweenStart.y-=n,this._yPos=- -this._container.y)):this._dragged?(0!=i&&(this._container.x-=i,this._containerPos.x-=i,this._xPos=-this._container.x),0!=n&&(this._container.y+=n,this._containerPos.y-=n,this._yPos=- -this._container.y)):(0!=t&&o&&(this._xPos=this._overlapSize.x,this._container.x=-this._xPos),0!=e&&r&&(this._yPos=this._overlapSize.y,this._container.y=this._yPos)),this._pageMode&&this.updatePageController()},u.prototype.handleSizeChanged=function(){this._displayInDemand&&(this._vScrollNone=this._contentSize.y<=this._viewSize.y,this._hScrollNone=this._contentSize.x<=this._viewSize.x),this._vtScrollBar&&(0==this._contentSize.y?this._vtScrollBar.setDisplayPerc(0):this._vtScrollBar.setDisplayPerc(Math.min(1,this._viewSize.y/this._contentSize.y))),this._hzScrollBar&&(0==this._contentSize.x?this._hzScrollBar.setDisplayPerc(0):this._hzScrollBar.setDisplayPerc(Math.min(1,this._viewSize.x/this._contentSize.x))),this.updateScrollBarVisible();var e=this._viewSize.x,i=this._viewSize.y;this._vScrollNone&&this._vtScrollBar&&(e+=this._vtScrollBar.width),this._hScrollNone&&this._hzScrollBar&&(i+=this._hzScrollBar.height),this._dontClipMargin&&(e+=this._owner.margin.left+this._owner.margin.right,i+=this._owner.margin.top+this._owner.margin.bottom),this._maskContainer.setContentSize(e,i),this._vtScrollBar&&this._vtScrollBar.handlePositionChanged(),this._hzScrollBar&&this._hzScrollBar.handlePositionChanged(),this._header&&this._header.handlePositionChanged(),this._footer&&this._footer.handlePositionChanged(),this._scrollType==t.ScrollType.Horizontal||this._scrollType==t.ScrollType.Both?this._overlapSize.x=Math.ceil(Math.max(0,this._contentSize.x-this._viewSize.x)):this._overlapSize.x=0,this._scrollType==t.ScrollType.Vertical||this._scrollType==t.ScrollType.Both?this._overlapSize.y=Math.ceil(Math.max(0,this._contentSize.y-this._viewSize.y)):this._overlapSize.y=0,this._xPos=t.ToolSet.clamp(this._xPos,0,this._overlapSize.x),this._yPos=t.ToolSet.clamp(this._yPos,0,this._overlapSize.y);var n=this._overlapSize[this._refreshBarAxis];0==n?n=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):n+=this._footerLockedSize,"x"==this._refreshBarAxis?this._container.setPosition(t.ToolSet.clamp(this._container.x,-n,this._headerLockedSize),-t.ToolSet.clamp(-this._container.y,-this._overlapSize.y,0)):this._container.setPosition(t.ToolSet.clamp(this._container.x,-this._overlapSize.x,0),-t.ToolSet.clamp(-this._container.y,-n,this._headerLockedSize)),this._header&&("x"==this._refreshBarAxis?this._header.height=this._viewSize.y:this._header.width=this._viewSize.x),this._footer&&("y"==this._refreshBarAxis?this._footer.height=this._viewSize.y:this._footer.width=this._viewSize.x),this.updateScrollBarPos(),this._pageMode&&this.updatePageController()},u.prototype.posChanged=function(t){0==this._aniFlag?this._aniFlag=t?1:-1:1!=this._aniFlag||t||(this._aniFlag=-1),this._needRefresh=!0,cc.director.getScheduler().isScheduled(this.refresh,this)||this.scheduleOnce(this.refresh)},u.prototype.refresh=function(e){this._needRefresh=!1,this.unschedule(this.refresh),(this._pageMode||this._snapToItem)&&(h.x=-this._xPos,h.y=-this._yPos,this.alignPosition(h,!1),this._xPos=-h.x,this._yPos=-h.y),this.refresh2(),this._owner.node.emit(t.Event.SCROLL,this._owner),this._needRefresh&&(this._needRefresh=!1,this.unschedule(this.refresh),this.refresh2()),this.updateScrollBarPos(),this._aniFlag=0},u.prototype.refresh2=function(){var t,e;1!=this._aniFlag||this._dragged?(0!=this._tweening&&this.killTween(),this._container.setPosition(Math.floor(-this._xPos),-Math.floor(-this._yPos)),this.loopCheckingCurrent()):(this._overlapSize.x>0?t=-Math.floor(this._xPos):(0!=this._container.x&&(this._container.x=0),t=0),this._overlapSize.y>0?e=-Math.floor(this._yPos):(0!=this._container.y&&(this._container.y=0),e=0),t!=this._container.x||e!=-this._container.y?(this._tweenDuration.x=this._tweenDuration.y=n,this._tweenStart.x=this._container.x,this._tweenStart.y=-this._container.y,this._tweenChange.x=t-this._tweenStart.x,this._tweenChange.y=e-this._tweenStart.y,this.startTween(1)):0!=this._tweening&&this.killTween());this._pageMode&&this.updatePageController()},u.prototype.onTouchBegin=function(e){if(this._touchEffect){e.captureTouch(),0!=this._tweening?(this.killTween(),t.GRoot.inst.inputProcessor.cancelClick(e.touchId),this._dragged=!0):this._dragged=!1;var i=this._owner.globalToLocal(e.pos.x,e.pos.y,a);this._containerPos.x=this._container.x,this._containerPos.y=-this._container.y,this._beginTouchPos.set(i),this._lastTouchPos.set(i),this._lastTouchGlobalPos.set(e.pos),this._isHoldAreaDone=!1,this._velocity.set(cc.Vec2.ZERO),this._velocityScale=1,this._lastMoveTime=t.ToolSet.getTime()}},u.prototype.onTouchMove=function(e){if(cc.isValid(this._owner.node)&&this._touchEffect&&!(t.GObject.draggingObject&&t.GObject.draggingObject.onStage||u.draggingPane&&u.draggingPane!=this&&u.draggingPane._owner.onStage)){var n,o,s,h=this._owner.globalToLocal(e.pos.x,e.pos.y,a),l=t.UIConfig.touchScrollSensitivity;if(this._scrollType==t.ScrollType.Vertical){if(!this._isHoldAreaDone){if(i|=1,(n=Math.abs(this._beginTouchPos.y-h.y))<l)return;if(0!=(2&i)&&n<Math.abs(this._beginTouchPos.x-h.x))return}o=!0}else if(this._scrollType==t.ScrollType.Horizontal){if(!this._isHoldAreaDone){if(i|=2,(n=Math.abs(this._beginTouchPos.x-h.x))<l)return;if(0!=(1&i)&&n<Math.abs(this._beginTouchPos.y-h.y))return}s=!0}else{if(i=3,!this._isHoldAreaDone&&(n=Math.abs(this._beginTouchPos.y-h.y))<l&&(n=Math.abs(this._beginTouchPos.x-h.x))<l)return;o=s=!0}var c=Math.floor(this._containerPos.x+h.x-this._beginTouchPos.x),p=Math.floor(this._containerPos.y+h.y-this._beginTouchPos.y);o&&(p>0?this._bouncebackEffect?this._header&&0!=this._header.maxHeight?this._container.y=-Math.floor(Math.min(.5*p,this._header.maxHeight)):this._container.y=-Math.floor(Math.min(.5*p,this._viewSize.y*r)):this._container.y=0:p<-this._overlapSize.y?this._bouncebackEffect?this._footer&&this._footer.maxHeight>0?this._container.y=-Math.floor(Math.max(.5*(p+this._overlapSize.y),-this._footer.maxHeight)-this._overlapSize.y):this._container.y=-Math.floor(Math.max(.5*(p+this._overlapSize.y),-this._viewSize.y*r)-this._overlapSize.y):this._container.y=this._overlapSize.y:this._container.y=-p),s&&(c>0?this._bouncebackEffect?this._header&&0!=this._header.maxWidth?this._container.x=Math.floor(Math.min(.5*c,this._header.maxWidth)):this._container.x=Math.floor(Math.min(.5*c,this._viewSize.x*r)):this._container.x=0:c<0-this._overlapSize.x?this._bouncebackEffect?this._footer&&this._footer.maxWidth>0?this._container.x=Math.floor(Math.max(.5*(c+this._overlapSize.x),-this._footer.maxWidth)-this._overlapSize.x):this._container.x=Math.floor(Math.max(.5*(c+this._overlapSize.x),-this._viewSize.x*r)-this._overlapSize.x):this._container.x=-this._overlapSize.x:this._container.x=c);var d=t.ToolSet.getTime(),f=Math.max(d-this._lastMoveTime,1/60),_=h.x-this._lastTouchPos.x,g=h.y-this._lastTouchPos.y;if(s||(_=0),o||(g=0),0!=f){var m=60*f-1;if(m>1){var y=Math.pow(.833,m);this._velocity.x=this._velocity.x*y,this._velocity.y=this._velocity.y*y}this._velocity.x=t.ToolSet.lerp(this._velocity.x,60*_/60/f,10*f),this._velocity.y=t.ToolSet.lerp(this._velocity.y,60*g/60/f,10*f)}var v=this._lastTouchGlobalPos.x-e.pos.x,b=this._lastTouchGlobalPos.y-e.pos.y;0!=_?this._velocityScale=Math.abs(v/_):0!=g&&(this._velocityScale=Math.abs(b/g)),this._lastTouchPos.set(h),this._lastTouchGlobalPos.x=e.pos.x,this._lastTouchGlobalPos.y=e.pos.y,this._lastMoveTime=d,this._overlapSize.x>0&&(this._xPos=t.ToolSet.clamp(-this._container.x,0,this._overlapSize.x)),this._overlapSize.y>0&&(this._yPos=t.ToolSet.clamp(- -this._container.y,0,this._overlapSize.y)),0!=this._loop&&(c=this._container.x,p=-this._container.y,this.loopCheckingCurrent()&&(this._containerPos.x+=this._container.x-c,this._containerPos.y+=-this._container.y-p)),u.draggingPane=this,this._isHoldAreaDone=!0,this._dragged=!0,this.updateScrollBarPos(),this.updateScrollBarVisible(),this._pageMode&&this.updatePageController(),this._owner.node.emit(t.Event.SCROLL),this._owner}},u.prototype.onTouchEnd=function(e){if(u.draggingPane==this&&(u.draggingPane=null),i=0,this._dragged&&this._touchEffect&&this._owner.node.activeInHierarchy){this._dragged=!1,this._tweenStart.x=this._container.x,this._tweenStart.y=-this._container.y,h.set(this._tweenStart);var n=!1;if(this._container.x>0?(h.x=0,n=!0):this._container.x<-this._overlapSize.x&&(h.x=-this._overlapSize.x,n=!0),-this._container.y>0?(h.y=0,n=!0):-this._container.y<-this._overlapSize.y&&(h.y=-this._overlapSize.y,n=!0),n){if(this._tweenChange.x=h.x-this._tweenStart.x,this._tweenChange.y=h.y-this._tweenStart.y,this._tweenChange.x<-t.UIConfig.touchDragSensitivity||this._tweenChange.y<-t.UIConfig.touchDragSensitivity?(this._refreshEventDispatching=!0,this._owner.node.emit(t.Event.PULL_DOWN_RELEASE),this._owner,this._refreshEventDispatching=!1):(this._tweenChange.x>t.UIConfig.touchDragSensitivity||this._tweenChange.y>t.UIConfig.touchDragSensitivity)&&(this._refreshEventDispatching=!0,this._owner.node.emit(t.Event.PULL_UP_RELEASE,this._owner),this._refreshEventDispatching=!1),this._headerLockedSize>0&&0==h[this._refreshBarAxis])h[this._refreshBarAxis]=this._headerLockedSize,this._tweenChange.x=h.x-this._tweenStart.x,this._tweenChange.y=h.y-this._tweenStart.y;else if(this._footerLockedSize>0&&h[this._refreshBarAxis]==-this._overlapSize[this._refreshBarAxis]){var r=this._overlapSize[this._refreshBarAxis];0==r?r=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):r+=this._footerLockedSize,h[this._refreshBarAxis]=-r,this._tweenChange.x=h.x-this._tweenStart.x,this._tweenChange.y=h.y-this._tweenStart.y}this._tweenDuration.x=this._tweenDuration.y=o}else{if(this._inertiaDisabled)this._tweenDuration.x=this._tweenDuration.y=o;else{var a=60*(t.ToolSet.getTime()-this._lastMoveTime)-1;if(a>1){var s=Math.pow(.833,a);this._velocity.x=this._velocity.x*s,this._velocity.y=this._velocity.y*s}this.updateTargetAndDuration(this._tweenStart,h)}if(l.x=h.x-this._tweenStart.x,l.y=h.y-this._tweenStart.y,this.loopCheckingTarget(h),(this._pageMode||this._snapToItem)&&this.alignPosition(h,!0),this._tweenChange.x=h.x-this._tweenStart.x,this._tweenChange.y=h.y-this._tweenStart.y,0==this._tweenChange.x&&0==this._tweenChange.y)return void this.updateScrollBarVisible();(this._pageMode||this._snapToItem)&&(this.fixDuration("x",l.x),this.fixDuration("y",l.y))}this.startTween(2)}else this._dragged=!1},u.prototype.onRollOver=function(){this._hover=!0,this.updateScrollBarVisible()},u.prototype.onRollOut=function(){this._hover=!1,this.updateScrollBarVisible()},u.prototype.onMouseWheel=function(t){if(this._mouseWheelEnabled){var e=t.mouseWheelDelta>0?-1:1;this._overlapSize.x>0&&0==this._overlapSize.y?this._pageMode?this.setPosX(this._xPos+this._pageSize.x*e,!1):this.setPosX(this._xPos+this._mouseWheelStep*e,!1):this._pageMode?this.setPosY(this._yPos+this._pageSize.y*e,!1):this.setPosY(this._yPos+this._mouseWheelStep*e,!1)}},u.prototype.updateScrollBarPos=function(){this._vtScrollBar&&this._vtScrollBar.setScrollPerc(0==this._overlapSize.y?0:t.ToolSet.clamp(this._container.y,0,this._overlapSize.y)/this._overlapSize.y),this._hzScrollBar&&this._hzScrollBar.setScrollPerc(0==this._overlapSize.x?0:t.ToolSet.clamp(-this._container.x,0,this._overlapSize.x)/this._overlapSize.x),this.checkRefreshBar()},u.prototype.updateScrollBarVisible=function(){this._vtScrollBar&&(this._viewSize.y<=this._vtScrollBar.minSize||this._vScrollNone?this._vtScrollBar.node.active=!1:this.updateScrollBarVisible2(this._vtScrollBar)),this._hzScrollBar&&(this._viewSize.x<=this._hzScrollBar.minSize||this._hScrollNone?this._hzScrollBar.node.active=!1:this.updateScrollBarVisible2(this._hzScrollBar))},u.prototype.updateScrollBarVisible2=function(e){this._scrollBarDisplayAuto&&t.GTween.kill(e,!1,"alpha"),!this._scrollBarDisplayAuto||this._hover||0!=this._tweening||this._dragged||e.gripDragging?(e.alpha=1,e.node.active=!0):e.node.active&&t.GTween.to(1,0,.5).setDelay(.5).onComplete(this.__barTweenComplete,this).setTarget(e,"alpha")},u.prototype.__barTweenComplete=function(t){var e=t.target;e.alpha=1,e.node.active=!1},u.prototype.getLoopPartSize=function(t,e){return(this._contentSize[e]+("x"==e?this._owner.columnGap:this._owner.lineGap))/t},u.prototype.loopCheckingCurrent=function(){var t=!1;return 1==this._loop&&this._overlapSize.x>0?this._xPos<.001?(this._xPos+=this.getLoopPartSize(2,"x"),t=!0):this._xPos>=this._overlapSize.x&&(this._xPos-=this.getLoopPartSize(2,"x"),t=!0):2==this._loop&&this._overlapSize.y>0&&(this._yPos<.001?(this._yPos+=this.getLoopPartSize(2,"y"),t=!0):this._yPos>=this._overlapSize.y&&(this._yPos-=this.getLoopPartSize(2,"y"),t=!0)),t&&this._container.setPosition(Math.floor(-this._xPos),-Math.floor(-this._yPos)),t},u.prototype.loopCheckingTarget=function(t){1==this._loop&&this.loopCheckingTarget2(t,"x"),2==this._loop&&this.loopCheckingTarget2(t,"y")},u.prototype.loopCheckingTarget2=function(t,e){var i,n;t[e]>0?(i=this.getLoopPartSize(2,e),(n=this._tweenStart[e]-i)<=0&&n>=-this._overlapSize[e]&&(t[e]-=i,this._tweenStart[e]=n)):t[e]<-this._overlapSize[e]&&(i=this.getLoopPartSize(2,e),(n=this._tweenStart[e]+i)<=0&&n>=-this._overlapSize[e]&&(t[e]+=i,this._tweenStart[e]=n))},u.prototype.loopCheckingNewPos=function(e,i){if(0==this._overlapSize[i])return e;var n,o="x"==i?this._xPos:this._yPos,r=!1;return e<.001?(e+=this.getLoopPartSize(2,i))>o&&(n=this.getLoopPartSize(6,i),n=Math.ceil((e-o)/n)*n,o=t.ToolSet.clamp(o+n,0,this._overlapSize[i]),r=!0):e>=this._overlapSize[i]&&(e-=this.getLoopPartSize(2,i))<o&&(n=this.getLoopPartSize(6,i),n=Math.ceil((o-e)/n)*n,o=t.ToolSet.clamp(o-n,0,this._overlapSize[i]),r=!0),r&&("x"==i?this._container.x=-Math.floor(o):this._container.y=Math.floor(o)),e},u.prototype.alignPosition=function(t,e){if(this._pageMode)t.x=this.alignByPage(t.x,"x",e),t.y=this.alignByPage(t.y,"y",e);else if(this._snapToItem){var i=this._owner.getSnappingPosition(-t.x,-t.y,a);t.x<0&&t.x>-this._overlapSize.x&&(t.x=-i.x),t.y<0&&t.y>-this._overlapSize.y&&(t.y=-i.y)}},u.prototype.alignByPage=function(t,e,i){var n;if(t>0)n=0;else if(t<-this._overlapSize[e])n=Math.ceil(this._contentSize[e]/this._pageSize[e])-1;else{n=Math.floor(-t/this._pageSize[e]);var o=i?t-this._containerPos[e]:t-("x"==e?this._container.x:-this._container.y),r=Math.min(this._pageSize[e],this._contentSize[e]-(n+1)*this._pageSize[e]),a=-t-n*this._pageSize[e];Math.abs(o)>this._pageSize[e]?a>.5*r&&n++:a>r*(o<0?.3:.7)&&n++,(t=-n*this._pageSize[e])<-this._overlapSize[e]&&(t=-this._overlapSize[e])}if(i){var s,h=this._tweenStart[e];s=h>0?0:h<-this._overlapSize[e]?Math.ceil(this._contentSize[e]/this._pageSize[e])-1:Math.floor(-h/this._pageSize[e]);var l=Math.floor(-this._containerPos[e]/this._pageSize[e]);Math.abs(n-l)>1&&Math.abs(s-l)<=1&&(t=-(n=n>l?l+1:l-1)*this._pageSize[e])}return t},u.prototype.updateTargetAndDuration=function(t,e){e.x=this.updateTargetAndDuration2(t.x,"x"),e.y=this.updateTargetAndDuration2(t.y,"y")},u.prototype.updateTargetAndDuration2=function(t,e){var i=this._velocity[e],n=0;if(t>0)t=0;else if(t<-this._overlapSize[e])t=-this._overlapSize[e];else{var r=cc.sys.isMobile,a=Math.abs(i)*this._velocityScale;r&&(a*=1136/Math.max(cc.winSize.width,cc.winSize.height));var s=0;if(this._pageMode||!r?a>500&&(s=Math.pow((a-500)/500,2)):a>1e3&&(s=Math.pow((a-1e3)/1e3,2)),0!=s)s>1&&(s=1),a*=s,i*=s,this._velocity[e]=i,n=Math.log(60/a)/Math.log(this._decelerationRate)/60,t+=Math.floor(i*n*.4)}return n<o&&(n=o),this._tweenDuration[e]=n,t},u.prototype.fixDuration=function(t,e){if(!(0==this._tweenChange[t]||Math.abs(this._tweenChange[t])>=Math.abs(e))){var i=Math.abs(this._tweenChange[t]/e)*this._tweenDuration[t];i<o&&(i=o),this._tweenDuration[t]=i}},u.prototype.startTween=function(t){this._tweenTime.set(cc.Vec2.ZERO),this._tweening=t,this.updateScrollBarVisible()},u.prototype.killTween=function(){1==this._tweening&&(this._container.setPosition(this._tweenStart.x+this._tweenChange.x,-(this._tweenStart.y+this._tweenChange.y)),this._owner.node.emit(t.Event.SCROLL,this._owner)),this._tweening=0,this.updateScrollBarVisible(),this._owner.node.emit(t.Event.SCROLL_END,this._owner)},u.prototype.checkRefreshBar=function(){if(null!=this._header||null!=this._footer){var t="x"==this._refreshBarAxis?this._container.x:-this._container.y;if(this._header)if(t>0){this._header.node.active=!0;var e=a;e.x=this._header.width,e.y=this._header.height,e[this._refreshBarAxis]=t,this._header.setSize(e.x,e.y)}else this._header.node.active=!1;if(this._footer){var i=this._overlapSize[this._refreshBarAxis];t<-i||0==i&&this._footerLockedSize>0?(this._footer.node.active=!0,(e=a).x=this._footer.x,e.y=this._footer.y,e[this._refreshBarAxis]=i>0?t+this._contentSize[this._refreshBarAxis]:Math.max(Math.min(t+this._viewSize[this._refreshBarAxis],this._viewSize[this._refreshBarAxis]-this._footerLockedSize),this._viewSize[this._refreshBarAxis]-this._contentSize[this._refreshBarAxis]),this._footer.setPosition(e.x,e.y),e.x=this._footer.width,e.y=this._footer.height,e[this._refreshBarAxis]=i>0?-i-t:this._viewSize[this._refreshBarAxis]-this._footer[this._refreshBarAxis],this._footer.setSize(e.x,e.y)):this._footer.node.active=!1}}},u.prototype.update=function(e){if(0!=this._tweening){var i=this.runTween("x",e),n=this.runTween("y",e);return this._container.setPosition(i,-n),2==this._tweening&&(this._overlapSize.x>0&&(this._xPos=t.ToolSet.clamp(-i,0,this._overlapSize.x)),this._overlapSize.y>0&&(this._yPos=t.ToolSet.clamp(-n,0,this._overlapSize.y)),this._pageMode&&this.updatePageController()),0==this._tweenChange.x&&0==this._tweenChange.y?(this._tweening=0,this.loopCheckingCurrent(),this.updateScrollBarPos(),this.updateScrollBarVisible(),this._owner.node.emit(t.Event.SCROLL,this._owner),this._owner.node.emit(t.Event.SCROLL_END,this._owner)):(this.updateScrollBarPos(),this._owner.node.emit(t.Event.SCROLL,this._owner)),!0}},u.prototype.runTween=function(t,e){var i;if(0!=this._tweenChange[t]){if(this._tweenTime[t]+=e,this._tweenTime[t]>=this._tweenDuration[t])i=this._tweenStart[t]+this._tweenChange[t],this._tweenChange[t]=0;else{var n=c(this._tweenTime[t],this._tweenDuration[t]);i=this._tweenStart[t]+Math.floor(this._tweenChange[t]*n)}var r=0,a=-this._overlapSize[t];if(this._headerLockedSize>0&&this._refreshBarAxis==t&&(r=this._headerLockedSize),this._footerLockedSize>0&&this._refreshBarAxis==t){var s=this._overlapSize[this._refreshBarAxis];0==s?s=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):s+=this._footerLockedSize,a=-s}2==this._tweening&&this._bouncebackEffect?i>20+r&&this._tweenChange[t]>0||i>r&&0==this._tweenChange[t]?(this._tweenTime[t]=0,this._tweenDuration[t]=o,this._tweenChange[t]=-i+r,this._tweenStart[t]=i):(i<a-20&&this._tweenChange[t]<0||i<a&&0==this._tweenChange[t])&&(this._tweenTime[t]=0,this._tweenDuration[t]=o,this._tweenChange[t]=a-i,this._tweenStart[t]=i):i>r?(i=r,this._tweenChange[t]=0):i<a&&(i=a,this._tweenChange[t]=0)}else i="x"==t?this._container.x:-this._container.y;return i},u}(cc.Component);t.ScrollPane=e;var i=0,n=.5,o=.3,r=.5,a=new cc.Vec2,s=new cc.Rect,h=new cc.Vec2,l=new cc.Vec2;function c(t,e){return(t=t/e-1)*t*t+1}}(fgui||(fgui={})),function(t){var e=function(){function e(t){this._ownerBaseX=0,this._ownerBaseY=0,this._totalTimes=0,this._totalTasks=0,this._options=0,this._totalDuration=0,this._autoPlayTimes=1,this._autoPlayDelay=0,this._timeScale=1,this._startTime=0,this._endTime=0,this._owner=t,this._items=new Array}return e.prototype.play=function(t,e,i,n,o){this._play(t,e,i,n,o,!1)},e.prototype.playReverse=function(t,e,i){this._play(t,e,i,0,-1,!0)},e.prototype.changePlayTimes=function(t){this._totalTimes=t},e.prototype.setAutoPlay=function(t,e,i){void 0==e&&(e=-1),void 0==i&&(i=0),this._autoPlay!=t&&(this._autoPlay=t,this._autoPlayTimes=e,this._autoPlayDelay=i,this._autoPlay?this._owner.onStage&&this.play(null,this._autoPlayTimes,this._autoPlayDelay):this._owner.onStage||this.stop(!1,!0))},e.prototype._play=function(e,n,o,r,a,s){void 0==n&&(n=1),void 0==o&&(o=0),void 0==r&&(r=0),void 0==a&&(a=-1),this.stop(!0,!0),this._totalTimes=n,this._reversed=s,this._startTime=r,this._endTime=a,this._playing=!0,this._paused=!1,this._onComplete=e;for(var h=this._items.length,l=0;l<h;l++){var c=this._items[l];if(null==c.target?c.targetId?c.target=this._owner.getChildById(c.targetId):c.target=this._owner:c.target!=this._owner&&c.target.parent!=this._owner&&(c.target=null),c.target&&c.type==i.Transition){var u=c.target.getTransition(c.value.transName);if(u==this&&(u=null),u)if(0==c.value.playTimes){var p;for(p=l-1;p>=0;p--){var d=this._items[p];if(d.type==i.Transition&&d.value.trans==u){d.value.stopTime=c.time-d.time;break}}p<0?c.value.stopTime=0:u=null}else c.value.stopTime=-1;c.value.trans=u}}0==o?this.onDelayedPlay():t.GTween.delayedCall(o).onComplete(this.onDelayedPlay,this)},e.prototype.stop=function(e,i){if(void 0==e&&(e=!0),this._playing){this._playing=!1,this._totalTasks=0,this._totalTimes=0;var n=this._onComplete;this._onComplete=null,t.GTween.kill(this);var o=this._items.length;if(this._reversed)for(var r=o-1;r>=0;r--){var a=this._items[r];null!=a.target&&this.stopItem(a,e)}else for(r=0;r<o;r++)null!=(a=this._items[r]).target&&this.stopItem(a,e);i&&null!=n&&n()}},e.prototype.stopItem=function(t,e){if(0!=t.displayLockToken&&(t.target.releaseDisplayLock(t.displayLockToken),t.displayLockToken=0),t.tweener&&(t.tweener.kill(e),t.tweener=null,t.type!=i.Shake||e||(t.target._gearLocked=!0,t.target.setPosition(t.target.x-t.value.lastOffsetX,t.target.y-t.value.lastOffsetY),t.target._gearLocked=!1)),t.type==i.Transition){var n=t.value.trans;n&&n.stop(e,!1)}},e.prototype.setPaused=function(e){if(this._playing&&this._paused!=e){this._paused=e;var n=t.GTween.getTween(this);n&&n.setPaused(e);for(var o=this._items.length,r=0;r<o;r++){var a=this._items[r];null!=a.target&&(a.type==i.Transition?a.value.trans&&a.value.trans.setPaused(e):a.type==i.Animation&&(e?(a.value.flag=a.target.getProp(t.ObjectPropID.Playing),a.target.setProp(t.ObjectPropID.Playing,!1)):a.target.setProp(t.ObjectPropID.Playing,a.value.flag)),a.tweener&&a.tweener.setPaused(e))}}},e.prototype.dispose=function(){this._playing&&t.GTween.kill(this);for(var e=this._items.length,i=0;i<e;i++){var n=this._items[i];n.tweener&&(n.tweener.kill(),n.tweener=null),n.target=null,n.hook=null,n.tweenConfig&&(n.tweenConfig.endHook=null)}this._items.length=0,this._playing=!1,this._onComplete=null},Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),e.prototype.setValue=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var o,r=this._items.length,a=0;a<r;a++){var s=this._items[a];if(s.label==t)o=s.tweenConfig?s.tweenConfig.startValue:s.value;else{if(!s.tweenConfig||s.tweenConfig.endLabel!=t)continue;o=s.tweenConfig.endValue}switch(s.type){case i.XY:case i.Size:case i.Pivot:case i.Scale:case i.Skew:o.b1=!0,o.b2=!0,o.f1=parseFloat(e[0]),o.f2=parseFloat(e[1]);break;case i.Alpha:case i.Rotation:case i.Color:o.f1=parseFloat(e[0]);break;case i.Animation:o.frame=parseInt(e[0]),e.length>1&&(o.playing=e[1]);break;case i.Visible:o.visible=e[0];break;case i.Sound:o.sound=e[0],e.length>1&&(o.volume=parseFloat(e[1]));break;case i.Transition:o.transName=e[0],e.length>1&&(o.playTimes=parseInt(e[1]));break;case i.Shake:o.amplitude=parseFloat(e[0]),e.length>1&&(o.duration=parseFloat(e[1]));break;case i.ColorFilter:o.f1=parseFloat(e[0]),o.f2=parseFloat(e[1]),o.f3=parseFloat(e[2]),o.f4=parseFloat(e[3]);break;case i.Text:case i.Icon:o.text=e[0]}}},e.prototype.setHook=function(t,e){for(var i=this._items.length,n=0;n<i;n++){var o=this._items[n];if(o.label==t){o.hook=e;break}if(o.tweenConfig&&o.tweenConfig.endLabel==t){o.tweenConfig.endHook=e;break}}},e.prototype.clearHooks=function(){for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.hook=null,i.tweenConfig&&(i.tweenConfig.endHook=null)}},e.prototype.setTarget=function(t,e){for(var i=this._items.length,n=0;n<i;n++){var o=this._items[n];o.label==t&&(o.targetId=e.id,o.target=null)}},e.prototype.setDuration=function(t,e){for(var i=this._items.length,n=0;n<i;n++){var o=this._items[n];o.tweenConfig&&o.label==t&&(o.tweenConfig.duration=e)}},e.prototype.getLabelTime=function(t){for(var e=this._items.length,i=0;i<e;i++){var n=this._items[i];if(n.label==t)return n.time;if(n.tweenConfig&&n.tweenConfig.endLabel==t)return n.time+n.tweenConfig.duration}return Number.NaN},Object.defineProperty(e.prototype,"timeScale",{get:function(){return this._timeScale},set:function(e){if(this._timeScale!=e&&(this._timeScale=e,this._playing))for(var n=this._items.length,o=0;o<n;o++){var r=this._items[o];r.tweener?r.tweener.setTimeScale(e):r.type==i.Transition?r.value.trans&&(r.value.trans.timeScale=e):r.type==i.Animation&&r.target&&r.target.setProp(t.ObjectPropID.TimeScale,e)}},enumerable:!1,configurable:!0}),e.prototype.updateFromRelations=function(t,e,n){var o=this._items.length;if(0!=o)for(var r=0;r<o;r++){var a=this._items[r];a.type==i.XY&&a.targetId==t&&(a.tweenConfig?(a.tweenConfig.startValue.f1+=e,a.tweenConfig.startValue.f2+=n,a.tweenConfig.endValue.f1+=e,a.tweenConfig.endValue.f2+=n):(a.value.f1+=e,a.value.f2+=n))}},e.prototype.onEnable=function(){this._autoPlay&&!this._playing&&this.play(null,this._autoPlayTimes,this._autoPlayDelay)},e.prototype.onDisable=function(){0==(this._options&o)&&this.stop(0!=(this._options&r),!1)},e.prototype.onDelayedPlay=function(){if(this.internalPlay(),this._playing=this._totalTasks>0,this._playing){if(0!=(this._options&n))for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.target&&i.target!=this._owner&&(i.displayLockToken=i.target.addDisplayLock())}}else if(null!=this._onComplete){var o=this._onComplete;this._onComplete=null,o()}},e.prototype.internalPlay=function(){this._ownerBaseX=this._owner.x,this._ownerBaseY=this._owner.y,this._totalTasks=0;var t,e,n=this._items.length,o=!1;if(this._reversed)for(e=n-1;e>=0;e--)null!=(t=this._items[e]).target&&this.playItem(t);else for(e=0;e<n;e++)null!=(t=this._items[e]).target&&(t.type==i.Animation&&0!=this._startTime&&t.time<=this._startTime?(o=!0,t.value.flag=!1):this.playItem(t));o&&this.skipAnimations()},e.prototype.playItem=function(e){var n;if(e.tweenConfig){if(n=this._reversed?this._totalDuration-e.time-e.tweenConfig.duration:e.time,-1==this._endTime||n<=this._endTime){var o,r;switch(this._reversed?(o=e.tweenConfig.endValue,r=e.tweenConfig.startValue):(o=e.tweenConfig.startValue,r=e.tweenConfig.endValue),e.value.b1=o.b1||r.b1,e.value.b2=o.b2||r.b2,e.type){case i.XY:case i.Size:case i.Scale:case i.Skew:e.tweener=t.GTween.to2(o.f1,o.f2,r.f1,r.f2,e.tweenConfig.duration);break;case i.Alpha:case i.Rotation:e.tweener=t.GTween.to(o.f1,r.f1,e.tweenConfig.duration);break;case i.Color:e.tweener=t.GTween.toColor(o.f1,r.f1,e.tweenConfig.duration);break;case i.ColorFilter:e.tweener=t.GTween.to4(o.f1,o.f2,o.f3,o.f4,r.f1,r.f2,r.f3,r.f4,e.tweenConfig.duration)}e.tweener.setDelay(n).setEase(e.tweenConfig.easeType).setRepeat(e.tweenConfig.repeat,e.tweenConfig.yoyo).setTimeScale(this._timeScale).setTarget(e).onStart(this.onTweenStart,this).onUpdate(this.onTweenUpdate,this).onComplete(this.onTweenComplete,this),this._endTime>=0&&e.tweener.setBreakpoint(this._endTime-n),this._totalTasks++}}else e.type==i.Shake?(n=this._reversed?this._totalDuration-e.time-e.value.duration:e.time,e.value.offsetX=e.value.offsetY=0,e.value.lastOffsetX=e.value.lastOffsetY=0,e.tweener=t.GTween.shake(0,0,e.value.amplitude,e.value.duration).setDelay(n).setTimeScale(this._timeScale).setTarget(e).onUpdate(this.onTweenUpdate,this).onComplete(this.onTweenComplete,this),this._endTime>=0&&e.tweener.setBreakpoint(this._endTime-e.time),this._totalTasks++):(n=this._reversed?this._totalDuration-e.time:e.time)<=this._startTime?(this.applyValue(e),this.callHook(e,!1)):(-1==this._endTime||n<=this._endTime)&&(this._totalTasks++,e.tweener=t.GTween.delayedCall(n).setTimeScale(this._timeScale).setTarget(e).onComplete(this.onDelayedPlayItem,this));e.tweener&&e.tweener.seek(this._startTime)},e.prototype.skipAnimations=function(){for(var e,n,o,r,a,s,h=this._items.length,l=0;l<h;l++)if(!((s=this._items[l]).type!=i.Animation||s.time>this._startTime||(r=s.value).flag)){e=(a=s.target).getProp(t.ObjectPropID.Frame),n=a.getProp(t.ObjectPropID.Playing)?0:-1,o=0;for(var c=l;c<h;c++)(s=this._items[c]).type!=i.Animation||s.target!=a||s.time>this._startTime||((r=s.value).flag=!0,-1!=r.frame?(e=r.frame,n=r.playing?s.time:-1,o=0):r.playing?n<0&&(n=s.time):(n>=0&&(o+=s.time-n),n=-1),this.callHook(s,!1));n>=0&&(o+=this._startTime-n),a.setProp(t.ObjectPropID.Playing,n>=0),a.setProp(t.ObjectPropID.Frame,e),o>0&&a.setProp(t.ObjectPropID.DeltaTime,1e3*o)}},e.prototype.onDelayedPlayItem=function(t){var e=t.target;e.tweener=null,this._totalTasks--,this.applyValue(e),this.callHook(e,!1),this.checkAllComplete()},e.prototype.onTweenStart=function(t){var e,n,o=t.target;o.type!=i.XY&&o.type!=i.Size||(this._reversed?(e=o.tweenConfig.endValue,n=o.tweenConfig.startValue):(e=o.tweenConfig.startValue,n=o.tweenConfig.endValue),o.type==i.XY?o.target!=this._owner?(e.b1?e.b3&&(t.startValue.x=e.f1*this._owner.width):t.startValue.x=o.target.x,e.b2?e.b3&&(t.startValue.y=e.f2*this._owner.height):t.startValue.y=o.target.y,n.b1?n.b3&&(t.endValue.x=n.f1*this._owner.width):t.endValue.x=t.startValue.x,n.b2?n.b3&&(t.endValue.y=n.f2*this._owner.height):t.endValue.y=t.startValue.y):(e.b1||(t.startValue.x=o.target.x-this._ownerBaseX),e.b2||(t.startValue.y=o.target.y-this._ownerBaseY),n.b1||(t.endValue.x=t.startValue.x),n.b2||(t.endValue.y=t.startValue.y)):(e.b1||(t.startValue.x=o.target.width),e.b2||(t.startValue.y=o.target.height),n.b1||(t.endValue.x=t.startValue.x),n.b2||(t.endValue.y=t.startValue.y)),o.tweenConfig.path&&(o.value.b1=o.value.b2=!0,t.setPath(o.tweenConfig.path)));this.callHook(o,!1)},e.prototype.onTweenUpdate=function(t){var e=t.target;switch(e.type){case i.XY:case i.Size:case i.Scale:case i.Skew:e.value.f1=t.value.x,e.value.f2=t.value.y,e.tweenConfig.path&&(e.value.f1+=t.startValue.x,e.value.f2+=t.startValue.y);break;case i.Alpha:case i.Rotation:e.value.f1=t.value.x;break;case i.Color:e.value.f1=t.value.color;break;case i.ColorFilter:e.value.f1=t.value.x,e.value.f2=t.value.y,e.value.f3=t.value.z,e.value.f4=t.value.w;break;case i.Shake:e.value.offsetX=t.deltaValue.x,e.value.offsetY=t.deltaValue.y}this.applyValue(e)},e.prototype.onTweenComplete=function(t){var e=t.target;e.tweener=null,this._totalTasks--,t.allCompleted&&this.callHook(e,!0),this.checkAllComplete()},e.prototype.onPlayTransCompleted=function(t){this._totalTasks--,this.checkAllComplete()},e.prototype.callHook=function(t,e){e?t.tweenConfig&&null!=t.tweenConfig.endHook&&t.tweenConfig.endHook(t.label):t.time>=this._startTime&&null!=t.hook&&t.hook(t.label)},e.prototype.checkAllComplete=function(){if(this._playing&&0==this._totalTasks)if(this._totalTimes<0)this.internalPlay();else if(this._totalTimes--,this._totalTimes>0)this.internalPlay();else{this._playing=!1;for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.target&&0!=i.displayLockToken&&(i.target.releaseDisplayLock(i.displayLockToken),i.displayLockToken=0)}if(null!=this._onComplete){var n=this._onComplete;this._onComplete=null,n()}}},e.prototype.applyValue=function(e){e.target._gearLocked=!0;var n=e.value;switch(e.type){case i.XY:e.target==this._owner?n.b1&&n.b2?e.target.setPosition(n.f1+this._ownerBaseX,n.f2+this._ownerBaseY):n.b1?e.target.x=n.f1+this._ownerBaseX:e.target.y=n.f2+this._ownerBaseY:n.b3?n.b1&&n.b2?e.target.setPosition(n.f1*this._owner.width,n.f2*this._owner.height):n.b1?e.target.x=n.f1*this._owner.width:n.b2&&(e.target.y=n.f2*this._owner.height):n.b1&&n.b2?e.target.setPosition(n.f1,n.f2):n.b1?e.target.x=n.f1:n.b2&&(e.target.y=n.f2);break;case i.Size:n.b1||(n.f1=e.target.width),n.b2||(n.f2=e.target.height),e.target.setSize(n.f1,n.f2);break;case i.Pivot:e.target.setPivot(n.f1,n.f2,e.target.pivotAsAnchor);break;case i.Alpha:e.target.alpha=n.f1;break;case i.Rotation:e.target.rotation=n.f1;break;case i.Scale:e.target.setScale(n.f1,n.f2);break;case i.Skew:e.target.setSkew(n.f1,n.f2);break;case i.Color:e.target.setProp(t.ObjectPropID.Color,n.f1);break;case i.Animation:n.frame>=0&&e.target.setProp(t.ObjectPropID.Frame,n.frame),e.target.setProp(t.ObjectPropID.Playing,n.playing),e.target.setProp(t.ObjectPropID.TimeScale,this._timeScale);break;case i.Visible:e.target.visible=n.visible;break;case i.Transition:if(this._playing){var o=n.trans;if(o){this._totalTasks++;var r=this._startTime>e.time?this._startTime-e.time:0,a=this._endTime>=0?this._endTime-e.time:-1;n.stopTime>=0&&(a<0||a>n.stopTime)&&(a=n.stopTime),o.timeScale=this._timeScale,o._play(function(){this.onPlayTransCompleted(e)}.bind(this),n.playTimes,0,r,a,this._reversed)}}break;case i.Sound:if(this._playing&&e.time>=this._startTime){if(null==n.audioClip){var s=t.UIPackage.getItemByURL(n.sound);s&&(n.audioClip=s.owner.getItemAsset(s))}n.audioClip&&t.GRoot.inst.playOneShotSound(n.audioClip,n.volume)}break;case i.Shake:e.target.setPosition(e.target.x-n.lastOffsetX+n.offsetX,e.target.y-n.lastOffsetY+n.offsetY),n.lastOffsetX=n.offsetX,n.lastOffsetY=n.offsetY;break;case i.ColorFilter:break;case i.Text:e.target.text=n.text;break;case i.Icon:e.target.icon=n.text}e.target._gearLocked=!1},e.prototype.setup=function(e){this.name=e.readS(),this._options=e.readInt(),this._autoPlay=e.readBool(),this._autoPlayTimes=e.readInt(),this._autoPlayDelay=e.readFloat();for(var i=e.readShort(),n=0;n<i;n++){var o=e.readShort(),r=e.position;e.seek(r,0);var h=new a(e.readByte());this._items[n]=h,h.time=e.readFloat();var l=e.readShort();if(h.targetId=l<0?"":this._owner.getChildAt(l).id,h.label=e.readS(),e.readBool()){if(e.seek(r,1),h.tweenConfig=new s,h.tweenConfig.duration=e.readFloat(),h.time+h.tweenConfig.duration>this._totalDuration&&(this._totalDuration=h.time+h.tweenConfig.duration),h.tweenConfig.easeType=e.readByte(),h.tweenConfig.repeat=e.readInt(),h.tweenConfig.yoyo=e.readBool(),h.tweenConfig.endLabel=e.readS(),e.seek(r,2),this.decodeValue(h,e,h.tweenConfig.startValue),e.seek(r,3),this.decodeValue(h,e,h.tweenConfig.endValue),e.version>=2){var c=e.readInt();if(c>0){h.tweenConfig.path=new t.GPath;for(var u=new Array,p=0;p<c;p++){var d=e.readByte();switch(d){case t.CurveType.Bezier:u.push(t.GPathPoint.newBezierPoint(e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat()));break;case t.CurveType.CubicBezier:u.push(t.GPathPoint.newCubicBezierPoint(e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat()));break;default:u.push(t.GPathPoint.newPoint(e.readFloat(),e.readFloat(),d))}}h.tweenConfig.path.create(u)}}}else h.time>this._totalDuration&&(this._totalDuration=h.time),e.seek(r,2),this.decodeValue(h,e,h.value);e.position=r+o}},e.prototype.decodeValue=function(t,e,n){switch(t.type){case i.XY:case i.Size:case i.Pivot:case i.Skew:n.b1=e.readBool(),n.b2=e.readBool(),n.f1=e.readFloat(),n.f2=e.readFloat(),e.version>=2&&t.type==i.XY&&(n.b3=e.readBool());break;case i.Alpha:case i.Rotation:n.f1=e.readFloat();break;case i.Scale:n.f1=e.readFloat(),n.f2=e.readFloat();break;case i.Color:n.f1=e.readColor().toRGBValue();break;case i.Animation:n.playing=e.readBool(),n.frame=e.readInt();break;case i.Visible:n.visible=e.readBool();break;case i.Sound:n.sound=e.readS(),n.volume=e.readFloat();break;case i.Transition:n.transName=e.readS(),n.playTimes=e.readInt();break;case i.Shake:n.amplitude=e.readFloat(),n.duration=e.readFloat();break;case i.ColorFilter:n.f1=e.readFloat(),n.f2=e.readFloat(),n.f3=e.readFloat(),n.f4=e.readFloat();break;case i.Text:case i.Icon:n.text=e.readS()}},e}();t.Transition=e;var i,n=1,o=2,r=4;(function(t){t[t.XY=0]="XY",t[t.Size=1]="Size",t[t.Scale=2]="Scale",t[t.Pivot=3]="Pivot",t[t.Alpha=4]="Alpha",t[t.Rotation=5]="Rotation",t[t.Color=6]="Color",t[t.Animation=7]="Animation",t[t.Visible=8]="Visible",t[t.Sound=9]="Sound",t[t.Transition=10]="Transition",t[t.Shake=11]="Shake",t[t.ColorFilter=12]="ColorFilter",t[t.Skew=13]="Skew",t[t.Text=14]="Text",t[t.Icon=15]="Icon",t[t.Unknown=16]="Unknown"})(i||(i={}));var a=function(){return function(t){this.type=t,this.value={},this.displayLockToken=0}}(),s=function(){return function(){this.easeType=t.EaseType.QuadOut,this.startValue={b1:!0,b2:!0},this.endValue={b1:!0,b2:!0}}}()}(fgui||(fgui={})),function(t){var e=function(){function e(){}return e.loadFromXML=function(t){var i={};e.strings=i;for(var n=(new cc.SAXParser).parse(t).documentElement.childNodes,o=n.length,r=0;r<o;r++){var a=n[r];if("string"==a.tagName){var s=a.getAttribute("name"),h=a.childNodes.length>0?a.firstChild.nodeValue:"",l=s.indexOf("-");if(-1==l)continue;var c=s.substr(0,l),u=s.substr(l+1),p=i[c];p||(p={},i[c]=p),p[u]=h}}},e.translateComponent=function(i){if(null!=e.strings){var n=e.strings[i.owner.id+i.id];if(null!=n){var o,r,a,s,h,l,c,u,p,d=i.rawData;d.seek(0,2);var f=d.readShort();for(h=0;h<f;h++){c=d.readShort(),u=d.position,d.seek(u,0);var _=d.readByte(),g=_;d.skip(4),o=d.readS(),g==t.ObjectType.Component&&d.seek(u,6)&&(g=d.readByte()),d.seek(u,1),null!=(r=n[o+"-tips"])&&d.writeS(r),d.seek(u,2);var m=d.readShort();for(l=0;l<m;l++){if(a=d.readShort(),a+=d.position,6==d.readByte()){for(d.skip(2),p=d.readShort(),v=0;v<p;v++)null!=d.readS()&&(null!=(r=n[o+"-texts_"+v])?d.writeS(r):d.skip(2));d.readBool()&&null!=(r=n[o+"-texts_def"])&&d.writeS(r)}if(_==t.ObjectType.Component&&d.version>=2){d.seek(u,4),d.skip(2),d.skip(4*d.readShort());for(var y=d.readShort(),v=0;v<y;v++){var b=d.readS();0==d.readShort()&&null!=(r=n[o+"-cp-"+b])?d.writeS(r):d.skip(2)}}d.position=a}switch(g){case t.ObjectType.Text:case t.ObjectType.RichText:case t.ObjectType.InputText:null!=(r=n[o])&&(d.seek(u,6),d.writeS(r)),null!=(r=n[o+"-prompt"])&&(d.seek(u,4),d.writeS(r));break;case t.ObjectType.List:case t.ObjectType.Tree:for(d.seek(u,8),d.skip(2),s=d.readShort(),l=0;l<s;l++){if(a=d.readShort(),a+=d.position,d.skip(2),g==t.ObjectType.Tree&&d.skip(2),null!=(r=n[o+"-"+l])?d.writeS(r):d.skip(2),null!=(r=n[o+"-"+l+"-0"])?d.writeS(r):d.skip(2),d.version>=2){d.skip(6),d.skip(4*d.readUshort());for(y=d.readUshort(),v=0;v<y;v++){b=d.readS();0==d.readUshort()&&null!=(r=n[o+"-"+l+"-"+b])?d.writeS(r):d.skip(2)}}d.position=a}break;case t.ObjectType.Label:d.seek(u,6)&&d.readByte()==g&&(null!=(r=n[o])?d.writeS(r):d.skip(2),d.skip(2),d.readBool()&&d.skip(4),d.skip(4),d.readBool()&&null!=(r=n[o+"-prompt"])&&d.writeS(r));break;case t.ObjectType.Button:d.seek(u,6)&&d.readByte()==g&&(null!=(r=n[o])?d.writeS(r):d.skip(2),null!=(r=n[o+"-0"])&&d.writeS(r));break;case t.ObjectType.ComboBox:if(d.seek(u,6)&&d.readByte()==g){for(s=d.readShort(),l=0;l<s;l++)a=d.readShort(),a+=d.position,null!=(r=n[o+"-"+l])&&d.writeS(r),d.position=a;null!=(r=n[o])&&d.writeS(r)}}d.position=u+c}}}},e}();t.TranslationHelper=e}(fgui||(fgui={})),function(t){var e=function(){function e(){}return e.defaultFont="Arial",e.modalLayerColor=new cc.Color(51,51,51,51),e.buttonSoundVolumeScale=1,e.defaultScrollStep=25,e.defaultScrollDecelerationRate=.967,e.defaultScrollBarDisplay=t.ScrollBarDisplayType.Visible,e.defaultScrollTouchEffect=!0,e.defaultScrollBounceEffect=!0,e.defaultComboBoxVisibleItemCount=10,e.touchScrollSensitivity=20,e.touchDragSensitivity=10,e.clickDragSensitivity=2,e.bringWindowToFrontOnClick=!0,e.frameTimeForAsyncUIConstruction=.002,e.linkUnderline=!0,e.defaultUIGroup="UI",e}();t.UIConfig=e,t.addLoadHandler=function(t){};var i={};t.registerFont=function(t,e){e instanceof cc.Font?i[t]=e:i[t]=cc.loader.getRes(t,cc.Font)},t.getFontByName=function(t){return i[t]}}(fgui||(fgui={})),function(t){var e=function(){function e(){}return e.setExtension=function(i,n){if(null==i)throw new Error("Invaild url: "+i);var o=t.UIPackage.getItemByURL(i);o&&(o.extensionType=n),e.extensions[i]=n},e.setLoaderExtension=function(t){e.loaderType=t},e.resolveExtension=function(t){var i=e.extensions["ui://"+t.owner.id+t.id];i||(i=e.extensions["ui://"+t.owner.name+"/"+t.name]),i&&(t.extensionType=i)},e.newObject=function(i,n){var o;if(e.counter++,"number"==typeof i)switch(i){case t.ObjectType.Image:return new t.GImage;case t.ObjectType.MovieClip:return new t.GMovieClip;case t.ObjectType.Component:return new t.GComponent;case t.ObjectType.Text:return new t.GTextField;case t.ObjectType.RichText:return new t.GRichTextField;case t.ObjectType.InputText:return new t.GTextInput;case t.ObjectType.Group:return new t.GGroup;case t.ObjectType.List:return new t.GList;case t.ObjectType.Graph:return new t.GGraph;case t.ObjectType.Loader:return e.loaderType?new e.loaderType:new t.GLoader;case t.ObjectType.Button:return new t.GButton;case t.ObjectType.Label:return new t.GLabel;case t.ObjectType.ProgressBar:return new t.GProgressBar;case t.ObjectType.Slider:return new t.GSlider;case t.ObjectType.ScrollBar:return new t.GScrollBar;case t.ObjectType.ComboBox:return new t.GComboBox;case t.ObjectType.Tree:return new t.GTree;case t.ObjectType.Loader3D:return new t.GLoader3D;default:return null}else(o=i.type==t.PackageItemType.Component?n?new n:i.extensionType?new i.extensionType:e.newObject(i.objectType):e.newObject(i.objectType))&&(o.packageItem=i);return o},e.counter=0,e.extensions={},e}();t.UIObjectFactory=e}(fgui||(fgui={})),function(t){var e,i=function(){function e(){this._items=[],this._itemsById={},this._itemsByName={},this._sprites={},this._dependencies=[],this._branches=[],this._branchIndex=-1}return Object.defineProperty(e,"branch",{get:function(){return e._branch},set:function(t){e._branch=t;for(var i in e._instById){var n=e._instById[i];n._branches&&(n._branchIndex=n._branches.indexOf(t))}},enumerable:!1,configurable:!0}),e.getVar=function(t){return e._vars[t]},e.setVar=function(t,i){e._vars[t]=i},e.getById=function(t){return e._instById[t]},e.getByName=function(t){return e._instByName[t]},e.addPackage=function(i){var n=e._instById[i];if(n)return n;var o=cc.resources.get(i,cc.BufferAsset);if(!o)throw"Resource '"+i+"' not ready";if(!o._buffer)throw"Missing asset data.";return(n=new e)._bundle=cc.resources,n.loadPackage(new t.ByteBuffer(o._buffer),i),e._instById[n.id]=n,e._instByName[n.name]=n,e._instById[n._path]=n,n},e.loadPackage=function(){for(var i,o,r,a,s=[],h=0;h<arguments.length;h++)s[h]=arguments[h];s[0]instanceof cc.AssetManager.Bundle?(a=s[0],i=s[1],s.length>3?(o=s[2],r=s[3]):r=s[2]):(i=s[0],s.length>2?(o=s[1],r=s[2]):r=s[1]),(a=a||cc.resources).load(i,cc.BufferAsset,o,function(s,h){if(s)null!=r&&r(s,null);else{var l=new e;l._bundle=a,l.loadPackage(new t.ByteBuffer(h._buffer),i);for(var c=l._items.length,u=[],p=[],d=0;d<c;d++){var f=l._items[d];if(f.type==t.PackageItemType.Atlas||f.type==t.PackageItemType.Sound){var _=n[f.type];u.push(f.file),p.push(_)}}var g,m=u.length,y=function(t){m--,t&&(g=t),m<=0&&(e._instById[l.id]=l,e._instByName[l.name]=l,l._path&&(e._instByName[l._path]=l),null!=r&&r(g,l))};m>0?u.forEach(function(t,e){a.load(t,p[e],o,y)}):y()}})},e.removePackage=function(t){var i=e._instById[t];if(i||(i=e._instByName[t]),!i)throw"No package found: "+t;i.dispose(),delete e._instById[i.id],delete e._instByName[i.name],i._path&&delete e._instById[i._path]},e.createObject=function(t,i,n){var o=e.getByName(t);return o?o.createObject(i,n):null},e.createObjectFromURL=function(t,i){var n=e.getItemByURL(t);return n?n.owner.internalCreateObject(n,i):null},e.getItemURL=function(t,i){var n=e.getByName(t);if(!n)return null;var o=n._itemsByName[i];return o?"ui://"+n.id+o.id:null},e.getItemByURL=function(t){var i=t.indexOf("//");if(-1==i)return null;var n=t.indexOf("/",i+2);if(-1==n){if(t.length>13){var o=t.substr(5,8),r=e.getById(o);if(null!=r){var a=t.substr(13);return r.getItemById(a)}}}else{var s=t.substr(i+2,n-i-2);if(null!=(r=e.getByName(s))){var h=t.substr(n+1);return r.getItemByName(h)}}return null},e.normalizeURL=function(t){if(null==t)return null;var i=t.indexOf("//");if(-1==i)return null;var n=t.indexOf("/",i+2);if(-1==n)return t;var o=t.substr(i+2,n-i-2),r=t.substr(n+1);return e.getItemURL(o,r)},e.setStringsSource=function(e){t.TranslationHelper.loadFromXML(e)},e.prototype.loadPackage=function(i,n){if(1179080009!=i.readUint())throw"FairyGUI: old package format found in '"+n+"'";this._path=n,i.version=i.readInt();var o=i.version>=2;i.readBool();this._id=i.readString(),this._name=i.readString(),i.skip(20);var r,a,s,h,l,c=i.position;i.seek(c,4),r=i.readInt();var u,p=new Array(r);for(i.stringTable=p,a=0;a<r;a++)p[a]=i.readString();if(i.seek(c,5))for(r=i.readInt(),a=0;a<r;a++){var d=i.readUshort(),f=i.readInt();p[d]=i.readString(f)}for(i.seek(c,0),r=i.readShort(),a=0;a<r;a++)this._dependencies.push({id:i.readS(),name:i.readS()});o&&((r=i.readShort())>0&&(this._branches=i.readSArray(r),e._branch&&(this._branchIndex=this._branches.indexOf(e._branch))),l=r>0),i.seek(c,1);var _=n.lastIndexOf("/"),g=-1==_?"":n.substr(0,_+1);for(n+="_",r=i.readShort(),a=0;a<r;a++){switch(s=i.readInt(),s+=i.position,(u=new t.PackageItem).owner=this,u.type=i.readByte(),u.id=i.readS(),u.name=i.readS(),i.readS(),u.file=i.readS(),i.readBool(),u.width=i.readInt(),u.height=i.readInt(),u.type){case t.PackageItemType.Image:u.objectType=t.ObjectType.Image;var m=i.readByte();1==m?(u.scale9Grid=new cc.Rect,u.scale9Grid.x=i.readInt(),u.scale9Grid.y=i.readInt(),u.scale9Grid.width=i.readInt(),u.scale9Grid.height=i.readInt(),u.tileGridIndice=i.readInt()):2==m&&(u.scaleByTile=!0),u.smoothing=i.readBool();break;case t.PackageItemType.MovieClip:u.smoothing=i.readBool(),u.objectType=t.ObjectType.MovieClip,u.rawData=i.readBuffer();break;case t.PackageItemType.Font:u.rawData=i.readBuffer();break;case t.PackageItemType.Component:var y=i.readByte();u.objectType=y>0?y:t.ObjectType.Component,u.rawData=i.readBuffer(),t.UIObjectFactory.resolveExtension(u);break;case t.PackageItemType.Atlas:case t.PackageItemType.Sound:case t.PackageItemType.Misc:u.file=n+cc.path.mainFileName(u.file);break;case t.PackageItemType.Spine:case t.PackageItemType.DragonBones:u.file=g+cc.path.mainFileName(u.file),u.skeletonAnchor=new cc.Vec2,u.skeletonAnchor.x=i.readFloat(),u.skeletonAnchor.y=i.readFloat()}if(o){(h=i.readS())&&(u.name=h+"/"+u.name);var v=i.readUbyte();v>0&&(l?u.branches=i.readSArray(v):this._itemsById[i.readS()]=u);var b=i.readUbyte();b>0&&(u.highResolution=i.readSArray(b))}this._items.push(u),this._itemsById[u.id]=u,null!=u.name&&(this._itemsByName[u.name]=u),i.position=s}for(i.seek(c,2),r=i.readShort(),a=0;a<r;a++){s=i.readShort(),s+=i.position;var C=i.readS();u=this._itemsById[i.readS()];var S=new cc.Rect;S.x=i.readInt(),S.y=i.readInt(),S.width=i.readInt(),S.height=i.readInt();var w={atlas:u,rect:S,offset:new cc.Vec2,originalSize:new cc.Size(0,0)};w.rotated=i.readBool(),o&&i.readBool()?(w.offset.x=i.readInt(),w.offset.y=i.readInt(),w.originalSize.width=i.readInt(),w.originalSize.height=i.readInt()):(w.originalSize.width=w.rect.width,w.originalSize.height=w.rect.height),this._sprites[C]=w,i.position=s}if(i.seek(c,3))for(r=i.readShort(),a=0;a<r;a++)s=i.readInt(),s+=i.position,(u=this._itemsById[i.readS()])&&u.type==t.PackageItemType.Image&&(u.hitTestData=new t.PixelHitTestData(i)),i.position=s},e.prototype.dispose=function(){for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.asset&&cc.assetManager.releaseAsset(i.asset)}},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dependencies",{get:function(){return this._dependencies},enumerable:!1,configurable:!0}),e.prototype.createObject=function(t,e){var i=this._itemsByName[t];return i?this.internalCreateObject(i,e):null},e.prototype.internalCreateObject=function(i,n){var o=t.UIObjectFactory.newObject(i,n);return null==o?null:(e._constructing++,o.constructFromResource(),e._constructing--,o)},e.prototype.getItemById=function(t){return this._itemsById[t]},e.prototype.getItemByName=function(t){return this._itemsByName[t]},e.prototype.getItemAssetByName=function(t){var e=this._itemsByName[t];if(null==e)throw"Resource not found -"+t;return this.getItemAsset(e)},e.prototype.getItemAsset=function(e){switch(e.type){case t.PackageItemType.Image:if(!e.decoded){e.decoded=!0;var i=this._sprites[e.id];if(i){var o=this.getItemAsset(i.atlas);if(o){var r=new cc.SpriteFrame(o,i.rect,i.rotated,new cc.Vec2(i.offset.x-(i.originalSize.width-i.rect.width)/2,-(i.offset.y-(i.originalSize.height-i.rect.height)/2)),i.originalSize);e.scale9Grid&&(r.insetLeft=e.scale9Grid.x,r.insetTop=e.scale9Grid.y,r.insetRight=e.width-e.scale9Grid.xMax,r.insetBottom=e.height-e.scale9Grid.yMax),e.asset=r}}}break;case t.PackageItemType.Atlas:case t.PackageItemType.Sound:e.decoded||(e.decoded=!0,e.asset=this._bundle.get(e.file,n[e.type]),e.asset||console.log("Resource '"+e.file+"' not found"));break;case t.PackageItemType.Font:e.decoded||(e.decoded=!0,this.loadFont(e));break;case t.PackageItemType.MovieClip:e.decoded||(e.decoded=!0,this.loadMovieClip(e))}return e.asset},e.prototype.getItemAssetAsync=function(e,i){if(e.decoded)i(null,e);else if(e.loading)e.loading.push(i);else switch(e.type){case t.PackageItemType.Spine:e.loading=[i],this.loadSpine(e);break;case t.PackageItemType.DragonBones:e.loading=[i],this.loadDragonBones(e);break;default:this.getItemAsset(e),i(null,e)}},e.prototype.loadAllAssets=function(){for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];this.getItemAsset(i)}},e.prototype.loadMovieClip=function(t){var e=t.rawData;e.seek(0,0),t.interval=e.readInt()/1e3,t.swing=e.readBool(),t.repeatDelay=e.readInt()/1e3,e.seek(0,1);var i,n,o=e.readShort();t.frames=Array(o);for(var r=0;r<o;r++){var a=e.readShort();a+=e.position;var s=new cc.Rect;s.x=e.readInt(),s.y=e.readInt(),s.width=e.readInt(),s.height=e.readInt();var h={rect:s,addDelay:e.readInt()/1e3};if(null!=(i=e.readS())&&null!=(n=this._sprites[i])){var l=this.getItemAsset(n.atlas);if(l){t.width,h.rect.width;h.texture=new cc.SpriteFrame(l,n.rect,n.rotated,new cc.Vec2(h.rect.x-(t.width-h.rect.width)/2,-(h.rect.y-(t.height-h.rect.height)/2)),new cc.Size(t.width,t.height))}}t.frames[r]=h,e.position=a}},e.prototype.loadFont=function(t){var e=new cc.LabelAtlas;t.asset=e,e._fntConfig={commonHeight:0,fontSize:0,kerningDict:{},fontDefDictionary:{}};var i=e._fntConfig.fontDefDictionary,n=t.rawData;n.seek(0,0);var o=n.readBool(),r=n.readBool(),a=n.readBool();n.readBool();var s,h,l=n.readInt(),c=n.readInt(),u=n.readInt(),p=this._sprites[t.id];p&&(s=this.getItemAsset(p.atlas)),n.seek(0,1);for(var d=n.readInt(),f=0;f<d;f++){var _=n.readShort();_+=n.position,h={},i[n.readUshort()]=h;var g=new cc.Rect;h.rect=g;var m=n.readS();if(g.x=n.readInt(),g.y=n.readInt(),h.xOffset=n.readInt(),h.yOffset=n.readInt(),g.width=n.readInt(),g.height=n.readInt(),h.xAdvance=n.readInt(),h.channel=n.readByte(),1==h.channel?h.channel=3:2==h.channel?h.channel=2:3==h.channel&&(h.channel=1),o)g.x+=p.rect.x,g.y+=p.rect.y;else{var y=this._sprites[m];y&&(g.set(y.rect),h.xOffset+=y.offset.x,h.yOffset+=y.offset.y,0==l&&(l=y.originalSize.height),s||(y.atlas.load(),s=y.atlas.asset)),0==h.xAdvance&&(h.xAdvance=0==c?h.xOffset+h.rect.width:c)}n.position=_}e.fontSize=l,e._fntConfig.fontSize=l,e._fntConfig.commonHeight=0==u?l:u,e._fntConfig.resizable=a,e._fntConfig.canTint=r;var v=new cc.SpriteFrame;v.setTexture(s),e.spriteFrame=v,e.onLoad()},e.prototype.loadSpine=function(t){this._bundle.load(t.file,sp.SkeletonData,function(e,i){t.decoded=!0,t.asset=i;var n=t.loading;delete t.loading,n.forEach(function(i){return i(e,t)})})},e.prototype.loadDragonBones=function(t){var e=this;this._bundle.load(t.file,dragonBones.DragonBonesAsset,function(i,n){if(i){t.decoded=!0;var o=t.loading;return delete t.loading,void o.forEach(function(e){return e(i,t)})}t.asset=n;var r=t.file.replace("_ske","_tex"),a=r.lastIndexOf(".");-1!=a&&(r=r.substr(0,a+1)+"json"),e._bundle.load(r,dragonBones.DragonBonesAtlasAsset,function(e,i){t.decoded=!0,t.atlasAsset=i;var n=t.loading;delete t.loading,n.forEach(function(i){return i(e,t)})})})},e._constructing=0,e._instById={},e._instByName={},e._branch="",e._vars={},e}();t.UIPackage=i;var n=((e={})[t.PackageItemType.Atlas]=cc.Texture2D,e[t.PackageItemType.Sound]=cc.AudioClip,e)}(fgui||(fgui={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._requestingCmd=0,i._uiSources=new Array,i.bringToFontOnClick=t.UIConfig.bringWindowToFrontOnClick,i._node.on(t.Event.TOUCH_BEGIN,i.onTouchBegin_1,i,!0),i}return __extends(i,e),i.prototype.addUISource=function(t){this._uiSources.push(t)},Object.defineProperty(i.prototype,"contentPane",{get:function(){return this._contentPane},set:function(e){this._contentPane!=e&&(this._contentPane&&this.removeChild(this._contentPane),this._contentPane=e,this._contentPane&&(this.addChild(this._contentPane),this.setSize(this._contentPane.width,this._contentPane.height),this._contentPane.addRelation(this,t.RelationType.Size),this._frame=this._contentPane.getChild("frame"),this._frame&&(this.closeButton=this._frame.getChild("closeButton"),this.dragArea=this._frame.getChild("dragArea"),this.contentArea=this._frame.getChild("contentArea"))))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"frame",{get:function(){return this._frame},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"closeButton",{get:function(){return this._closeButton},set:function(t){this._closeButton&&this._closeButton.offClick(this.closeEventHandler,this),this._closeButton=t,this._closeButton&&this._closeButton.onClick(this.closeEventHandler,this)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dragArea",{get:function(){return this._dragArea},set:function(e){this._dragArea!=e&&(this._dragArea&&(this._dragArea.draggable=!1,this._dragArea.off(t.Event.DRAG_START,this.onDragStart_1,this)),this._dragArea=e,this._dragArea&&(this._dragArea.draggable=!0,this._dragArea.on(t.Event.DRAG_START,this.onDragStart_1,this)))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"contentArea",{get:function(){return this._contentArea},set:function(t){this._contentArea=t},enumerable:!1,configurable:!0}),i.prototype.show=function(){t.GRoot.inst.showWindow(this)},i.prototype.showOn=function(t){t.showWindow(this)},i.prototype.hide=function(){this.isShowing&&this.doHideAnimation()},i.prototype.hideImmediately=function(){var e=this.parent instanceof t.GRoot?this.parent:null;e||(e=t.GRoot.inst),e.hideWindowImmediately(this)},i.prototype.centerOn=function(e,i){this.setPosition(Math.round((e.width-this.width)/2),Math.round((e.height-this.height)/2)),i&&(this.addRelation(e,t.RelationType.Center_Center),this.addRelation(e,t.RelationType.Middle_Middle))},i.prototype.toggleStatus=function(){this.isTop?this.hide():this.show()},Object.defineProperty(i.prototype,"isShowing",{get:function(){return null!=this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isTop",{get:function(){return this.parent&&this.parent.getChildIndex(this)==this.parent.numChildren-1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"modal",{get:function(){return this._modal},set:function(t){this._modal=t},enumerable:!1,configurable:!0}),i.prototype.bringToFront=function(){this.root.bringToFront(this)},i.prototype.showModalWait=function(e){null!=e&&(this._requestingCmd=e),t.UIConfig.windowModalWaiting&&(this._modalWaitPane||(this._modalWaitPane=t.UIPackage.createObjectFromURL(t.UIConfig.windowModalWaiting)),this.layoutModalWaitPane(),this.addChild(this._modalWaitPane))},i.prototype.layoutModalWaitPane=function(){if(this._contentArea){var t=this._frame.localToGlobal();t=this.globalToLocal(t.x,t.y,t),this._modalWaitPane.setPosition(t.x+this._contentArea.x,t.y+this._contentArea.y),this._modalWaitPane.setSize(this._contentArea.width,this._contentArea.height)}else this._modalWaitPane.setSize(this.width,this.height)},i.prototype.closeModalWait=function(t){return(null==t||this._requestingCmd==t)&&(this._requestingCmd=0,this._modalWaitPane&&this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane),!0)},Object.defineProperty(i.prototype,"modalWaiting",{get:function(){return this._modalWaitPane&&null!=this._modalWaitPane.parent},enumerable:!1,configurable:!0}),i.prototype.init=function(){if(!this._inited&&!this._loading)if(this._uiSources.length>0){this._loading=!1;for(var t=this._uiSources.length,e=0;e<t;e++){var i=this._uiSources[e];i.loaded||(i.load(this.__uiLoadComplete,this),this._loading=!0)}this._loading||this._init()}else this._init()},i.prototype.onInit=function(){},i.prototype.onShown=function(){},i.prototype.onHide=function(){},i.prototype.doShowAnimation=function(){this.onShown()},i.prototype.doHideAnimation=function(){this.hideImmediately()},i.prototype.__uiLoadComplete=function(){for(var t=this._uiSources.length,e=0;e<t;e++){if(!this._uiSources[e].loaded)return}this._loading=!1,this._init()},i.prototype._init=function(){this._inited=!0,this.onInit(),this.isShowing&&this.doShowAnimation()},i.prototype.dispose=function(){this.parent&&this.hideImmediately(),e.prototype.dispose.call(this)},i.prototype.closeEventHandler=function(t){this.hide()},i.prototype.onEnable=function(){e.prototype.onEnable.call(this),this._inited?this.doShowAnimation():this.init()},i.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.closeModalWait(),this.onHide()},i.prototype.onTouchBegin_1=function(t){this.isShowing&&this.bringToFontOnClick&&this.bringToFront()},i.prototype.onDragStart_1=function(e){t.GObject.cast(e.currentTarget).stopDrag(),this.startDrag(e.touchId)},i}(t.GComponent);t.Window=e}(fgui||(fgui={})),function(t){var e=function(){function e(){}return e.createAction=function(e){switch(e){case 0:return new t.PlayTransitionAction;case 1:return new t.ChangePageAction}return null},e.prototype.run=function(t,e,i){null!=this.fromPage&&0!=this.fromPage.length&&-1==this.fromPage.indexOf(e)||null!=this.toPage&&0!=this.toPage.length&&-1==this.toPage.indexOf(i)?this.leave(t):this.enter(t)},e.prototype.enter=function(t){},e.prototype.leave=function(t){},e.prototype.setup=function(t){var e,i;for(e=t.readShort(),this.fromPage=[],i=0;i<e;i++)this.fromPage[i]=t.readS();for(e=t.readShort(),this.toPage=[],i=0;i<e;i++)this.toPage[i]=t.readS()},e}();t.ControllerAction=e}(fgui||(fgui={})),function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.enter=function(e){if(this.controllerName){var i;if(this.objectId){var n=e.parent.getChildById(this.objectId);if(!(n instanceof t.GComponent))return;i=n}else i=e.parent;if(i){var o=i.getController(this.controllerName);o&&o!=e&&!o.changing&&("~1"==this.targetPage?e.selectedIndex<o.pageCount&&(o.selectedIndex=e.selectedIndex):"~2"==this.targetPage?o.selectedPage=e.selectedPage:o.selectedPageId=this.targetPage)}}},i.prototype.setup=function(t){e.prototype.setup.call(this,t),this.objectId=t.readS(),this.controllerName=t.readS(),this.targetPage=t.readS()},i}(t.ControllerAction);t.ChangePageAction=e}(fgui||(fgui={})),function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.playTimes=1,e.delay=0,e.stopOnExit=!1,e}return __extends(e,t),e.prototype.enter=function(t){var e=t.parent.getTransition(this.transitionName);e&&(this._currentTransition&&this._currentTransition.playing?e.changePlayTimes(this.playTimes):e.play(null,this.playTimes,this.delay),this._currentTransition=e)},e.prototype.leave=function(t){this.stopOnExit&&this._currentTransition&&(this._currentTransition.stop(),this._currentTransition=null)},e.prototype.setup=function(e){t.prototype.setup.call(this,e),this.transitionName=e.readS(),this.playTimes=e.readInt(),this.delay=e.readFloat(),this.stopOnExit=e.readBool()},e}(t.ControllerAction);t.PlayTransitionAction=e}(fgui||(fgui={})),function(t){(function(t){t[t.Normal=0]="Normal",t[t.None=1]="None",t[t.Add=2]="Add",t[t.Multiply=3]="Multiply",t[t.Screen=4]="Screen",t[t.Erase=5]="Erase",t[t.Mask=6]="Mask",t[t.Below=7]="Below",t[t.Off=8]="Off",t[t.Custom1=9]="Custom1",t[t.Custom2=10]="Custom2",t[t.Custom3=11]="Custom3"})(t.BlendMode||(t.BlendMode={}));var e=function(){function t(){}return t.apply=function(t,e){var n=i[e];t.getComponentsInChildren(cc.RenderComponent).forEach(function(t){t.srcBlendFactor=n[0],t.dstBlendFactor=n[1]})},t.override=function(t,e,n){i[t][0]=e,i[t][1]=n},t}();t.BlendModeUtils=e;var i=[[cc.macro.SRC_ALPHA,cc.macro.ONE_MINUS_SRC_ALPHA],[cc.macro.ONE,cc.macro.ONE],[cc.macro.SRC_ALPHA,cc.macro.ONE],[cc.macro.DST_COLOR,cc.macro.ONE_MINUS_SRC_ALPHA],[cc.macro.ONE,cc.macro.ONE_MINUS_SRC_COLOR],[cc.macro.ZERO,cc.macro.ONE_MINUS_SRC_ALPHA],[cc.macro.ZERO,cc.macro.SRC_ALPHA],[cc.macro.ONE_MINUS_DST_ALPHA,cc.macro.DST_ALPHA],[cc.macro.ONE,cc.macro.ZERO],[cc.macro.SRC_ALPHA,cc.macro.ONE_MINUS_SRC_ALPHA],[cc.macro.SRC_ALPHA,cc.macro.ONE_MINUS_SRC_ALPHA],[cc.macro.SRC_ALPHA,cc.macro.ONE_MINUS_SRC_ALPHA]]}(fgui||(fgui={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._flip=t.FlipType.None,i._fillMethod=t.FillMethod.None,i._fillOrigin=t.FillOrigin.Left,i._fillAmount=0,i}return __extends(i,e),Object.defineProperty(i.prototype,"flip",{get:function(){return this._flip},set:function(e){if(this._flip!=e){this._flip=e;var i=1,n=1;this._flip!=t.FlipType.Horizontal&&this._flip!=t.FlipType.Both||(i=-1),this._flip!=t.FlipType.Vertical&&this._flip!=t.FlipType.Both||(n=-1),1==i&&1==n||this.node.setAnchorPoint(.5,.5),this.node.setScale(i,n)}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillMethod",{get:function(){return this._fillMethod},set:function(t){this._fillMethod!=t&&(this._fillMethod=t,0!=this._fillMethod?(this.type=cc.Sprite.Type.FILLED,this._fillMethod<=3?this.fillType=this._fillMethod-1:this.fillType=cc.Sprite.FillType.RADIAL,this.fillCenter=new cc.Vec2(.5,.5),this.setupFill()):this.type=cc.Sprite.Type.SIMPLE)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillOrigin",{get:function(){return this._fillOrigin},set:function(t){this._fillOrigin!=t&&(this._fillOrigin=t,0!=this._fillMethod&&this.setupFill())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillClockwise",{get:function(){return this._fillClockwise},set:function(t){this._fillClockwise!=t&&(this._fillClockwise=t,0!=this._fillMethod&&this.setupFill())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillAmount",{get:function(){return this._fillAmount},set:function(t){this._fillAmount!=t&&(this._fillAmount=t,0!=this._fillMethod&&(this._fillClockwise?this.fillRange=-this._fillAmount:this.fillRange=this._fillAmount))},enumerable:!1,configurable:!0}),i.prototype.setupFill=function(){if(this._fillMethod==t.FillMethod.Horizontal||this._fillMethod==t.FillMethod.Vertical)this._fillClockwise=this._fillOrigin==t.FillOrigin.Right||this._fillOrigin==t.FillOrigin.Bottom,this.fillStart=this._fillClockwise?1:0;else switch(this._fillOrigin){case t.FillOrigin.Right:this.fillOrigin=0;break;case t.FillOrigin.Top:this.fillStart=.25;break;case t.FillOrigin.Left:this.fillStart=.5;break;case t.FillOrigin.Bottom:this.fillStart=.75}},Object.defineProperty(i.prototype,"grayed",{get:function(){return this._grayed},set:function(t){var e;this._grayed!=t&&(this._grayed=t,t?((e=this._graySpriteMaterial)||(e=cc.Material.getBuiltinMaterial("2d-gray-sprite")),e=this._graySpriteMaterial=cc.MaterialVariant.create(e,this)):((e=this._spriteMaterial)||(e=cc.Material.getBuiltinMaterial("2d-sprite",this)),e=this._spriteMaterial=cc.MaterialVariant.create(e,this)),this.setMaterial(0,e))},enumerable:!1,configurable:!0}),i}(cc.Sprite);t.Image=e}(fgui||(fgui={})),function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.interval=0,e.repeatDelay=0,e.timeScale=1,e._playing=!0,e._frameCount=0,e._frame=0,e._start=0,e._end=0,e._times=0,e._endAt=0,e._status=0,e._smoothing=!0,e._frameElapsed=0,e._reversed=!1,e._repeatedCount=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"frames",{get:function(){return this._frames},set:function(t){this._frames=t,this._frames?(this._frameCount=this._frames.length,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),(-1==this._endAt||this._endAt>this._frameCount-1)&&(this._endAt=this._frameCount-1),(this._frame<0||this._frame>this._frameCount-1)&&(this._frame=this._frameCount-1),this.type=cc.Sprite.Type.SIMPLE,this.drawFrame(),this._frameElapsed=0,this._repeatedCount=0,this._reversed=!1):this._frameCount=0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameCount",{get:function(){return this._frameCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame!=t&&(this._frames&&t>=this._frameCount&&(t=this._frameCount-1),this._frame=t,this._frameElapsed=0,this.drawFrame())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},set:function(t){this._playing!=t&&(this._playing=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"smoothing",{get:function(){return this._smoothing},set:function(t){this._smoothing=t},enumerable:!1,configurable:!0}),e.prototype.rewind=function(){this._frame=0,this._frameElapsed=0,this._reversed=!1,this._repeatedCount=0,this.drawFrame()},e.prototype.syncStatus=function(t){this._frame=t._frame,this._frameElapsed=t._frameElapsed,this._reversed=t._reversed,this._repeatedCount=t._repeatedCount,this.drawFrame()},e.prototype.advance=function(t){for(var e=this._frame,i=this._reversed,n=t;;){var o=this.interval+this._frames[this._frame].addDelay;if(0==this._frame&&this._repeatedCount>0&&(o+=this.repeatDelay),t<o){this._frameElapsed=0;break}if(t-=o,this.swing?this._reversed?(this._frame--,this._frame<=0&&(this._frame=0,this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=Math.max(0,this._frameCount-2),this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=0,this._repeatedCount++)),this._frame==e&&this._reversed==i){var r=n-t;t-=Math.floor(t/r)*r}}this.drawFrame()},e.prototype.setPlaySettings=function(t,e,i,n,o,r){void 0==t&&(t=0),void 0==e&&(e=-1),void 0==i&&(i=0),void 0==n&&(n=-1),this._start=t,this._end=e,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),this._times=i,this._endAt=n,-1==this._endAt&&(this._endAt=this._end),this._status=0,this._callback=o,this._callbackObj=r,this.frame=t},e.prototype.update=function(t){if(this._playing&&0!=this._frameCount&&3!=this._status){1!=this.timeScale&&(t*=this.timeScale),this._frameElapsed+=t;var e=this.interval+this._frames[this._frame].addDelay;if(0==this._frame&&this._repeatedCount>0&&(e+=this.repeatDelay),!(this._frameElapsed<e)){if(this._frameElapsed-=e,this._frameElapsed>this.interval&&(this._frameElapsed=this.interval),this.swing?this._reversed?(this._frame--,this._frame<=0&&(this._frame=0,this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=Math.max(0,this._frameCount-2),this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=0,this._repeatedCount++)),1==this._status)this._frame=this._start,this._frameElapsed=0,this._status=0;else if(2==this._status){if(this._frame=this._endAt,this._frameElapsed=0,this._status=3,null!=this._callback){var i=this._callback,n=this._callbackObj;this._callback=null,this._callbackObj=null,i.call(n)}}else this._frame==this._end&&(this._times>0?(this._times--,0==this._times?this._status=2:this._status=1):0!=this._start&&(this._status=1));this.drawFrame()}}},e.prototype.drawFrame=function(){if(this._frameCount>0&&this._frame<this._frames.length){var t=this._frames[this._frame];this.spriteFrame=t.texture}},e}(t.Image);t.MovieClip=e}(fgui||(fgui={})),function(t){var e=function(e){function n(t,i){var n=e.call(this,t,i)||this;return n.pos=new cc.Vec2,n.touchId=0,n.clickCount=0,n.button=0,n.keyModifiers=0,n.mouseWheelDelta=0,n}return __extends(n,e),Object.defineProperty(n.prototype,"isShiftDown",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isCtrlDown",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.captureTouch=function(){var e=t.GObject.cast(this.currentTarget);e&&this._processor.addTouchMonitor(this.touchId,e)},n._borrow=function(t,e){var o;return i.length?((o=i.pop()).type=t,o.bubbles=e):o=new n(t,e),o},n._return=function(t){t.initiator=null,t.touch=null,t.unuse(),i.push(t)},n.TOUCH_BEGIN="fui_touch_begin",n.TOUCH_MOVE="fui_touch_move",n.TOUCH_END="fui_touch_end",n.CLICK="fui_click",n.ROLL_OVER="fui_roll_over",n.ROLL_OUT="fui_roll_out",n.MOUSE_WHEEL="fui_mouse_wheel",n.DISPLAY="fui_display",n.UNDISPLAY="fui_undisplay",n.GEAR_STOP="fui_gear_stop",n.LINK="fui_text_link",n.Submit="editing-return",n.TEXT_CHANGE="text-changed",n.STATUS_CHANGED="fui_status_changed",n.XY_CHANGED="fui_xy_changed",n.SIZE_CHANGED="fui_size_changed",n.SIZE_DELAY_CHANGE="fui_size_delay_change",n.DRAG_START="fui_drag_start",n.DRAG_MOVE="fui_drag_move",n.DRAG_END="fui_drag_end",n.DROP="fui_drop",n.SCROLL="fui_scroll",n.SCROLL_END="fui_scroll_end",n.PULL_DOWN_RELEASE="fui_pull_down_release",n.PULL_UP_RELEASE="fui_pull_up_release",n.CLICK_ITEM="fui_click_item",n}(cc.Event);t.Event=e;var i=new Array}(fgui||(fgui={})),function(t){var e=function(){function t(t,e,i){this._data=t,this.offsetX=void 0==e?0:e,this.offsetY=void 0==i?0:i,this.scaleX=1,this.scaleY=1}return t.prototype.hitTest=function(t){var e=Math.floor((t.x/this.scaleX-this.offsetX)*this._data.scale),i=Math.floor((t.y/this.scaleY-this.offsetY)*this._data.scale);if(e<0||i<0||e>=this._data.pixelWidth)return!1;var n=i*this._data.pixelWidth+e,o=Math.floor(n/8),r=n%8;return o>=0&&o<this._data.pixels.length&&1==(this._data.pixels[o]>>r&1)},t}();t.PixelHitTest=e;var i=function(){return function(t){t.readInt(),this.pixelWidth=t.readInt(),this.scale=1/t.readByte(),this.pixels=t.readBuffer().data}}();t.PixelHitTestData=i;var n=function(){function t(t){this._child=t}return t.prototype.hitTest=function(t,e){return null!=this._child.hitTest(e,!1)},t}();t.ChildHitArea=n}(fgui||(fgui={})),function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._touches=new Array,t._rollOutChain=new Array,t._rollOverChain=new Array,t._touchPos=new cc.Vec2,t}return __extends(n,e),n.prototype.onLoad=function(){this._owner=this.node.$gobj},n.prototype.onEnable=function(){var t=this.node;t.on(cc.Node.EventType.TOUCH_START,this.touchBeginHandler,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveHandler,this),t.on(cc.Node.EventType.TOUCH_END,this.touchEndHandler,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancelHandler,this),t.on(cc.Node.EventType.MOUSE_DOWN,this.mouseDownHandler,this),t.on(cc.Node.EventType.MOUSE_MOVE,this.mouseMoveHandler,this),t.on(cc.Node.EventType.MOUSE_UP,this.mouseUpHandler,this),t.on(cc.Node.EventType.MOUSE_WHEEL,this.mouseWheelHandler,this),this._touchListener=this.node._touchListener},n.prototype.onDisable=function(){var t=this.node;t.off(cc.Node.EventType.TOUCH_START,this.touchBeginHandler,this),t.off(cc.Node.EventType.TOUCH_MOVE,this.touchMoveHandler,this),t.off(cc.Node.EventType.TOUCH_END,this.touchEndHandler,this),t.off(cc.Node.EventType.TOUCH_CANCEL,this.touchCancelHandler,this),t.off(cc.Node.EventType.MOUSE_DOWN,this.mouseDownHandler,this),t.off(cc.Node.EventType.MOUSE_MOVE,this.mouseMoveHandler,this),t.off(cc.Node.EventType.MOUSE_UP,this.mouseUpHandler,this),t.off(cc.Node.EventType.MOUSE_WHEEL,this.mouseWheelHandler,this),this._touchListener=null},n.prototype.getAllTouches=function(t){t=t||new Array;for(var e=this._touches.length,i=0;i<e;i++){var n=this._touches[i];-1!=n.touchId&&t.push(n.touchId)}return t},n.prototype.getTouchPosition=function(t){void 0===t&&(t=-1);for(var e=this._touches.length,i=0;i<e;i++){var n=this._touches[i];if(-1!=n.touchId&&(-1==t||n.touchId==t))return n.pos}return cc.Vec2.ZERO},n.prototype.getTouchTarget=function(){for(var t=this._touches.length,e=0;e<t;e++){var i=this._touches[e];if(-1!=i.touchId)return i.target}return null},n.prototype.addTouchMonitor=function(t,e){var i=this.getInfo(t,!1);i&&(-1==i.touchMonitors.indexOf(e)&&i.touchMonitors.push(e))},n.prototype.removeTouchMonitor=function(t){for(var e=this._touches.length,i=0;i<e;i++){var n=this._touches[i],o=n.touchMonitors.indexOf(t);-1!=o&&n.touchMonitors.splice(o,1)}},n.prototype.cancelClick=function(t){var e=this.getInfo(t,!1);e&&(e.clickCancelled=!0)},n.prototype.simulateClick=function(e){var i;(i=t.Event._borrow(t.Event.TOUCH_BEGIN,!0)).initiator=e,i.pos.set(e.localToGlobal()),i.touchId=0,i.clickCount=1,i.button=0,i._processor=this,this._captureCallback&&this._captureCallback.call(this._owner,i),e.node.dispatchEvent(i),i.unuse(),i.type=t.Event.TOUCH_END,i.bubbles=!0,e.node.dispatchEvent(i),i.unuse(),i.type=t.Event.CLICK,i.bubbles=!0,e.node.dispatchEvent(i),t.Event._return(i)},n.prototype.touchBeginHandler=function(e,i){var n=this.updateInfo(e.getID(),e.getLocation(),e);this._touchListener.setSwallowTouches(n.target!=this._owner),this.setBegin(n);var o=this.getEvent(n,n.target,t.Event.TOUCH_BEGIN,!0);return this._captureCallback&&this._captureCallback.call(this._owner,o),n.target.node.dispatchEvent(o),this.handleRollOver(n,n.target),!0},n.prototype.touchMoveHandler=function(e,i){var n=this.updateInfo(e.getID(),e.getLocation(),e);if(this.handleRollOver(n,n.target),n.began){for(var o=this.getEvent(n,n.target,t.Event.TOUCH_MOVE,!1),r=!1,a=n.touchMonitors.length,s=0;s<a;s++){var h=n.touchMonitors[s];null!=h.node&&h.node.activeInHierarchy&&(o.unuse(),o.type=t.Event.TOUCH_MOVE,h.node.dispatchEvent(o),h==this._owner&&(r=!0))}!r&&this.node&&(o.unuse(),o.type=t.Event.TOUCH_MOVE,this.node.dispatchEvent(o)),t.Event._return(o)}},n.prototype.touchEndHandler=function(e,i){var n=this.updateInfo(e.getID(),e.getLocation(),e);this.setEnd(n);for(var o=this.getEvent(n,n.target,t.Event.TOUCH_END,!1),r=n.touchMonitors.length,a=0;a<r;a++){var s=n.touchMonitors[a];s==n.target||null==s.node||!s.node.activeInHierarchy||s instanceof t.GComponent&&s.isAncestorOf(n.target)||(o.unuse(),o.type=t.Event.TOUCH_END,s.node.dispatchEvent(o))}n.touchMonitors.length=0,n.target&&n.target.node&&(n.target instanceof t.GRichTextField&&n.target.node.getComponent(cc.RichText)._onTouchEnded(o),o.unuse(),o.type=t.Event.TOUCH_END,o.bubbles=!0,n.target.node.dispatchEvent(o)),t.Event._return(o),n.target=this.clickTest(n),n.target&&(o=this.getEvent(n,n.target,t.Event.CLICK,!0),n.target.node.dispatchEvent(o),t.Event._return(o)),cc.sys.isMobile?this.handleRollOver(n,null):this.handleRollOver(n,n.target),n.target=null,n.touchId=-1,n.button=-1},n.prototype.touchCancelHandler=function(e,i){for(var n=this.updateInfo(e.getID(),e.getLocation(),e),o=this.getEvent(n,n.target,t.Event.TOUCH_END,!1),r=n.touchMonitors.length,a=0;a<r;a++){var s=n.touchMonitors[a];s==n.target||null==s.node||!s.node.activeInHierarchy||s instanceof t.GComponent&&s.isAncestorOf(n.target)||(o.initiator=s,s.node.dispatchEvent(o))}n.touchMonitors.length=0,n.target&&n.target.node&&(o.bubbles=!0,n.target.node.dispatchEvent(o)),t.Event._return(o),this.handleRollOver(n,null),n.target=null,n.touchId=-1,n.button=-1},n.prototype.mouseDownHandler=function(t){this.getInfo(0,!0).button=t.getButton()},n.prototype.mouseUpHandler=function(t){this.getInfo(0,!0).button=t.getButton()},n.prototype.mouseMoveHandler=function(e){var i=this.getInfo(0,!1);if(!(i&&Math.abs(i.pos.x-e.getLocationX())<1&&Math.abs(i.pos.y-(t.GRoot.inst.height-e.getLocationY()))<1)&&(i=this.updateInfo(0,e.getLocation()),this.handleRollOver(i,i.target),i.began)){for(var n=this.getEvent(i,i.target,t.Event.TOUCH_MOVE,!1),o=!1,r=i.touchMonitors.length,a=0;a<r;a++){var s=i.touchMonitors[a];null!=s.node&&s.node.activeInHierarchy&&(n.initiator=s,s.node.dispatchEvent(n),s==this._owner&&(o=!0))}!o&&this.node&&(n.initiator=this._owner,this.node.dispatchEvent(n),t.Event._return(n)),t.Event._return(n)}},n.prototype.mouseWheelHandler=function(e){var i=this.updateInfo(0,e.getLocation());i.mouseWheelDelta=Math.max(e.getScrollX(),e.getScrollY());var n=this.getEvent(i,i.target,t.Event.MOUSE_WHEEL,!0);i.target.node.dispatchEvent(n),t.Event._return(n)},n.prototype.updateInfo=function(e,i,n){var o=cc.Camera.findCamera(this.node);o?o.getScreenToWorldPoint(i,this._touchPos):this._touchPos.set(i),this._touchPos.y=t.GRoot.inst.height-this._touchPos.y;var r=this._owner.hitTest(this._touchPos);r||(r=this._owner);var a=this.getInfo(e);return a.target=r,a.pos.set(this._touchPos),a.button=cc.Event.EventMouse.BUTTON_LEFT,a.touch=n,a},n.prototype.getInfo=function(t,e){void 0===e&&(e=!0);for(var n=null,o=this._touches.length,r=0;r<o;r++){var a=this._touches[r];if(a.touchId==t)return a;-1==a.touchId&&(n=a)}if(!n){if(!e)return null;n=new i,this._touches.push(n)}return n.touchId=t,n},n.prototype.setBegin=function(t){t.began=!0,t.clickCancelled=!1,t.downPos.set(t.pos),t.downTargets.length=0;for(var e=t.target;e;)t.downTargets.push(e),e=e.findParent()},n.prototype.setEnd=function(e){e.began=!1;var i=t.ToolSet.getTime();i-e.lastClickTime<.45?2==e.clickCount?e.clickCount=1:e.clickCount++:e.clickCount=1,e.lastClickTime=i},n.prototype.clickTest=function(t){if(0==t.downTargets.length||t.clickCancelled||Math.abs(t.pos.x-t.downPos.x)>50||Math.abs(t.pos.y-t.downPos.y)>50)return null;var e=t.downTargets[0];if(e&&e.node&&e.node.activeInHierarchy)return e;for(e=t.target;e;){if(-1!=t.downTargets.indexOf(e)&&e.node&&e.node.activeInHierarchy)break;e=e.findParent()}return e},n.prototype.handleRollOver=function(e,i){if(e.lastRollOver!=i){for(var n=e.lastRollOver;n&&n.node;)this._rollOutChain.push(n),n=n.findParent();for(n=i;n&&n.node;){if(-1!=(r=this._rollOutChain.indexOf(n))){this._rollOutChain.length=r;break}this._rollOverChain.push(n),n=n.findParent()}e.lastRollOver=i;for(var o=this._rollOutChain.length,r=0;r<o;r++)if((n=this._rollOutChain[r]).node&&n.node.activeInHierarchy){var a=this.getEvent(e,n,t.Event.ROLL_OUT,!1);n.node.dispatchEvent(a),t.Event._return(a)}o=this._rollOverChain.length;for(r=0;r<o;r++)if((n=this._rollOverChain[r]).node&&n.node.activeInHierarchy){a=this.getEvent(e,n,t.Event.ROLL_OVER,!1);n.node.dispatchEvent(a),t.Event._return(a)}this._rollOutChain.length=0,this._rollOverChain.length=0}},n.prototype.getEvent=function(e,i,n,o){var r=t.Event._borrow(n,o);return r.initiator=i,r.touch=e.touch,r.pos.set(e.pos),r.touchId=e.touch?e.touch.getID():0,r.clickCount=e.clickCount,r.button=e.button,r.mouseWheelDelta=e.mouseWheelDelta,r._processor=this,r},n}(cc.Component);t.InputProcessor=e;var i=function(){return function(){this.pos=new cc.Vec2,this.touchId=0,this.clickCount=0,this.mouseWheelDelta=0,this.button=-1,this.downPos=new cc.Vec2,this.began=!1,this.clickCancelled=!1,this.lastClickTime=0,this.downTargets=new Array,this.touchMonitors=new Array}}()}(fgui||(fgui={})),function(t){var e,i=function(){function i(t){this._owner=t}return i.create=function(i,n){return e||(e=[t.GearDisplay,t.GearXY,t.GearSize,t.GearLook,t.GearColor,t.GearAnimation,t.GearText,t.GearIcon,t.GearDisplay2,t.GearFontSize]),new e[n](i)},i.prototype.dispose=function(){this._tweenConfig&&this._tweenConfig._tweener&&(this._tweenConfig._tweener.kill(),this._tweenConfig._tweener=null)},Object.defineProperty(i.prototype,"controller",{get:function(){return this._controller},set:function(t){t!=this._controller&&(this._controller=t,this._controller&&this.init())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"tweenConfig",{get:function(){return this._tweenConfig||(this._tweenConfig=new n),this._tweenConfig},enumerable:!1,configurable:!0}),i.prototype.setup=function(e){var i,o;this._controller=this._owner.parent.getControllerAt(e.readShort()),this.init();var r=e.readShort();if(this instanceof t.GearDisplay)this.pages=e.readSArray(r);else if(this instanceof t.GearDisplay2)this.pages=e.readSArray(r);else{for(i=0;i<r;i++)null!=(o=e.readS())&&this.addStatus(o,e);e.readBool()&&this.addStatus(null,e)}if(e.readBool()&&(this._tweenConfig=new n,this._tweenConfig.easeType=e.readByte(),this._tweenConfig.duration=e.readFloat(),this._tweenConfig.delay=e.readFloat()),e.version>=2)if(this instanceof t.GearXY){if(e.readBool()){for(this.positionsInPercent=!0,i=0;i<r;i++)null!=(o=e.readS())&&this.addExtStatus(o,e);e.readBool()&&this.addExtStatus(null,e)}}else this instanceof t.GearDisplay2&&(this.condition=e.readByte())},i.prototype.updateFromRelations=function(t,e){},i.prototype.addStatus=function(t,e){},i.prototype.init=function(){},i.prototype.apply=function(){},i.prototype.updateState=function(){},i}();t.GearBase=i;var n=function(){return function(){this.tween=!0,this.easeType=t.EaseType.QuadOut,this.duration=.3,this.delay=0}}();t.GearTweenConfig=n}(fgui||(fgui={})),function(t){var e=function(e){function i(t){return e.call(this,t)||this}return __extends(i,e),i.prototype.init=function(){this._default={playing:this._owner.getProp(t.ObjectPropID.Playing),frame:this._owner.getProp(t.ObjectPropID.Frame)},this._storage={}},i.prototype.addStatus=function(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.playing=e.readBool(),i.frame=e.readInt()},i.prototype.apply=function(){this._owner._gearLocked=!0;var e=this._storage[this._controller.selectedPageId];e||(e=this._default),this._owner.setProp(t.ObjectPropID.Playing,e.playing),this._owner.setProp(t.ObjectPropID.Frame,e.frame),this._owner._gearLocked=!1},i.prototype.updateState=function(){var e=this._storage[this._controller.selectedPageId];e||(this._storage[this._controller.selectedPageId]=e={}),e.playing=this._owner.getProp(t.ObjectPropID.Playing),e.frame=this._owner.getProp(t.ObjectPropID.Frame)},i}(t.GearBase);t.GearAnimation=e}(fgui||(fgui={})),function(t){var e=function(e){function i(t){return e.call(this,t)||this}return __extends(i,e),i.prototype.init=function(){this._default={color:this._owner.getProp(t.ObjectPropID.Color),strokeColor:this._owner.getProp(t.ObjectPropID.OutlineColor)},this._storage={}},i.prototype.addStatus=function(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.color=e.readColor(),i.strokeColor=e.readColor()},i.prototype.apply=function(){this._owner._gearLocked=!0;var e=this._storage[this._controller.selectedPageId];e||(e=this._default),this._owner.setProp(t.ObjectPropID.Color,e.color),this._owner.setProp(t.ObjectPropID.OutlineColor,e.strokeColor),this._owner._gearLocked=!1},i.prototype.updateState=function(){var e=this._storage[this._controller.selectedPageId];e||(this._storage[this._controller.selectedPageId]=e={}),e.color=this._owner.getProp(t.ObjectPropID.Color),e.strokeColor=this._owner.getProp(t.ObjectPropID.OutlineColor)},i}(t.GearBase);t.GearColor=e}(fgui||(fgui={})),function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i._displayLockToken=1,i._visible=0,i}return __extends(e,t),e.prototype.init=function(){this.pages=null},e.prototype.apply=function(){this._displayLockToken++,0==this._displayLockToken&&(this._displayLockToken=1),null==this.pages||0==this.pages.length||-1!=this.pages.indexOf(this._controller.selectedPageId)?this._visible=1:this._visible=0},e.prototype.addLock=function(){return this._visible++,this._displayLockToken},e.prototype.releaseLock=function(t){t==this._displayLockToken&&this._visible--},Object.defineProperty(e.prototype,"connected",{get:function(){return null==this._controller||this._visible>0},enumerable:!1,configurable:!0}),e}(t.GearBase);t.GearDisplay=e}(fgui||(fgui={})),function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i._visible=0,i}return __extends(e,t),e.prototype.init=function(){this.pages=null},e.prototype.apply=function(){null==this.pages||0==this.pages.length||-1!=this.pages.indexOf(this._controller.selectedPageId)?this._visible=1:this._visible=0},e.prototype.evaluate=function(t){var e=null==this._controller||this._visible>0;return e=0==this.condition?e&&t:e||t},e}(t.GearBase);t.GearDisplay2=e}(fgui||(fgui={})),function(t){var e=function(e){function i(t){var i=e.call(this,t)||this;return i._default=0,i}return __extends(i,e),i.prototype.init=function(){this._default=this._owner.getProp(t.ObjectPropID.FontSize),this._storage={}},i.prototype.addStatus=function(t,e){null==t?this._default=e.readInt():this._storage[t]=e.readInt()},i.prototype.apply=function(){this._owner._gearLocked=!0;var e=this._storage[this._controller.selectedPageId];void 0!=e?this._owner.setProp(t.ObjectPropID.FontSize,e):this._owner.setProp(t.ObjectPropID.FontSize,this._default),this._owner._gearLocked=!1},i.prototype.updateState=function(){this._storage[this._controller.selectedPageId]=this._owner.getProp(t.ObjectPropID.FontSize)},i}(t.GearBase);t.GearFontSize=e}(fgui||(fgui={})),function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.init=function(){this._default=this._owner.icon,this._storage={}},e.prototype.addStatus=function(t,e){null==t?this._default=e.readS():this._storage[t]=e.readS()},e.prototype.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];this._owner.icon=void 0!==t?t:this._default,this._owner._gearLocked=!1},e.prototype.updateState=function(){this._storage[this._controller.selectedPageId]=this._owner.icon},e}(t.GearBase);t.GearIcon=e}(fgui||(fgui={})),function(t){var e=function(e){function i(t){return e.call(this,t)||this}return __extends(i,e),i.prototype.init=function(){this._default={alpha:this._owner.alpha,rotation:this._owner.rotation,grayed:this._owner.grayed,touchable:this._owner.touchable},this._storage={}},i.prototype.addStatus=function(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.alpha=e.readFloat(),i.rotation=e.readFloat(),i.grayed=e.readBool(),i.touchable=e.readBool()},i.prototype.apply=function(){var e=this._storage[this._controller.selectedPageId];if(e||(e=this._default),this._tweenConfig&&this._tweenConfig.tween&&!t.UIPackage._constructing&&!t.GearBase.disableAllTweenEffect){if(this._owner._gearLocked=!0,this._owner.grayed=e.grayed,this._owner.touchable=e.touchable,this._owner._gearLocked=!1,this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==e.alpha&&this._tweenConfig._tweener.endValue.y==e.rotation)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var i=e.alpha!=this._owner.alpha,n=e.rotation!=this._owner.rotation;(i||n)&&(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=t.GTween.to2(this._owner.alpha,this._owner.rotation,e.alpha,e.rotation,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setUserData((i?1:0)+(n?2:0)).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}else this._owner._gearLocked=!0,this._owner.grayed=e.grayed,this._owner.touchable=e.touchable,this._owner.alpha=e.alpha,this._owner.rotation=e.rotation,this._owner._gearLocked=!1},i.prototype.__tweenUpdate=function(t){var e=t.userData;this._owner._gearLocked=!0,0!=(1&e)&&(this._owner.alpha=t.value.x),0!=(2&e)&&(this._owner.rotation=t.value.y),this._owner._gearLocked=!1},i.prototype.__tweenComplete=function(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null},i.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.alpha=this._owner.alpha,t.rotation=this._owner.rotation,t.grayed=this._owner.grayed,t.touchable=this._owner.touchable},i}(t.GearBase);t.GearLook=e}(fgui||(fgui={})),function(t){var e=function(e){function i(t){return e.call(this,t)||this}return __extends(i,e),i.prototype.init=function(){this._default={width:this._owner.width,height:this._owner.height,scaleX:this._owner.scaleX,scaleY:this._owner.scaleY},this._storage={}},i.prototype.addStatus=function(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.width=e.readInt(),i.height=e.readInt(),i.scaleX=e.readFloat(),i.scaleY=e.readFloat()},i.prototype.apply=function(){var e=this._storage[this._controller.selectedPageId];if(e||(e=this._default),this._tweenConfig&&this._tweenConfig.tween&&!t.UIPackage._constructing&&!t.GearBase.disableAllTweenEffect){if(this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==e.width&&this._tweenConfig._tweener.endValue.y==e.height&&this._tweenConfig._tweener.endValue.z==e.scaleX&&this._tweenConfig._tweener.endValue.w==e.scaleY)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var i=e.width!=this._owner.width||e.height!=this._owner.height,n=e.scaleX!=this._owner.scaleX||e.scaleY!=this._owner.scaleY;(i||n)&&(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=t.GTween.to4(this._owner.width,this._owner.height,this._owner.scaleX,this._owner.scaleY,e.width,e.height,e.scaleX,e.scaleY,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setUserData((i?1:0)+(n?2:0)).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}else this._owner._gearLocked=!0,this._owner.setSize(e.width,e.height,this._owner.gearXY.controller==this._controller),this._owner.setScale(e.scaleX,e.scaleY),this._owner._gearLocked=!1},i.prototype.__tweenUpdate=function(t){var e=t.userData;this._owner._gearLocked=!0,0!=(1&e)&&this._owner.setSize(t.value.x,t.value.y,this._owner.checkGearController(1,this._controller)),0!=(2&e)&&this._owner.setScale(t.value.z,t.value.w),this._owner._gearLocked=!1},i.prototype.__tweenComplete=function(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null},i.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.width=this._owner.width,t.height=this._owner.height,t.scaleX=this._owner.scaleX,t.scaleY=this._owner.scaleY},i.prototype.updateFromRelations=function(t,e){if(null!=this._controller&&null!=this._storage){for(var i in this._storage){var n=this._storage[i];n.width+=t,n.height+=e}this._default.width+=t,this._default.height+=e,this.updateState()}},i}(t.GearBase);t.GearSize=e}(fgui||(fgui={})),function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.init=function(){this._default=this._owner.text,this._storage={}},e.prototype.addStatus=function(t,e){null==t?this._default=e.readS():this._storage[t]=e.readS()},e.prototype.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];this._owner.text=void 0!==t?t:this._default,this._owner._gearLocked=!1},e.prototype.updateState=function(){this._storage[this._controller.selectedPageId]=this._owner.text},e}(t.GearBase);t.GearText=e}(fgui||(fgui={})),function(t){var e=function(e){function i(t){return e.call(this,t)||this}return __extends(i,e),i.prototype.init=function(){this._default={x:this._owner.x,y:this._owner.y,px:this._owner.x/this._owner.parent.width,py:this._owner.y/this._owner.parent.height},this._storage={}},i.prototype.addStatus=function(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.x=e.readInt(),i.y=e.readInt()},i.prototype.addExtStatus=function(t,e){var i;(i=null==t?this._default:this._storage[t]).px=e.readFloat(),i.py=e.readFloat()},i.prototype.apply=function(){var e,i,n=this._storage[this._controller.selectedPageId];if(n||(n=this._default),this.positionsInPercent&&this._owner.parent?(e=n.px*this._owner.parent.width,i=n.py*this._owner.parent.height):(e=n.x,i=n.y),this._tweenConfig&&this._tweenConfig.tween&&!t.UIPackage._constructing&&!t.GearBase.disableAllTweenEffect){if(this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==e&&this._tweenConfig._tweener.endValue.y==i)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var o=this._owner.x,r=this._owner.y;o==e&&r==i||(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=t.GTween.to2(o,r,e,i,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}else this._owner._gearLocked=!0,this._owner.setPosition(e,i),this._owner._gearLocked=!1},i.prototype.__tweenUpdate=function(t){this._owner._gearLocked=!0,this._owner.setPosition(t.value.x,t.value.y),this._owner._gearLocked=!1},i.prototype.__tweenComplete=function(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null},i.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.x=this._owner.x,t.y=this._owner.y,t.px=this._owner.x/this._owner.parent.width,t.py=this._owner.y/this._owner.parent.height},i.prototype.updateFromRelations=function(t,e){if(null!=this._controller&&null!=this._storage&&!this.positionsInPercent){for(var i in this._storage){var n=this._storage[i];n.x+=t,n.y+=e}this._default.x+=t,this._default.y+=e,this.updateState()}},i}(t.GearBase);t.GearXY=e}(fgui||(fgui={})),function(t){var e=.5*Math.PI,i=2*Math.PI;function n(t,e){return 1-o(e-t,e)}function o(t,e){return(t/=e)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function r(t,e){return t<.5*e?.5*n(2*t,e):.5*o(2*t-e,e)+.5}t.evaluateEase=function(a,s,h,l,c){switch(a){case t.EaseType.Linear:return s/h;case t.EaseType.SineIn:return 1-Math.cos(s/h*e);case t.EaseType.SineOut:return Math.sin(s/h*e);case t.EaseType.SineInOut:return-.5*(Math.cos(Math.PI*s/h)-1);case t.EaseType.QuadIn:return(s/=h)*s;case t.EaseType.QuadOut:return-(s/=h)*(s-2);case t.EaseType.QuadInOut:return(s/=.5*h)<1?.5*s*s:-.5*(--s*(s-2)-1);case t.EaseType.CubicIn:return(s/=h)*s*s;case t.EaseType.CubicOut:return(s=s/h-1)*s*s+1;case t.EaseType.CubicInOut:return(s/=.5*h)<1?.5*s*s*s:.5*((s-=2)*s*s+2);case t.EaseType.QuartIn:return(s/=h)*s*s*s;case t.EaseType.QuartOut:return-((s=s/h-1)*s*s*s-1);case t.EaseType.QuartInOut:return(s/=.5*h)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2);case t.EaseType.QuintIn:return(s/=h)*s*s*s*s;case t.EaseType.QuintOut:return(s=s/h-1)*s*s*s*s+1;case t.EaseType.QuintInOut:return(s/=.5*h)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2);case t.EaseType.ExpoIn:return 0==s?0:Math.pow(2,10*(s/h-1));case t.EaseType.ExpoOut:return s==h?1:1-Math.pow(2,-10*s/h);case t.EaseType.ExpoInOut:return 0==s?0:s==h?1:(s/=.5*h)<1?.5*Math.pow(2,10*(s-1)):.5*(2-Math.pow(2,-10*--s));case t.EaseType.CircIn:return-(Math.sqrt(1-(s/=h)*s)-1);case t.EaseType.CircOut:return Math.sqrt(1-(s=s/h-1)*s);case t.EaseType.CircInOut:return(s/=.5*h)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1);case t.EaseType.ElasticIn:var u;return 0==s?0:1==(s/=h)?1:(0==c&&(c=.3*h),l<1?(l=1,u=c/4):u=c/i*Math.asin(1/l),-l*Math.pow(2,10*(s-=1))*Math.sin((s*h-u)*i/c));case t.EaseType.ElasticOut:var p;return 0==s?0:1==(s/=h)?1:(0==c&&(c=.3*h),l<1?(l=1,p=c/4):p=c/i*Math.asin(1/l),l*Math.pow(2,-10*s)*Math.sin((s*h-p)*i/c)+1);case t.EaseType.ElasticInOut:var d;return 0==s?0:2==(s/=.5*h)?1:(0==c&&(c=h*(.3*1.5)),l<1?(l=1,d=c/4):d=c/i*Math.asin(1/l),s<1?l*Math.pow(2,10*(s-=1))*Math.sin((s*h-d)*i/c)*-.5:l*Math.pow(2,-10*(s-=1))*Math.sin((s*h-d)*i/c)*.5+1);case t.EaseType.BackIn:return(s/=h)*s*((l+1)*s-l);case t.EaseType.BackOut:return(s=s/h-1)*s*((l+1)*s+l)+1;case t.EaseType.BackInOut:return(s/=.5*h)<1?s*s*((1+(l*=1.525))*s-l)*.5:.5*((s-=2)*s*((1+(l*=1.525))*s+l)+2);case t.EaseType.BounceIn:return n(s,h);case t.EaseType.BounceOut:return o(s,h);case t.EaseType.BounceInOut:return r(s,h);default:return-(s/=h)*(s-2)}}}(fgui||(fgui={})),function(t){var e=function(){function t(){}return t.Linear=0,t.SineIn=1,t.SineOut=2,t.SineInOut=3,t.QuadIn=4,t.QuadOut=5,t.QuadInOut=6,t.CubicIn=7,t.CubicOut=8,t.CubicInOut=9,t.QuartIn=10,t.QuartOut=11,t.QuartInOut=12,t.QuintIn=13,t.QuintOut=14,t.QuintInOut=15,t.ExpoIn=16,t.ExpoOut=17,t.ExpoInOut=18,t.CircIn=19,t.CircOut=20,t.CircInOut=21,t.ElasticIn=22,t.ElasticOut=23,t.ElasticInOut=24,t.BackIn=25,t.BackOut=26,t.BackInOut=27,t.BounceIn=28,t.BounceOut=29,t.BounceInOut=30,t.Custom=31,t}();t.EaseType=e}(fgui||(fgui={})),function(t){var e=function(){function e(){this._segments=new Array,this._points=new Array}return Object.defineProperty(e.prototype,"length",{get:function(){return this._fullLength},enumerable:!1,configurable:!0}),e.prototype.create=function(e,n,o,r){var a;Array.isArray(e)?a=e:((a=new Array).push(e),a.push(n),o&&a.push(o),r&&a.push(r)),this._segments.length=0,this._points.length=0,this._fullLength=0;var s=a.length;if(0!=s){var h=i;h.length=0;var l=a[0];l.curveType==t.CurveType.CRSpline&&h.push(new cc.Vec2(l.x,l.y));for(var c=1;c<s;c++){var u=a[c];if(l.curveType!=t.CurveType.CRSpline){var p={};p.type=l.curveType,p.ptStart=this._points.length,l.curveType==t.CurveType.Straight?(p.ptCount=2,this._points.push(new cc.Vec2(l.x,l.y)),this._points.push(new cc.Vec2(u.x,u.y))):l.curveType==t.CurveType.Bezier?(p.ptCount=3,this._points.push(new cc.Vec2(l.x,l.y)),this._points.push(new cc.Vec2(u.x,u.y)),this._points.push(new cc.Vec2(l.control1_x,l.control1_y))):l.curveType==t.CurveType.CubicBezier&&(p.ptCount=4,this._points.push(new cc.Vec2(l.x,l.y)),this._points.push(new cc.Vec2(u.x,u.y)),this._points.push(new cc.Vec2(l.control1_x,l.control1_y)),this._points.push(new cc.Vec2(l.control2_x,l.control2_y))),p.length=t.ToolSet.distance(l.x,l.y,u.x,u.y),this._fullLength+=p.length,this._segments.push(p)}u.curveType!=t.CurveType.CRSpline?h.length>0&&(h.push(new cc.Vec2(u.x,u.y)),this.createSplineSegment()):h.push(new cc.Vec2(u.x,u.y)),l=u}h.length>1&&this.createSplineSegment()}},e.prototype.createSplineSegment=function(){var e=i,n=e.length;e.splice(0,0,e[0]),e.push(e[n]),e.push(e[n]),n+=3;var o={};o.type=t.CurveType.CRSpline,o.ptStart=this._points.length,o.ptCount=n,this._points=this._points.concat(e),o.length=0;for(var r=1;r<n;r++)o.length+=t.ToolSet.distance(e[r-1].x,e[r-1].y,e[r].x,e[r].y);this._fullLength+=o.length,this._segments.push(o),e.length=0},e.prototype.clear=function(){this._segments.length=0,this._points.length=0},e.prototype.getPointAt=function(e,i){i?i.x=i.y=0:i=new cc.Vec2,e=t.ToolSet.clamp01(e);var n,o=this._segments.length;if(0==o)return i;if(1==e)return(n=this._segments[o-1]).type==t.CurveType.Straight?(i.x=t.ToolSet.lerp(this._points[n.ptStart].x,this._points[n.ptStart+1].x,e),i.y=t.ToolSet.lerp(this._points[n.ptStart].y,this._points[n.ptStart+1].y,e),i):n.type==t.CurveType.Bezier||n.type==t.CurveType.CubicBezier?this.onBezierCurve(n.ptStart,n.ptCount,e,i):this.onCRSplineCurve(n.ptStart,n.ptCount,e,i);for(var r=e*this._fullLength,a=0;a<o;a++)if((r-=(n=this._segments[a]).length)<0){e=1+r/n.length,n.type==t.CurveType.Straight?(i.x=t.ToolSet.lerp(this._points[n.ptStart].x,this._points[n.ptStart+1].x,e),i.y=t.ToolSet.lerp(this._points[n.ptStart].y,this._points[n.ptStart+1].y,e)):i=n.type==t.CurveType.Bezier||n.type==t.CurveType.CubicBezier?this.onBezierCurve(n.ptStart,n.ptCount,e,i):this.onCRSplineCurve(n.ptStart,n.ptCount,e,i);break}return i},Object.defineProperty(e.prototype,"segmentCount",{get:function(){return this._segments.length},enumerable:!1,configurable:!0}),e.prototype.getAnchorsInSegment=function(t,e){null==e&&(e=new Array);for(var i=this._segments[t],n=0;n<i.ptCount;n++)e.push(new cc.Vec2(this._points[i.ptStart+n].x,this._points[i.ptStart+n].y));return e},e.prototype.getPointsInSegment=function(e,i,n,o,r,a){null==o&&(o=new Array),a&&!isNaN(a)||(a=.1),r&&r.push(i);var s=this._segments[e];if(s.type==t.CurveType.Straight)o.push(new cc.Vec2(t.ToolSet.lerp(this._points[s.ptStart].x,this._points[s.ptStart+1].x,i),t.ToolSet.lerp(this._points[s.ptStart].y,this._points[s.ptStart+1].y,i))),o.push(new cc.Vec2(t.ToolSet.lerp(this._points[s.ptStart].x,this._points[s.ptStart+1].x,n),t.ToolSet.lerp(this._points[s.ptStart].y,this._points[s.ptStart+1].y,n)));else{var h;h=s.type==t.CurveType.Bezier||s.type==t.CurveType.CubicBezier?this.onBezierCurve:this.onCRSplineCurve,o.push(h.call(this,s.ptStart,s.ptCount,i,new cc.Vec2));for(var l=Math.min(s.length*a,50),c=0;c<=l;c++){var u=c/l;u>i&&u<n&&(o.push(h.call(this,s.ptStart,s.ptCount,u,new cc.Vec2)),null!=r&&r.push(u))}o.push(h.call(this,s.ptStart,s.ptCount,n,new cc.Vec2))}return null!=r&&r.push(n),o},e.prototype.getAllPoints=function(t,e,i){null==t&&(t=new Array),i&&!isNaN(i)||(i=.1);for(var n=this._segments.length,o=0;o<n;o++)this.getPointsInSegment(o,0,1,t,e,i);return t},e.prototype.onCRSplineCurve=function(e,i,n,o){var r=Math.floor(n*(i-4))+e,a=this._points[r].x,s=this._points[r].y,h=this._points[r+1].x,l=this._points[r+1].y,c=this._points[r+2].x,u=this._points[r+2].y,p=this._points[r+3].x,d=this._points[r+3].y,f=1==n?1:t.ToolSet.repeat(n*(i-4),1),_=((2-f)*f-1)*f*.5,g=.5*((3*f-5)*f*f+2),m=((-3*f+4)*f+1)*f*.5,y=(f-1)*f*f*.5;return o.x=a*_+h*g+c*m+p*y,o.y=s*_+l*g+u*m+d*y,o},e.prototype.onBezierCurve=function(t,e,i,n){var o=1-i,r=this._points[t].x,a=this._points[t].y,s=this._points[t+1].x,h=this._points[t+1].y,l=this._points[t+2].x,c=this._points[t+2].y;if(4==e){var u=this._points[t+3].x,p=this._points[t+3].y;n.x=o*o*o*r+3*o*o*i*l+3*o*i*i*u+i*i*i*s,n.y=o*o*o*a+3*o*o*i*c+3*o*i*i*p+i*i*i*h}else n.x=o*o*r+2*o*i*l+i*i*s,n.y=o*o*a+2*o*i*c+i*i*h;return n},e}();t.GPath=e;var i=new Array}(fgui||(fgui={})),function(t){var e;(function(t){t[t.CRSpline=0]="CRSpline",t[t.Bezier=1]="Bezier",t[t.CubicBezier=2]="CubicBezier",t[t.Straight=3]="Straight"})(e=t.CurveType||(t.CurveType={}));var i=function(){function t(){this.x=0,this.y=0,this.control1_x=0,this.control1_y=0,this.control2_x=0,this.control2_y=0,this.curveType=0}return t.newPoint=function(e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var o=new t;return o.x=e,o.y=i,o.control1_x=0,o.control1_y=0,o.control2_x=0,o.control2_y=0,o.curveType=n,o},t.newBezierPoint=function(i,n,o,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0);var a=new t;return a.x=i,a.y=n,a.control1_x=o,a.control1_y=r,a.control2_x=0,a.control2_y=0,a.curveType=e.Bezier,a},t.newCubicBezierPoint=function(i,n,o,r,a,s){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===s&&(s=0);var h=new t;return h.x=i,h.y=n,h.control1_x=o,h.control1_y=r,h.control2_x=a,h.control2_y=s,h.curveType=e.CubicBezier,h},t.prototype.clone=function(){var e=new t;return e.x=this.x,e.y=this.y,e.control1_x=this.control1_x,e.control1_y=this.control1_y,e.control2_x=this.control2_x,e.control2_y=this.control2_y,e.curveType=this.curveType,e},t}();t.GPathPoint=i}(fgui||(fgui={})),function(t){var e=function(){function e(){}return e.to=function(e,i,n){return t.TweenManager.createTween()._to(e,i,n)},e.to2=function(e,i,n,o,r){return t.TweenManager.createTween()._to2(e,i,n,o,r)},e.to3=function(e,i,n,o,r,a,s){return t.TweenManager.createTween()._to3(e,i,n,o,r,a,s)},e.to4=function(e,i,n,o,r,a,s,h,l){return t.TweenManager.createTween()._to4(e,i,n,o,r,a,s,h,l)},e.toColor=function(e,i,n){return t.TweenManager.createTween()._toColor(e,i,n)},e.delayedCall=function(e){return t.TweenManager.createTween().setDelay(e)},e.shake=function(e,i,n,o){return t.TweenManager.createTween()._shake(e,i,n,o)},e.isTweening=function(e,i){return t.TweenManager.isTweening(e,i)},e.kill=function(e,i,n){t.TweenManager.killTweens(e,i,n)},e.getTween=function(e,i){return t.TweenManager.getTween(e,i)},e.catchCallbackExceptions=!0,e}();t.GTween=e}(fgui||(fgui={})),function(t){var e=function(){function e(){this._startValue=new t.TweenValue,this._endValue=new t.TweenValue,this._value=new t.TweenValue,this._deltaValue=new t.TweenValue,this._reset()}return e.prototype.setDelay=function(t){return this._delay=t,this},Object.defineProperty(e.prototype,"delay",{get:function(){return this._delay},enumerable:!1,configurable:!0}),e.prototype.setDuration=function(t){return this._duration=t,this},Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),e.prototype.setBreakpoint=function(t){return this._breakpoint=t,this},e.prototype.setEase=function(t){return this._easeType=t,this},e.prototype.setEasePeriod=function(t){return this._easePeriod=t,this},e.prototype.setEaseOvershootOrAmplitude=function(t){return this._easeOvershootOrAmplitude=t,this},e.prototype.setRepeat=function(t,e){return this._repeat=t,this._yoyo=e,this},Object.defineProperty(e.prototype,"repeat",{get:function(){return this._repeat},enumerable:!1,configurable:!0}),e.prototype.setTimeScale=function(t){return this._timeScale=t,this},e.prototype.setSnapping=function(t){return this._snapping=t,this},e.prototype.setTarget=function(e,i){return this._target=e,this._propType=i,e instanceof t.GObject?this._node=e.node:e instanceof cc.Node&&(this._node=e),this},Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!1,configurable:!0}),e.prototype.setPath=function(t){return this._path=t,this},e.prototype.setUserData=function(t){return this._userData=t,this},Object.defineProperty(e.prototype,"userData",{get:function(){return this._userData},enumerable:!1,configurable:!0}),e.prototype.onUpdate=function(t,e){return this._onUpdate=t,this._onUpdateCaller=e,this},e.prototype.onStart=function(t,e){return this._onStart=t,this._onStartCaller=e,this},e.prototype.onComplete=function(t,e){return this._onComplete=t,this._onCompleteCaller=e,this},Object.defineProperty(e.prototype,"startValue",{get:function(){return this._startValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endValue",{get:function(){return this._endValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deltaValue",{get:function(){return this._deltaValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedTime",{get:function(){return this._normalizedTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){return 0!=this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allCompleted",{get:function(){return 1==this._ended},enumerable:!1,configurable:!0}),e.prototype.setPaused=function(t){return this._paused=t,this},e.prototype.seek=function(t){if(!this._killed){if(this._elapsedTime=t,this._elapsedTime<this._delay){if(!this._started)return;this._elapsedTime=this._delay}this.update()}},e.prototype.kill=function(t){this._killed||(t&&(0==this._ended&&(this._breakpoint>=0?this._elapsedTime=this._delay+this._breakpoint:this._repeat>=0?this._elapsedTime=this._delay+this._duration*(this._repeat+1):this._elapsedTime=this._delay+2*this._duration,this.update()),this.callCompleteCallback()),this._killed=!0)},e.prototype._to=function(t,e,i){return this._valueSize=1,this._startValue.x=t,this._endValue.x=e,this._duration=i,this},e.prototype._to2=function(t,e,i,n,o){return this._valueSize=2,this._startValue.x=t,this._endValue.x=i,this._startValue.y=e,this._endValue.y=n,this._duration=o,this},e.prototype._to3=function(t,e,i,n,o,r,a){return this._valueSize=3,this._startValue.x=t,this._endValue.x=n,this._startValue.y=e,this._endValue.y=o,this._startValue.z=i,this._endValue.z=r,this._duration=a,this},e.prototype._to4=function(t,e,i,n,o,r,a,s,h){return this._valueSize=4,this._startValue.x=t,this._endValue.x=o,this._startValue.y=e,this._endValue.y=r,this._startValue.z=i,this._endValue.z=a,this._startValue.w=n,this._endValue.w=s,this._duration=h,this},e.prototype._toColor=function(t,e,i){return this._valueSize=4,this._startValue.color=t,this._endValue.color=e,this._duration=i,this},e.prototype._shake=function(t,e,i,n){return this._valueSize=5,this._startValue.x=t,this._startValue.y=e,this._startValue.w=i,this._duration=n,this},e.prototype._init=function(){this._delay=0,this._duration=0,this._breakpoint=-1,this._easeType=t.EaseType.QuadOut,this._timeScale=1,this._easePeriod=0,this._easeOvershootOrAmplitude=1.70158,this._snapping=!1,this._repeat=0,this._yoyo=!1,this._valueSize=0,this._started=!1,this._paused=!1,this._killed=!1,this._elapsedTime=0,this._normalizedTime=0,this._ended=0},e.prototype._reset=function(){this._target=null,this._propType=null,this._userData=null,this._node=null,this._path=null,this._onStart=this._onUpdate=this._onComplete=null,this._onStartCaller=this._onUpdateCaller=this._onCompleteCaller=null},e.prototype._update=function(t){if(!this._node||cc.isValid(this._node)){if(1!=this._timeScale&&(t*=this._timeScale),0!=t){if(0!=this._ended)return this.callCompleteCallback(),void(this._killed=!0);this._elapsedTime+=t,this.update(),0!=this._ended&&(this._killed||(this.callCompleteCallback(),this._killed=!0))}}else this._killed=!0},e.prototype.update=function(){if(this._ended=0,0!=this._valueSize){if(!this._started){if(this._elapsedTime<this._delay)return;if(this._started=!0,this.callStartCallback(),this._killed)return}var e=!1,n=this._elapsedTime-this._delay;if(this._breakpoint>=0&&n>=this._breakpoint&&(n=this._breakpoint,this._ended=2),0!=this._repeat){var o=Math.floor(n/this._duration);n-=this._duration*o,this._yoyo&&(e=o%2==1),this._repeat>0&&this._repeat-o<0&&(this._yoyo&&(e=this._repeat%2==1),n=this._duration,this._ended=1)}else n>=this._duration&&(n=this._duration,this._ended=1);if(this._normalizedTime=t.evaluateEase(this._easeType,e?this._duration-n:n,this._duration,this._easeOvershootOrAmplitude,this._easePeriod),this._value.setZero(),this._deltaValue.setZero(),5==this._valueSize)if(0==this._ended){var r=this._startValue.w*(1-this._normalizedTime),a=r*(Math.random()>.5?1:-1),s=r*(Math.random()>.5?1:-1);this._deltaValue.x=a,this._deltaValue.y=s,this._value.x=this._startValue.x+a,this._value.y=this._startValue.y+s}else this._value.x=this._startValue.x,this._value.y=this._startValue.y;else if(this._path){var h=i;this._path.getPointAt(this._normalizedTime,h),this._snapping&&(h.x=Math.round(h.x),h.y=Math.round(h.y)),this._deltaValue.x=h.x-this._value.x,this._deltaValue.y=h.y-this._value.y,this._value.x=h.x,this._value.y=h.y}else for(var l=0;l<this._valueSize;l++){var c=this._startValue.getField(l),u=c+(this._endValue.getField(l)-c)*this._normalizedTime;this._snapping&&(u=Math.round(u)),this._deltaValue.setField(l,u-this._value.getField(l)),this._value.setField(l,u)}if(null!=this._target&&null!=this._propType)if(this._propType instanceof Function)switch(this._valueSize){case 1:this._propType.call(this._target,this._value.x);break;case 2:this._propType.call(this._target,this._value.x,this._value.y);break;case 3:this._propType.call(this._target,this._value.x,this._value.y,this._value.z);break;case 4:this._propType.call(this._target,this._value.x,this._value.y,this._value.z,this._value.w);break;case 5:this._propType.call(this._target,this._value.color);break;case 6:this._propType.call(this._target,this._value.x,this._value.y)}else 5==this._valueSize?this._target[this._propType]=this._value.color:this._target[this._propType]=this._value.x;this.callUpdateCallback()}else this._elapsedTime>=this._delay+this._duration&&(this._ended=1)},e.prototype.callStartCallback=function(){if(null!=this._onStart)try{this._onStart.call(this._onStartCaller,this)}catch(t){console.log("FairyGUI: error in start callback > "+t)}},e.prototype.callUpdateCallback=function(){if(null!=this._onUpdate)try{this._onUpdate.call(this._onUpdateCaller,this)}catch(t){console.log("FairyGUI: error in update callback > "+t)}},e.prototype.callCompleteCallback=function(){if(null!=this._onComplete)try{this._onComplete.call(this._onCompleteCaller,this)}catch(t){console.log("FairyGUI: error in complete callback > "+t)}},e}();t.GTweener=e;var i=new cc.Vec2}(fgui||(fgui={})),function(t){var e,i=new Array(30),n=new Array,o=0,r=function(){function r(){}return r.createTween=function(){var a;return e||(e=new cc.Node("[TweenManager]"),cc.game.addPersistRootNode(e),cc.director.getScheduler().schedule(r.update,e,0,!1)),(a=n.length>0?n.pop():new t.GTweener)._init(),i[o++]=a,o==i.length&&(i.length=i.length+Math.ceil(.5*i.length)),a},r.isTweening=function(t,e){if(null==t)return!1;for(var n=null==e||void 0==e,r=0;r<o;r++){var a=i[r];if(a&&a.target==t&&!a._killed&&(n||a._propType==e))return!0}return!1},r.killTweens=function(t,e,n){if(null==t)return!1;for(var r=!1,a=o,s=null==n||void 0==n,h=0;h<a;h++){var l=i[h];!l||l.target!=t||l._killed||!s&&l._propType!=n||(l.kill(e),r=!0)}return r},r.getTween=function(t,e){if(null==t)return null;for(var n=o,r=null==e||void 0==e,a=0;a<n;a++){var s=i[a];if(s&&s.target==t&&!s._killed&&(r||s._propType==e))return s}return null},r.update=function(t){for(var e=i,r=o,a=-1,s=0;s<r;s++){var h=e[s];null==h?-1==a&&(a=s):h._killed?(h._reset(),n.push(h),e[s]=null,-1==a&&(a=s)):(h._paused||h._update(t),-1!=a&&(e[a]=h,e[s]=null,a++))}if(a>=0){if(o!=r){var l=r;for(r=o-r,s=0;s<r;s++)e[a++]=e[l++]}o=a}return!1},r}();t.TweenManager=r}(fgui||(fgui={})),function(t){var e=function(){function t(){this.x=this.y=this.z=this.w=0}return Object.defineProperty(t.prototype,"color",{get:function(){return(this.w<<24)+(this.x<<16)+(this.y<<8)+this.z},set:function(t){this.x=(16711680&t)>>16,this.y=(65280&t)>>8,this.z=255&t,this.w=(4278190080&t)>>24},enumerable:!1,configurable:!0}),t.prototype.getField=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("Index out of bounds: "+t)}},t.prototype.setField=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("Index out of bounds: "+t)}},t.prototype.setZero=function(){this.x=this.y=this.z=this.w=0},t}();t.TweenValue=e}(fgui||(fgui={})),function(t){var e=function(){function t(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this.version=0,-1==i&&(i=t.byteLength-e),this._bytes=new Uint8Array(t,e,i),this._view=new DataView(this._bytes.buffer,e,i),this._pos=0,this._length=i}return Object.defineProperty(t.prototype,"data",{get:function(){return this._bytes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._pos},set:function(t){if(t>this._length)throw"Out of bounds";this._pos=t},enumerable:!1,configurable:!0}),t.prototype.skip=function(t){this._pos+=t},t.prototype.validate=function(t){if(this._pos+t>this._length)throw"Out of bounds"},t.prototype.readByte=function(){return this.validate(1),this._view.getInt8(this._pos++)},t.prototype.readUbyte=function(){return this._bytes[this._pos++]},t.prototype.readBool=function(){return 1==this.readByte()},t.prototype.readShort=function(){this.validate(2);var t=this._view.getInt16(this._pos,this.littleEndian);return this._pos+=2,t},t.prototype.readUshort=function(){this.validate(2);var t=this._view.getUint16(this._pos,this.littleEndian);return this._pos+=2,t},t.prototype.readInt=function(){this.validate(4);var t=this._view.getInt32(this._pos,this.littleEndian);return this._pos+=4,t},t.prototype.readUint=function(){this.validate(4);var t=this._view.getUint32(this._pos,this.littleEndian);return this._pos+=4,t},t.prototype.readFloat=function(){this.validate(4);var t=this._view.getFloat32(this._pos,this.littleEndian);return this._pos+=4,t},t.prototype.readString=function(t){void 0==t&&(t=this.readUshort()),this.validate(t);for(var e="",i=this._pos+t,n=0,o=String.fromCharCode,r=this._bytes,a=this._pos;a<i;)(n=r[a++])<128?0!=n&&(e+=o(n)):e+=o(n<224?(63&n)<<6|127&r[a++]:n<240?(31&n)<<12|(127&r[a++])<<6|127&r[a++]:(15&n)<<18|(127&r[a++])<<12|r[a++]<<6&127|127&r[a++]),0;return this._pos+=t,e},t.prototype.readS=function(){var t=this.readUshort();return 65534==t?null:65533==t?"":this.stringTable[t]},t.prototype.readSArray=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this.readS();return e},t.prototype.writeS=function(t){var e=this.readUshort();65534!=e&&65533!=e&&(this.stringTable[e]=t)},t.prototype.readColor=function(t){var e=this.readUbyte(),i=this.readUbyte(),n=this.readUbyte(),o=this.readUbyte();return new cc.Color(e,i,n,t?o:255)},t.prototype.readChar=function(){var t=this.readUshort();return String.fromCharCode(t)},t.prototype.readBuffer=function(){var e=this.readUint();this.validate(e);var i=new t(this._bytes.buffer,this._bytes.byteOffset+this._pos,e);return i.stringTable=this.stringTable,i.version=this.version,this._pos+=e,i},t.prototype.seek=function(t,e){var i,n=this._pos;return this._pos=t,e<this.readByte()?(1==this.readByte()?(this._pos+=2*e,i=this.readUshort()):(this._pos+=4*e,i=this.readUint()),i>0?(this._pos=t+i,!0):(this._pos=n,!1)):(this._pos=n,!1)},t}();t.ByteBuffer=e}(fgui||(fgui={})),function(t){var e=function(){function t(t,e,i,o){this.matrix=new Array(n),this.reset(),void 0===t&&void 0===e&&void 0===i&&void 0===o||this.adjustColor(t,e,i,o)}return t.prototype.reset=function(){for(var t=0;t<n;t++)this.matrix[t]=i[t]},t.prototype.invert=function(){this.multiplyMatrix([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0])},t.prototype.adjustColor=function(t,e,i,n){this.adjustHue(n||0),this.adjustContrast(e||0),this.adjustBrightness(t||0),this.adjustSaturation(i||0)},t.prototype.adjustBrightness=function(t){t=255*this.cleanValue(t,1),this.multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0])},t.prototype.adjustContrast=function(t){var e=(t=this.cleanValue(t,1))+1,i=128*(1-e);this.multiplyMatrix([e,0,0,0,i,0,e,0,0,i,0,0,e,0,i,0,0,0,1,0])},t.prototype.adjustSaturation=function(t){t=this.cleanValue(t,1);var e=1-(t+=1),i=e*o,n=e*r,s=e*a;this.multiplyMatrix([i+t,n,s,0,0,i,n+t,s,0,0,i,n,s+t,0,0,0,0,0,1,0])},t.prototype.adjustHue=function(t){t=this.cleanValue(t,1),t*=Math.PI;var e=Math.cos(t),i=Math.sin(t);this.multiplyMatrix([o+e*(1-o)+i*-o,r+e*-r+i*-r,a+e*-a+i*(1-a),0,0,o+e*-o+.143*i,r+e*(1-r)+.14*i,a+e*-a+-.283*i,0,0,o+e*-o+i*-(1-o),r+e*-r+i*r,a+e*(1-a)+i*a,0,0,0,0,0,1,0])},t.prototype.concat=function(t){t.length==n&&this.multiplyMatrix(t)},t.prototype.clone=function(){var e=new t;return e.copyMatrix(this.matrix),e},t.prototype.copyMatrix=function(t){for(var e=n,i=0;i<e;i++)this.matrix[i]=t[i]},t.prototype.multiplyMatrix=function(t){for(var e=[],i=0,n=0;n<4;++n){for(var o=0;o<5;++o)e[i+o]=t[i]*this.matrix[o]+t[i+1]*this.matrix[o+5]+t[i+2]*this.matrix[o+10]+t[i+3]*this.matrix[o+15]+(4==o?t[i+4]:0);i+=5}this.copyMatrix(e)},t.prototype.cleanValue=function(t,e){return Math.min(e,Math.max(-e,t))},t}();t.ColorMatrix=e;var i=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],n=i.length,o=.299,r=.587,a=.114}(fgui||(fgui={})),function(t){var e=function(){function t(){this._readPos=0,this._handlers={},this._handlers.url=this.onTag_URL,this._handlers.img=this.onTag_IMG,this._handlers.b=this.onTag_Simple,this._handlers.i=this.onTag_Simple,this._handlers.u=this.onTag_Simple,this._handlers.color=this.onTag_COLOR,this._handlers.size=this.onTag_SIZE}return t.prototype.onTag_URL=function(t,e,i){if(e){n="";return this.linkColor&&(n+="</color>"),this.linkUnderline&&(n+="</u>"),n+="</on>"}var n=void 0;return n=null!=i?'<on click="onClickLink" param="'+i+'">':'<on click="onClickLink" param="'+this.getTagText()+'">',this.linkUnderline&&(n+="<u>"),this.linkColor&&(n+="<color="+this.linkColor+">"),n},t.prototype.onTag_IMG=function(t,e,i){if(e)return null;var n=this.getTagText(!0);return n?'<img src="'+n+'"/>':null},t.prototype.onTag_Simple=function(t,e,i){return e?"</"+t+">":"<"+t+">"},t.prototype.onTag_COLOR=function(t,e,i){return e?"</color>":(this.lastColor=i,"<color="+i+">")},t.prototype.onTag_FONT=function(t,e,i){return e?"</font>":'<font face="'+i+'">'},t.prototype.onTag_SIZE=function(t,e,i){return e?"</size>":(this.lastSize=i,"<size="+i+">")},t.prototype.getTagText=function(t){for(var e,i=this._readPos,n="";-1!=(e=this._text.indexOf("[",i));){if(92!=this._text.charCodeAt(e-1)){n+=this._text.substring(i,e);break}n+=this._text.substring(i,e-1),n+="[",i=e+1}return-1==e?null:(t&&(this._readPos=e),n)},t.prototype.parse=function(t,e){this._text=t,this.lastColor=null,this.lastSize=null;for(var i,n,o,r,a,s,h,l=0,c="";-1!=(i=this._text.indexOf("[",l));)if(i>0&&92==this._text.charCodeAt(i-1))c+=this._text.substring(l,i-1),c+="[",l=i+1;else{if(c+=this._text.substring(l,i),l=i,-1==(i=this._text.indexOf("]",l)))break;o="/"==this._text.charAt(l+1),r=this._text.substring(o?l+2:l+1,i),this._readPos=i+1,a=null,s=null,-1!=(n=r.indexOf("="))&&(a=r.substring(n+1),r=r.substring(0,n)),r=r.toLowerCase(),null!=(h=this._handlers[r])?null==(s=h.call(this,r,o,a))||e||(c+=s):c+=this._text.substring(l,this._readPos),l=this._readPos}return l<this._text.length&&(c+=this._text.substr(l)),this._text=null,c},t.inst=new t,t}();t.UBBParser=e}(fgui||(fgui={})),function(t){var e=function(){function t(){}return t.startsWith=function(t,e,i){return!!t&&(!(t.length<e.length)&&(t=t.substring(0,e.length),i?t.toLowerCase()==e.toLowerCase():t==e))},t.encodeHTML=function(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"):""},t.clamp=function(t,e,i){return t<e?t=e:t>i&&(t=i),t},t.clamp01=function(t){return t>1?t=1:t<0&&(t=0),t},t.lerp=function(t,e,i){return t+i*(e-t)},t.getTime=function(){return(new Date).getMilliseconds()/1e3},t.toGrayed=function(t){var e=.299*t.getR()+.587*t.getG()+.114*t.getB();return new cc.Color(e,e,e,t.getA())},t.repeat=function(t,e){return t-Math.floor(t/e)*e},t.distance=function(t,e,i,n){return Math.sqrt(Math.pow(t-i,2)+Math.pow(e-n,2))},t}();t.ToolSet=e}(fgui||(fgui={})),cc._RF.pop()},{}],fgui_root:[function(t,e,i){"use strict";cc._RF.push(e,"97ef5fgupRE57QoPpgsRcFI","fgui_root");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.FGUIRoot=void 0;var r=t("./base_ui"),a=t("./export_ui"),s=t("../game/repository"),h=t("./tip_ui"),l=t("../game/TrialPnl"),c=t("../game/Store"),u=t("../game/RevivePnl"),p=t("../game/ExportPnl"),d=t("../game/SignInPnl"),f=t("../game/TaskPnl"),_=t("../game/HomePnl"),g=t("../game/StoryPnl"),m=t("../game/ResultPnl"),y=t("../../util/global_def"),v=t("../game/PausePnl"),b=t("../game/ExportFriPnl"),C=t("../game/EndLayer"),S=t("../game/GamePnl"),w=t("../../game_logic"),x=t("../../util/event_mgr"),I=cc._decorator,P=I.ccclass,T=(I.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var i;return n(e,t),i=e,e.prototype.onLoad=function(){y.G.Game.hasInit||(y.G.Game.hasInit=!0,i.instance=this,fgui.addLoadHandler(),fgui.GRoot.create(),r.BaseUI.root=fgui.GRoot.inst,cc.game.addPersistRootNode(r.BaseUI.root.node),w.default.instance.eventManager.addListener(x.EventType.KLoadResOver,this._loadRes.bind(this)))},e.prototype._loadRes=function(){cc.loader.loadResArray([i.nativePath+"CommUI_atlas0",i.nativePath+"CommUI",i.nativePath+"HomeHUD",i.nativePath+"HDSDK"],this._onLoadCommUI.bind(this))},e.prototype._onLoadCommUI=function(t,e){if(e){fgui.UIPackage.addPackage(i.nativePath+"CommUI");var n=fgui.UIPackage.createObject("CommUI","Tip").asCom;n&&h.TipUI.instance.init(n),this._onLoadHDSDK(null)}},e.prototype._onLoadHomeHUD=function(t){var e="HomeHUD";fgui.UIPackage.addPackage(i.nativePath+e);var n=fgui.UIPackage.createObject(e,"homePnl").asCom;n&&_.default.instance.init(n);var o=fgui.UIPackage.createObject(e,"signInPnl").asCom;o&&d.SignInPnl.instance.init(o);var r=fgui.UIPackage.createObject(e,"storyPnl").asCom;r&&g.default.instance.init(r);var a=fgui.UIPackage.createObject(e,"repositoryPnl").asCom;a&&s.Repository.instance.init(a);var h=fgui.UIPackage.createObject(e,"storePnl").asCom;h&&c.Store.instance.init(h);var y=fgui.UIPackage.createObject(e,"trialPnl").asCom;y&&l.TrialPnl.instance.init(y);var w=fgui.UIPackage.createObject(e,"resultPnl").asCom;w&&m.default.instance.init(w);var x=fgui.UIPackage.createObject(e,"gamePnl").asCom;x&&S.default.instance.init(x);var I=fgui.UIPackage.createObject(e,"revivePnl").asCom;I&&u.RevivePnl.instance.init(I);var P=fgui.UIPackage.createObject(e,"exportPnl").asCom;P&&p.ExportPnl.instance.init(P);var T=fgui.UIPackage.createObject(e,"pausePnl").asCom;T&&v.default.instance.init(T);var k=fgui.UIPackage.createObject(e,"endLayer").asCom;k&&C.default.instance.init(k);var O=fgui.UIPackage.createObject(e,"exportFriPnl").asCom;O&&b.default.instance.init(O);var A=fgui.UIPackage.createObject(e,"taskPnl").asCom;A&&f.TaskPnl.instance.init(A)},e.prototype._onLoadHDSDK=function(t){t?console.error("[Load _onLoadHDSDK] err",t):(fgui.UIPackage.addPackage(i.nativePath+"HDSDK"),a.ExportUI.instance.init(),CC_WECHATGAME,this._onLoadHomeHUD(null))},e.instance=null,e.nativePath="fgui/",e=i=o([P],e)}(cc.Component));i.FGUIRoot=T,cc._RF.pop()},{"../../game_logic":"game_logic","../../util/event_mgr":"event_mgr","../../util/global_def":"global_def","../game/EndLayer":"EndLayer","../game/ExportFriPnl":"ExportFriPnl","../game/ExportPnl":"ExportPnl","../game/GamePnl":"GamePnl","../game/HomePnl":"HomePnl","../game/PausePnl":"PausePnl","../game/ResultPnl":"ResultPnl","../game/RevivePnl":"RevivePnl","../game/SignInPnl":"SignInPnl","../game/Store":"Store","../game/StoryPnl":"StoryPnl","../game/TaskPnl":"TaskPnl","../game/TrialPnl":"TrialPnl","../game/repository":"repository","./base_ui":"base_ui","./export_ui":"export_ui","./tip_ui":"tip_ui"}],findPath:[function(t,e,i){"use strict";cc._RF.push(e,"3f76dH9eC1GQKEWiN5FZRPd","findPath");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../util/global_def"),a=t("./enemy"),s=t("./lifeBase"),h=t("../scene/gameScene"),l=cc._decorator,c=l.ccclass;l.property;function u(t,e){window.hitObj;var i=64*t;if(null==window.hitObj[i])return null;var n=64*e;return window.hitObj[i][n]}var p=function(){function t(t,e){this.close=!1,this.x=0,this.y=0,this.links=null,this.linksLength=0,this.parent=null,this.G=0,this.F=0,this.J=0,this.next=null,this.pre=null,this.H=0,this.x=t,this.y=e}return t.prototype.addLinks=function(t,e,i,n,o,r){var a=this;this.links=[];var s=r,h=function(){a.y,a.x;null==u(a.x-1,a.y-1)?n+1<s&&a.addL(a.x-1,a.y,t,e,n+1):a.addL(a.x-1,a.y,t,e,0);a.y,a.x;null==u(a.x+1,a.y-1)?n+1<s&&a.addL(a.x+1,a.y,t,e,n+1):a.addL(a.x+1,a.y,t,e,0)},l=function(){if(n+1<s){a.y,a.x;null==u(a.x,a.y)?a.addL(a.x,a.y+1,t,e,n+1,!0):a.addL(a.x,a.y+1,t,e,0,!0)}a.y,a.x;null==u(a.x,a.y-2)?a.addL(a.x,a.y-1,t,e,n):a.addL(a.x,a.y-1,t,e,0)};o?(l(),h()):(h(),l())},t.prototype.addL=function(e,i,n,o,r,a){void 0===a&&(a=!1);var s=i+"*"+e;(null==u(e,i)||a)&&null==n[s]&&(n[s]=new t(e,i),n[s].J=r,this.links[this.links.length]=n[s],this.linksLength++)},t}(),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.path=[],e.mapArr={},e.hitObj=[],e.findMax=300,e.searchX=!1,e.maxJ=4,e.pw=r.G.Game.pw,e.ph=r.G.Game.ph,e.dir=cc.v2(0,0),e}return n(e,t),e.prototype.setMaxJ=function(t){this.maxJ=t},e.prototype.onLoad=function(){this.hitObj=window.hitObj},e.prototype.turnPos=function(t){return{x:Math.floor(t.x/this.pw),y:Math.ceil(t.y/this.ph)}},e.prototype.search=function(t){this.endPoint=this.turnPos(t);var e=this.node.x<h.default.instance.hero.x?1:-1,i=this.node.getComponent(s.default).Rect,n=this.node.x+window.flagPoint.x+e*i.width/2,o=this.node.y+window.flagPoint.y+50;this.startPoint=this.turnPos(cc.v2(n,o));var a=function(t){return null!=u(t.x,t.y-1)};if(this.endPoint.y>this.startPoint.y){for(var l=[],c=-1;c<=1;++c){var d={x:this.endPoint.x+c,y:this.endPoint.y};a(d)&&l.push(d)}if(0==l.length)return this.path=[],this.path;var f=r.G.randRange(0,l.length-1);this.endPoint=l[f]}else if(!a(this.endPoint))return this.path=[],this.path;if(this.startPoint.y-this.endPoint.y>0?this.searchX=!1:this.searchX=!0,null!=u(this.endPoint.x,this.endPoint.y))return this.path=[],this.path;this.mapArr={};var _,g,m,y,v,b,C,S=new p(this.startPoint.x,this.startPoint.y),w=new p(this.endPoint.x,this.endPoint.y),x=Math.abs(this.startPoint.x-this.endPoint.x)+Math.abs(this.startPoint.y-this.endPoint.y),I=[null,null];I[0]=S,S.close=!0,S.G=0;for(var P=0;;){if(++P>=this.findMax)return this.path=[],this.path;var T=I[0].parent;if(null!=T&&(this.dir=cc.v2(I[0].x-T.x,I[0].y-T.y)),v=I[0],I[0]=v.next,null!=I[0]&&(I[0].pre=null),v.x==w.x&&v.y==w.y)return this.path=[],this.prunePath(S,v),this.path;for(null==v.links&&v.addLinks(this.mapArr,this.hitObj,this.dir,v.J,this.searchX,this.maxJ),C=v.links,g=v.linksLength,_=0;_<g;_++)b=C[_],m=v.G+1,b.close?(null!=b.pre&&(b.pre.next=b.next),null!=b.next&&(b.next.pre=b.pre),I[1]==b&&(I[1]=b.next),b.parent=v,b.G=m,b.F=m+b.H,b.pre=null,b.next=I[0],null!=I[0]&&(I[0].pre=b),I[0]=b):(b.close=!0,b.parent=v,b.G=m,b.H=Math.abs(this.endPoint.x-b.x)+Math.abs(this.endPoint.y-b.y),m+=b.H,b.F=m,m=m-x>>1,b.next=I[m],b.pre=null,null!=I[m]&&(I[m].pre=b),I[m]=b);if(null==I[0]){if(null==I[1])return this.path=[],this.path;y=I[0],I[0]=I[1],I[1]=y,x+=2}}},e.prototype.prunePath=function(t,e){var i=this;if(this.startPoint.x!=this.endPoint.x||this.startPoint.y!=this.endPoint.y){this.node.getComponent(a.default).Rect;var n,o=e;for(o.x,e.x,o.y,e.y;;){var r=function(){var t=i.node.getComponent(s.default).Rect.width/2,e=o.x*i.pw,n=e.toString(),r=((o.y-1)*i.ph).toString(),a=window.hitObj,l=0,c=0,u=0,p=0,d=o.y*i.ph-window.flagPoint.y-i.ph;if(a[n]&&a[n][r]){var f=a[n][r][0];l=e>=f.x?e:f.x,(c=f.x+f.width)>=e+i.pw&&(c=e+i.pw),l%i.pw==0&&(u=t),c%i.pw==0&&l%i.pw==0&&(p=t),d=-f.y-window.flagPoint.y}else u=t,p=t,l=e,c=e+i.pw;var _=1;_=null!=o.parent&&o.x!=o.parent.x?o.x<o.parent.x?-1:1:i.node.x<h.default.instance.hero.x?1:-1;var g=p,m=c-window.flagPoint.x-p;return m<l-window.flagPoint.x&&(m=l-window.flagPoint.x,g=0),-1==_&&(g=u,(m=l-window.flagPoint.x+u)>c-window.flagPoint.x&&(m=c-window.flagPoint.x,g=0)),{pos:cc.v2(m,d),id:{x:o.x,y:o.y},j:o.J,d:_,ofx:g}};if(o.x==t.x&&o.y==t.y)return void(null!=u(o.x,o.y-1)&&(this.path[this.path.length]=r()));if(n=o.parent,o.x,o.y,0!=o.J)o=n;else{var l=r();0==this.path.length?null!=u(o.x,o.y-1)&&(this.path[this.path.length]=l):this.path[this.path.length]=l,o=n}}}},e=o([c],e)}(cc.Component);i.default=d,cc._RF.pop()},{"../../util/global_def":"global_def","../scene/gameScene":"gameScene","./enemy":"enemy","./lifeBase":"lifeBase"}],fire:[function(t,e,i){"use strict";cc._RF.push(e,"5d8c5Vj29hLDaeZ4LdhcaKq","fire");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../ItemInfo"),a=cc._decorator,s=a.ccclass,h=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this.node.getChildByName("lightBg").runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.fadeTo(1.5,200),cc.scaleTo(1.5,2)),cc.spawn(cc.fadeTo(1.5,100),cc.scaleTo(1.5,1)))))},e=o([s],e)}(r.default));i.default=h,cc._RF.pop()},{"../ItemInfo":"ItemInfo"}],food:[function(t,e,i){"use strict";cc._RF.push(e,"d6d293rsoxPLY/eEif/h2AU","food");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../lifeBase"),a=t("../../ItemInfo"),s=cc._decorator,h=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blood=20,e.run=!0,e}return n(e,t),e.prototype.onCollisionEnter=function(t,e){if(this.run){var i=t.node;if("hero"==i.group&&"hero"==i.name)i.getComponent(r.default).addBlood(this.blood),this.doDestroy()}},e.prototype.doDestroy=function(){},e=o([h],e)}(a.default));i.default=l,cc._RF.pop()},{"../../ItemInfo":"ItemInfo","../../lifeBase":"lifeBase"}],gameGuide:[function(t,e,i){"use strict";cc._RF.push(e,"1f712NEaZtAILTfSCSVvIit","gameGuide");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./gameScene"),a=t("./uiControl"),s=t("../../game_logic"),h=t("../../util/event_mgr"),l=t("../prefabs/lifeBase"),c=t("../prefabs/enemy"),u=t("../tools/wordFactory"),p=t("../prefabs/enemyAct/EnemyFactory"),d=t("../prefabs/enemyAct/cg_gun"),f=cc._decorator,_=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.step=0,e.game=null,e.ui=null,e.curEnemy=null,e.curCount=0,e}var i;return n(e,t),i=e,e.prototype.onLoad=function(){var t=this;i.instance=this,this.game=r.default.instance,this.ui=a.default.instance,this.addStep();var e=this;s.default.instance.eventManager.addListener(h.EventType.KGuide,function(i){if(t.curEnemy=i,0==e.curCount){var n=e.curEnemy.getComponent(l.default);e.curEnemy.addComponent(l.checkLimit),n.blood=30,t.schedule(function(){n.isDie&&(e.unscheduleAllCallbacks(),t.scheduleOnce(function(){e.game.addComponent(r.adjustMapCamera),e.game.openMap()},1))},.2,cc.macro.REPEAT_FOREVER,.2)}else if(1==e.curCount){var o=e.curEnemy.getComponent(l.default);e.curEnemy.addComponent(l.checkLimit),o.blood=10,e.curEnemy.removeComponent(c.enemyAct),e.curEnemy.removeComponent(p.hidAct),o.act=e.curEnemy.addComponent(d.stopAct),t.schedule(function(){o.isDie&&(e.unscheduleAllCallbacks(),t.scheduleOnce(function(){e.game.addComponent(r.adjustMapCamera),e.game.openMap()},1))},.2,cc.macro.REPEAT_FOREVER,.2)}e.curCount++}),CC_WECHATGAME},e.prototype.hideAllBtn=function(){a.default.instance.leftBtn.active=!1,a.default.instance.rightBtn.active=!1,a.default.instance.upBtn.active=!1,a.default.instance.attackBtn.active=!1},e.prototype.startBtn=function(t,e){e=e||this.stopBtn.bind(this),t.active=!0,t.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.7,120),cc.fadeTo(.7,255)))),t.once(cc.Node.EventType.TOUCH_START,e)},e.prototype.stopBtn=function(t){var e=t.target||t;e.stopAllActions(),e.opacity=255},e.prototype.addStep=function(){var t=this;switch(this.step++,this.step){case 1:this.scheduleOnce(function(){t.game.closeMap(-1,0)},2),this.hideAllBtn(),this.startBtn(this.ui.rightBtn,function(){t.stopBtn(t.ui.rightBtn),t.ui.leftBtn.active=!0}),this.scheduleOnce(function(){var e=t.game.map.getLayerNodeFun("before");u.default.instance.showDes("\u524d\u8fdb",cc.v3(430,377,0),e)},2.5);break;case 2:this.startBtn(this.ui.upBtn);var e=this.game.map.getLayerNodeFun("before");u.default.instance.showDes("\u8df3\u4e0a\u53bb~",cc.v3(1266,383,0),e);break;case 3:this.startBtn(this.ui.attackBtn),this.game.closeMap(2,0,200);e=this.game.map.getLayerNodeFun("before");u.default.instance.showDes("\u6218\u6597\u5f00\u59cb!",cc.v3(2055,321,0),e);break;case 4:this.startBtn(this.ui.rightBtn),this.game.closeMap(2,0,200);e=this.game.map.getLayerNodeFun("before");u.default.instance.showDes("\u6293\u4f4f\u654c\u4eba\u5f80\u540e\u629b",cc.v3(3141,336,0),e);break;case 5:this.game.closeMap(2,0,0)}},e.instance=null,e=i=o([_],e)}(cc.Component));i.default=g,cc._RF.pop()},{"../../game_logic":"game_logic","../../util/event_mgr":"event_mgr","../prefabs/enemy":"enemy","../prefabs/enemyAct/EnemyFactory":"EnemyFactory","../prefabs/enemyAct/cg_gun":"cg_gun","../prefabs/lifeBase":"lifeBase","../tools/wordFactory":"wordFactory","./gameScene":"gameScene","./uiControl":"uiControl"}],gameScene:[function(t,e,i){"use strict";cc._RF.push(e,"643bc/24J5Is7q2xnvhVSxo","gameScene");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.adjustMapCamera=i.gameSceneType=void 0;var r,a=t("../prefabs/hero"),s=t("../tools/resource_control"),h=t("../../util/effect/shaker"),l=t("../../util/global_def"),c=t("../prefabs/lifeBase"),u=t("../tools/storage_control"),p=t("../../game_logic"),d=t("../prefabs/enemyAct/EnemyFactory"),f=t("../prefabs/props/bigNodeManager"),_=t("../prefabs/ghost"),g=t("../../game_ui/game/GamePnl"),m=cc._decorator,y=m.ccclass,v=m.property;(function(t){t[t.common=0]="common",t[t.deathMath=1]="deathMath"})(r=i.gameSceneType||(i.gameSceneType={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ghostsp=null,e.bg=null,e.peakCamera=null,e.mapCamera=null,e.mapCameraCmp=null,e.mapNode=null,e.mapJsonName="cave0",e.heroPre=null,e.hero=null,e.weapon=null,e.fire=null,e.enemyManager=[],e.levelX=300,e.shake=null,e.archivePoint=null,e.listenerManager=[],e.gameOver=null,e.type=r.common,e.ad=null,e.origalPos=null,e.stopMapY=0,e.shaking=!1,e.runCamera=!1,e.scaCamera=0,e.easCamera=0,e.heroLimitLeft=null,e.heroLimitRight=null,e.cameraLimitLeft=null,e.cameraLimitRight=null,e}var i;return n(e,t),i=e,e.prototype.addBanner=function(){if(CC_WECHATGAME){var t=wx.getSystemInfoSync();null==this.ad&&(this.ad=wx.createBannerAd({adUnitId:l.G.bannerIDs[0],style:{left:.5*t.screenWidth-125,top:t.screenHeight-120,width:250}})),this.ad.show().then(function(t){}).catch(function(t){})}},e.prototype.addCollItem=function(){for(var t=0;t<20;++t){var e="f_"+String(t);this.map.isHit[e]=!0}var i=["f_1000","p_box0","p_platform+0","p_platform+1","p_platform+2","brige"];for(var n in i){e=i[n];this.map.isHit[e]=!0}var o=["f_2","f_3","f_4","f_5","f_7","f_8","f_9","f_10","f_11","f_12","f_13","f_14","f_15","f_16","f_17","f_18","f_19","f_20"];for(var n in o){var r=o[n];this.map.isTop[r]=!0}},e.prototype._init=function(t){void 0===t&&(t=!0),this.map.init(),this.archivePoint=u.default.instance.getJson("archivePoint",null),this.archivePoint&&t&&(this.map.flagPoint={x:Math.floor(this.archivePoint.x),y:Math.floor(this.archivePoint.y)}),window.flagPoint=this.map.flagPoint;var e=this;this.addCollItem(),this.map.Init=function(){window.runBo=!0;var t=e.map.getLayerNodeFun("floor_1");t&&(t.opacity=0),e.initHero(),e.fire.parent=null,e.fire.parent=e.hero.parent},d.default.instance=new d.default,this.map.onLoadSprite=function(t,i,n){var o=t.name[0];if("0"==o)e.map.removeMapNode(t.parent),d.default.instance.create(t);else if(("p"==o||"P"==o)&&0==t.children.length){var r=t.name.substr(2),a=r.indexOf("+");-1!=a&&(r=r.substr(0,a));var h=s.default.instance.getPrefabs(r);if(!h)return;var l=cc.instantiate(h);l.x=t.width/2;var c=1-l.anchorY;l.y=-t.height*c,l.parent=t,l.getComponent("ItemInfo").init(),l.getComponent("ItemInfo").persistent&&(e.map.NodeIdArr[n]=t,t.NodeId=n)}(t.width>250||t.height>250)&&(e.map.removeMapNode(t),null==t.getComponent(f.bigNode)&&t.addComponent(f.bigNode))},this.map._mapCameraNode=this.mapCamera,this.initShake(),this.mapCameraCmp=this.mapCamera.getComponent(cc.Camera),this.map.onLoadSpriteParent=function(t,e,i,n,o){for(var r=t.count.x,a=1;a<=r;++a){var s=n+a,h=this.nodeAllObj[e][s];this.addNodeChildFun(h[0],h[1]-this.flagPoint.x,h[2]-this.flagPoint.y,o,s)}}},e.prototype.initMap=function(t){var e=this;void 0===t&&(t=!0),s.default.instance.getMapData(this.mapJsonName,function(i){e.map.mapObj=i,e._init(t)})},e.prototype.onLoad=function(){var t=this;g.default.instance.show();var e=cc.instantiate(this.bg);e.getComponent("bg").getDir=function(){var e=t.hero.getComponent("hero");return e.inCollItem?0:e.lineVelocity.x<0?-1:1},e.parent=cc.director.getScene(),e.zIndex=-1,this.peakCamera=e.getChildByName("Peak Camera"),cc.director.getCollisionManager().enabled=!0,i.instance=this,window.game=this,this.map=this.mapNode.getComponent("Map");var n=-l.G.viewX/2-this.levelX,o=l.G.viewX/2+this.levelX;this.schedule(function(){for(var e in t.enemyManager){var i=t.enemyManager[e],r=i.node,a=i.parent,s=i.pos,h=t.mapCamera.convertToNodeSpaceAR(s);h.x>n&&h.x<o&&(r.parent=a,r.position=a.convertToNodeSpaceAR(s),t.enemyManager.splice(Number(e),1))}},.7,cc.macro.REPEAT_FOREVER,0)},e.prototype.initHero=function(){var t=this;this.hero=cc.instantiate(this.heroPre),l.G.Game.trialIds&&l.G.Game.trialIds.heroId?this.hero.getComponent("hero").init(l.G.Game.trialIds.heroId,!0):this.hero.getComponent("hero").init(a.heroType.Dan,!0);var e=cc.view.getVisibleSize().width,i=cc.v3(e/2,270,0),n=this.map.getLayerNodeFun("before");this.hero.parent=n,this.hero.position=i,this.origalPos=cc.v2(i.x,i.y);var o=this.node.addComponent(C),r=this.hero.convertToWorldSpaceAR(cc.v2(0,0));o.ofy=this.mapCamera.convertToNodeSpaceAR(r),o.ofy.y-=1,this.scheduleOnce(function(){t.closeMap(-1,0,0)},.5);var s=this.hero.getChildByName("camera").getComponent(cc.Camera);if(this.ghostsp.getComponent(_.default).setCamera(this.hero,s),l.G.Game.trialIds){var h=this.hero.getComponent(a.heroAct),c=l.G.Game.trialIds.products,u=l.G.Game.trialIds.weaponId;for(var p in c){var d=Number(c[p]);h.addWeapon(d,1e3)}u&&h.addWeapon(Number(u),1e3),l.G.Game.trialIds=null}},e.prototype.update=function(t){this.updCamera(),this.shake.update(t)},e.prototype.initShake=function(){this.shake=new h.default;var t=[this.mapCamera];this.shake.init(t,2,3,.05,.3,h.ShakeType.kVerReg),this.shake.appendAttenuation(.5,.1),this.shake.appendOverCallback(function(){i.instance.shaking=!1})},e.prototype.startShake=function(){this.shaking=!0;var t=this.mapCamera.getComponent(cc.Camera),e=[this.mapCamera];this.shake.init(e,2/t.zoomRatio,3/t.zoomRatio,.05,.2,h.ShakeType.kVerReg),this.shake.shake()},e.prototype.setCamera=function(t,e){this.runCamera=!0,this.scaCamera=t,this.easCamera=e},e.prototype.updCamera=function(){if(0!=this.runCamera){var t=this.scaCamera-this.mapCameraCmp.zoomRatio;Math.abs(t)<.01&&(this.mapCameraCmp.zoomRatio=this.scaCamera,this.runCamera=!1);var e=t*this.easCamera;this.mapCameraCmp.zoomRatio+=e}},e.prototype.closeMap=function(t,e,i){var n=this;void 0===e&&(e=100),void 0===i&&(i=100);var o=this.hero,r=o.getComponent(c.default).Rect.width,a=this.mapCamera,s=a.convertToWorldSpaceAR(cc.v2(0,0));s=o.parent.convertToNodeSpaceAR(s);var h=function(){n.heroLimitLeft=s.x-l.G.viewX/2-e+r/2,n.cameraLimitLeft=a.x-e},u=function(){n.heroLimitRight=s.x+l.G.viewX/2+i-r/2,n.cameraLimitRight=a.x+i};switch(t){case-1:h();break;case 1:u();break;case 2:h(),u()}return{left:this.heroLimitLeft-r/2,right:this.heroLimitRight+r/2}},e.prototype.openMap=function(){this.heroLimitLeft=null,this.heroLimitRight=null,this.cameraLimitLeft=null,this.cameraLimitRight=null},e.prototype.onDestroy=function(){g.default.instance.hide();for(var t in this.listenerManager){var e=this.listenerManager[t];p.default.instance.eventManager.removeListener(e.key,e.id)}},e.instance=null,o([v(cc.Node)],e.prototype,"ghostsp",void 0),o([v(cc.Prefab)],e.prototype,"bg",void 0),o([v(cc.Node)],e.prototype,"mapCamera",void 0),o([v(cc.Node)],e.prototype,"mapNode",void 0),o([v(cc.Prefab)],e.prototype,"heroPre",void 0),o([v(dragonBones.ArmatureDisplay)],e.prototype,"weapon",void 0),o([v(cc.Node)],e.prototype,"fire",void 0),e=i=o([y],e)}(cc.Component);i.default=b;var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ofy=null,e.game=null,e.easing=.1,e}return n(e,t),e.prototype.onLoad=function(){this.game=b.instance},e.prototype.update=function(){if(!this.game.shaking){var t=this.game.hero.position.sub(cc.v3(this.game.origalPos)),e=cc.v3(0).add(t);this.game.mapCamera.z=0;var i=e.sub(this.game.mapCamera.position);if(!(i.mag()<1)){if(1==this.game.stopMapY){var n=this.game.hero.convertToWorldSpaceAR(cc.v2(0,0));(n=this.game.mapCamera.convertToNodeSpaceAR(n)).y<this.ofy.y&&(this.game.stopMapY=0)}var o=this.game.hero.getComponent(c.default).lineVelocity.y;this.easing=Math.abs(o)/1e3*.4+.08,this.easing>.5&&(this.easing=.5);var r=i.mul(this.easing);r.y>5&&(r.y=5),this.game.stopMapY&&(r.y=0),this.game.mapCamera.position=this.game.mapCamera.position.add(r),this.game.peakCamera.x=this.game.peakCamera.x+r.x,this.game.cameraLimitLeft&&this.game.mapCamera.x<this.game.cameraLimitLeft&&(this.game.mapCamera.x=this.game.cameraLimitLeft,this.game.peakCamera.x=this.game.cameraLimitLeft),this.game.cameraLimitRight&&this.game.mapCamera.x>this.game.cameraLimitRight&&(this.game.mapCamera.x=this.game.cameraLimitRight,this.game.peakCamera.x=this.game.cameraLimitRight),this.game.map.setLocationFun(0,0)}}},e}(cc.Component),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.game=null,e}return n(e,t),e.prototype.onLoad=function(){this.game=b.instance,this.node.getComponent(C).enabled=!1},e.prototype.update=function(){var t=this.game.hero.position.sub(cc.v3(this.game.origalPos)),i=cc.v3(0).add(t);this.game.mapCamera.z=0;var n=i.sub(this.game.mapCamera.position);if(n.mag()<50)return this.node.getComponent(C).enabled=!0,void this.node.removeComponent(e);var o=n.normalize().mul(20);this.game.mapCamera.position=this.game.mapCamera.position.add(o),this.game.peakCamera.x=this.game.peakCamera.x+o.x,this.game.map.setLocationFun(0,0)},e}(cc.Component);i.adjustMapCamera=S,cc._RF.pop()},{"../../game_logic":"game_logic","../../game_ui/game/GamePnl":"GamePnl","../../util/effect/shaker":"shaker","../../util/global_def":"global_def","../prefabs/enemyAct/EnemyFactory":"EnemyFactory","../prefabs/ghost":"ghost","../prefabs/hero":"hero","../prefabs/lifeBase":"lifeBase","../prefabs/props/bigNodeManager":"bigNodeManager","../tools/resource_control":"resource_control","../tools/storage_control":"storage_control"}],game_logic:[function(t,e,i){"use strict";cc._RF.push(e,"a6eadC2Rd9Pl7V8Mmweg7fd","game_logic");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.GameMode=void 0;var r,a=t("./util/global_def"),s=t("./util/storage"),h=t("./util/event_mgr"),l=t("./util/audio_mgr"),c=t("./util/timed_task"),u=t("./game_ui/common/export_ui"),p=t("./data/data_hub"),d=t("./HDSDK"),f=t("./util/mgp_util"),_=t("./util/structure/hd_map"),g=t("./game/user_info/user_info"),m=cc._decorator,y=m.ccclass,v=m.property;(function(t){t[t.kMenu=0]="kMenu",t[t.kScene=1]="kScene"})(r=i.GameMode||(i.GameMode={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.intersTime=0,e.updFuncMap_=new _.HDMapT,e.config={export:1,sh2v:0,chk:0,adChk:0,bnrGap:15,bnrRefresh:4,videoBonus:100,bnrJumpProb:100,bnrClickCD:10,bnrClickSucTime:30,bnrClickCnt:4,forceNavProb:0,fakeBnrShow:1,fakeBtnClick:100,forceFakePageProb:50,directAward:0,v2sh:1,exportPageTypeProb:100,debug:0,testServer:0,framerate:60,proName:"HeroDan"},e.cfgJson_=null,e.gameEvtMgr_=null,e.timedTaskMgr_=null,e.exportUI_=null,e.sessionKey="",e.openId="",e.unionId="",e.gameId="",e.loginTime=0,e.gameMode=r.kMenu,e.loadResOver=!1,e.showWindowNum=100,e.shareCount=3,e.ip_switch=0,e.ip_switch_MP=0,e.sdkPopCount=100,e.InitSDK=!1,e.forceNum=100,e.bannerJump=100,e.bannerNear=0,e.forceSlideNum=100,e.adChk=1,e.wxNodeNum=0,e.clickNum=0,e.CDTime=20,e.bannerTime=30,e.useWxSDK=100,e.forceNavProb=0,e.forceFakePageProb=100,e.export=1,e.bLogined=!1,e.bannerTimeCount=0,e.clickImport=!1,e.hasBanner=!1,e.fpsSum_=0,e.frames_=0,e.bRecDt_=!1,e}var i;return n(e,t),i=e,e.prototype.init=function(){var t=this;CC_WECHATGAME&&(f.MgpUtil.fetchSdkInfo(),wx.tmSDK.login().then(function(e){console.log("[TMSDK] login",e),p.DataHub.loadBackendConfig(e.login_province+e.login_city),t.bLogined=!0}),wx.showShareMenu({withShareTicket:!1,success:function(t){},fail:function(){},complete:function(){}}),wx.tmSDK.onShareAppMessage(function(){return{scene:"forward",query:""}}))},e.prototype.onLoad=function(){if(f.MgpUtil.init(),a.G.viewX=cc.view.getVisibleSize().width,a.G.viewY=cc.view.getVisibleSize().height,g.GameUserInfo.read(),d.HDSDK.init("","test"),this.init(),a.G.BlendBanner(),i.instance=this,a.G.console("[game config]",1,this.config),cc.dynamicAtlasManager.enabled=!1,cc.game.addPersistRootNode(this.node),cc.game.setFrameRate(60),null==this.gameEvtMgr_&&(this.gameEvtMgr_=h.default.instance),this.gameEvtMgr_.init(),null==this.timedTaskMgr_&&(this.timedTaskMgr_=c.TimedTaskMgr.instance),this.timedTaskMgr_.clear(),null==this.exportUI_&&(this.exportUI_=u.ExportUI.instance),1==this.config.debug&&s.default.clearAllStorage(),this.loadData(),cc.sys.platform==cc.sys.WECHAT_GAME){var t=function(){return{title:"",imageUrl:"",query:""}}.bind(this);f.MgpUtil.showForward(t),wx.onAudioInterruptionEnd(function(){cc.audioEngine.pauseMusic(),cc.audioEngine.resumeMusic()}),wx.onShow(function(t){cc.director.resume(),l.AudioMgr.instance.stopEffects(),l.AudioMgr.instance.replayMusic(),a.G.console("onShow",1,t);(function(t){a.G.console("on show invite cb",t)}).bind(this);(f.MgpUtil.normShareResult(),this.bannerTimeCount>0)&&(Date.now()-this.bannerTimeCount<=1e3*this.bannerTime&&(a.G.bannerClick--,console.log("Banner \u5207\u524d\u53f0"+a.G.bannerClick),this.bannerTimeCount=0,a.G.hasClickBanner=!0,i.instance.scheduleOnce(function(){a.G.hasClickBanner=!1},10)))}.bind(this)),wx.onHide(function(t){cc.director.pause(),l.AudioMgr.instance.pauseMusic(),l.AudioMgr.instance.stopEffects(),f.MgpUtil.bannerStat(t)}.bind(this))}a.G.requestShareData()},e.prototype.start=function(){},e.prototype.log=function(){},e.prototype.loadData=function(){this.readData(),this.readWxData()},e.prototype.saveWxData=function(){var t={openId:this.openId,loginTime:this.loginTime};s.default.writeJSON(s.SaveDef.kWxStatus,t)},e.prototype.readWxData=function(){var t=s.default.readJSON(s.SaveDef.kWxStatus);t&&(this.openId=t.openId,this.loginTime=t.loginTime,console.log("read wx data",t))},e.prototype.saveData=function(){s.default.writeJSON(s.SaveDef.kGameData,{})},e.prototype.readData=function(){var t=s.default.readJSON(s.SaveDef.kGameData);a.G.isExistObj(t)},Object.defineProperty(e.prototype,"eventManager",{get:function(){return this.gameEvtMgr_},enumerable:!1,configurable:!0}),e.prototype.changeScene=function(t,e,i){h.default.instance.clear();cc.director.preloadScene(t,function(t,i,n){e&&e(t,i,n)},function(e){e?cc.log("change scene err",e):(a.G.console("changeScene over"),cc.director.loadScene(t,i),cc.sys.garbageCollect(),CC_WECHATGAME&&wx.triggerGC())})},e.prototype._execUpdFunc=function(t,e,i,n){i&&i(n)},e.prototype.update=function(t){if(this.intersTime--,this.gameEvtMgr_&&this.gameEvtMgr_.excuteEvents(),this.timedTaskMgr_&&this.timedTaskMgr_.excuteTasks(t),this.exportUI_&&this.exportUI_.update(t),this.updFuncMap_.each(this._execUpdFunc.bind(this),t),this.bRecDt_){if(t>0){var e=1/t;e>60&&(e=60),this.fpsSum_+=e}++this.frames_}},e.instance=null,o([v(cc.JsonAsset)],e.prototype,"config",void 0),e=i=o([y],e)}(cc.Component);i.default=b,cc._RF.pop()},{"./HDSDK":"HDSDK","./data/data_hub":"data_hub","./game/user_info/user_info":"user_info","./game_ui/common/export_ui":"export_ui","./util/audio_mgr":"audio_mgr","./util/event_mgr":"event_mgr","./util/global_def":"global_def","./util/mgp_util":"mgp_util","./util/storage":"storage","./util/structure/hd_map":"hd_map","./util/timed_task":"timed_task"}],game_setting:[function(t,e,i){"use strict";cc._RF.push(e,"3e6f7W5eylJW6QXQf8cxbSg","game_setting"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.debug=0,t.testServer=0,t.framerate=60,t.payment=0,t.proName="test",t.openId="",t.unionId="",t.sessionKey="",t.gameId="",t}();i.GameSetting=n,cc._RF.pop()},{}],ghost:[function(t,e,i){"use strict";cc._RF.push(e,"4af2fHQpmRO+KAzuF3f2MoO","ghost");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../util/global_def"),a=cc._decorator,s=a.ccclass,h=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ghostCanvasList=[],e.ghostComps=[],e.role=null,e.roleCamera=null,e.texture=null,e.running=!1,e}var i;return n(e,t),i=e,e.prototype.setCamera=function(t,e){this.role=t,this.roleCamera=e,this.init()},e.prototype.onLoad=function(){i.instance=this},e.prototype.init=function(){var t=this,e=this.role.zIndex;this.texture=new cc.RenderTexture,this.texture.initWithSize(r.G.viewX,r.G.viewY),this.roleCamera.targetTexture=this.texture;var i=new cc.SpriteFrame;i.setTexture(this.texture),this.ghostCanvasList.forEach(function(n,o){n.node.scaleY=-1,n.node.zIndex=e-o,n.node.opacity=200-50*o,n.spriteFrame=i,n.node.parent=null,n.node.parent=t.role.parent,n.node.active=!1,n.node.position=t.role.position;var r=n.addComponent(c);t.ghostComps.push(r)}),this.schedule(function(){if(t.running){var e=t.ghostComps.length,i=t;t.ghostComps.forEach(function(n,o){if(n.node.position.sub(t.role.position).mag()<1)return n.target=null,n.node.active=!1,void(o==e-1&&(i.running=!1));n.setTarget(.1*o+.1,t.role)})}},.1,cc.macro.REPEAT_FOREVER)},e.prototype.run=function(){this.running=!0;var t=this;this.ghostCanvasList.forEach(function(e,i){e.node.active=!0,e.node.position=t.role.position})},e.prototype.stop=function(){this.running=!1;this.ghostCanvasList.forEach(function(t,e){t.node.active=!1})},e.instance=null,o([h([cc.Sprite])],e.prototype,"ghostCanvasList",void 0),e=i=o([s],e)}(cc.Component);i.default=l;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vx=null,e.vy=null,e.target=null,e}return n(e,t),e.prototype.setTarget=function(t,e){this.target=e;var i=e.position.sub(this.node.position);this.vx=i.x/(60*t),this.vy=i.y/(60*t)},e.prototype.update=function(){this.target&&(this.node.x+=this.vx,this.node.y+=this.vy)},e}(cc.Component);cc._RF.pop()},{"../../util/global_def":"global_def"}],global_def:[function(t,e,i){"use strict";cc._RF.push(e,"cdef6H9LbZEe7LVSvFzVyrV","global_def"),Object.defineProperty(i,"__esModule",{value:!0}),i.G=void 0;t("./network/http_req");var n=t("../game_logic"),o=t("../game/tools/resource_control"),r=t("./mgp_util"),a=t("../data/data_hub"),s=t("../game_ui/game/ExportFriPnl"),h=function(){function t(){}return t.log=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];e&&e.length>0?console.log(t,e):console.log(t)},t.setMat=function(t,e){var i=t._components[0],n=o.default.instance.getMat(e),r=cc.MaterialVariant.create(n,i);i.setMaterial(0,r)},t.setPosYAsSysMenu=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),CC_WECHATGAME){var n=wx.getSystemInfoSync(),o=wx.getMenuButtonBoundingClientRect();console.log("\u53f3\u4e0a\u89d2",o);var r=cc.view.getVisibleSize(),a=null;0==e?a=r.height/2-o.top/n.screenHeight*r.height+i:1==e&&(console.log(t.name+"\u5e95\u90e8"+i),a=r.height/2-o.bottom/n.screenHeight*r.height+i),a&&(t.y=a),console.log(t.name+"\u65b0\u5750\u6807",t.y)}},t.onLoadRes=function(e,i){if(CC_WECHATGAME){t.totalPro=e.length,t.pro=0;var n=function(n){var o=e[n];cc.assetManager.loadBundle(o,function(e){if(console.log(e),e)return console.log(o+"\u4e0b\u8f7d\u5931\u8d25"),console.error(e);t.pro++,console.log(o+"\u4e0b\u8f7d\u6210\u529f"),t.pro>=t.totalPro&&(console.log("\u4e0b\u8f7d\u5b8c\u6bd5"),i())})};for(var o in e)n(o)}else i()},t.copyArr=function(t,e){for(var i in t){var n=t[i];e.push(n)}},t.rmFromArray=function(t,e){for(var i=0;i<e.length;++i)if(e[i]==t){e.splice(i,1);break}},t.createImage=function(t,e){cc.loader.load({url:t,type:"jpg"},function(t,i){t?cc.log(t):e.spriteFrame=new cc.SpriteFrame(i)})},t.readStr=function(t){for(var e=[],i="",n=0;n<t.length;n++)if(","!=t[n])i+=t[n];else{var o=Number(i);e.push(o),i=""}return e},t.isEmptyObj=function(t){if(t){if("object"!=typeof t)return!1;for(var e in t)return!1}return!0},t.isExistObj=function(t){return!this.isEmptyObj(t)},t.uniqueArray=function(t){return t.filter(function(t,e,i){return i.indexOf(t)===e})},t.uniqueArrayEx=function(t){var e={};return t.filter(function(t,i,n){return!e.hasOwnProperty(typeof t+JSON.stringify(t))&&(e[typeof t+JSON.stringify(t)]=!0)})},t.clampString=function(t,e,i){i=null==i?"...":i,e*=2;for(var n=function(t){for(var e=[],i=0,n=0,o=0;o<t.length;){var r=o;if(65039!=(i=t.charCodeAt(o++)))if(n){var a=65536+(n-55296<<10)+(i-56320);e.push({v:a,pos:r}),n=0}else 55296<=i&&i<=56319?n=i:e.push({v:i,pos:r})}return e}(t),o=0,r=0,a=0;a<n.length;++a){var s=1;if(n[a].v>=128&&(s=2),o+s>e)break;r=a,o+=s}if(n.length-1==r)return t;var h=i?1:0;return t.substring(0,n[r-h].pos+1)+i},t.isEqualF=function(t,e){var i=!1;return Math.abs(t-e)<=1e-6&&(i=!0),i},t.randRange=function(t,e){return Math.round(Math.random()*(e-t))+t},t.randRangeF=function(t,e,i){void 0===i&&(i=3);var n=Math.random()*(e-t)+t;return n=parseFloat(n.toFixed(i))},t.dispatchCustomEvent=function(e,i,n){var o=new cc.Event.EventCustom(i,!0);t.isEmptyObj(n)||o.setUserData(n),e.dispatchEvent(o)},t.readJson=function(t,e){cc.loader.loadRes(t,cc.JsonAsset,function(t,i){t?cc.log(t):(e&&e(i.json),cc.loader.release(i))})},t.readAudio=function(t,e,i,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1),cc.assetManager.loadBundle("audio",function(r,a){if(console.log(r),r)return console.log(t+"\u4e0b\u8f7d\u5931\u8d25"),console.error(r);a.load(t,cc.AudioClip,function(t,r){e&&e(r,i,n,o)})})},t.readImgAsSpFrm=function(t,e,i,n){cc.loader.loadRes(t,cc.SpriteFrame,function(t,o){t?cc.log(t):(e&&(e.getComponent(cc.Sprite).spriteFrame=o,e.getComponent(cc.Sprite).sizeMode=i||cc.Sprite.SizeMode.TRIMMED),n&&n(o))})},t.console=function(t,e){void 0===e&&(e=1);for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n]},t.findItem=function(t,e){for(var i in e){if(e[i]==t)return!0}return!1},t.BlendBanner=function(){for(var e=[0,1],i=[],n=0;n<2;++n){var o=e.length,r=t.randRange(0,o-1),a=e[r];i.push(t.bannerIDs[a]),e.splice(r,1)}t.bannerIDs=i},t.requestShareData=function(){},t.getSysTime=function(){var t=new Date;return Math.floor(t.getTime()/1e3)},t.turnTime=function(t){var e=String(Math.floor(t/3600)),i=String(Math.floor(t%3600/60)>=10?Math.floor(t%3600/60):"0"+Math.floor(t%3600/60)),n=String(Math.floor(t%3600%60)>=10?Math.floor(t%3600%60):"0"+Math.floor(t%3600%60));return(e="0"!=e?e+":":"")+(i="0"!=i?i+":":"")+(n=""!=n?n:"")},t.onShow=function(t){CC_WECHATGAME?wx.onShow(t):cc.game.on(cc.game.EVENT_SHOW,t,this)},t.onHide=function(t){CC_WECHATGAME?wx.onHide(t):cc.game.on(cc.game.EVENT_HIDE,t,this)},t.shareGame=function(e,i,n){if(CC_WECHATGAME){console.log("\u5f00\u59cb\u5206\u4eab");var o=t.randRange(0,t.shareData.length-1),a=JSON.parse(t.shareData[o]),s=a.title,h="https://huandong-1257458597.cos.ap-guangzhou.myqcloud.com/Canyou/share/"+a.img,l=i||function(){var t=n||"\u53d1\u9001\u5230\u4e0d\u540c\u7fa4\u624d\u80fd\u83b7\u5f97\u5956\u52b1";wx.showModal({title:"\u63d0\u793a",content:t,showCancel:!0,cancelText:"\u6b8b\u5fcd\u62d2\u7edd",cancelColor:"",confirmText:"\u518d\u8bd5\u4e00\u6b21",success:function(t){console.log("\u53c2\u6570",t),t.confirm&&r.MgpUtil.shareNorm(s,h,e,l)}})};r.MgpUtil.shareNorm(s,h,e,l)}else e()},t.ipSwitch=function(){return t.randRange(0,100)<n.default.instance.showWindowNum&&0==n.default.instance.ip_switch},t.isForceSlideNum=function(){return t.randRange(0,100)<n.default.instance.forceSlideNum&&0==n.default.instance.ip_switch},t.isCloseExport=function(){return n.default.instance.adChk&&1==n.default.instance.ip_switch_MP},t.isUserWxSDK=function(){return t.randRange(0,100)<n.default.instance.useWxSDK&&0==n.default.instance.ip_switch},t.navigateIcon=function(e,i,n,o){new Promise(function(t,e){var i=wx.navigateToMiniProgram;Object.defineProperty(wx,"navigateToMiniProgram",{writable:!0,value:function(e){var n=e.fail;e.fail=function(e){n&&n(e),t(e)},i(e)}}),Object.defineProperty(wx,"navigateToMiniProgram",{writable:!1})}).then(function(e){console.log("\u8df3\u8f6c\u5931\u8d25",e),o&&o(),s.default.instance.show(),t.isUserWxSDK()}),wx.tmSDK.flowNavigate({positionId:e,creativeId:i}).then(function(t){console.log("\u8df3\u8f6c\u6210\u529f"),n&&t&&n(t)})},t.touchIcon=function(e,i,n){var o=e.target.positionId,r=e.target.creativeId;console.log("\u8df3\u8f6c\u6570\u636e",o,r),null!=o&&null!=r&&t.navigateIcon(o,r,i,n)},t.setItemInfo=function(e,i,n,o){var r=e.getChildByName("image"),a=e.getChildByName("name"),s=e.getChildByName("bg");s.positionId=i.positionId,s.creativeId=i.creativeId;var h=r.getComponent(cc.Sprite);t.createImage(i.show_config.image,h),a.getComponent(cc.Label).string=i.show_config.title,null==s.touchFun&&(t.isForceSlideNum()?(s.touchFun=1,s.on(cc.Node.EventType.TOUCH_START,n)):(s.touchFun=1,s.on(cc.Node.EventType.TOUCH_END,n))),null==e.parent&&o.addChild(e)},t.getTmSdkData=function(t,e){CC_WECHATGAME&&wx.tmSDK.getFlowConfig({positionId:t}).then(function(t){console.log("\u731c\u4f60\u559c\u6b22nav list",t),e(t.creatives)})},Object.defineProperty(t,"isTMSDK",{get:function(){return"undefined"!=typeof wx&&void 0!==wx.tmSDK},enumerable:!1,configurable:!0}),t.isCanBannerJump=function(){return console.log("\u8bef\u70b9\u6982\u7387",a.DataHub.config.bnrJumpProb,a.DataHub.blockType,t.Game.bannerClickCount),a.DataHub.config.bnrJumpProb>0&&t.Game.bannerClickCount>0},t.bannerNodeJump=function(t,e){t.enabled=!1;var i=t.node,n=60+a.DataHub.config.bnrGap;i.y-=n,i.runAction(cc.sequence(cc.delayTime(1.5),cc.callFunc(function(){t.enabled=!0,e(),i.y+=n})))},t.novice=!1,t.loadResOver=!1,t.zIndex=0,t.loadOver=!1,t.bannerClick=2,t.layerZindex=1e3,t.totalPro=0,t.pro=null,t.viewX=null,t.viewY=null,t.ads=null,t.grds=null,t.Game={ExprotCb:{},trialHeroId:null,bannerClickCount:3,forceVideo:!1,vibrate:!0,trialIds:null,hasInit:!1,searchPathCount:1,enemyTypeCount:4,curHeroID:0,step:0,loadResOver:!1,loadAniOver:!1,isCanEnterGame:!1,pw:64,ph:64,GameType:1,refreshCount:0,level:0,realLevel:0,lastLevel:null,GameLevel:0,totalLevelNum:37,totalLevel:[],continue:!1,showLevel:0,power:10,weaponCount:5,Collidertag:{hero:1001,heroPoint:1002,enemy:1003}},t.Set={vibration:!0},t.GameCount=0,t.hasClickBanner=!1,t.newList=null,t.VideoIDs=["adunit-4edfa7b798ed9bbf"],t.bannerIDs=["adunit-146b5d26c74797d8","adunit-a7ac029096df366b"],t.insertIDs=["adunit-e57cc086193d4fcc"],t}();i.G=h,cc._RF.pop()},{"../data/data_hub":"data_hub","../game/tools/resource_control":"resource_control","../game_logic":"game_logic","../game_ui/game/ExportFriPnl":"ExportFriPnl","./mgp_util":"mgp_util","./network/http_req":"http_req"}],gun0:[function(t,e,i){"use strict";cc._RF.push(e,"6c772Pxz4NJ/q3KJ5pPOaZA","gun0");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./weapon"),a=t("../hero"),s=t("../../scene/gameScene"),h=t("../../tools/nodePool_control"),l=t("../../../util/global_def"),c=t("../../scene/uiControl"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="gun_1",e.weaponType=r.WeaponType.gun0,e.type=0,e.hide=null,e.iconImage="p_gun0",e.changeSlot="weapon_2",e.fireOffset=cc.v2(80,-10),e}return n(e,t),e.prototype.destroyAni=function(){var t=this,e=cc.instantiate(this.hide);e.getComponent("animation").reuse(1),e.parent=this.node.parent,e.position=this.node.position,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.scaleTo(.3,0),cc.callFunc(function(){t.node.destroy(),s.default.instance.map.removeMapNode(t.node.parent)})))},e.prototype.adjustGun=function(t,e){t.offset.scaleX=1,t.offset.scaleY=1,t.offset.x=25,t.offset.y=-3.8,e.invalidUpdate(null,!0)},e.prototype.changeImage=function(){var t=this.node.parent.getComponent(a.heroAct),e=this.name,i=t.entity.ani.armature(),n=i.getSlot(this.changeSlot);this.adjustGun(n,i);var o=dragonBones.CCFactory.getInstance(),r=s.default.instance.weapon.getArmatureKey(),h=s.default.instance.weapon.armatureName;o.replaceSlotDisplay(r,h,e,"\u6b66\u5668/"+e,n),c.default.instance.changeWeapIcon(this.iconImage)},e.prototype.fire=function(){var t=this,e=this.node.parent,i=e.getComponent(a.heroAct);i.entity.ani.playAnimation(i.aniName.aniKaiQiang_1,1);var n=i.getDir();s.default.instance.fire.scaleX=-n,s.default.instance.fire.x=e.x+this.fireOffset.x*n,s.default.instance.fire.y=e.y+this.fireOffset.y,s.default.instance.fire.runAction(cc.sequence(cc.fadeTo(.1,l.G.randRange(120,255)),cc.fadeOut(.1))),this.scheduleOnce(function(){var o=h.default.instance.getNode("bullet");o.parent=e.parent,o.x=e.x+t.fireOffset.x*n,o.y=e.y+t.fireOffset.y+l.G.randRange(-10,10),o.getComponent(r.default).fly(n),i.addWeapon(t.weaponType,-1)},.2)},o([d(cc.Prefab)],e.prototype,"hide",void 0),e=o([p],e)}(r.default);i.default=f,cc._RF.pop()},{"../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../../scene/uiControl":"uiControl","../../tools/nodePool_control":"nodePool_control","../hero":"hero","./weapon":"weapon"}],gun1:[function(t,e,i){"use strict";cc._RF.push(e,"dcaf7Bxa6BGh5H9agRT2vsE","gun1");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./weapon"),a=t("../hero"),s=t("../../scene/gameScene"),h=t("../../tools/nodePool_control"),l=t("../../../util/global_def"),c=t("./gun0"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="gun_0",e.weaponType=r.WeaponType.gun1,e.type=0,e.hide=null,e.iconImage="p_gun1",e.fireCount=0,e.fireOffset=cc.v2(65,-10),e}return n(e,t),e.prototype.destroyAni=function(){var t=this,e=cc.instantiate(this.hide);e.getComponent("animation").reuse(1),e.parent=this.node.parent,e.position=this.node.position,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.scaleTo(.3,0),cc.callFunc(function(){t.node.destroy(),s.default.instance.map.removeMapNode(t.node.parent)})))},e.prototype.adjustGun=function(t,e){t.offset.x=12,t.offset.y=-3.8,t.offset.scaleX=1.28,t.offset.scaleY=1.28,e.invalidUpdate(null,!0),this.fireCount=0},e.prototype.fire=function(){var t=this,e=this.node.parent,i=e.getComponent(a.heroAct),n=function(){i.entity.ani.playAnimation(i.aniName.aniKaiQiang_1,1);var n=i.getDir();s.default.instance.fire.scaleX=-n,s.default.instance.fire.x=e.x+t.fireOffset.x*n,s.default.instance.fire.y=e.y+t.fireOffset.y,s.default.instance.fire.runAction(cc.sequence(cc.fadeTo(.1,l.G.randRange(120,255)),cc.fadeOut(.1))),i.scheduleOnce(function(){var o=h.default.instance.getNode("bullet");o.parent=e.parent,o.x=e.x+t.fireOffset.x*n,o.y=e.y+t.fireOffset.y+l.G.randRange(-10,10),o.getComponent(r.default).fly(n),i.addWeapon(t.weaponType,-1)},.1)},o=0;this.fireCount++,this.fireCount%3==0&&(o=.3),i.scheduleOnce(function(){n()},o)},o([d(cc.Prefab)],e.prototype,"hide",void 0),e=o([p],e)}(c.default);i.default=f,cc._RF.pop()},{"../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../../tools/nodePool_control":"nodePool_control","../hero":"hero","./gun0":"gun0","./weapon":"weapon"}],hd_map:[function(t,e,i){"use strict";cc._RF.push(e,"c02b1oyS6JALrqGy/PLATtD","hd_map");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this.keys_=null,this.values_=null,this.keys_=new Array,this.values_=new Object}return t.prototype.keyLen=function(){return this.keys_.length},t.prototype.valueLen=function(){return this.values.length},t.prototype.copy=function(t){var e=t.keys_,i=t.values_;if(e)for(var n=0;n<e.length;++n)this.keys_[n]=e[n];if(i)for(var o in i)i.hasOwnProperty(o)&&(this.values_[o]=i[o])},t.prototype.toString=function(){for(var t="{ ",e=0,i=this.keys_.length;e<i;++e,t+=", "){var n=this.keys_[e];t+=n+" = "+this.values_[n]}return t=t.substring(0,t.length-1),t+=" }"},t.prototype.size=function(){return this.keys_.length},t.prototype.put=function(t,e){var i=t.toString();null==this.values_[i]?(this.values_[i]=e,this.keys_.push(i)):this.values_[i]=e},t.prototype.get=function(t){if(null==t);var e=t.toString();return this.values_[e]},t.prototype.getFirst=function(){var t=this.keys_[0];return this.values_[t]},t.prototype.getLast=function(){var t=this.keys_[this.keys_.length-1];return this.values_[t]},t.prototype.getByIndex=function(t){var e=null;if(t>=0&&t<this.keys_.length){var i=this.keys_[t];e=this.values_[i]}return e},t.prototype.remove=function(t){var e=t.toString(),i=this.indexOf(e);-1!=i&&this.keys_.splice(i,1),this.values_[e]=null},t.prototype.clear=function(){for(var t=0,e=this.keys_.length;t<e;++t)this.values_[this.keys_[t]]=null;this.keys_=[]},t.prototype.containsKey=function(t){var e=t.toString();return null!=this.values_[e]},t.prototype.isEmpty=function(){return 0===this.keys_.length},t.prototype.each=function(t,e){if(void 0===e&&(e=null),t)for(var i=0;i<this.keys_.length;++i){var n=this.keys_[i];t(i,n,this.values_[n],e)}},t.prototype.indexOf=function(t){var e=-1,i=this.size();if(i>0)for(var n=t.toString(),o=0,r=i;o<r;++o)if(this.keys_[o]==n){e=o;break}return e},t.prototype.values=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);for(var i=new Array,n=(e>0?Math.min(this.keys_.length,e):this.keys_.length)+t,o=t;o<n;++o)i.push(this.values_[this.keys_[o]]);return i},t.prototype.valuesByIndex=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);for(var i=new Array,n=(e>0?Math.min(this.keys_.length,e):this.keys_.length)+t,o=t;o<n;++o)i.push(this.values_[this.keys_[o]]);return i},t}();i.default=o;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.put=function(e,i){t.prototype.put.call(this,e,i)},e.prototype.get=function(t){var e=t.toString();return this.values_[e]},e.prototype.getFirst=function(){var t=this.keys_[0];return this.values_[t]},e.prototype.getLast=function(){var t=this.keys_[this.keys_.length-1];return this.values_[t]},e.prototype.getByIndex=function(t){var e=null;if(t>=0&&t<this.keys_.length){var i=this.keys_[t];e=this.values_[i]}return e},e.prototype.values=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);for(var i=new Array,n=(e>0?Math.min(this.keys_.length,e):this.keys_.length)+t,o=t;o<n;++o)i.push(this.values_[this.keys_[o]]);return i},e}(o);i.HDMapT=r,cc._RF.pop()},{}],heroLD:[function(t,e,i){"use strict";cc._RF.push(e,"d7923FWyfVC36by9BCYtdK6","heroLD");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../hero"),a=t("../../../util/audio_mgr"),s=t("../../tools/resource_control"),h=cc._decorator,l=h.ccclass,c=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heavy=1.5,e.speedMv=270,e.dataName="attack_1",e.originSc=.9,e.aniName={aniMv:"pao",aniJm:"tiao",aniIdle:"daiji",aniYiJi:"yiji",aniLianJi0:"lianji_0",aniLianJi1:"lianji_1",aniLianJi2:"lianji_2",aniLianJi3:"lianji_3",aniLianJi4:"lianji_4",aniXiaTi0:"xiati_0",aniXiaTi1:"xiati_1",aniShangTi:"shangti",aniXuLi0:"xuli_0",aniXuLi1:"xuli_1",aniXuLi2:"xuli_2",aniQinNa:"qinna",aniQinNa0_0:"qinna0_0",aniQinNa1_0:"qinna1_0",aniQinNa1_1:"qinna1_1",aniQinNa1_2:"qinna1_2",aniKaiQiang_0:"kaiqiang_0",aniKaiQiang_1:"kaiqiang_1",aniKaiQiang_2:"kaiqiang_2",aniTouZhi:"touzhi",aniHurt:"beida",aniFall:"siwang",aniDie:"daodi",aniReLife:"zhanqi"},e}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this);var e=this.entity.ani.armature();e.getBone("root").offset.y=-15,e.invalidUpdate(null,!0)},e.prototype.doLiJi=function(t){var e=this;0!=this.dir&&(this.node.scaleX=this.dir*this.originSc);var i="";t==r.actState.lianji0?(a.AudioMgr.instance.playHeroAtt1(),i=this.aniName.aniLianJi0):t==r.actState.lianji1?(a.AudioMgr.instance.playHeroAtt2(),i=this.aniName.aniLianJi1):t==r.actState.lianji2?(a.AudioMgr.instance.playHeroAtt3(),i=this.aniName.aniLianJi2,this.scheduleOnce(function(){e.jumping=!0,e.entity.lineVelocity.y=600},.2)):t==r.actState.lianji3&&(a.AudioMgr.instance.playHeroAtt4(),i=this.aniName.aniLianJi3),this.entity.ani.playAnimation(i,1);var n=this.getData(),o=n.t2,s=n.effect,h=n.t3,l=n.power+this.levelData[0]*n.powerUp,c=n.hurtEnemy;this.scheduleOnce(function(){e.point.setTartget(l,cc.v3(70,0,0),t,o,s,c)},h)},e.prototype.doQinNa1=function(t){var e=this,i="";if(t==r.actState.qinna1_0)a.AudioMgr.instance.playHeroAtt0(),i=this.aniName.aniQinNa1_0;else if(t==r.actState.qinna1_1)i=this.aniName.aniQinNa1_1;else if(t==r.actState.qinna1_2)this.scheduleOnce(function(){var t=e.getDir();e.entity.lineVelocity=cc.v2(200*-t,300),a.AudioMgr.instance.playAttFoot1(),e.entity.ani.timeScale=.5,e.scheduleOnce(function(){e.entity.ani.timeScale=1},1)},.1),this.entity.lineVelocity.y=300,i=this.aniName.aniQinNa1_2;else if(t==r.actState.qinna1_3)return this.entity.ani.timeScale=1,void this.setState(r.actState.idle);this.entity.ani.playAnimation(i,1);var n=this.getData(),o=n.t2,s=n.effect,h=n.t3,l=n.power+this.levelData[3]*n.powerUp,c=n.hurtEnemy;this.scheduleOnce(function(){e.point.setTartget(l,cc.v3(70,0,0),t,o,s,c,1)},h)},e.prototype.doXuLi0=function(t){this.entity.ani.playAnimation(this.aniName.aniXuLi0,-1);var e=s.default.instance.getPrefabs("xuli"),i=cc.instantiate(e);i.getComponent("animation").reuse(1),i.parent=this.node,a.AudioMgr.instance.playXuLi(),this.setMat("glowColor",cc.color(255,0,0)),this.setMat("glowColorSize",.1)},e.prototype.doXuLi1=function(t){var e=this;a.AudioMgr.instance.playHeroAtt3(),this.entity.ani.playAnimation(this.aniName.aniXuLi1,3);var i=this.getData(),n=i.t2,o=i.effect,r=(i.t3,i.power+this.levelData[4]*i.powerUp),s=i.hurtEnemy,h=-1;this.stateSchedule(function(){h=-h,e.point.setTartget(r,cc.v3(70*h,0,0),t,n,o,s,.5,.15)},.15,4,0),this.entity.lineVelocity.x=200*this.getDir(),this.stateScheduleOnce(function(){e.entity.lineVelocity.x=200*-e.getDir()},.55),this.setMat("glowColorSize",0)},e.prototype.doXuli2=function(t){return this.setState(r.actState.idle),!0},e.prototype.checkXiaTi=function(){return!(!this.jumping||this.state==r.actState.fallWater||this.state==r.actState.lianji2)},e=o([l],e)}(r.heroAct));i.default=c,cc._RF.pop()},{"../../../util/audio_mgr":"audio_mgr","../../tools/resource_control":"resource_control","../hero":"hero"}],heroLX:[function(t,e,i){"use strict";cc._RF.push(e,"11796HMY/RCeorMliMWAWac","heroLX");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../hero"),a=t("../../../util/audio_mgr"),s=t("../ghost"),h=t("../../tools/resource_control"),l=t("../../scene/gameScene"),c=cc._decorator,u=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speedMv=380,e.speedJm=850,e.dataName="attack_2",e.originSc=.9,e.aniName={aniMv:"pao",aniJm:"tiao",aniIdle:"daiji",aniYiJi:"yiji",aniLianJi0:"lianji_0",aniLianJi1:"lianji_1",aniLianJi2:"lianji_2",aniLianJi3:"lianji_3",aniLianJi4:"lianji_4",aniXiaTi0:"xiati_0",aniXiaTi1:"xiati_1",aniShangTi:"shangti",aniXuLi0:"xuli_0",aniXuLi1:"xuli_1",aniXuLi2:"xuli_2",aniQinNa:"qinna",aniQinNa0_0:"qinna0_0",aniQinNa1_0:"qinna1_0",aniQinNa1_1:"qinna1_1",aniQinNa1_2:"qinna1_2",aniKaiQiang_0:"kaiqiang_0",aniKaiQiang_1:"kaiqiang_1",aniKaiQiang_2:"kaiqiang_2",aniTouZhi:"touzhi",aniHurt:"beida",aniFall:"siwang",aniDie:"daodi",aniReLife:"zhanqi"},e}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this);var e=this.entity.ani.armature();e.getBone("root").offset.y=-10,e.invalidUpdate(null,!0)},e.prototype.doLiJi=function(t){var e=this;0!=this.dir&&(this.node.scaleX=this.dir*this.originSc);var i="";t==r.actState.lianji0?(a.AudioMgr.instance.playHeroAtt1(),i=this.aniName.aniLianJi0):t==r.actState.lianji1?(a.AudioMgr.instance.playHeroAtt2(),i=this.aniName.aniLianJi1):t==r.actState.lianji2?(a.AudioMgr.instance.playHeroAtt3(),i=this.aniName.aniLianJi2,this.scheduleOnce(function(){e.entity.lineVelocity.x=100*e.getDir(),e.entity.lineVelocity.y=650,l.default.instance.stopMapY=1,e.jumping=!0,e.scheduleOnce(function(){e.entity.lineVelocity.x=0},.2),s.default.instance.run(),e.scheduleOnce(function(){s.default.instance.stop()},.5)},.1)):t==r.actState.lianji3&&(a.AudioMgr.instance.playHeroAtt4(),i=this.aniName.aniLianJi3),this.entity.ani.playAnimation(i,1);var n=this.getData(),o=n.t2,h=n.effect,c=n.t3,u=n.power+this.levelData[0]*n.powerUp,p=n.hurtEnemy;this.scheduleOnce(function(){e.point.setTartget(u,cc.v3(70,0,0),t,o,h,p)},c)},e.prototype.doXuLi0=function(t){this.entity.ani.playAnimation(this.aniName.aniXuLi0,-1);var e=h.default.instance.getPrefabs("xuli"),i=cc.instantiate(e);i.getComponent("animation").reuse(1),i.parent=this.node,a.AudioMgr.instance.playXuLi(),this.setMat("glowColor",cc.color(106,90,205)),this.setMat("glowColorSize",.1)},e.prototype.doXuLi1=function(t){var e=this;a.AudioMgr.instance.playHeroAtt3(),this.entity.ani.playAnimation(this.aniName.aniXuLi1,1);var i=this.getData(),n=i.t2,o=i.effect,r=(i.t3,i.power+this.levelData[4]*i.powerUp),s=i.hurtEnemy;this.scheduleOnce(function(){e.point.setTartget(r,cc.v3(70,0,0),t,n,o,s,1,.5)},0)},e.prototype.doXuli2=function(t){var e=this;return this.entity.lineVelocity.x=1e3*this.getDir(),s.default.instance.run(),this.scheduleOnce(function(){e.entity.lineVelocity.x=0,e.setMat("glowColorSize",0)},.25),this.scheduleOnce(function(){e.setState(r.actState.idle),s.default.instance.stop()},.5),!1},e.prototype.doQinNa0=function(t){var e=this;this.entity.ani.playAnimation(this.aniName.aniQinNa0_0,1);var i=this.getData(),n=i.t2,o=i.effect,r=(i.t3,i.power+this.levelData[3]*i.powerUp),a=i.hurtEnemy;this.entity.lineVelocity.y=300,this.scheduleOnce(function(){e.point.setTartget(r,cc.v3(70,0,0),t,n,o,a,1)},0)},e.prototype.doQinNa1=function(t){var e=this,i="";if(t==r.actState.qinna1_0)a.AudioMgr.instance.playHeroAtt0(),i=this.aniName.aniQinNa1_0;else if(t==r.actState.qinna1_1)i=this.aniName.aniQinNa1_1;else if(t==r.actState.qinna1_2)i=this.aniName.aniQinNa1_2;else if(t==r.actState.qinna1_3)return void this.setState(r.actState.idle);this.entity.ani.playAnimation(i,1);var n=this.getData(),o=n.t2,s=n.effect,h=n.t3,l=n.power+this.levelData[3]*n.powerUp,c=n.hurtEnemy;this.scheduleOnce(function(){e.point.setTartget(l,cc.v3(70,0,0),t,o,s,c,1)},h)},e=o([u],e)}(r.heroAct));i.default=p,cc._RF.pop()},{"../../../util/audio_mgr":"audio_mgr","../../scene/gameScene":"gameScene","../../tools/resource_control":"resource_control","../ghost":"ghost","../hero":"hero"}],heroPointLD:[function(t,e,i){"use strict";cc._RF.push(e,"400ad0UGg5FO6BSIftDmtLb","heroPointLD");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../heroPoint"),a=t("../hero"),s=t("../enemy"),h=cc._decorator,l=h.ccclass,c=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.doLianJi=function(t){if(t.stopTime=this.stopFrameTime,this.attType<a.actState.lianji2){var e=this.attType-a.actState.lianji0;t.setState(s.eActState.hurtLianJi0+e)}else this.attType==a.actState.lianji2&&t.setState(s.eActState.hurtSL);this.attType==a.actState.lianji2&&(this.pos.x+=20*this.dir,this.effname="att1")},e.prototype.doQinNa=function(t){if(t.stopTime=this.stopFrameTime,this.attType<=a.actState.qinna1_1){var e=this.attType-a.actState.qinna1_0;t.setState(s.eActState.hurtQinNa1_0+e)}else this.attType==a.actState.qinna1_2&&(t.setState(s.eActState.hurtPedal),this.effname="att1")},e.prototype.doXuLi=function(t,e,i,n){t.stopTime=this.stopFrameTime;this.attType,a.actState.xuli1;t.setState(s.eActState.hurtJiFei),this.effname="att1",this.pos.x+=20*this.dir},e=o([l],e)}(r.default));i.default=c,cc._RF.pop()},{"../enemy":"enemy","../hero":"hero","../heroPoint":"heroPoint"}],heroPointLX:[function(t,e,i){"use strict";cc._RF.push(e,"61dca80VAtNtJsfPhKCS3oh","heroPointLX");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../heroPoint"),a=t("../enemy"),s=t("../hero"),h=t("../../../util/global_def"),l=t("../../../util/audio_mgr"),c=cc._decorator,u=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.doYiJi=function(t,e){e.canCounDoAct=!0,t.stopTime=this.stopFrameTime,t.setState(a.eActState.hurtUppercut)},e.prototype.doLianJi=function(t){if(t.stopTime=this.stopFrameTime,this.attType<s.actState.lianji2){var e=this.attType-s.actState.lianji0;t.setState(a.eActState.hurtLianJi0+e,!1,cc.v2(0,h.G.randRange(250,300)))}else this.attType==s.actState.lianji2&&t.setState(a.eActState.hurtJiFei,!1,cc.v2(500,700));this.attType==s.actState.lianji2&&(this.pos.x+=20*this.dir,this.effname="att1")},e.prototype.doQinNa0=function(t){t.stopTime=this.stopFrameTime,t.setState(a.eActState.hurtQinNa0_0,!1,cc.v2(500,500))},e.prototype.doQinNa=function(t){if(t.stopTime=this.stopFrameTime,this.attType<=s.actState.qinna1_1){var e=this.attType-s.actState.qinna1_0;t.setState(a.eActState.hurtQinNa1_0+e)}else this.attType==s.actState.qinna1_2&&(t.setState(a.eActState.hurtPedal),this.effname="att1")},e.prototype.doXuLi=function(t,e,i,n){l.AudioMgr.instance.playAttFoot1(),t.stopTime=this.stopFrameTime,t.setState(a.eActState.hurtXuli2),this.effname="att1",this.pos.x+=20*this.dir},e=o([u],e)}(r.default));i.default=p,cc._RF.pop()},{"../../../util/audio_mgr":"audio_mgr","../../../util/global_def":"global_def","../enemy":"enemy","../hero":"hero","../heroPoint":"heroPoint"}],heroPoint:[function(t,e,i){"use strict";cc._RF.push(e,"c598ezRjY9B9Y1OUj9KLVhT","heroPoint");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./enemy"),a=t("./hero"),s=t("../scene/gameScene"),h=t("../tools/nodePool_control"),l=t("../tools/wordFactory"),c=cc._decorator,u=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=cc.v3(0,0,0),e.power=0,e.attType=a.actState.yiji,e.stopFrameTime=0,e.effect=0,e.hurtEnemy=255,e.effname=null,e.r=null,e.pos=null,e.dir=null,e.easing=.3,e.keepTime=0,e}return n(e,t),e.prototype.setTartget=function(t,e,i,n,o,r,a,s){void 0===r&&(r=255),void 0===a&&(a=.3),void 0===s&&(s=0),this.effect=o,this.easing=a,this.node.position=cc.v3(-20,0,0),this.node.active=!0,this.target=e,this.power=t,this.attType=i,this.stopFrameTime=n,this.hurtEnemy=r,this.keepTime=60*s},e.prototype.doYiJi=function(t,e){e.canCounDoAct=!0,t.stopTime=this.stopFrameTime,t.setState(r.eActState.hurtYiJi)},e.prototype.doLianJi=function(t){t.stopTime=this.stopFrameTime;var e=this.attType-a.actState.lianji0;t.setState(r.eActState.hurtLianJi0+e),this.attType==a.actState.lianji2&&(this.pos.x+=20*this.dir,this.effname="att1")},e.prototype.doQinNa=function(t){t.stopTime=this.stopFrameTime;var e=this.attType-a.actState.qinna1_0;t.setState(r.eActState.hurtQinNa1_0+e),this.attType==a.actState.qinna1_2&&(this.pos.y+=50,this.pos.x+=20*this.dir,this.effname="att1")},e.prototype.doQinNa0=function(t){t.stopTime=this.stopFrameTime,t.setState(r.eActState.hurtQinNa0_0)},e.prototype.doXuLi=function(t,e,i,n){var o=this;if(this.attType==a.actState.xuli1){s.default.instance.setCamera(1.3,.5);var h=e.node.uuid;i.hitInfo.push({key:h,value:0,node:e,touchId:this.node.uuid}),this.scheduleOnce(function(){i.rmHitInfo(h,o.node.uuid)},.5),i.scheduleOnce(function(){s.default.instance.setCamera(1,.5)},.4)}t.stopTime=this.stopFrameTime;var l=this.attType-a.actState.xuli1;t.setState(r.eActState.hurtXuLi1+l),this.effname="att1",this.pos.x+=20*this.dir},e.prototype.onCollisionEnter=function(t,e){var i=this,n=t.node;if("enemy"==n.group&&this.hurtEnemy>0){var o=s.default.instance.hero,c=o.getComponent(a.heroAct),u=n.getComponent(r.enemyAct);if(u.state==r.eActState.fall)return;if(u.setDefense(),!u.isCanHurt())return void(c.qNEnemy==n&&this.attType==a.actState.qinna&&(this.hurtEnemy=-1,c.qNEnemy=null,c.recover()));switch(this.effname="att0",this.r=0,this.pos=n.position,this.pos.y+=n.height/2,u.isBoss&&(this.pos=o.position),this.dir=o.scaleX>0?1:-1,this.attType){case a.actState.yiji:this.doYiJi(u,c);break;case a.actState.lianji0:case a.actState.lianji1:case a.actState.lianji2:case a.actState.lianji3:this.doLianJi(u);break;case a.actState.qinna:if(c.qNEnemy!=n)return;this.hurtEnemy--,u.stopTime=this.stopFrameTime,u.setState(r.eActState.qinNa);break;case a.actState.qinna0_0:if(c.qNEnemy!=n)return;this.doQinNa0(u);break;case a.actState.qinna1_0:case a.actState.qinna1_1:case a.actState.qinna1_2:case a.actState.qinna1_3:this.doQinNa(u);break;case a.actState.xuli1:case a.actState.xuli2:this.doXuLi(u,t,c,o);break;case a.actState.xiati_0:this.scheduleOnce(function(){i.keepTime=0,c.setReTarget()},.01),u.setState(r.eActState.hurtXiaTi);break;case a.actState.shangti:this.pos.y+=50,this.pos.x+=20*this.dir,u.stopTime=this.stopFrameTime,u.setState(r.eActState.hurtShangTi),this.effname="att1"}if(0!=this.power){this.power=Math.floor(this.power*c.heavy);var p=h.default.instance.getNode(this.effname);p.getComponent("animation").reuse(),p.angle=-this.r,p.scaleX=this.dir,p.position=this.pos,p.parent=n.parent;var d=cc.v3(n.x,n.y+30,0);l.default.instance.play(l.wordType.jump,String(this.power),d,n.parent),u.entity.addBlood(-this.power),u.setEffect(this.effect)}}},e.prototype.onCollisionExit=function(t,e){},e.prototype.update=function(){var t=this.target.sub(this.node.position);if(t.mag()<1){if(this.keepTime--,this.keepTime>0)return;return this.node.position=this.target,void(this.node.active=!1)}var e=t.mul(this.easing);this.node.position=this.node.position.add(e)},e=o([u],e)}(cc.Component));i.default=p,cc._RF.pop()},{"../scene/gameScene":"gameScene","../tools/nodePool_control":"nodePool_control","../tools/wordFactory":"wordFactory","./enemy":"enemy","./hero":"hero"}],hero:[function(t,e,i){"use strict";cc._RF.push(e,"6f1ed+xnSBItLFiz4oYlZGY","hero");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.heroPlot=i.heroDan=i.heroAct=i.INStructType=i.hAniName=i.actState=i.heroType=void 0;var r,a=t("./lifeBase"),s=t("../scene/gameScene"),h=t("./enemy"),l=t("./heroPoint"),c=t("../../game_logic"),u=t("../tools/nodePool_control"),p=t("../../util/audio_mgr"),d=t("../tools/resource_control"),f=t("./weapon/weapon"),_=t("../../util/global_def"),g=t("./weapon/darts"),m=t("./weapon/knife"),y=t("./weapon/gun0"),v=t("./weapon/gun1"),b=t("../scene/uiControl"),C=t("../user_info/user_info"),S=t("./weapon/brick"),w=t("./heroAct/heroPointLD"),x=t("./heroAct/heroPointLX"),I=t("../../util/event_mgr"),P=t("../../game_ui/game/EndLayer"),T=cc._decorator,k=T.ccclass;T.property;(function(t){t[t.Dan=0]="Dan",t[t.LD=1]="LD",t[t.LX=2]="LX",t[t.plot=3]="plot"})(r=i.heroType||(i.heroType={}));var O,A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.originGy=-32,e.act=null,e.Rect=new cc.Rect(0,0,50,100),e}return n(e,t),e.prototype.onLoad=function(){this.origSize=cc.size(100,100),t.prototype.onLoad.call(this)},e.prototype.dealStop=function(e){t.prototype.dealStop.call(this,e)},e.prototype.init=function(t,e){if(void 0===e&&(e=!0),e){var i=this.node.getChildByName("point");if(t==r.Dan)_.G.Game.curHeroID=0,this.act=this.node.addComponent(j),this.act.point=i.addComponent(l.default);else if(t==r.plot)this.act=this.node.addComponent(R);else if(t==r.LD)_.G.Game.curHeroID=1,this.ani.dragonAsset=d.default.instance.getDragonBonesAsset("hero1_ske"),this.ani.dragonAtlasAsset=d.default.instance.getDragonBonesAtlasAsset("hero1_tex"),this.act=this.node.addComponent("heroLD"),this.act.point=i.addComponent(w.default);else if(t==r.LX){_.G.Game.curHeroID=2,this.ani.dragonAsset=d.default.instance.getDragonBonesAsset("hero2_ske"),this.ani.dragonAtlasAsset=d.default.instance.getDragonBonesAtlasAsset("hero2_tex"),this.act=this.node.addComponent("heroLX"),this.act.point=i.addComponent(x.default),this.node.getChildByName("camera").active=!0}}},e.prototype.onCollisionEnter=function(t,e){t.tag},e.prototype.dealWallX=function(t){this.lineVelocity=cc.v2(0,this.lineVelocity.y)},e.prototype.dealWallY=function(t){},e.prototype.addBloodAni=function(t){b.default.instance.addBlood(t)},e.prototype.dealBottom=function(){this.act.down(),this.act.jumping=!1,this.act.shangTiing=!1,this.act.fall()},e.prototype.dealCliff=function(){},e.prototype.update=function(e){t.prototype.update.call(this,e)},e.prototype.die=function(t){this.isDie||(P.default.instance.showBAd(function(){s.default.instance.gameOver()}),this.act.doDie(t))},e=o([k],e)}(a.default);i.default=A,function(t){t[t.idle=0]="idle",t[t.left=-1]="left",t[t.right=1]="right",t[t.yiji=5]="yiji",t[t.lianji0=6]="lianji0",t[t.lianji1=7]="lianji1",t[t.lianji2=8]="lianji2",t[t.lianji3=9]="lianji3",t[t.qinna=10]="qinna",t[t.qinna0_0=11]="qinna0_0",t[t.qinna1_0=12]="qinna1_0",t[t.qinna1_1=13]="qinna1_1",t[t.qinna1_2=14]="qinna1_2",t[t.qinna1_3=15]="qinna1_3",t[t.hurt=16]="hurt",t[t.xiati_0=17]="xiati_0",t[t.xiati_1=18]="xiati_1",t[t.shangti=19]="shangti",t[t.xuli0=20]="xuli0",t[t.xuli1=21]="xuli1",t[t.xuli2=22]="xuli2",t[t.fantan=23]="fantan",t[t.shoot=24]="shoot",t[t.fallWater=25]="fallWater",t[t.fall=26]="fall",t[t.die=27]="die"}(O=i.actState||(i.actState={}));var B,D=function(){return function(){this.aniMv="pao",this.aniJm="tiao",this.aniIdle="daiji",this.aniYiJi="yiji",this.aniLianJi0="lianji_0",this.aniLianJi1="lianji_1",this.aniLianJi2="lianji_2",this.aniLianJi3="lianji_3",this.aniLianJi4="lianji_4",this.aniXiaTi0="xiati_0",this.aniXiaTi1="xiati_1",this.aniShangTi="shangti",this.aniXuLi0="xuli_0",this.aniXuLi1="xuli_1",this.aniXuLi2="xuli_2",this.aniQinNa="qinna",this.aniQinNa0_0="qinna0_0",this.aniQinNa1_0="qinna1_0",this.aniQinNa1_1="qinna1_1",this.aniQinNa1_2="qinna1_2",this.aniKaiQiang_0="kaiqiang_0",this.aniKaiQiang_1="kaiqiang_1",this.aniKaiQiang_2="kaiqiang_2",this.aniTouZhi="touzhi",this.aniHurt="beida",this.aniFall="siwang_0",this.aniDie="daodi",this.aniReLife="zhanqi"}}();i.hAniName=D,function(t){t[t.null=0]="null",t[t.attack=1]="attack",t[t.up=2]="up",t[t.left=3]="left",t[t.right=4]="right",t[t.shoot=5]="shoot"}(B=i.INStructType||(i.INStructType={}));var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.entity=null,e.point=null,e.blood=200,e.heavy=1,e.speedMv=300,e.speedJm=800,e.dir=0,e.attTime=-1,e.state=0,e.hitTime=-1,e.attQn=!1,e.aniName=new D,e.originSc=.8,e.instruct=[],e.instructTime=0,e.data=null,e.dataName="attack_0",e.weaponData=null,e.levelData=[1,1,1,1,1],e.isShoot=!1,e.curWeaponId=null,e.weaponNode=null,e.weaponCom=null,e.XuLiTime=-1,e.touchAttck=!1,e.jumping=!1,e.shangTiing=!1,e.protectTime=0,e.hurtDir=0,e.buff=!1,e.canCounDoAct=!1,e.hitInfo=[],e.qNEnemy=null,e}return n(e,t),e.prototype.fall=function(){var t=this;this.state==O.fall&&(this.entity.isDie&&this.setState(O.die,!0),this.entity.lineVelocity.x=this.entity.lineVelocity.x/1.5,this.entity.lineVelocity.y=180,this.scheduleOnce(function(){t.entity.lineVelocity.x=0},.2))},e.prototype.doDie=function(t){"enemy"==t?(p.AudioMgr.instance.playHerHurt(),this.setState(O.fall)):"water"==t?(this.entity.lineVelocity.x=0,this.setState(O.die)):"thorn"==t&&(this.hurtDir=1,this.setState(O.fall))},e.prototype.stateScheduleOnce=function(t,e){var i=this,n=this.state;this.scheduleOnce(function(){if(i.state==n)t();else;},e)},e.prototype.stateSchedule=function(t,e,i,n){var o=this,r=this.state;this.schedule(function(){o.state==r?t():o.unschedule(t)},e,i,n)},e.prototype.changeWeapon=function(t){if(this.curWeaponId!=t){switch(this.weaponNode.removeComponent(this.weaponCom),t){case f.WeaponType.darts:this.weaponCom=this.weaponNode.addComponent(g.default);break;case f.WeaponType.knife:this.weaponCom=this.weaponNode.addComponent(m.default);break;case f.WeaponType.gun0:this.weaponCom=this.weaponNode.addComponent(y.default);break;case f.WeaponType.gun1:this.weaponCom=this.weaponNode.addComponent(v.default);break;case f.WeaponType.brick:this.weaponCom=this.weaponNode.addComponent(S.default)}this.weaponCom.hurtNum=this.weaponData[t].hurt,this.weaponCom.changeImage();var e=this.weaponData[t];b.default.instance.showWeapPro(e.num/e.ceiling)}},e.prototype.addWeapon=function(t,e){var i=this.weaponData[t];if(i.num+=e,b.default.instance.showWeapPro(i.num/i.ceiling),i.num>i.ceiling)i.num=i.ceiling;else if(i.num<0){i.num=0;for(var n=_.G.Game.weaponCount,o=1;o<=n;o++){var r=(t+o)%n;if(0!=this.weaponData[r].num)return void this.changeWeapon(r)}return void b.default.instance.hidWeapPanle()}b.default.instance.weapShow||(this.changeWeapon(t),b.default.instance.showWeapPanle())},e.prototype.yijiMv=function(){var t=this;0==this.dir||this.findHitInfo(1)||this.findHitInfo(-1)||(this.entity.lineVelocity.x=this.dir*this.speedMv,this.scheduleOnce(function(){t.entity.lineVelocity.x=0},.1))},e.prototype.setMat=function(t,e){this.entity.ani.getMaterial(0).setProperty(t,e)},e.prototype.pushInStruct=function(t,e){if(void 0===e&&(e=!1),!(this.instructTime>0)){this.instruct.push(t);var i=this.getData(),n=null!=i?i.t1_type:1;(e||n)&&this.runInStruct()}},e.prototype.isCanLianJi=function(){var t=!1;for(var e in this.hitInfo){var i=this.hitInfo[e].node;if(null==i.getComponent(h.enemyAct))return void this.rmHitInfo(i.uuid,this.node.uuid);if(i.getComponent(h.enemyAct).state!=h.eActState.fall){t=!0;break}}return!!(0!=this.hitInfo.length&&t||this.canCounDoAct)},e.prototype.doInstructUp=function(){this.state!=O.fallWater&&(this.state!=O.qinna?this.shangTiing||!this.jumping?this.jump():this.setState(O.shangti):this.setState(O.qinna0_0))},e.prototype.checkXiaTi=function(){return!(!this.jumping||this.state==O.fallWater)},e.prototype.runInStruct=function(){var t=this;if(!this.entity.isDie){var e=this.instruct.pop();if(null!=e){if(e==B.attack){if(this.checkXiaTi()){if(this.entity.lineVelocity.y>0){var i=this.entity.lineVelocity.y/(60*-this.entity.gravity);this.scheduleOnce(function(){t.setState(O.xiati_0)},i)}else this.setState(O.xiati_0);return}switch(this.state){case O.shoot:case O.yiji:this.isCanLianJi()?(this.setState(O.lianji0),this.canCounDoAct=!1):(this.yijiMv(),this.setState(O.yiji));break;case O.lianji0:case O.lianji1:this.setState(this.state+1);break;case O.qinna:this.setState(O.qinna1_0);break;case O.qinna1_0:case O.qinna1_1:case O.qinna1_2:this.setState(this.state+1);break;case O.left:case O.right:case O.idle:case O.xiati_1:case O.lianji3:this.yijiMv(),this.setState(O.yiji);break;default:this.recover()}}else if(e==B.up)this.doInstructUp();else if(e==B.null)this.state!=O.left&&this.state!=O.right||this.setState(O.idle);else if(e==B.left){if(this.state==O.qinna)return void(1==this.getDir()&&this.setState(O.qinna0_0));if(this.state==O.shoot)return void this.setState(O.shoot);if(this.entity.ani.animationName==this.aniName.aniFall)return void(this.entity.lineVelocity.x=-this.speedMv);this.jumping&&this.dir*this.node.scaleX<0&&this.entity.ani.playAnimation(this.aniName.aniIdle,-1),this.setState(O.left)}else if(e==B.right){if(this.state==O.qinna)return void(-1==this.getDir()&&this.setState(O.qinna0_0));if(this.state==O.shoot)return void this.setState(O.shoot);if(this.entity.ani.animationName==this.aniName.aniFall)return void(this.entity.lineVelocity.x=this.speedMv);this.jumping&&this.dir*this.node.scaleX<0&&this.entity.ani.playAnimation(this.aniName.aniIdle,-1),this.setState(O.right)}else if(e==B.shoot){if(this.state==O.left||this.state==O.right||this.state==O.idle||this.state==O.shoot)return void this.setState(O.shoot);if(this.state==O.qinna||this.state==O.fallWater)return;this.recover()}}else switch(this.state){case O.lianji2:this.setState(O.lianji3);break;case O.qinna1_0:case O.qinna1_1:case O.qinna1_2:this.setState(this.state+1);break;case O.xuli1:this.setState(O.xuli2);break;default:this.touchAttck&&this.state==O.yiji?(this.XuLiTime=15,this.recover()):this.recover()}}},e.prototype.checkXuLi=function(){this.XuLiTime<0||(0!=this.XuLiTime||0!=this.dir||this.jumping||this.setState(O.xuli0),this.XuLiTime--)},e.prototype.checkInStruct=function(){this.instructTime--},e.prototype.setInStructTime=function(){var t=this.entity.ani.animationName,e=this.data[t];this.instructTime=null!=e?60*e.t1:0},e.prototype.getDir=function(){return this.node.scaleX>0?1:-1},e.prototype.onLoad=function(){var t=this;this.node.scale=this.originSc,this.data=d.default.instance.getJsonAsset(this.dataName),this.weaponData=d.default.instance.getJsonAsset("curWeapon");var e=d.default.instance.getJsonAsset("weapon");C.GameUserInfo.getRoleSkill(0)&&(this.levelData=C.GameUserInfo.getRoleSkill(0));for(var i=0;i<_.G.Game.weaponCount;i++){var n=e[i],o=C.GameUserInfo.getWeaponLvl(String(i));if(_.G.Game.trialIds&&_.G.Game.trialIds.weaponId)i==Number(_.G.Game.trialIds.weaponId)&&(o=5);this.weaponData[i].speed=n.speed,this.weaponData[i].hurt=n.hurt+n.act_lv*o,this.weaponData[i].ceiling=n.num+n.num_lv*o}this.entity=this.node.getComponent(A),this.setState(O.idle);var r=this;this.entity.ani.on(dragonBones.EventObject.COMPLETE,function(e){var i=r.entity.ani.animationName,n=r.getData().t2;(r.entity.ani.animationName==r.aniName.aniXuLi1&&0==r.hitInfo.length||r.dir*r.node.scaleX<0)&&(n=0),t.scheduleOnce(function(){i==t.entity.ani.animationName&&t.runInStruct()},n)}),this.weaponNode=new cc.Node,this.weaponNode.parent=this.node,this.weaponCom=this.weaponNode.addComponent(f.default),this.changeWeapon(f.WeaponType.gun0)},e.prototype.getData=function(){var t=this.entity.ani.animationName,e=this.data[t];if(!e);return e},e.prototype.cancleTouch=function(){this.XuLiTime=-1,this.touchAttck=!1,this.state==O.xuli0&&this.setState(O.xuli1)},e.prototype.jump=function(){this.shangTiing||0!=this.entity.gravity||(this.jumping=!0,this.entity.ani.playAnimation(this.aniName.aniJm,1),this.entity.lineVelocity.y=this.speedJm,this.entity.lineVelocity.x=this.dir*this.speedMv,this.entity.gravity=this.entity.originGy,s.default.instance.stopMapY=1,this.node.y+=1)},e.prototype.down=function(){if(s.default.instance.stopMapY=0,0!=this.jumping){this.entity.cancelGravity=!1,this.entity.lineVelocity.x=this.dir*this.speedMv,this.recover();var t=u.default.instance.getNode("fall");t.getComponent("animation").reuse(),t.parent=this.node.parent,t.x=this.node.x,t.y=this.node.y-this.entity.Rect.height/2}},e.prototype.setDir=function(t){this.dir=t,this.state!=O.idle&&this.state!=O.left&&this.state!=O.right||0!=this.dir&&(this.node.scaleX=this.dir*this.originSc)},e.prototype.doLiJi=function(t){var e=this;0!=this.dir&&(this.node.scaleX=this.dir*this.originSc);var i="";t==O.lianji0?(p.AudioMgr.instance.playHeroAtt1(),i=this.aniName.aniLianJi0):t==O.lianji1?(p.AudioMgr.instance.playHeroAtt2(),i=this.aniName.aniLianJi1):t==O.lianji2?(p.AudioMgr.instance.playHeroAtt3(),i=this.aniName.aniLianJi2):t==O.lianji3&&(p.AudioMgr.instance.playHeroAtt4(),i=this.aniName.aniLianJi3),this.entity.ani.playAnimation(i,1);var n=this.getData(),o=n.t2,r=n.effect,a=n.t3,s=n.power+this.levelData[0]*n.powerUp,h=n.hurtEnemy;this.scheduleOnce(function(){e.point.setTartget(s,cc.v3(70,0,0),t,o,r,h)},a)},e.prototype.doQinNa0=function(t){var e=this;this.entity.ani.playAnimation(this.aniName.aniQinNa0_0,1);var i=this.getData(),n=i.t2,o=i.effect,r=i.t3,a=i.power+this.levelData[3]*i.powerUp,s=i.hurtEnemy;this.scheduleOnce(function(){e.point.setTartget(a,cc.v3(70,0,0),t,n,o,s)},r)},e.prototype.doQinNa1=function(t){var e=this;t==O.qinna1_0?p.AudioMgr.instance.playHeroAtt0():t==O.qinna1_1||(t==O.qinna1_2?p.AudioMgr.instance.playHeroAtt3():O.qinna1_3);var i="qinna1_"+(t-O.qinna1_0);this.entity.ani.playAnimation(i,1);var n=this.getData(),o=n.t2,r=n.effect,a=n.t3,s=n.power+this.levelData[3]*n.powerUp,h=n.hurtEnemy;this.scheduleOnce(function(){e.point.setTartget(s,cc.v3(70,0,0),t,o,r,h,1)},a)},e.prototype.doXuLi0=function(t){var e=this;this.entity.ani.playAnimation(this.aniName.aniXuLi0,-1);var i=d.default.instance.getPrefabs("xuli"),n=cc.instantiate(i);n.getComponent("animation").reuse(1),n.parent=this.node,p.AudioMgr.instance.playXuLi(),this.scheduleOnce(function(){e.setMat("glowColor",cc.color(255,255,0)),e.setMat("glowColorSize",.1)},.4)},e.prototype.doXuLi1=function(t){var e=this;p.AudioMgr.instance.playHeroAtt3(),this.entity.ani.playAnimation(this.aniName.aniXuLi1,1);var i=this.getData(),n=i.t2,o=i.effect,r=(i.t3,i.power+this.levelData[4]*i.powerUp),a=i.hurtEnemy;this.scheduleOnce(function(){e.point.setTartget(r,cc.v3(70,0,0),t,n,o,a,1)},0)},e.prototype.doXuli2=function(t){var e=this;return this.entity.lineVelocity.x=500*this.getDir(),this.scheduleOnce(function(){e.entity.ani.playAnimation(e.aniName.aniXuLi2,1),e.entity.lineVelocity.x=0,e.setMat("glowColorSize",0)},.2),this.point.setTartget(0,cc.v3(70,0,0),t,0,0,255,1),!1},e.prototype.checkQnReason=function(t){this.state!=O.left&&this.state!=O.right||this.findHitInfo(this.state)&&(this.hitTime=20,this.qNEnemy=t)},e.prototype.showRed=function(){var t=this;this.setMat("glowColor",cc.color(255,0,0)),this.setMat("glowColorSize",.1),this.setMat("glowThreshold",.1),this.scheduleOnce(function(){t.entity.startUpdate(),t.entity.cancelGravity=!1,t.setMat("glowColorSize",0),t.setMat("glowThreshold",.9)},.2)},e.prototype.setState=function(t,e,i){var n=this;if(void 0===e&&(e=!1),this.state!=O.fall||t==O.die||t==O.fallWater){switch(t){case O.idle:this.buff=!1,this.state!=O.fantan&&(this.entity.lineVelocity.x=0),this.jumping&&!e||this.entity.ani.playAnimation(this.aniName.aniIdle,-1);break;case O.left:case O.right:this.buff=!1,this.dir*this.node.scaleX<0&&(this.node.scaleX=this.dir*this.originSc);var o=-1;t==O.right&&(o=1),this.findHitInfo(t)||(this.entity.lineVelocity.x=this.speedMv*this.dir),(this.entity.ani.animationName!=this.aniName.aniMv&&!this.jumping||e)&&this.entity.ani.playAnimation(this.aniName.aniMv,-1),this.findHitInfo(t)&&(this.hitTime=20);break;case O.yiji:this.buff=!1,0!=this.dir&&(this.node.scaleX=this.dir*this.originSc),p.AudioMgr.instance.playHeroAtt0(),this.entity.ani.playAnimation(this.aniName.aniYiJi,1);var r=(o=this.getData()).t2,a=o.effect,h=o.t3,l=o.power+this.levelData[0]*o.powerUp;this.scheduleOnce(function(){n.point.setTartget(l,cc.v3(70,0,0),t,r,a)},h);break;case O.lianji0:case O.lianji1:case O.lianji2:case O.lianji3:this.buff=!1,this.doLiJi(t);break;case O.qinna:this.buff=!1,this.entity.ani.playAnimation(this.aniName.aniQinNa,1);var u=(o=this.getData()).t2,d=o.effect,f=(h=o.t3,o.power),_=o.hurtEnemy;this.scheduleOnce(function(){n.point.setTartget(f,cc.v3(70,0,0),t,u,d,_)},h);break;case O.qinna0_0:this.buff=!1,this.doQinNa0(t);break;case O.xuli0:this.buff=!1,this.state=t,this.doXuLi0(t);break;case O.xuli1:this.buff=!0,this.state=t,this.doXuLi1(t);break;case O.xuli2:if(this.buff=!0,this.doXuli2(t))return;break;case O.qinna1_0:case O.qinna1_1:case O.qinna1_2:case O.qinna1_3:this.buff=!1,this.doQinNa1(t);break;case O.xiati_0:this.buff=!0,p.AudioMgr.instance.playHeroAtt2(),this.entity.ani.playAnimation(this.aniName.aniXiaTi0,1),this.entity.cancelGravity=!0,this.entity.lineVelocity.x=800*this.getDir(),this.entity.lineVelocity.y=-800;var g=(o=this.getData()).t2,m=o.effect,y=o.power+this.levelData[1]*o.powerUp,v=o.hurtEnemy;this.point.setTartget(y,cc.v3(40,-40,0),t,g,m,v,1,.4);break;case O.xiati_1:this.buff=!0,this.entity.ani.playAnimation(this.aniName.aniXiaTi1,1);break;case O.shangti:this.buff=!0,p.AudioMgr.instance.playHeroAtt2(),this.entity.cancelGravity=!0,this.entity.gravity=0,this.entity.lineVelocity.y=250,this.scheduleOnce(function(){n.entity.gravity=n.entity.originGy,n.entity.cancelGravity=!1},.2),this.entity.ani.playAnimation(this.aniName.aniShangTi,1);var b=(o=this.getData()).t2,C=o.effect,S=(h=o.t3,o.power+this.levelData[2]*o.powerUp),w=o.hurtEnemy;this.scheduleOnce(function(){n.point.setTartget(S,cc.v3(70,-20,0),t,b,C,w,1)},h),this.shangTiing=!0;break;case O.shoot:this.buff=!1,this.jumping||(this.entity.lineVelocity.x=0),this.weaponCom.fire();break;case O.hurt:if(this.protectTime>0)break;this.showRed();var x=i||-20;if(this.entity.addBlood(x,"enemy"),this.buff||this.entity.isDie)return;this.entity.ani.playAnimation(this.aniName.aniHurt,1),this.entity.lineVelocity.x=0,p.AudioMgr.instance.playHerHurt(),this.entity.stopUpdate();break;case O.fallWater:if(s.default.instance.stopMapY=2,this.entity.cancelGravity=!1,this.jumping=!0,this.entity.lineVelocity.y=1e3,this.entity.ani.playAnimation(this.aniName.aniFall,-1),this.protectTime>0)break;x=i||-15;if(this.entity.addBlood(x,"water"),this.entity.isDie)return void(this.entity.lineVelocity.x=0);break;case O.fall:this.entity.ani.playAnimation(this.aniName.aniDie,1),this.entity.lineVelocity.y=300,this.node.scaleX=this.originSc*this.hurtDir,this.entity.lineVelocity.x=300*-this.hurtDir,this.entity.Rect=cc.rect(0,0,50,70);break;case O.die:this.state=O.die;var P=c.default.instance.eventManager.addListener(I.EventType.kCloseRevivePnl,function(t){c.default.instance.eventManager.removeListener(I.EventType.kCloseRevivePnl,P),n.entity.isDie=!1,n.entity.addBlood(100),n.entity.ani.animationName==n.aniName.aniDie&&n.entity.ani.playAnimation(n.aniName.aniReLife,1),n.entity.Rect=cc.rect(0,0,50,100),n.scheduleOnce(function(){n.setState(O.idle)},.2),n.protectTime=180,n.node.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.1,170),cc.fadeTo(.1,255)))),n.scheduleOnce(function(){n.node.stopAllActions(),n.node.opacity=255,n.protectTime=0},3)});s.default.instance.listenerManager.push({key:I.EventType.kCloseRevivePnl,id:P})}this.state=t,this.setInStructTime(),this.instruct=[]}},e.prototype.checkQn=function(){if(!(this.hitTime<0))if(this.state==O.left||this.state==O.right){if(this.hitTime--,0==this.hitTime&&!this.jumping){if(!this.qNEnemy)return;this.qNEnemy.getComponent(h.enemyAct).setState(h.eActState.idle),this.setState(O.qinna)}}else this.hitTime=-1},e.prototype.recover=function(){this.isShoot?this.setState(O.shoot):0==this.dir?this.setState(O.idle,!0):1==this.dir?(this.setState(O.right,!0),this.setDir(1)):-1==this.dir&&(this.setState(O.left,!0),this.setDir(-1))},e.prototype.setReTarget=function(){if(this.state==O.xiati_0){var t=this.entity.lineVelocity.normalize().neg();this.entity.lineVelocity=t.scale(cc.v2(380,600)),this.setState(O.xiati_1),this.entity.cancelGravity=!1}},e.prototype.update=function(){this.entity.checkLimit(),this.checkXuLi(),this.checkInStruct(),this.checkQn()},e.prototype.findHitInfo=function(t){for(var e in this.hitInfo){if(this.hitInfo[e].value==t)return!0}return!1},e.prototype.rmHitInfo=function(t,e){for(var i in this.hitInfo){var n=this.hitInfo[i];if(n.key==t&&n.touchId==e){this.hitInfo.splice(Number(i),1);break}}},e.prototype.hitEnemy=function(){this.entity.lineVelocity.x=0},e.prototype.onCollisionEnter=function(t,e){var i=t.node;if("enemy"==i.group){if(!i.getComponent(h.enemyAct).isCanQn)return;if(this.state==O.xuli1||this.state==O.xuli2)return;var n=this.node.x-i.x;if(!this.jumping&&Math.abs(n)>40){this.node.y,this.node.height,i.y,i.height;var o=i.uuid;n<0?this.hitInfo.push({key:o,value:1,node:i,touchId:this.node.uuid}):this.hitInfo.push({key:o,value:-1,node:i,touchId:this.node.uuid}),this.hitEnemy(),this.findHitInfo(this.dir)&&(this.hitTime=20)}Math.abs(n)>40&&i.getComponent(h.enemyAct).isCanHurt()&&null==this.qNEnemy&&(this.qNEnemy=i)}},e.prototype.createEffect=function(t){var e=u.default.instance.getNode("att1");e.getComponent("animation").reuse();var i=s.default.instance.hero.scaleX>0?1:-1;e.scaleX=i,e.x=t.x,e.y=t.y+30,e.parent=t.parent,e.angle=45*-i},e.prototype.collExit=function(t){var e=t.uuid;this.rmHitInfo(e,this.node.uuid),this.hitTime=-1,t==this.qNEnemy&&(this.qNEnemy=null)},e.prototype.onCollisionExit=function(t,e){this.collExit(t.node),this.state!=O.left&&this.state!=O.right||(this.entity.lineVelocity.x=this.speedMv*this.dir)},e}(cc.Component);i.heroAct=M;var j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(M);i.heroDan=j;var R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this.entity=this.node.getComponent(A),this.entity.ani.playAnimation(this.aniName.aniIdle,-1)},e.prototype.down=function(){},e.prototype.update=function(){this.checkXuLi(),this.checkInStruct(),this.checkQn()},e}(M);i.heroPlot=R,cc._RF.pop()},{"../../game_logic":"game_logic","../../game_ui/game/EndLayer":"EndLayer","../../util/audio_mgr":"audio_mgr","../../util/event_mgr":"event_mgr","../../util/global_def":"global_def","../scene/gameScene":"gameScene","../scene/uiControl":"uiControl","../tools/nodePool_control":"nodePool_control","../tools/resource_control":"resource_control","../user_info/user_info":"user_info","./enemy":"enemy","./heroAct/heroPointLD":"heroPointLD","./heroAct/heroPointLX":"heroPointLX","./heroPoint":"heroPoint","./lifeBase":"lifeBase","./weapon/brick":"brick","./weapon/darts":"darts","./weapon/gun0":"gun0","./weapon/gun1":"gun1","./weapon/knife":"knife","./weapon/weapon":"weapon"}],hole:[function(t,e,i){"use strict";cc._RF.push(e,"0b936PYbsxEQ6nFnCxKfkQo","hole");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../ItemInfo"),a=t("../../../util/global_def"),s=t("../enemyAct/EnemyFactory"),h=t("../../../game_logic"),l=t("../../../util/event_mgr"),c=t("../../scene/gameScene"),u=cc._decorator,p=u.ccclass,d=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){var t=this.node.parent;t.removeComponent(cc.Sprite),this.node.removeComponent(f),this.node.addComponent(f).init(t)},e=o([p],e)}(r.default));i.default=d;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.right=null,e.left=null,e}return n(e,t),e.prototype.init=function(t){var e=this;this.right=this.node.getChildByName("right"),this.left=this.node.getChildByName("left"),this.right.active=!1,this.left.active=!1;for(var i=t.door.x,n=(t.door.y,t.type?1:0),o=t.hid?t.hid.x:200,r=["cg_stick","cg_gun","jc_stick","jc_gun"],h=0;h<a.G.Game.enemyTypeCount;h++)for(var l=0;l<4;l++){var u=t["enemy"+h+"x"+l];if(u)for(var p=0;p<u.x;p++){var d=s.default.instance.addEnemy(r[h],1);d.scaleX*=i,1==i?(d.parent=this.right,d.position=cc.v3(75,0,0)):(d.parent=this.left,d.position=cc.v3(-75,0,0)),d.addComponent(s.hidHole),d.holdId=this.node.uuid}}0==n&&this.schedule(function(){c.default.instance.hero&&e.check(o)},.1,cc.macro.REPEAT_FOREVER,.1)},e.prototype.check=function(t){var e=c.default.instance.hero,i=this.node.convertToWorldSpaceAR(cc.v2(0,0)),n=(i=e.parent.convertToNodeSpaceAR(i)).sub(cc.v2(e.x,e.y));Math.abs(n.x-t)<50&&Math.abs(n.y)<400&&(this.left.active=!0,this.right.active=!0,h.default.instance.eventManager.addEvent(l.EventType.KActiveEnemy,this,{index:255,holdId:this.node.uuid}),this.unscheduleAllCallbacks())},e}(cc.Component);i.holeControl=f,cc._RF.pop()},{"../../../game_logic":"game_logic","../../../util/event_mgr":"event_mgr","../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../ItemInfo":"ItemInfo","../enemyAct/EnemyFactory":"EnemyFactory"}],home:[function(t,e,i){"use strict";cc._RF.push(e,"58a42Zu0t9H3Jd7Rz/JtrOH","home");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../game_logic"),a=t("../../util/global_def"),s=t("../tools/storage_control"),h=t("../../util/transitions"),l=t("./gameScene"),c=t("../../util/event_mgr"),u=t("../../game_ui/game/TrialPnl"),p=t("../../game_ui/game/Store"),d=t("../../game_ui/game/RevivePnl"),f=t("./plot"),_=t("./gameGuide"),g=t("../prefabs/props/bigNodeManager"),m=t("../../game_ui/game/HomePnl"),y=t("../../game_ui/game/StoryPnl"),v=t("../prefabs/props/deathMath"),b=t("./uiControl"),C=t("../tools/resource_control"),S=t("../../util/mgp_util"),w=t("../../data/data_hub"),x=cc._decorator,I=x.ccclass,P=x.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.des=null,e.ui=null,e}var i;return n(e,t),i=e,e.prototype.onLoad=function(){var t=this;i.instance=this;var e=function(){t.des.string="\u8d44\u6e90\u52a0\u8f7d\u6210\u529f"};a.G.Game.loadResOver?e():r.default.instance.eventManager.addListener(c.EventType.KLoadResOver,e.bind(this)),S.MgpUtil.addInterstitialAd(a.G.insertIDs[0]),a.G.novice=s.default.instance.getBoolean("novice",!0)},e.prototype.onOpenTrialPnl=function(){u.TrialPnl.instance.show()},e.prototype.onOpenStore=function(){p.Store.instance.show(new p.StoreData)},e.prototype.enterGame=function(t){h.default.instance.loadScene("gameScene",["Canvas/MainCamera"],["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],"crop-circle",function(){l.default.instance.mapJsonName=t,l.default.instance.node.getComponent(g.default).initCamera(l.default.instance.mapCamera),l.default.instance.initMap(),l.default.instance.gameOver=function(){d.RevivePnl.instance.show(b.default.instance.curCoin)},l.default.instance.addBanner()},null,function(){l.default.instance.ad&&l.default.instance.ad.hide()})},e.prototype.enterPloat=function(){var t=this;h.default.instance.loadScene("plot",["Canvas/MainCamera"],["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],"crop-circle",function(){f.default.instance.node.getComponent(g.default).initCamera(f.default.instance.mapCamera)},function(){t.scheduleOnce(function(){f.default.instance.addStep()},1)},function(){var t=h.default.instance;t.badKingNode=cc.instantiate(t.badKing),t.badKingNode.parent=t.node,h.default.instance.des.opacity=0,t.des.getComponent(cc.Label).string="\u57ce\u5821\u7684\u660f\u541b",t.des.active=!0,t.des.y-=250,t.des.runAction(cc.fadeIn(.5)),t.loading=!1,t.scheduleOnce(function(){t.des.active=!1,t.loading=!0,t.badKingNode.destroy()},1)})},e.prototype.enterGuide=function(){h.default.instance.loadScene("gameScene",["Canvas/MainCamera"],["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],"crop-circle",function(){l.default.instance.node.getComponent(g.default).initCamera(l.default.instance.mapCamera),l.default.instance.mapJsonName="guide",l.default.instance.initMap(!1),l.default.instance.addComponent(_.default),l.default.instance.gameOver=function(){d.RevivePnl.instance.show(b.default.instance.curCoin)}},null)},e.prototype.onClickEnterGame0=function(){this.ui.active=!1,this.des.string="\u6e38\u620f\u8fdb\u5165\u4e2d...";this.enterGame("cave0")},e.prototype.onClickEnterGame1=function(){this.enterPloat()},e.prototype.onClickEnterGame2=function(){this.enterGuide()},e.prototype.onClickTrial=function(){u.TrialPnl.instance.show()},e.prototype.toGame=function(t,e){var i=this;void 0===e&&(e=!1),a.G.Game.GameLevel=t;var n=function(){if(m.default.instance.hide(),y.default.instance.hide(),i.des.string="\u6e38\u620f\u8fdb\u5165\u4e2d...",e)i.enterPloat();else{var n=function(){u.TrialPnl.instance.show(function(){i.enterGame(["guide","zm1","bossMap0","zm2","test","zm3","cave0","zm4"][t])})};2==t||4==t?C.default.instance.loadBundle("boss",n):n()}},o=s.default.instance.getNumEveryday("forceVideoNum",0);a.G.Game.forceVideo&&w.DataHub.config.forceVideoNum>o?(s.default.instance.setNum("forceVideoNum",++o),S.MgpUtil.watchVideoAds(a.G.VideoIDs[0],n,n,n,null,null,null)):n()},e.prototype.toDeathMath=function(t){a.G.Game.GameLevel=t+1e3,m.default.instance.hide(),y.default.instance.hide(),this.des.string="\u573a\u666f\u52a0\u8f7d\u4e2d...";var e=C.default.instance.getJsonAsset("sidou")[t=4*a.G.randRange(0,1)+t];h.default.instance.loadScene("gameScene",["Canvas/MainCamera"],["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],"crop-circle",function(){var t=e.map;l.default.instance.mapJsonName=t,l.default.instance.node.getComponent(g.default).initCamera(l.default.instance.mapCamera),l.default.instance.initMap(),l.default.instance.addBanner()},function(){var t=l.default.instance.node.addComponent(v.default);t.setInfo(e),l.default.instance.gameOver=function(){t.showEnd(!1,0)},l.default.instance.type=l.gameSceneType.deathMath},function(){l.default.instance.ad&&l.default.instance.ad.hide()})},e.instance=null,o([P(cc.Label)],e.prototype,"des",void 0),o([P(cc.Node)],e.prototype,"ui",void 0),e=i=o([I],e)}(cc.Component);i.default=T,cc._RF.pop()},{"../../data/data_hub":"data_hub","../../game_logic":"game_logic","../../game_ui/game/HomePnl":"HomePnl","../../game_ui/game/RevivePnl":"RevivePnl","../../game_ui/game/Store":"Store","../../game_ui/game/StoryPnl":"StoryPnl","../../game_ui/game/TrialPnl":"TrialPnl","../../util/event_mgr":"event_mgr","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../../util/transitions":"transitions","../prefabs/props/bigNodeManager":"bigNodeManager","../prefabs/props/deathMath":"deathMath","../tools/resource_control":"resource_control","../tools/storage_control":"storage_control","./gameGuide":"gameGuide","./gameScene":"gameScene","./plot":"plot","./uiControl":"uiControl"}],house:[function(t,e,i){"use strict";cc._RF.push(e,"47296m2G8lPTIjHqWYqD7Sz","house");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./ItemInfo"),a=t("../../game_ui/game/repository"),s=cc._decorator,h=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tip=null,e.finger=null,e}return n(e,t),e.prototype.onLoad=function(){this.tip=this.node.getChildByName("tip"),this.finger=this.tip.getChildByName("finger"),this.addListener()},e.prototype.addListener=function(){},e.prototype.open=function(){this.tip.active&&a.Repository.instance.show()},e.prototype.close=function(){},e.prototype.onCollisionEnter=function(t,e){var i=t.node;"hero"==i.group&&"point"!=i.name&&(this.tip.active=!0,this.finger.stopAllActions(),this.finger.scale=1,this.finger.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.2,1)))))},e.prototype.onCollisionExit=function(t,e){var i=t.node;"hero"==i.group&&"point"!=i.name&&(this.tip.active=!1)},e=o([h],e)}(r.default));i.default=l,cc._RF.pop()},{"../../game_ui/game/repository":"repository","./ItemInfo":"ItemInfo"}],http_req:[function(t,e,i){"use strict";cc._RF.push(e,"fc973sFPBpJD6286u+HIaSL","http_req"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../../game_logic"),o=t("../../game_setting"),r="https://login.joyfulh.com/comLogin",a="http://119.23.108.126:8900/comLogin",s="https://statistic.joyfulh.com/statistic",h="http://hdtest.joyfulh.com/statistic",l="/user/getShareSwitch",c="/user/getTitles",u="/user/getTimeSwitch",p="/data/getTimeMillis",d="/userPlayRecord/batchUpdRecord",f="/userPlayRecord/getUserPlayRecord",_="/rank/getRankRecord",g="/rank/updRankRecord",m="/statData/getStatData",y="/statData/updStatData",v="/user/getUid",b="/data/updStatistic",C="/data/batchUpdStat",S="/IPScreen/getScreen",w="/data/updShareStat",x="/data/updInviteStat",I=function(){return function(){this.url="",this.data=""}}();i.SendData=I;var P=function(){function t(){}return t.common=function(t,e,i,n){if(null!=e){var o=new I;if(o.url=t,"object"==typeof e){for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];if(null==a)continue;if(""!=o.data&&(o.data+="&"),"object"==typeof a){var s=JSON.stringify(a);o.data+=r+"="+encodeURI(s)}else"string"==typeof a||"number"==typeof a||"boolean"==typeof a?o.data+=r+"="+encodeURI(a.toString()):(o.data+=r+"="+encodeURI(a.toString()),cc.error("[HttpRequest] please check your data type,only support object,string,number or boolean"))}}else o.data=encodeURI(e);this._send(o,i,n),o=null}else cc.error("[HttpRequest] failed")},t.shareOut=function(t){var e=s+w;1==o.GameSetting.testServer&&(e=h+w);var i={proName:o.GameSetting.proName,path:t};this.common(e,i,null,null)},t.shareClick=function(t){var e=s+x;1==o.GameSetting.testServer&&(e=h+x);var i={proName:o.GameSetting.proName,path:t,openid:o.GameSetting.openId};this.common(e,i,null,null)},t.getTimestamp=function(t,e){var i=r+p;1==n.default.instance.config.testServer&&(i=a+p),this.common(i,"",t,e)},t.getFuncSwitch=function(t,e,i){var o=r+l;1==n.default.instance.config.testServer&&(o=a+l);var s={proName:n.default.instance.config.proName,version:t};this.common(o,s,e,i)},t.getShareTitle=function(t,e){var i=r+c;1==n.default.instance.config.testServer&&(i=a+c);var o={proName:n.default.instance.config.proName};this.common(i,o,t,e)},t.getTimeSwtich=function(t,e,i){var o=r+u;1==n.default.instance.config.testServer&&(o=a+u);var s={proName:n.default.instance.config.proName,keys:t};this.common(o,s,e,i)},t.batchUpload=function(t,e,i,o,s){void 0===s&&(s=!1);var h=s?n.default.instance.unionId:n.default.instance.openId;if(null==h||""==h)return i&&i(2),void console.warn("fetchUserData - no valid user id");var l=r+d;1==n.default.instance.config.testServer&&(l=a+d),s=s||!1;var c={proName:n.default.instance.config.proName,wxId:h,data:t};this.common(l,c,function(t){0==t.status?e&&e(t):i(t.status)},o)},t.fetchUserData=function(t,e,i,o){void 0===o&&(o=!1);var s=o?n.default.instance.unionId:n.default.instance.openId;if(null==s||""==s)return e&&e(2),void console.warn("fetchUserData - no valid user id");var h=r+f;1==n.default.instance.config.testServer&&(h=a+f);var l={proName:n.default.instance.config.proName,wxId:s};this.common(h,l,function(i){0==i.status?t&&t(i):e(i.status)},i)},t.fetchRankData=function(t,e,i,o,s){var h=r+_;1==n.default.instance.config.testServer&&(h=a+_);var l={proName:n.default.instance.config.proName,type:t,page:e,limit:i};this.common(h,l,o,s)},t.uploadRankData=function(t,e){var i=r+g;1==n.default.instance.config.testServer&&(i=a+g);for(var o={proName:n.default.instance.config.proName,openId:n.default.instance.openId,type:t},s=0;s<e.length;++s)o[e[s].name]=e[s].val;this.common(i,o,null)},t.fetchStatData=function(t,e){var i=r+m;1==n.default.instance.config.testServer&&(i=a+m);var o={proName:n.default.instance.config.proName};this.common(i,o,t,e)},t.updateStatData=function(t,e){var i=r+y;1==n.default.instance.config.testServer&&(i=a+y);var o={proName:n.default.instance.config.proName,data:t};this.common(i,o,null,e)},t.getUserId=function(t,e,i,o){var r=s+v;1==n.default.instance.config.testServer&&(r=h+v);var a={proName:n.default.instance.config.proName,openId:t,unionId:e};this.common(r,a,i,o)},t.updateStatistic=function(t,e,i,o,r,a){var l=s+b;1==n.default.instance.config.testServer&&(l=h+b);var c={proName:n.default.instance.config.proName,uid:t,key:e,value:i,choose:o||0};this.common(l,c,r,a)},t.batchUpdateStat=function(t,e,i){var o=s+C;1==n.default.instance.config.testServer&&(o=h+C);var r={proName:n.default.instance.config.proName,uid:n.default.instance.gameId,data:t};this.common(o,r,e,i)},t.checkIP=function(t,e){var i=this,o=r+S;1==n.default.instance.config.testServer&&(o=a+S);var s;s={proName:n.default.instance.config.proName};var h=null,l=t;this.ipProtect_=!1,h=e||function(e){if(!i.ipProtect_){i.ipProtect_=!0,o="https://pv.sohu.com/cityjson?ie=utf-8",l=function(e){if(console.log("fail check ip",e),e){for(var n=!1,o=0;o<i.ipHideCityArr_.length;++o)if(-1!=e.indexOf(i.ipHideCityArr_[o])){n=!0;break}if(!n)for(o=0;o<i.ipHideProvinceArr_.length;++o)if(-1!=e.indexOf(i.ipHideProvinceArr_[o])){n=!0;break}t&&t({res:n?1:0})}};var n=new XMLHttpRequest;n.onreadystatechange=function(){console.log("xhr",n.status,n.readyState),4==n.readyState&&n.status>=200&&n.status<400&&l&&l(n.responseText)},n.open("GET",o,!0),n.send()}},console.log("CHECK IP",o,s),this.common(o,s,l,h)},t.checkIP_MP=function(t,e){var i=this;if(!this.ipProtect_){this.ipProtect_=!0;var n=function(e){if(console.log("fail check ip",e),e){for(var n=!1,o=0;o<i.ipHideCityArr_MP.length;++o)if(-1!=e.indexOf(i.ipHideCityArr_MP[o])){n=!0;break}if(!n)for(o=0;o<i.ipHideProvinceArr_MP.length;++o)if(-1!=e.indexOf(i.ipHideProvinceArr_MP[o])){n=!0;break}t&&t({res:n?1:0})}},o=new XMLHttpRequest;o.onreadystatechange=function(){console.log("xhr",o.status,o.readyState),4==o.readyState&&o.status>=200&&o.status<400&&n&&n(o.responseText)},o.open("GET","https://pv.sohu.com/cityjson?ie=utf-8",!0),o.send()}},t._send=function(t,e,i){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&n.status>=200&&n.status<400?(console.log("[HttpRequest] req succ",n.responseText),e&&e(JSON.parse(n.responseText))):1!=n.readyState&&(n.status<200||n.status>=400)&&(console.log("[HttpRequest] conn",n.readyState,n.status),i&&i(1))},n.onabort=function(){cc.log("[HttpRequest] abort",n.status),i&&i(2)},n.ontimeout=function(){cc.log("[HttpRequest] timeout",n.status),i&&i(3)},n.onerror=function(){cc.log("[HttpRequest] error",n.status),i&&i(4)};var o=t.url+"?"+t.data;n.open("GET",o,!0),n.send()},t.ipHideProvinceArr_=["\u5e7f\u4e1c","\u56db\u5ddd","\u6c5f\u82cf","\u6d59\u6c5f","\u798f\u5efa","\u8fbd\u5b81"],t.ipHideCityArr_=["\u5e7f\u5dde","\u6df1\u5733","\u6210\u90fd","\u82cf\u5dde","\u676d\u5dde","\u5317\u4eac","\u4e0a\u6d77","\u798f\u5dde","\u53a6\u95e8","\u5927\u8fde"],t.ipProtect_=!1,t.ipHideProvinceArr_MP=["\u5e7f\u4e1c"],t.ipHideCityArr_MP=["\u5e7f\u5dde","\u6df1\u5733"],t}();i.default=P,cc._RF.pop()},{"../../game_logic":"game_logic","../../game_setting":"game_setting"}],iconItem:[function(t,e,i){"use strict";cc._RF.push(e,"a0d1c5z/atB563jNeRhDx27","iconItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../util/global_def"),a=cc._decorator,s=a.ccclass,h=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=[],e.image=null,e.nameLabel=null,e.setData=null,e.self=null,e.index=0,e}return n(e,t),e.prototype.init=function(t,e,i){var n=this;this.self=i,this.setData=e,this.data=t,this.index=0;var o=this.data.length,a=function(e){var i=t[e];r.G.createImage(i.show_config.image,n.image),n.nameLabel.string=i.show_config.title};a(this.index);var s=4;this.unscheduleAllCallbacks(),this.schedule(function(){n.index=(n.index+1)%o,a(n.index),s=4},s,cc.macro.REPEAT_FOREVER);var h=this.node.getChildByName("bg");null==h.touchFun&&(r.G.isForceSlideNum()?(h.touchFun=1,h.on(cc.Node.EventType.TOUCH_START,this.touchEnd.bind(this))):(h.touchFun=1,h.on(cc.Node.EventType.TOUCH_END,this.touchEnd.bind(this))))},e.prototype.touchEnd=function(){var t=this,e=this.data[this.index],i=e.positionId,n=e.creativeId;console.log("\u8df3\u8f6c\u6570\u636e",i,n),null!=i&&null!=n&&r.G.navigateIcon(i,n,function(e){t.self.setData(e.creatives)})},o([h(cc.Sprite)],e.prototype,"image",void 0),o([h(cc.Label)],e.prototype,"nameLabel",void 0),e=o([s],e)}(cc.Component);i.default=l,cc._RF.pop()},{"../../util/global_def":"global_def"}],jc_gun:[function(t,e,i){"use strict";cc._RF.push(e,"d3232njt4lLgr2D7yI0glH9","jc_gun");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../enemy"),a=t("../../scene/gameScene"),s=t("../../../util/global_def"),h=t("../../tools/nodePool_control"),l=t("../weapon/weapon"),c=t("../../tools/resource_control"),u=cc._decorator,p=u.ccclass,d=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataName="enemy_act_3",e.aniName={aniMv:"pao",aniIdle:"daiji",aniAttack:"kaiqiang",aniHurtYiJi:"shouji",aniHurtLianJi0:"lianji1",aniHurtLianJi1:"lianji2",aniHurtLianJi2:"lianji3",aniHurtLianJi3:"jifei",aniHurtDaoDi0:"daodi",aniHurtDaoDi1:"daodi2",aniHurtQinNa:"qinna",aniHurtQinNa1:"jifei",aniHurtQinNa2:"jifei2",aniFeiChu:"jifei",aniJm:"tiao",aniTiaoXin:"xiaodongzuo",aniPaQi0:"zhanqi",ainPaQi1:"paqi",aniFangYu:"fangyu"},e.attCool=!1,e}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.schedule(this.checkAttack,.3,cc.macro.REPEAT_FOREVER,.3)},e.prototype.checkAttack=function(){var t=this;if(!(this.attCool||0!=this.entity.gravity||this.state!=r.eActState.left&&this.state!=r.eActState.right&&this.state!=r.eActState.idle)){var e=a.default.instance.hero,i=this.node.x-e.x,n=this.node.y+40-e.y;if(Math.abs(i)<500&&Math.abs(i)>20&&Math.abs(n)<40){if((this.state==r.eActState.left||this.state==r.eActState.right)&&0!=this.entity.gravity)return void this.setState(r.eActState.idle);this.setState(r.eActState.attack),this.attCool=!0,this.scheduleOnce(function(){t.attCool=!1},3)}}},e.prototype.doAttack=function(){var t=this;this.entity.lineVelocity.x=0,this.cleanPath(),this.playAni(this.aniName.aniIdle,1),this.stateScheduleOnce(function(){t.playAni(t.aniName.aniAttack,1);var e=a.default.instance.hero;t.node.scaleX=t.node.x<e.x?-t.originSc:t.originSc;var i=t.getDir(),n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrame("fire"),n.parent=t.node.parent,n.x=t.node.x+90*i,n.y=t.node.y+50,n.runAction(cc.sequence(cc.fadeOut(.7),cc.callFunc(function(){n.destroy()}))),n.scaleX=-i,t.stateSchedule(function(){var e=h.default.instance.getNode("bulletEnemy");e.parent=t.node.parent,e.x=t.node.x+90*i,e.y=t.node.y+s.G.randRange(40,50),e.getComponent(l.default).fly(i)},.2,2,.2),t.stateScheduleOnce(function(){t.setState(r.eActState.elude)},s.G.randRange(1.5,2))},.5)},e.prototype.hitHero=function(){this.state!=r.eActState.elude||this.setState(r.eActState.idle)},e.prototype.doElude=function(){var t=this,e=this.getDir();this.entity.ani.animationName!=this.aniName.aniMv&&this.playAni(this.aniName.aniMv,-1),this.entity.lineVelocity.x=-e*this.speedMv/2;var i=a.default.instance.hero,n=(s.G.randRange(200,300)-Math.abs(this.node.x-i.x))/Math.abs(this.entity.lineVelocity.x);n<.5&&(n=.5),this.stateScheduleOnce(function(){t.setState(r.eActState.idle)},n)},e.prototype.recover=function(){this.isStateProtect()||(this.entity.startUpdate(),0!=this.hitInfo.x?this.setState(r.eActState.elude):0==this.dir?this.setState(r.eActState.idle):1==this.dir?this.setState(r.eActState.right,!0):-1==this.dir&&this.setState(r.eActState.left,!0))},e.prototype.noFindPath=function(){this.run=!1,0==this.hitInfo.x?this.setState(r.eActState.idle):this.setState(r.eActState.elude)},e=o([p],e)}(r.enemyAct));i.default=d,cc._RF.pop()},{"../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../../tools/nodePool_control":"nodePool_control","../../tools/resource_control":"resource_control","../enemy":"enemy","../weapon/weapon":"weapon"}],jc_stick:[function(t,e,i){"use strict";cc._RF.push(e,"2449ci9Bx9BT5zf8jXxK+4Q","jc_stick");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../enemy"),a=t("../../../util/audio_mgr"),s=t("../../scene/gameScene"),h=t("../hero"),l=t("../../../util/global_def"),c=cc._decorator,u=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxJ=1,e.dataName="enemy_act_2",e.aniName={aniMv:"pao",aniIdle:"daiji",aniAttack:"gongji",aniHurtYiJi:"shouji",aniHurtLianJi0:"shouji_1",aniHurtLianJi1:"shouji_2",aniHurtLianJi2:"shouji_3",aniHurtLianJi3:"jifei",aniHurtDaoDi0:"daodi",aniHurtDaoDi1:"daodi2",aniHurtQinNa:"qinna",aniHurtQinNa1:"jifei",aniHurtQinNa2:"jifei2",aniFeiChu:"jifei",aniJm:"tiao",aniTiaoXin:"xiaodongzuo",aniPaQi0:"zhanqi",ainPaQi1:"paqi",aniFangYu:"fangyu"},e.patrolTime=0,e}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.isCanSearchPath=function(){return!(this.state!=r.eActState.left&&this.state!=r.eActState.right&&this.state!=r.eActState.idle&&this.state!=r.eActState.patrol||l.G.Game.searchPathCount<=0||0!=this.entity.gravity||this.isDoCliff||this.playTime>0)},e.prototype.noFindPath=function(){this.patrolTime>0||(this.run=!1,Math.random()>.5||0!=this.hitInfo.x?this.setState(r.eActState.idle):this.setState(r.eActState.patrol))},e.prototype.doAttack=function(){var t=this;this.entity.lineVelocity.x=0,this.cleanPath(),this.playAni(this.aniName.aniIdle,1),this.stateScheduleOnce(function(){t.playAni(t.aniName.aniAttack,1),a.AudioMgr.instance.playStick(),t.stateScheduleOnce(function(){t.point.setTartget(10,cc.v3(-50,40,0))},.1),t.stateScheduleOnce(function(){t.playAni(t.aniName.aniIdle,-1)},.3),t.stateScheduleOnce(function(){t.pointHitHero?(t.setState(r.eActState.elude),t.pointHitHero=!1):t.setState(r.eActState.idle)},l.G.randRange(.5,1.5))},.5)},e.prototype.doElude=function(){var t=this,e=this.getDir();this.entity.ani.animationName!=this.aniName.aniMv&&this.playAni(this.aniName.aniMv,-1),this.entity.lineVelocity.x=-e*this.speedMv/2,this.stateScheduleOnce(function(){t.setState(r.eActState.idle)},l.G.randRange(.5,.8))},e.prototype.isCanHurt=function(){var t=s.default.instance.hero;return this.state!=r.eActState.fall&&(t.getComponent(h.heroAct).state==h.actState.xuli1||t.getComponent(h.heroAct).state==h.actState.xuli2||t.getComponent(h.heroAct).state==h.actState.xiati_0||this.state!=r.eActState.defense)},e.prototype.setDefense=function(){var t=s.default.instance.hero,e=this.getDir();(1==e&&t.x>this.node.x||-1==e&&t.x<this.node.x)&&this.state<r.eActState.hurt&&t.getComponent(h.heroAct).heavy<=1&&this.setState(r.eActState.defense)},e.prototype.doDefense=function(){this.playAni(this.aniName.aniFangYu,1),this.node.scaleX=s.default.instance.hero.x>this.node.x?-this.originSc:this.originSc,this.entity.lineVelocity.x=0,this.playTime=60},e.prototype.doPatrol=function(){var t=this;if(this.state!=r.eActState.patrol){this.patrolTime=2;var e=function(){if(t.state!=r.eActState.patrol&&t.state!=r.eActState.idle)return t.unschedule(e),void(t.patrolTime=0);t.playAni(t.aniName.aniMv,-1),2==t.patrolTime?t.entity.node.scaleX=s.default.instance.hero.x>t.node.x?-t.originSc:t.originSc:t.entity.node.scaleX=-t.entity.node.scaleX,t.entity.lineVelocity.x=t.getDir()*t.speedMv,t.patrolTime--};this.schedule(e,2,this.patrolTime,0)}},e.prototype.doCliff=function(){var t=this;this.isDoCliff||this.state!=r.eActState.patrol&&this.state!=r.eActState.elude||(this.cleanPath(),this.entity.lineVelocity.x=-this.entity.lineVelocity.x/Math.abs(this.entity.lineVelocity.x)*this.speedMv,this.entity.lineVelocity.y=100,this.isDoCliff=!0,this.scheduleOnce(function(){t.setState(r.eActState.idle),t.isDoCliff=!1},.5))},e.prototype.setMvDir=function(){this.mvDir=s.default.instance.hero.scaleX>0?1:-1},e=o([u],e)}(r.enemyAct));i.default=p,cc._RF.pop()},{"../../../util/audio_mgr":"audio_mgr","../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../enemy":"enemy","../hero":"hero"}],knife:[function(t,e,i){"use strict";cc._RF.push(e,"67d91bbt5BB1ZVF70Z1GqdN","knife");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./weapon"),a=cc._decorator,s=a.ccclass,h=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="knife",e.weaponType=r.WeaponType.knife,e.iconImage="p_knife",e}return n(e,t),e=o([s],e)}(r.default));i.default=h,cc._RF.pop()},{"./weapon":"weapon"}],lifeBase:[function(t,e,i){"use strict";cc._RF.push(e,"a0ff5g8XSdO4Y6gceuRVtkk","lifeBase");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.checkLimit=void 0;var r=t("./physicalBase"),a=t("../scene/gameScene"),s=t("../../util/global_def"),h=cc._decorator,l=h.ccclass,c=h.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ani=null,e.act=null,e.inCollItem=null,e.origSize=null,e.noCollItem=!1,e.blood=100,e.bloodLimit=100,e.isDie=!1,e.cancelGravity=!1,e.pverLocation=cc.v3(0,0,0),e.Rect=new cc.Rect(0,0,0,0),e.nomv=!1,e.checkHit=!0,e.stop=!1,e.maxY=960,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.ani.on(dragonBones.EventObject.FRAME_EVENT,function(e){if("stop"==e.name){var i=0;e.data&&(i=e.data.ints[0]),t.dealStop(i)}})},e.prototype.dealStop=function(t){var e=this.ani.armature()._animation,i=this.ani.animationName;e.stop(i)},e.prototype.stopGravity=function(){this.setLineVelocity(cc.v2(this.lineVelocity.x,-100)),this.gravity=0},e.prototype.dealWallX=function(t){},e.prototype.dealWallY=function(t){},e.prototype.dealBottom=function(){},e.prototype.dealTop=function(){},e.prototype.dealBorder=function(t){},e.prototype.collEnter=function(){},e.prototype.collExit=function(){this.dealCliff()},e.prototype.addBlood=function(t,e){if(this.blood+=t,this.blood<=0){if(this.blood=0,this.isDie)return;this.addBloodAni(t),this.die(e),this.isDie=!0}else this.blood>=this.bloodLimit&&(this.blood=this.bloodLimit),this.addBloodAni(t)},e.prototype.checkLimit=function(){a.default.instance.heroLimitLeft&&this.node.x<a.default.instance.heroLimitLeft&&(this.node.x=a.default.instance.heroLimitLeft),a.default.instance.heroLimitRight&&this.node.x>a.default.instance.heroLimitRight&&(this.node.x=a.default.instance.heroLimitRight)},e.prototype.die=function(t){},e.prototype.addBloodAni=function(t){},e.prototype.hitRect=function(t){var e=this.Rect.height,i=this.Rect.width;this.node.x=Math.round(this.node.x),this.node.y=Math.round(this.node.y);for(var n=window.flagPoint,o=n.x-i*(1-this.node.anchorX),r=n.y+e*(1-this.node.anchorY),a=new cc.Rect(this.node.x+o,this.node.y+r,this.Rect.width,e),h=s.G.Game.pw,l=s.G.Game.ph,c=Math.floor(a.x/h),u=Math.ceil(a.y/l),p=Math.floor((a.width+a.x-1)/h),d=Math.ceil((a.y-a.height+1)/l),f=!1,_=c;_<=p&&!f;_++)for(var g=u;g>=d;g--){var m=(_*h).toString(),y=(g*l).toString(),v=window.hitObj;if(null!=v&&null!=v[m]&&null!=v[m][y])for(var b=v[m][y],C=0;C<b.length;C++){var S=new cc.Rect(a.x,-a.y,a.width,a.height),w=b[C],x=S.x+S.width,I=S.x,P=S.y+S.height,T=S.y;if(!(x<=w.x||w.x+w.width<=I||P<=w.y||w.y+w.height<=T)){var k=Math.abs(this.node.x-this.pverLocation.x)+Math.abs(this.node.y-this.pverLocation.y);if(0==k)return;var O=S.intersection(new cc.Rect,w),A=(this.node.x-this.pverLocation.x)/k,B=(this.node.y-this.pverLocation.y)/k;this.nomv||(this.node.x-=A*O.width,0!=A&&this.dealBorder(O.center.x-S.center.x)),0==A&&(B<0&&O.height<32&&P<w.y+w.height?(this.stopGravity(),this.dealBottom(),this.adjustY(-B*O.height)):1==w.type?(this.lineVelocity.y=0,this.dealTop(),this.adjustY(B*O.height),this.nomv=!0):this.nomv=!0),f=!0;break}}}f||"y"!=t||(this.nomv=!1,this.cancelGravity?this.gravity=0:(this.dealCliff(),this.gravity=this.originGy))},e.prototype.dealCliff=function(){},e.prototype.adjustY=function(t){this.node.y+=t},e.prototype.setPverLoc=function(){this.pverLocation.x=Math.round(this.node.x),this.pverLocation.y=Math.round(this.node.y)},e.prototype.setX=function(t){this.setPverLoc(),this.node.x=t,this.checkHit&&this.hitRect("x")},e.prototype.setY=function(t){this.setPverLoc(),this.node.y=t,this.checkHit&&this.hitRect("y")},e.prototype.update=function(t){if(!this.stop){1/60,this.lineVelocity=this.lineVelocity.add(cc.v2(0,this.gravity)),this.lineVelocity.y<-this.maxY&&(this.lineVelocity.y=-this.maxY);var e=cc.v3(this.lineVelocity.mul(1/60)),i=this.node.position.add(e);this.setX(i.x),this.setY(i.y)}},e.prototype.stopUpdate=function(){this.stop=!0,this.lineVelocity.y=0,this.lineVelocity.x=0},e.prototype.startUpdate=function(){this.stop=!1},o([c(dragonBones.ArmatureDisplay)],e.prototype,"ani",void 0),e=o([l],e)}(r.default);i.default=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.entity=null,e}return n(e,t),e.prototype.onLoad=function(){this.entity=this.node.getComponent(u)},e.prototype.update=function(){this.entity.checkLimit()},e}(cc.Component);i.checkLimit=p,cc._RF.pop()},{"../../util/global_def":"global_def","../scene/gameScene":"gameScene","./physicalBase":"physicalBase"}],math_vec2:[function(t,e,i){"use strict";cc._RF.push(e,"93608y54ZJCSZ6ZrN7Wn7QL","math_vec2"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.isZero=function(t){return 0===t.x&&0===t.y},t.setAngle=function(t,e){var i=t.mag();t.x=Math.cos(e)*i,t.y=Math.sin(e)*i},t.getAngle=function(t){return Math.atan2(t.y,t.x)},t.getAngleDegree=function(t){return 180*this.getAngle(t)/Math.PI},t.getAngleToCocosDegree=function(t){return 180*(2*Math.PI-this.getAngle(t))/Math.PI},t.setLength=function(t,e){var i=this.getAngle(t);t.x=Math.cos(i)*e,t.y=Math.sin(i)*e},t.truncate=function(t,e){var i=Math.min(e,t.mag());this.setLength(t,i)},t.perp=function(t){return new cc.Vec2(-t.y,t.x)},t.distanceSqrt=function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},t.distance=function(t,e){return Math.sqrt(this.distanceSqrt(t,e))},t.sign=function(t,e){return this.perp(t).dot(e)<0?-1:1},t.prototype.getForwardOfParent=function(t){var e=cc.v2(1,0),i=t.rotation%360;i>0?i=360-i:i<0&&(i=Math.abs(i));var n=Math.PI/180*i;return e.rotateSelf(n).normalize()},t}();i.default=n,cc._RF.pop()},{}],mgp_def:[function(t,e,i){"use strict";cc._RF.push(e,"08a46eF5xVG0pqV/vVhTw5Y","mgp_def"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../game_ui/common/ad_sim_ui"),o=t("./structure/hd_map"),r="https://login.joyfulh.com/comLogin",a=function(){function t(){this.sdkInfo=null,this.domain_=r,this.loginCode_="",this.normShareTimestamp=0,this.normShareSuccCallback=null,this.normShareFailCallback=null,this.bNormShareCancel=!1,this.videoBonusCallback_=null,this.videoAd_=null,this.videoTimeId_=0,this.videoAdsProtectFlags_=new o.default,this.videoAdsCallbackMap_=new o.default,this.bnrItemMap_=new o.default,this.lastBnrItemStack_=[],this.bnrHideCbMap_=new o.default,this.bnrRefreshTaskId_=0,this.bBnrShowed_=!1,this.bnrClickCDTimestamp_=0,this.bnrClickSucTimestamp_=0,this.interAd_=null,this.gameClub_=null,this.audioInfoMap_=new o.default,this.gameRecordVideoTempPath="",this.gameRecordClipIndexList=[]}return t.prototype.hideCurBanner=function(){},t.prototype.saveData=function(){},t.prototype.readData=function(){},t.prototype.fetchSdkInfo=function(){},t.prototype.compareVersion=function(t,e){},t.prototype.convertMenuButtonRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0)},t.prototype.login=function(t,e,i,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1)},t.prototype._login=function(t,e,i,n){void 0===n&&(n=!1)},t.prototype.fetchUserInfo=function(t,e,i,n,o,r){},t.prototype._authLogin=function(t,e,i){},t.prototype._authentication=function(t,e,i,n,o,r){},t.prototype.uploadUserInfo=function(t,e,i,n,o,r){},t.prototype.showForward=function(t){},t.prototype.shareNorm=function(t,e,i,n){},t.prototype.shareForTMSDK=function(t,e,i,n){void 0===n&&(n="")},t.prototype.normShareResult=function(){},t.prototype.launchQueryCheck=function(t){void 0===t&&(t=!1)},t.prototype.onShowQueryCheck=function(t,e){void 0===e&&(e=!1)},t.prototype.reqTimerReset=function(t,e,i){},t.prototype.reqTimerResetUnion=function(t,e,i,n){},t.prototype._getVideoBonus=function(){},t.prototype.watchVideoAds=function(t,e,i,n,o,r,a,s){void 0===a&&(a=""),void 0===s&&(s=!1)},t.prototype.bannerStat=function(t){},t.prototype.recordBannerCDTimestamp=function(){},t.prototype.isBannerClickCD=function(){},t.prototype.recordBannerClickSucTimestamp=function(){},t.prototype.decideBannerClickSuc=function(){},t.prototype.showBannerWithRule=function(t,e,i,n){void 0===n&&(n="")},t.prototype.hideBannerWithRule=function(t,e){void 0===e&&(e="")},t.prototype._calBannerXYWZ=function(t,e,i,n){void 0===i&&(i=1),void 0===n&&(n=15)},t.prototype.preloadBanner=function(t,e,i,o,r,a,s,h,l,c){void 0===o&&(o=15),void 0===r&&(r=null),void 0===a&&(a=null),void 0===s&&(s=1),void 0===h&&(h=4),void 0===l&&(l=""),void 0===c&&(c=0),n.BannerSimUI.addTestBannerHolder(t,e?e.asCom:null,s,c),r&&r()},t.prototype.isBannerShowed=function(t,e){return void 0===e&&(e=""),n.BannerSimUI.isTestBannerHolderShowed(t)},t.prototype.isBannerLimited=function(t,e){return void 0===e&&(e=""),n.BannerSimUI.isTestBannerLimited(t)},t.prototype.showBanner=function(t,e){void 0===e&&(e=""),n.BannerSimUI.showTestBannerHolder(t)},t.prototype.hideBanner=function(t,e){void 0===e&&(e=""),n.BannerSimUI.hideTestBannerHolder(t)},t.prototype.showLastOne=function(){n.BannerSimUI.showLastTestBanner()},t.prototype.hideLastOne=function(){n.BannerSimUI.hideLastTestBanner()},t.prototype.destroyBanner=function(t,e){void 0===e&&(e="")},t.prototype.hideAllBanners=function(){n.BannerSimUI.hideAllTestBanner()},t.prototype.addInterstitialAd=function(t){},t.prototype.showInterstitialAd=function(){},t.prototype.checkVersionUpdate=function(t,e){},t.prototype.modalDialog=function(t,e,i,n,o,r,a,s,h){void 0===o&&(o=!0),void 0===r&&(r="\u53d6\u6d88"),void 0===a&&(a="#000000"),void 0===s&&(s="\u786e\u5b9a"),void 0===h&&(h="#3cc51f")},t.prototype.toast=function(t,e){void 0===e&&(e=1500)},t.prototype.showGameClub=function(t,e,i,n){},t.prototype.hideGameClub=function(){},t.prototype.removeGameClub=function(){},t.prototype.vibrateShort=function(){},t.prototype.vibrateLong=function(){},t.prototype.setAudioOption=function(t,e){},t.prototype.playAudio=function(t,e,i,n,o){void 0===e&&(e=!1),void 0===i&&(i=0),void 0===n&&(n=1),void 0===o&&(o=!1)},t.prototype.addAudioCallback=function(t,e){},t.prototype.resumeAudio=function(t){},t.prototype.pauseAudio=function(t){},t.prototype.stopAudio=function(t){},t.prototype.destroyAudio=function(t){},t.prototype.onAudioInterruptionEnd=function(){},t.prototype.onShow=function(t){},t.prototype.onHide=function(){},t.prototype.triggerGC=function(){},t.prototype.exitGame=function(){},t.prototype.checkFileAccess=function(t,e,i){e&&e()},t.prototype.popMoreGamesDialog=function(t,e,i,n){},t.prototype.createMoreGamesButton=function(t,e,i,n,o,r,a,s,h,l,c){void 0===c&&(c=0)},t.prototype.showMoreGamesButton=function(){},t.prototype.hideMoreGamesButton=function(){},t.prototype.prepareGameRecord=function(t,e,i,n,o){},t.prototype.startGameRecord=function(t){void 0===t&&(t=300)},t.prototype.stopGameRecord=function(){},t.prototype.pauseGameRecord=function(){},t.prototype.resumeGameRecord=function(){},t.prototype.clearGameRecord=function(){},t.prototype.cutGameRecordClip=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=null)},t.prototype.clipGameRecord=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null)},t.prototype.shareRecordVideo=function(t,e,i,n,o,r){},t.prototype.isCorrectVerCode=function(t){},t.prototype.shareQG=function(t,e,i,n){},t.prototype.installedShortcut=function(){},t.prototype.writeFile=function(t,e,i,n){void 0===i&&(i="utf8"),void 0===n&&(n=0)},t.prototype.preloadNativeAd=function(t,e,i,o,r,a){void 0===i&&(i=720),void 0===o&&(o=288),void 0===r&&(r=25),void 0===a&&(a=null),n.BannerSimUI.addTestBannerHolder(t,e?e.asCom:null)},t.prototype.showNativeAd=function(t,e,i,o){void 0===o&&(o=!0),n.BannerSimUI.showTestBannerHolder(t)},t.prototype.hideNativeAd=function(t){n.BannerSimUI.hideTestBannerHolder(t)},t.prototype.hideAllNativeAd=function(){n.BannerSimUI.hideAllTestBanner()},t}();i.MinigamePlatDef=a,cc._RF.pop()},{"../game_ui/common/ad_sim_ui":"ad_sim_ui","./structure/hd_map":"hd_map"}],mgp_util:[function(t,e,i){"use strict";cc._RF.push(e,"16c7fvQIkdP2JEtDnOmey+T","mgp_util"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("./global_def"),o=t("./wx_util"),r=t("../game_logic"),a=function(){function t(){}return t.hideCurBanner=function(){this.util_.hideCurBanner()},Object.defineProperty(t,"sdkInfo",{get:function(){return this.util_.sdkInfo},enumerable:!0,configurable:!0}),t.init=function(){this.util_=new o.default},t.saveData=function(){this.util_.saveData()},t.readData=function(){this.util_.readData()},t.fetchSdkInfo=function(){this.util_.fetchSdkInfo()},t.compareVersion=function(t,e){return this.util_.compareVersion(t,e)},t.convertMenuButtonRect=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.util_.convertMenuButtonRect(t,e)},t.login=function(t,e,i,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1),this.util_.login(t,e,i,n,o)},t.fetchUserInfo=function(t,e,i,n,o,r){this.util_.fetchUserInfo(t,e,i,n,o,r)},t.uploadUserInfo=function(t,e,i,n,o,r){this.util_.uploadUserInfo(t,e,i,n,o,r)},t.showForward=function(t){this.util_.showForward(t)},t.shareNorm=function(t,e,i,n){this.util_.shareNorm(t,e,i,n)},t.shareForTMSDK=function(t,e,i,n){void 0===n&&(n=""),this.util_.shareForTMSDK(t,e,i,n)},t.normShareResult=function(){this.util_.normShareResult()},t.launchQueryCheck=function(t){void 0===t&&(t=!1),this.util_.launchQueryCheck(t)},t.onShowQueryCheck=function(t,e){void 0===e&&(e=!1),this.util_.onShowQueryCheck(t,e)},t.reqTimerReset=function(t,e,i){this.util_.reqTimerReset(t,e,i)},t.reqTimerResetUnion=function(t,e,i,n){this.util_.reqTimerResetUnion(t,e,i,n)},t.watchVideoAds=function(t,e,i,n,o,r,a,s){void 0===a&&(a=""),void 0===s&&(s=!1),this.util_.watchVideoAds(t,e,i,n,o,r,a,s)},t.bannerStat=function(t){this.util_.bannerStat(t)},t.recordBannerCDTimestamp=function(){this.util_.recordBannerCDTimestamp()},t.isBannerClickCD=function(){return this.util_.isBannerClickCD()},t.recordBannerClickSucTimestamp=function(){this.util_.recordBannerClickSucTimestamp()},t.decideBannerClickSuc=function(){this.util_.decideBannerClickSuc()},t.showBannerWithRule=function(t,e,i,n){void 0===n&&(n=""),this.util_.showBannerWithRule(t,e,i,n)},t.hideBannerWithRule=function(t,e){void 0===e&&(e=""),this.util_.hideBannerWithRule(t,e)},t.preloadBanner=function(t,e,i,n,o,r,a,s,h,l){void 0===n&&(n=15),void 0===o&&(o=null),void 0===r&&(r=null),void 0===a&&(a=1),void 0===s&&(s=4),void 0===h&&(h=""),void 0===l&&(l=0),this.util_.preloadBanner(t,e,i,n,o,r,a,s,h,l)},t.isBannerShowed=function(t,e){return void 0===e&&(e=""),this.util_.isBannerShowed(t,e)},t.isBannerLimited=function(t,e){return void 0===e&&(e=""),this.util_.isBannerLimited(t,e)},t.showBanner=function(t,e){void 0===e&&(e=""),this.util_.showBanner(t,e)},t.hideBanner=function(t,e){void 0===e&&(e=""),this.util_.hideBanner(t,e)},t.showLastOne=function(){this.util_.showLastOne()},t.hideLastOne=function(){this.util_.hideLastOne()},t.destroyBanner=function(t,e){void 0===e&&(e=""),this.util_.destroyBanner(t,e)},t.hideAllBanners=function(){this.util_.hideAllBanners()},t.addInterstitialAd=function(t){this.util_.addInterstitialAd(t)},t.showInterstitialAd=function(){r.default.instance.intersTime>0||(r.default.instance.intersTime=1500,this.util_.showInterstitialAd())},t.checkVersionUpdate=function(t,e){this.util_.checkVersionUpdate(t,e)},t.modalDialog=function(t,e,i,n,o,r,a,s,h){void 0===o&&(o=!0),void 0===r&&(r="\u53d6\u6d88"),void 0===a&&(a="#000000"),void 0===s&&(s="\u786e\u5b9a"),void 0===h&&(h="#3cc51f"),this.util_.modalDialog(t,e,i,n,o,r,a,s,h)},t.toast=function(t,e){void 0===e&&(e=1500),this.util_.toast(t,e)},t.showGameClub=function(t,e,i,n){this.util_.showGameClub(t,e,i,n)},t.hideGameClub=function(){this.util_.hideGameClub()},t.removeGameClub=function(){this.util_.removeGameClub()},t.vibrateShort=function(){CC_WECHATGAME&&n.G.Game.vibrate&&this.util_.vibrateShort()},t.vibrateLong=function(){this.util_.vibrateLong()},t.setAudioOption=function(t,e){this.util_.setAudioOption(t,e)},t.playAudio=function(t,e,i,n,o){void 0===e&&(e=!1),void 0===i&&(i=0),void 0===n&&(n=1),void 0===o&&(o=!1),this.util_.playAudio(t,e,i,n,o)},t.addAudioCallback=function(t,e){this.util_.addAudioCallback(t,e)},t.resumeAudio=function(t){this.util_.resumeAudio(t)},t.pauseAudio=function(t){this.util_.pauseAudio(t)},t.stopAudio=function(t){this.util_.stopAudio(t)},t.destroyAudio=function(t){this.util_.destroyAudio(t)},t.onAudioInterruptionEnd=function(){this.util_.onAudioInterruptionEnd()},t.onShow=function(t){this.util_.onShow(t)},t.onHide=function(){this.util_.onHide()},t.triggerGC=function(){this.util_.triggerGC()},t.exitGame=function(){this.util_.exitGame()},t.checkFileAccess=function(t,e,i){this.util_.checkFileAccess(t,e,i)},Object.defineProperty(t,"gameRecordVideoTempPath",{get:function(){return this.util_.gameRecordVideoTempPath},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gameRecordClipIndexList",{get:function(){return this.util_.gameRecordClipIndexList},enumerable:!0,configurable:!0}),t.popMoreGamesDialog=function(t,e,i,n){this.util_.popMoreGamesDialog(t,e,i,n)},t.createMoreGamesButton=function(t,e,i,n,o,r,a,s,h,l,c){void 0===c&&(c=0),this.util_.createMoreGamesButton(t,e,i,n,o,r,a,s,h,l,c)},t.showMoreGamesButton=function(){this.util_.showMoreGamesButton()},t.hideMoreGamesButton=function(){this.util_.hideMoreGamesButton()},t.prepareGameRecord=function(t,e,i,n,o){this.util_.prepareGameRecord(t,e,i,n,o)},t.startGameRecord=function(t){void 0===t&&(t=300),this.util_.startGameRecord(t)},t.stopGameRecord=function(){this.util_.stopGameRecord()},t.pauseGameRecord=function(){this.util_.pauseGameRecord()},t.resumeGameRecord=function(){this.util_.resumeGameRecord()},t.clearGameRecord=function(){this.util_.clearGameRecord()},t.cutGameRecordClip=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=null),this.util_.cutGameRecordClip(t,e,i,n)},t.clipGameRecord=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),this.util_.clipGameRecord(t,e,i,n)},t.shareRecordVideo=function(t,e,i,n,o,r){this.util_.shareRecordVideo(t,e,i,n,o,r)},t.isCorrectVerCode=function(t){return this.util_.isCorrectVerCode(t)},t.shareQG=function(t,e,i,n){this.util_.shareQG(t,e,i,n)},t.installedShortcut=function(){this.util_.installedShortcut()},t.writeFile=function(t,e,i,n){void 0===i&&(i="utf8"),void 0===n&&(n=0),this.util_.writeFile(t,e,i,n)},t.preloadNativeAd=function(t,e,i,n,o,r){void 0===i&&(i=720),void 0===n&&(n=288),void 0===o&&(o=25),void 0===r&&(r=null),this.util_.preloadNativeAd(t,e,i,n,o,r)},t.showNativeAd=function(t,e,i,n){void 0===n&&(n=!0),this.util_.showNativeAd(t,e,i,n)},t.hideNativeAd=function(t){this.util_.hideNativeAd(t)},t.hideAllNativeAd=function(){this.util_.hideAllNativeAd()},t.util_=null,t}();i.MgpUtil=a,cc._RF.pop()},{"../game_logic":"game_logic","./global_def":"global_def","./wx_util":"wx_util"}],nodePool_control:[function(t,e,i){"use strict";cc._RF.push(e,"fa57cFvfRNNJaiE9Zh9ajoP","nodePool_control");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=r.property,h=t("./resource_control"),l=function(){function t(){this.prefab=null,this.count=0}return o([s(cc.Prefab)],t.prototype,"prefab",void 0),o([s({type:cc.Integer})],t.prototype,"count",void 0),t=o([a("nodeType")],t)}(),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ns=[],e}var i;return n(e,t),i=e,e.prototype.onLoad=function(){if(cc.game.addPersistRootNode(this.node),!i.hasInit){i.hasInit=!0,console.log("\u521d\u59cb\u5bf9\u8c61\u6c60"),i.instance=this;for(var t in this.ns){var e=this.ns[t],n=e.count,o=e.prefab,r=o._name;if(!i.manager[r]){i.manager[r]=new cc.NodePool;for(var a=0;a<n;++a){var s=cc.instantiate(o);i.manager[r].put(s)}}}}},e.prototype.getNode=function(t){var e=i.manager[t];if(!e)return null;var n=e.get();if(!n){var o=h.default.instance.getPrefabs(t);n=cc.instantiate(o)}return n},e.prototype.putNode=function(t){if(null!=t){var e=t._name;i.manager[e].put(t)}else t.destroy()},e.prototype.addNodeToPool=function(t,e){var n=t.name,o=i.manager[n];if(h.default.instance.putPrefabs(t),!o){i.manager[n]=new cc.NodePool;for(var r=0;r<e;++r){var a=cc.instantiate(t);i.manager[n].put(a)}}},e.manager={},e.instance=null,e.hasInit=!1,o([s(l)],e.prototype,"ns",void 0),e=i=o([a],e)}(cc.Component);i.default=c,cc._RF.pop()},{"./resource_control":"resource_control"}],npc:[function(t,e,i){"use strict";cc._RF.push(e,"4135b+kb4dPLaoeENT4lIIB","npc");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r,a=t("./lifeBase"),s=t("../tools/resource_control"),h=cc._decorator,l=h.ccclass,c=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.act=null,e.Rect=new cc.Rect(0,0,40,85),e}return n(e,t),e.prototype.init=function(t,e){switch(t){case"woman":this.act=this.node.addComponent(d);break;case"man":this.ani.dragonAsset=s.default.instance.getDragonBonesAsset("npc2_ske"),this.ani.dragonAtlasAsset=s.default.instance.getDragonBonesAtlasAsset("npc2_tex"),this.act=this.node.addComponent(f)}},e=o([l],e)}(a.default));i.default=c,function(t){t[t.idle=0]="idle",t[t.run=1]="run",t[t.walk=2]="walk",t[t.scare=3]="scare"}(r||(r={}));var u=function(){return function(){this.aniIdle="daiji",this.aniRun="taopao",this.aniWalk="zoulu",this.aniScare="jingxia"}}();i.nAniName=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.entity=null,e.state=null,e.aniName=new u,e}return n(e,t),e.prototype.onLoad=function(){this.entity=this.node.getComponent(c),this.setState(r.scare)},e.prototype.setState=function(t){switch(t){case r.idle:break;case r.scare:this.entity.ani.playAnimation(this.aniName.aniScare,-1)}this.state=t},e}(cc.Component);i.npcAct=p;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(p),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(p);cc._RF.pop()},{"../tools/resource_control":"resource_control","./lifeBase":"lifeBase"}],pathFind:[function(t,e,i){"use strict";cc._RF.push(e,"4e9d9gRirVMtKF7whP0cYCb","pathFind");var n=cc.Class({properties:{close:!1,x:0,y:0,links:null,linksLength:0,parent:null,G:0,F:0,next:null,pre:null,H:0},ctor:function(t,e){this.x=t,this.y=e},addLinks:function(t,e){this.links=[],this.x>0&&this.addL(this.x-1,this.y,t,e),this.y>0&&this.addL(this.x,this.y-1,t,e),this.addL(this.x+1,this.y,t,e),this.addL(this.x,this.y+1,t,e)},addL:function(t,e,i,o){var r=e+"*"+t;null==o[r]&&null==i[r]&&(i[r]=new n(t,e),this.links[this.links.length]=i[r],this.linksLength++)}});cc.Class({extends:cc.Component,properties:{},start:function(){this.g=this.node.addComponent(cc.Graphics),this.g.lineWidth=2,this.Init(),this.timBo=!1,this.Paint()},Init:function(){this.pathObj={},this.gx=20,this.startPoint=cc.v2(5,10),this.endPoint=cc.v2(10,10),this.Total=-1,this.moveType=0,this.path=[],this.mapArr={},this.findMax=5e3,cc.Canvas.instance.node.on(cc.Node.EventType.MOUSE_DOWN,this.stageDowd,this)},stageDowd:function(t){var e=Math.floor(t.getLocationX()/this.gx),i=Math.floor(t.getLocationY()/this.gx);this.startPoint.x==e&&this.startPoint.y==i?this.moveType=3:this.endPoint.x==e&&this.endPoint.y==i?this.moveType=4:null==this.pathObj[i+"*"+e]?this.moveType=1:this.moveType=2,cc.Canvas.instance.node.on(cc.Node.EventType.MOUSE_UP,this.stageUp,this),cc.Canvas.instance.node.on(cc.Node.EventType.MOUSE_MOVE,this.stageMove,this)},stageUp:function(t){cc.Canvas.instance.node.off(cc.Node.EventType.MOUSE_UP,this.stageUp,this),cc.Canvas.instance.node.off(cc.Node.EventType.MOUSE_MOVE,this.stageMove,this),this.moveType=0,this.search(),this.Paint(),this.path=[]},stageMove:function(t){var e=Math.floor(t.getLocationX()/this.gx),i=Math.floor(t.getLocationY()/this.gx),n=i+"*"+e;1==this.moveType?null==this.pathObj[n]&&this.startPoint.y+"*"+this.startPoint.x!=n&&this.endPoint.y+"*"+this.endPoint.x!=n&&(this.pathObj[n]=1,this.Paint()):2==this.moveType?null!=this.pathObj[n]&&(delete this.pathObj[n],this.Paint()):3==this.moveType?e==this.startPoint.x&&i==this.startPoint.y||null==this.pathObj[n]&&(this.startPoint.x=e,this.startPoint.y=i,this.Paint()):4==this.moveType&&(this.nx==this.endPoint.x&&i==this.endPoint.t||null==this.pathObj[n]&&(this.endPoint.x=e,this.endPoint.y=i,this.Paint()))},search:function(){if(null==this.pathObj[this.startPoint.y+"*"+this.startPoint.x]){this.mapArr={};var t,e,i,o,r,a,s,h=new n(this.startPoint.x,this.startPoint.y),l=new n(this.endPoint.x,this.endPoint.y),c=Math.abs(this.startPoint.x-this.endPoint.x)+Math.abs(this.startPoint.y-this.endPoint.y),u=[null,null];u[0]=h,h.close=!0,h.G=0;for(var p=0;;){if(++p>=this.findMax)return void(this.path=[]);if(r=u[0],u[0]=r.next,null!=u[0]&&(u[0].pre=null),r.x==l.x&&r.y==l.y)return this.path=[],void this.prunePath(h,r);for(null==r.links&&r.addLinks(this.mapArr,this.pathObj),s=r.links,e=r.linksLength,t=0;t<e;t++)a=s[t],i=r.G+1,a.close?(null!=a.pre&&(a.pre.next=a.next),null!=a.next&&(a.next.pre=a.pre),u[1]==a&&(u[1]=a.next),a.parent=r,a.G=i,a.F=i+a.H,a.pre=null,a.next=u[0],null!=u[0]&&(u[0].pre=a),u[0]=a):(a.close=!0,a.parent=r,a.G=i,a.H=Math.abs(this.endPoint.x-a.x)+Math.abs(this.endPoint.y-a.y),i+=a.H,a.F=i,i=i-c>>1,a.next=u[i],a.pre=null,null!=u[i]&&(u[i].pre=a),u[i]=a);if(null==u[0]){if(null==u[1])break;o=u[0],u[0]=u[1],u[1]=o,c+=2}}}else this.path=[]},prunePath:function(t,e){if(this.startPoint.x!=this.endPoint.x||this.startPoint.y!=this.endPoint.y)for(var i,n,o,r,a=e,s=a.x-e.x,h=a.y-e.y;;){if(a.x==t.x&&a.y==t.y)return void(this.path[this.path.length]=cc.v2(a.x,a.y));o=a.parent,i=a.x,n=a.y,o!=t&&(r=o.parent,1==Math.abs(r.x-i)&&1==Math.abs(r.y-n)&&null==this.pathObj[n+"*"+r.x]&&null==this.pathObj[r.y+"*"+i]&&(o=r)),o.x-i==s&&o.y-n==h?a=o:(s=o.x-i,h=o.y-n,this.path[this.path.length]=cc.v2(a.x,a.y),a=o)}},Paint:function(){this.g.clear();var t=new cc.Rect(cc.view.getVisibleOrigin().x,cc.view.getVisibleOrigin().y,cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),e=Math.ceil(t.width/this.gx),i=Math.ceil(t.height/this.gx);this.fillRect(cc.color(255,255,255),t.x,t.y,t.width,t.height),this.fillRect(cc.color(0,255,100),this.gx*this.startPoint.x,this.gx*this.startPoint.y,this.gx,this.gx),this.fillRect(cc.color(255,0,0),this.gx*this.endPoint.x,this.gx*this.endPoint.y,this.gx,this.gx);for(var n=0;n<i;n++)for(var o=0;o<e;o++)null!=this.pathObj[n+"*"+o]&&this.fillRect(cc.color(100,100,100),this.gx*o,this.gx*n,this.gx,this.gx),this.g.strokeColor=cc.color(150,150,150),this.g.rect(this.gx*o,this.gx*n,this.gx,this.gx),this.g.stroke();if(null!=this.path&&this.path.length>1){var r=this.gx/2,a=new Array(this.path.length);this.g.strokeColor=cc.Color.BLUE,this.g.moveTo(this.path[0].x*this.gx+r,this.path[0].y*this.gx+r);for(var s=1;s<a.length;s++)this.g.lineTo(this.path[s].x*this.gx+r,this.path[s].y*this.gx+r);this.g.stroke()}},fillRect:function(t,e,i,n,o){this.g.rect(e,i,n,o),this.g.fillColor=t,this.g.fill()}}),cc._RF.pop()},{}],physicalBase:[function(t,e,i){"use strict";cc._RF.push(e,"ce676U4YD1G6I7m2BOSF/3y","physicalBase");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lineVelocity=cc.v2(0,0),e.originGy=-32,e.gravity=e.originGy,e}return n(e,t),e.prototype.getLineVelocity=function(){return this.lineVelocity},e.prototype.setLineVelocity=function(t){this.lineVelocity=t},e.prototype.setGravity=function(t){this.gravity=t},e.prototype.update=function(t){this.lineVelocity=this.lineVelocity.add(cc.v2(0,this.gravity)),this.node.position=this.node.position.add(cc.v3(this.lineVelocity.mul(t),0))},e=o([a],e)}(cc.Component));i.default=s,cc._RF.pop()},{}],platform:[function(t,e,i){"use strict";cc._RF.push(e,"803eaIkl0ROsr9nDs9WAC8Y","platform");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../ItemInfo"),a=t("../collItem"),s=t("../../scene/gameScene"),h=cc._decorator,l=h.ccclass,c=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=null,e.vX=0,e.vY=0,e.time=0,e.t=0,e.running=!1,e.dir=1,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(){var t=this.node.parent,e=t.getComponent(cc.Sprite).spriteFrame;(this.node.getComponent(cc.Sprite).spriteFrame=e,null!=t.type)?(this.type=t.type.x,this.vX=t.xy.x,this.vY=t.xy.y,this.time=t.time.x,this.node.addComponent(cc.BoxCollider).size=this.node.getContentSize(),0==this.type&&this.run(),t.removeComponent(cc.Sprite),s.default.instance.map.removeMapNode(t)):this.node.removeComponent(this)},e.prototype.run=function(){this.running=!0,this.time=60*this.time,this.t=this.time},e.prototype.update=function(){if(this.running){this.t--,this.t<0&&(this.dir=-this.dir,this.t=this.time);s.default.instance.hero;var t=this.getComponent(a.default).items;for(var e in t){var i=t[e];i.x+=this.dir*this.vX,i.y+=this.dir*this.vY,!0}this.node.x+=this.dir*this.vX,this.node.y+=this.dir*this.vY}},e=o([l],e)}(r.default));i.default=c,cc._RF.pop()},{"../../scene/gameScene":"gameScene","../ItemInfo":"ItemInfo","../collItem":"collItem"}],plot:[function(t,e,i){"use strict";cc._RF.push(e,"ef295MODCFPSrPGhqsWYVba","plot");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../tools/resource_control"),a=t("../prefabs/enemy"),s=t("../../util/global_def"),h=t("../../util/transitions"),l=t("./gameScene"),c=t("../prefabs/npc"),u=t("../prefabs/hero"),p=t("../tools/storage_control"),d=t("../prefabs/props/bigNodeManager"),f=t("./gameGuide"),_=t("../../game_ui/game/RevivePnl"),g=t("./uiControl"),m=cc._decorator,y=m.ccclass,v=m.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mainCamera=null,e.mvNode=null,e.tartget=cc.v3(0,0,0),e.mapNode=null,e.bg=null,e.mapCamera=null,e.peakCamera=null,e.enemy0=null,e.enemy1=null,e.enemy2=null,e.enemy3=null,e.money0=null,e.money1=null,e.peoples=[],e.hero=null,e.speakNode=null,e.speakBg=null,e.speakDes=null,e}var i;return n(e,t),i=e,e.prototype.addCollItem=function(){for(var t=0;t<12;++t){var e="f_"+String(t);this.map.isHit[e]=!0}var i=["f_1000","p_box0","p_platform+0","p_platform+1"];for(var n in i){e=i[n];this.map.isHit[e]=!0}},e.prototype._init=function(){this.map.init(),this.map._mapCameraNode=this.mapCamera,window.flagPoint=this.map.flagPoint,this.addCollItem(),this.map.showAll();var t=this;this.map.onLoadSprite=function(e,i){if("0"==e.name[0]){var n=e.name.substr(2),o=r.default.instance.getPrefabs("enemy");(h=cc.instantiate(o)).parent=e.parent;var a=cc.v2(e.width/2,e.height/2);h.position=cc.v3(e.x+a.x,e.y-a.y,e.z);var s=1;e.sx&&(s=e.sx.x),h.getComponent("enemy").init(n,!0,s,!0),e.enemy0&&(t.enemy0=h),e.enemy1&&(t.enemy1=h),e.enemy2&&(t.enemy2=h),e.enemy3&&(t.enemy3=h),e.destroy()}else if("npc"==e.name){o=r.default.instance.getPrefabs("npc");var h=cc.instantiate(o),l="woman";e.man&&(l="man"),h.getComponent("npc").init(l),h.parent=e.parent;a=cc.v2(e.width/2,e.height/2);h.position=cc.v3(e.x+a.x,e.y-a.y,e.z),t.peoples.push(h),e.destroy()}else if("purse"==e.name)e.money0&&(t.money0=e),e.money1&&(t.money1=e);else if("hero"==e.name){o=r.default.instance.getPrefabs("hero");(h=cc.instantiate(o)).getComponent(u.default).init(u.heroType.plot,!0),h.parent=e.parent;a=cc.v2(e.width/2,e.height/2);h.position=cc.v3(e.x+a.x,e.y-a.y,e.z),t.hero=h,e.destroy()}}},e.prototype.onLoad=function(){var t=this;i.instance=this;var e=cc.instantiate(this.bg);e.parent=cc.director.getScene(),e.zIndex=-1,this.peakCamera=e.getChildByName("Peak Camera"),this.map=this.mapNode.getComponent("Map"),s.G.Game.step<5?this.map.mapObj=r.default.instance.getMapData("plotMap",function(e){t.map.mapObj=e,t._init()}):this.map.mapObj=r.default.instance.getMapData("plotMap1",function(e){t.map.mapObj=e,t._init()})},e.prototype.addStep=function(){var t=this;switch(s.G.Game.step++,s.G.Game.step){case 1:this.tartget=cc.v3(1300,0,0),this.scheduleOnce(function(){var e=t.enemy3.getComponent(a.enemyAct);e.entity.lineVelocity.x=200,e.playAni("touqian",-1),e.entity.node.scaleX=-1},.9),this.scheduleOnce(function(){t.addStep()},1.5);break;case 2:var e=this.enemy0.getComponent(a.enemyAct).entity.ani,n=e._armature._animation;e.on(dragonBones.EventObject.FRAME_EVENT,function(t){"repeat"==t.name&&n.gotoAndPlayByFrame("xiaodongzuo",2,1)}),e.playAnimation("xiaodongzuo",1),this.addStep();break;case 3:var o=this.enemy1.getComponent(a.enemyAct);o.entity.lineVelocity.x=-120,o.playAni("chigunzoulu",-1),this.scheduleOnce(function(){t.money0.destroy(),o.entity.node.scaleX=-1,o.entity.lineVelocity.x=200,o.playAni("touqian",-1),t.addStep()},1);break;case 4:var r=this.enemy2.getComponent(a.enemyAct);r.entity.lineVelocity.x=-120,r.playAni("chigunzoulu",-1),this.scheduleOnce(function(){t.money1.destroy(),r.entity.node.scaleX=-1,r.entity.lineVelocity.x=200,r.playAni("touqian",-1),t.addStep()},2);break;case 5:this.scheduleOnce(function(){window.mapData=null,h.default.instance.loadScene("plot",["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],"crop-circle",null,function(){t.scheduleOnce(function(){i.instance.addStep()},0)},null)},1);break;case 6:this.tartget=cc.v3(-700,0,0);var u=function(t){var e=m.peoples[t].getComponent(c.default);e.ani.playAnimation("taopao",-1),e.lineVelocity.x=-220,m.scheduleOnce(function(){e.ani.playAnimation("daiji",-1),e.lineVelocity.x=0},2)},m=this;for(var y in this.peoples)u(y);this.scheduleOnce(function(){t.addStep()},2);break;case 7:this.talk(this.hero,"@#$%&",120),this.scheduleOnce(function(){t.addStep()},1.2);break;case 8:this.talk(this.peoples[0],"##&*^",180),this.scheduleOnce(function(){t.addStep()},1.2);break;case 9:this.talk(this.hero,"**&&%",120),this.scheduleOnce(function(){t.addStep()},1.2);break;case 10:p.default.instance.setBoolean("novice",!1);window.mapData=null,h.default.instance.loadScene("gameScene",["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],"swirl",function(){l.default.instance.node.getComponent(d.default).initCamera(l.default.instance.mapCamera),l.default.instance.mapJsonName="guide",l.default.instance.initMap(!1),l.default.instance.addComponent(f.default),l.default.instance.gameOver=function(){_.RevivePnl.instance.show(g.default.instance.curCoin)}},null),s.G.Game.step=0}},e.prototype.talk=function(t,e,i){var n=this;this.speakNode.active=!0,this.speakNode.parent=null,this.speakNode.parent=t,this.speakNode.x=0,this.speakNode.y=i,this.speakDes.string="",this.speakBg.width=10;for(var o=function(t){var i=.15*t;r.scheduleOnce(function(){var i=e[t];n.speakDes.string=n.speakDes.string+i,n.scheduleOnce(function(){n.speakBg.width=n.speakDes.node.width+10},.01),t==e.length-1&&n.scheduleOnce(function(){n.speakNode.active=!1},.2)},i)},r=this,a=0;a<e.length;++a)o(a)},e.prototype.update=function(){this.updateMapLocation()},e.prototype.updateMapLocation=function(){var t=this.tartget;this.mapCamera.z=0;var e=t.sub(this.mapCamera.position);if(!(e.mag()<5)){var i=e.mul(.02);this.mapCamera.position=this.mapCamera.position.add(i),this.map.setLocationFun(0,0)}},e.instance=null,o([v(cc.Node)],e.prototype,"mainCamera",void 0),o([v(cc.Node)],e.prototype,"mvNode",void 0),o([v(cc.Node)],e.prototype,"mapNode",void 0),o([v(cc.Prefab)],e.prototype,"bg",void 0),o([v(cc.Node)],e.prototype,"mapCamera",void 0),o([v(cc.Node)],e.prototype,"speakNode",void 0),o([v(cc.Node)],e.prototype,"speakBg",void 0),o([v(cc.Label)],e.prototype,"speakDes",void 0),e=i=o([y],e)}(cc.Component);i.default=b,cc._RF.pop()},{"../../game_ui/game/RevivePnl":"RevivePnl","../../util/global_def":"global_def","../../util/transitions":"transitions","../prefabs/enemy":"enemy","../prefabs/hero":"hero","../prefabs/npc":"npc","../prefabs/props/bigNodeManager":"bigNodeManager","../tools/resource_control":"resource_control","../tools/storage_control":"storage_control","./gameGuide":"gameGuide","./gameScene":"gameScene","./uiControl":"uiControl"}],repository:[function(t,e,i){"use strict";cc._RF.push(e,"e7313ueykhEkJ0wDkax3zmy","repository");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.Repository=void 0;var o,r=t("../common/base_ui"),a=t("../../game/user_info/user_info"),s=t("../../game/tools/resource_control"),h=t("../common/tip_ui"),l=t("../../util/structure/hd_map"),c=t("../../game_logic"),u=t("../../util/event_mgr"),p=t("../../util/global_def"),d=t("../common/export_ui");(function(t){t[t.skill=0]="skill",t[t.weapon=1]="weapon",t[t.roleBuy=2]="roleBuy",t[t.weaponBuy=3]="weaponBuy"})(o||(o={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleData=new l.default,e.skillData=new l.default,e.weaponData=new l.default,e.imgLoadPkg="ui://CommUI/",e.comAtlas=null,e.weaponIconData=[],e.roleImgPath=["hero0_tex","hero1_tex","hero2_tex"],e.weaponImgPath=["p_gun0","p_gun1","p_knife","p_darts","p_brick"],e.control=null,e.roleList=null,e.skillInfo=null,e.scroll=null,e.scrollImg=null,e.skillTran=null,e.weaponInfo=null,e.weaponList=null,e.weaponItem=null,e.weaponScroll=null,e.weaponTran=null,e.roleBtn=null,e.weaponBtn=null,e.currSelectRole=0,e.currSelectWeapon="0",e.selectBtnIndex=1005,e.unselectBtnIndex=1004,e.selectBtnScale=.8,e.unselectBtnScale=.7,e.skillDetail=null,e.weaponDetail=null,e.skillDetailCtrl=null,e.weaponDetailCtrl=null,e.closeCb_=null,e.currSelectSkill="",e.upSkillCoinNum=0,e.upWeaponCoinNum=0,e.star1Url="ui://CommUI/lvStar1",e.star2Url="ui://CommUI/lvStar2",e.star3Url="ui://CommUI/lvStar3",e.roleIconData=[],e.loadDragonArr=[],e}return n(e,t),e.prototype.show=function(t){this.closeCb_=t,this.com_&&(this.com_.visible=!0,this.showSelectRole(this.currSelectRole),this.showOpenScrollTran(),d.ExportUIInst.hideAll(),d.ExportGroup.showMembersTM(d.ExportGroupName.kRP4,d.ExportTmID.kRepository))},e.prototype.init=function(t){if(t){this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),t.getChild("closeBtn").asButton.onClick(this.hide.bind(this),this);var e=s.default.instance.getJsonAsset("hero"),i=s.default.instance.getJsonAsset("skill"),n=s.default.instance.getJsonAsset("weapon1");this.initRoleData(e),this.initSkillData(i),this.initWeaponData(n),this.roleList=t.getChild("roleList").asCom,this.scroll=t.getChild("scroll").asCom,this.scrollImg=this.scroll.getChild("img"),this.skillInfo=this.scroll.getChild("skillInfo").asCom,this.skillTran=this.scroll.getTransition("openScroll"),this.weaponInfo=t.getChild("weaponInfo").asCom,this.weaponList=this.weaponInfo.getChild("weaponList").asCom,this.weaponScroll=this.weaponInfo.getChild("img"),this.weaponTran=this.weaponInfo.getTransition("openWeapon"),this.weaponItem=this.weaponList.getChild("list").asList,this.skillDetail=this.scroll.getChild("detail").asCom,this.weaponDetail=this.weaponInfo.getChild("detail").asCom,this.skillDetailCtrl=this.skillDetail.getController("c1"),this.weaponDetailCtrl=this.weaponDetail.getController("c1"),this.skillDetailCtrl.selectedPage="skill",this.weaponDetailCtrl.selectedPage="weapon",this.weaponDetail.getChild("btn").asButton.onClick(this.upWeapon.bind(this),this),this.initRole(),this.initSkill(),this.initWeaponPnl(),this.control=t.getController("c1"),this.roleBtn=t.getChild("roleBtn").asButton,this.weaponBtn=t.getChild("weaponBtn").asButton,this.roleBtn.onClick(this.roleBtnClick.bind(this),this),this.weaponBtn.onClick(this.weaponBtnClick.bind(this),this),this.changePnl(!0),t.visible=!1,t.sortingOrder=r.UIHierarchy.kRepository,r.BaseUI.root.addChild(t),c.default.instance.eventManager.addListener(u.EventType.kLoadRD,this.listenerLoadDragon.bind(this)),p.G.Game.loadAniOver?this.roleImgListener():c.default.instance.eventManager.addListener(u.EventType.kLoadRoleImg,this.roleImgListener.bind(this)),this.initExport()}},e.prototype.hide=function(){d.ExportGroup.hideMembers(d.ExportGroupName.kRP4),this.com_.visible=!1,this.skillTran.playing&&this.skillTran.stop(),this.skillInfo.visible=!1,this.scrollImg.setSize(151,218),this.control.selectedPage="role",this.changePnl(!0),this.closeCb_&&(this.closeCb_(),this.closeCb_=null)},e.prototype.initRole=function(){var t=this;this.currSelectRole=a.GameUserInfo.prop.currRole,this.currSelectSkill=a.SkillType.lianji;for(var e=function(e){var n=i.roleList.getChild("n"+e).asCom;if(i.loadRoleImage(n,e),a.GameUserInfo.hasRole(e)){var o=n.getChild("lock"),r=n.getChild("screen");o.visible=!1,r.visible=!1,n.getChild("lv").asTextField.text=""+(a.GameUserInfo.getRoleLvl(e)+1)}n.getChild("name").asTextField.text=i.roleData.get(e).name,n.onClick(function(){t.currSelectRole=e,t.currSelectSkill=a.SkillType.lianji,t.chooseRole()},i)},i=this,n=0;n<3;n++)e(n);this.skillDetail.getChild("btn").asButton.on(fgui.Event.CLICK,this.upSkill.bind(this),this),this.initSkillLvl()},e.prototype.roleBtnClick=function(){this.control.selectedPage="role",this.changePnl(!0),this.currSelectSkill=a.SkillType.lianji,this.chooseRole()},e.prototype.weaponBtnClick=function(){this.control.selectedPage="weapon",this.changePnl(!1),this.weaponTran.play(),this.chooseWeapon()},e.prototype.chooseRole=function(){var t=this.currSelectRole;if(this.showSelectRole(t),a.GameUserInfo.hasRole(t)){a.GameUserInfo.prop.currRole=t;var e=this.skillDetail.getChild("btn").asButton;a.GameUserInfo.saveProp(),this.initSkillLvl(),this.skillDetailCtrl.selectedPage="skill",e.off(fgui.Event.CLICK),e.on(fgui.Event.CLICK,this.upSkill.bind(this),this),this.showOpenScrollTran()}else{this.skillTran.playing&&this.skillTran.stop(),this.skillInfo.visible=!1,this.scrollImg.setSize(151,218),this.skillDetailCtrl.selectedPage="buy",(e=this.skillDetail.getChild("buyBtn").asButton).off(fgui.Event.CLICK),e.on(fgui.Event.CLICK,this.buyRole.bind(this),this),this.changeDetailPnl(this.skillDetail,o.roleBuy)}},e.prototype.initSkillLvl=function(){var t=this,e=this.currSelectRole,i=a.GameUserInfo.getRoleSkill(e);this.changeDetailPnl(this.skillDetail,o.skill),this.skillData.each(function(e,n,o){var r=t.skillInfo.getChild(n).asCom;r.getChild("select").visible=n===a.SkillType.lianji,t.initLvlProc(r,o.max_lv,i[n]+1)})},e.prototype.showOpenScrollTran=function(){this.skillTran.play()},e.prototype.initSkill=function(){var t=this;this.skillData.each(function(e,i,n){var r=t.skillInfo.getChild(i).asCom;t.loadSkillImage(r,i),r.onClick(function(){t.currSelectSkill=i,t.chooseSkill(r),t.changeDetailPnl(t.skillDetail,o.skill)},t)})},e.prototype.chooseSkill=function(t){var e=this,i=t.name;this.skillData.each(function(t,n,o){e.skillInfo.getChild(n).asCom.getChild("select").visible=i===n})},e.prototype.changeDetailPnl=function(t,e){var i=t.getChild("btn").asButton;switch(e){case o.skill:var n=t.getChild("lvl").asTextField,r=t.getChild("skillName").asLoader,s=t.getChild("skillHarm").asTextField,h=t.getChild("skillDesc").asTextField,l=a.GameUserInfo.getRoleSkill(this.currSelectRole)[this.currSelectSkill]+1;n.text="LV."+l;var c=this.skillData.get(this.currSelectSkill);if(h.text=c.desc,r.url=this.imgLoadPkg+c.icon,s.text=c.act_desc,t.getChild("img").asLoader.url=this.imgLoadPkg+c.icon_2,l===c.max_lv)return i.visible=!1,void(t.getChild("up").visible=!1);i.visible=!0,t.getChild("up").visible=!0,this.upSkillCoinNum=(l-1)*c.money_rise+c.money,i.getChild("coin").asTextField.text=""+this.upSkillCoinNum;break;case o.weapon:var u=this.weaponData.get(this.currSelectWeapon);t.getChild("weaponName").asLoader.url=this.imgLoadPkg+u.icon,t.getChild("img").asLoader.texture=this.comAtlas[this.weaponImgPath[u.id]],t.getChild("weaponDesc").asTextField.text=u.act_desc;var p=a.GameUserInfo.getWeaponLvl(this.currSelectWeapon)+1;if(p===u.max_lv)return i.visible=!1,void(t.getChild("up").visible=!1);i.visible=!0,t.getChild("up").visible=!0,this.upWeaponCoinNum=(p-1)*u.money_lv+u.money,i.getChild("coin").asTextField.text=""+this.upWeaponCoinNum;break;case o.roleBuy:(i=t.getChild("buyBtn").asButton).visible=!0;var d=this.currSelectRole,f=this.roleData.get(d).money;i.getChild("coin").asTextField.text=""+f;break;case o.weaponBuy:}},e.prototype.buyRole=function(){var t=this.currSelectRole,e=this.roleData.get(t).money;if(a.GameUserInfo.updUserSpecialCurrency(-e)){a.GameUserInfo.addRole(t);var i=this.roleList.getChild("n"+t).asCom;i.getChild("lv").asTextField.text="1",i.getTransition("unlock").play(),this.chooseRole()}else h.TipUIInst.show("\u8d27\u5e01\u4e0d\u8db3")},e.prototype.upSkill=function(){var t=a.GameUserInfo.getRoleSkill(this.currSelectRole)[this.currSelectSkill]+1,e=this.skillData.get(this.currSelectSkill);if(a.GameUserInfo.updUserCoin(-this.upSkillCoinNum)){a.GameUserInfo.updRoleSkill(this.currSelectRole,this.currSelectSkill);var i=this.skillInfo.getChild(this.currSelectSkill).asCom,n=++t;this.skillDetail.getChild("lvl").asTextField.text="LV."+t,this.initLvlProc(i,e.max_lv,n);var o=this.skillDetail.getChild("btn").asButton;if(e.max_lv===t)return o.visible=!1,void(this.skillDetail.getChild("up").visible=!1);this.upSkillCoinNum=(t-1)*e.money_rise+e.money,o.getChild("coin").asTextField.text=""+this.upSkillCoinNum}else h.TipUIInst.show("\u91d1\u5e01\u4e0d\u8db3")},e.prototype.showSelectRole=function(t){for(var e=0;e<3;e++){var i=this.roleList.getChild("n"+e).asCom;i.getChild("select").visible=e===t,a.GameUserInfo.hasRole(e)&&(i.getChild("screen").visible=!1,i.getChild("lock").visible=!1)}},e.prototype.initLvlProc=function(t,e,i){var n=t.getChild("lvl").asCom;n.width=24*e;var o=n.getChild("list").asList,r=o._children;if(0===r.length){o.width=24*e;for(var a=0;a<e;a++){var s=new fgui.GLoader;s.setSize(24,24),s.url=a<i?this.star2Url:i<e&&a===i?this.star3Url:this.star1Url,o.addChild(s)}}else for(a=0;a<r.length;a++){var h=r[a].asLoader;h.url=a<i?this.star2Url:i<e&&a===i?this.star3Url:this.star1Url}},e.prototype.initWeaponPnl=function(){var t=this;this.currSelectWeapon=a.GameUserInfo.prop.currWeapon,this.weaponData.each(function(e,i,n){var o=fgui.UIPackage.createObject("HomeHUD","weapon").asCom;o.name=i,t.loadWeaponImage(o,i);var r=a.GameUserInfo.getWeaponLvl(i);null==r?(r=1,a.GameUserInfo.hasWeapon(i)&&a.GameUserInfo.setWeapon(i)):r+=1,t.initLvlProc(o,n.max_lv,r),t.weaponItem.addChild(o),o.onClick(function(){t.currSelectWeapon=i,t.chooseWeapon()},t)});var e=this;cc.loader.loadRes("Map/common",cc.SpriteAtlas,function(t,i){t||(e.comAtlas=i._spriteFrames,e.weaponImgListener())})},e.prototype.chooseWeapon=function(){var t=this;a.GameUserInfo.hasWeapon(this.currSelectWeapon)?(a.GameUserInfo.prop.currWeapon=this.currSelectWeapon,this.weaponDetailCtrl.selectedPage="weapon",this.changeDetailPnl(this.weaponDetail,o.weapon),a.GameUserInfo.saveProp()):(this.weaponDetailCtrl.selectedPage="buy",this.changeDetailPnl(this.weaponDetail,o.weaponBuy)),this.weaponData.each(function(e,i,n){t.weaponItem.getChild(i).asCom.getChild("select").visible=i===t.currSelectWeapon})},e.prototype.upWeapon=function(){if(a.GameUserInfo.updUserCoin(-this.upSkillCoinNum)){a.GameUserInfo.updWeaponLvl(this.currSelectWeapon);var t=this.weaponItem.getChild(this.currSelectWeapon).asCom,e=a.GameUserInfo.getWeaponLvl(this.currSelectWeapon)+1,i=this.weaponData.get(this.currSelectWeapon);this.initLvlProc(t,i.max_lv,e);var n=this.weaponDetail.getChild("btn").asButton;if(e===i.max_lv)return n.visible=!1,void(this.weaponDetail.getChild("up").visible=!1);this.upWeaponCoinNum=(e-1)*i.money_lv+i.money,n.getChild("coin").asTextField.text=""+this.upWeaponCoinNum}else h.TipUIInst.show("\u91d1\u5e01\u4e0d\u8db3")},e.prototype.unlockWeapon=function(){},e.prototype.changePnl=function(t){this.roleBtn.node.scale=t?this.selectBtnScale:this.unselectBtnScale,this.weaponBtn.node.scale=t?this.unselectBtnScale:this.selectBtnScale,this.roleBtn.sortingOrder=t?this.selectBtnIndex:this.unselectBtnIndex,this.weaponBtn.sortingOrder=t?this.unselectBtnIndex:this.selectBtnIndex,this.roleBtn.getChild("select").visible=t,this.weaponBtn.getChild("select").visible=!t},e.prototype.loadSkillImage=function(t,e){t.getChild("select").visible=t.name===a.SkillType.lianji,t.getChild("icon").asLoader.url=this.imgLoadPkg+this.skillData.get(e).icon_2},e.prototype.loadRoleImage=function(t,e){t.getChild("select").visible=e===this.currSelectRole;var i=t.getChild("icon").asImage;this.roleIconData.push({icon:i,role:e})},e.prototype.loadWeaponImage=function(t,e){t.getChild("select").visible=e===this.currSelectWeapon;var i=t.getChild("icon").asLoader;this.weaponIconData.push({icon:i,id:e})},e.prototype.weaponImgListener=function(){for(var t=0;t<this.weaponIconData.length;t++){var e=this.weaponIconData[t],i=this.weaponImgPath[e.id];e.icon.texture=this.comAtlas[i]}},e.prototype.roleImgListener=function(){c.default.instance.eventManager.addEvent(u.EventType.kLoadRD);for(var t=0;t<this.roleImgPath.length;t++){var e=this.roleIconData[t].icon.node,i=new cc.Node;this.loadDragon(t,i),e.addChild(i)}},e.prototype.getRoleDragon=function(t){var e=new cc.Node;return p.G.Game.loadAniOver?this.loadDragon(t,e):this.loadDragonArr.push({id:t,node:e}),e},e.prototype.loadDragon=function(t,e){var i=this.roleImgPath[t];if(i){e.name="node"+t,e.zIndex=10;var n=e.addComponent(dragonBones.ArmatureDisplay);n.dragonAsset=s.default.instance.getDragonBonesAsset(i.substr(0,i.indexOf("_"))+"_ske"),n.dragonAtlasAsset=s.default.instance.getDragonBonesAtlasAsset(i),n.armatureName="Armature",n.playAnimation("daiji",-1)}},e.prototype.listenerLoadDragon=function(){for(var t=0;t<this.loadDragonArr.length;t++){var e=this.loadDragonArr[t],i=e.id,n=e.node;this.loadDragon(i,n)}},e.prototype.initSkillData=function(t){for(var e in t){var i=t[e];i.id=e,this.skillData.put(e,i)}},e.prototype.initWeaponData=function(t){for(var e in t){var i=t[e];i.id=e,this.weaponData.put(e,i)}},e.prototype.initRoleData=function(t){for(var e in t){var i=t[e];i.id=e,this.roleData.put(e,i)}},e.prototype.initExport=function(){for(var t=[d.ExportUIName.kSL1,d.ExportUIName.kSL2,d.ExportUIName.KSL3,d.ExportUIName.kSR1,d.ExportUIName.kSR2,d.ExportUIName.kSR3],e=0;e<t.length;++e)d.ExportUIInst.bindSingle(t[e],this.com_);d.ExportGroup.addMembers(d.ExportGroupName.kRP4,t)},e.instance=new e,e}(r.BaseUI);i.Repository=f,cc._RF.pop()},{"../../game/tools/resource_control":"resource_control","../../game/user_info/user_info":"user_info","../../game_logic":"game_logic","../../util/event_mgr":"event_mgr","../../util/global_def":"global_def","../../util/structure/hd_map":"hd_map","../common/base_ui":"base_ui","../common/export_ui":"export_ui","../common/tip_ui":"tip_ui"}],resource_control:[function(t,e,i){"use strict";cc._RF.push(e,"1634bnG5XZExL9DSoLBL0VU","resource_control");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=(r.property,t("./../../game_logic")),h=t("../../util/event_mgr"),l=t("../../util/global_def"),c=function(){function t(){this._data={}}return t.prototype.load=function(t){this._data=t},t.prototype.getFileData=function(t){var e=this._data[t];return e||null},t}(),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.folder=[{fn:"data",ft:0},{fn:"common",ft:0},{fn:"rePrefabs",ft:0},{fn:"ani",ft:1},{fn:"mapData",ft:1},{fn:"shader",ft:1}],e.hasInit=!1,e.bundleTag={},e}var i;return n(e,t),i=e,e.prototype.RegisterZipLoader=function(){cc.loader.addDownloadHandlers({zip:function(t,e){var i;window.ZipLib(t.url,function(t){(i=new c).load(t),e(null,i)})}}),cc.loader.addLoadHandlers({zip:function(t,e){e(null,t.content)}})},e.prototype.start=function(){},e.prototype.loadZip=function(t){var e=this,n=0;JSZip.loadAsync(t).then(function(t){var o=!1;t.files["gameData/"]&&(o=!0),t.forEach(function(t,r){n++,r.async("text").then(function(r){if(n--,""!=r&&null!=r){var a=JSON.parse(r),l=t.indexOf("/"),c=t.indexOf(".");-1!=l&&-1!=c&&(t=t.substring(l+1,c)).substring(0,l),i.JsonAsset[t]=a}n<=0&&o&&s.default.instance.eventManager.addEvent(h.EventType.KLoadResOver,e,{})})})})},e.prototype.loadBundle=function(t,e){var i=this;this.bundleTag[t]?e&&e():(this.bundleTag[t]=!0,cc.assetManager.loadBundle(t,function(n,o){if(n)console.log("\u52a0\u8f7d\u5305\u4f53\u5931\u8d25222222222222222222222222222222"+n);else{var r=o._config.paths._map,a=0;for(var s in r)for(var h in r[s]){a++;var l=r[s][h];o.load(l.path,l.ctor,function(n,o){null==n?(a--,i.insertRes(o,!0),0==a&&e&&e()):console.log("\u52a0\u8f7d\u5305\u4f53\u5931\u8d25333333333333333333333333"+n,t)})}}}))},e.prototype.insertRes=function(t,e){void 0===e&&(e=!1);var n=t._name;if(t instanceof cc.Prefab)i.Prefabs[n]=t;else if(t instanceof dragonBones.DragonBonesAsset)i.DragonBonesAsset[n]=t;else if(t instanceof cc.Texture2D)i.Texture2D[n]=t;else if(t instanceof cc.SpriteFrame)i.SpriteFrame[n]=t;else if(t instanceof dragonBones.DragonBonesAtlasAsset)i.DragonBonesAtlasAsset[n]=t;else if(t instanceof cc.JsonAsset)i.JsonAsset[n]=t;else if(t instanceof cc.Material)i.mat[n]=t;else if(t instanceof cc.BufferAsset){var o=new Uint8Array(t._buffer);this.loadZip(o)}},e.prototype.loadRes=function(){var t=this,e=this.folder.length,n=function(n){console.log("\u8d44\u6e90"+n+"\u4e0b\u8f7d\u6210\u529f"),"data"==n?(l.G.Game.loadResOver=!0,s.default.instance.eventManager.addEvent(h.EventType.KLoadResOver,t,{}),console.log("\u6570\u636e\u52a0\u8f7d\u5b8c\u6bd52222222222222222222",i.instance.getJsonAsset("weapon1"))):"ani"==n&&(l.G.Game.loadAniOver=!0,s.default.instance.eventManager.addEvent(h.EventType.kLoadRoleImg,t)),0==--e&&(console.log("\u8d44\u6e90\u5168\u90e8\u4e0b\u8f7d\u6210\u529f1111111111111111111"),l.G.Game.isCanEnterGame=!0)},o=function(e){var i=r.folder[e].fn;0==r.folder[e].ft?cc.loader.loadResDir(i,function(e,o){if(!e){for(var r in o){var a=o[r];t.insertRes(a)}n(i)}}):r.loadBundle(i,function(){n(i)})},r=this;for(var a in this.folder)o(a)},e.prototype.onLoad=function(){i.instance=this,cc.game.addPersistRootNode(this.node),i.instance.hasInit||(i.instance.hasInit=!0,this.loadRes())},e.prototype.getPrefabs=function(t){return i.Prefabs[t]},e.prototype.putPrefabs=function(t){var e=t.name;i.Prefabs[e]=t},e.prototype.getSpriteFrame=function(t){return i.SpriteFrame[t]},e.prototype.getTexture2D=function(t){return i.Texture2D[t]},e.prototype.getDragonBonesAtlasAsset=function(t){return i.DragonBonesAtlasAsset[t]},e.prototype.getDragonBonesAsset=function(t,e){return void 0===e&&(e=!1),i.DragonBonesAsset[t]},e.prototype.getJsonAsset=function(t){i.JsonAsset;var e=i.JsonAsset[t];return e?e.json:null},e.prototype.getMat=function(t){return i.mat[t]},e.prototype.getMapData=function(t,e,n){if(void 0===n&&(n=!0),n=!1){t="mapData/"+(t+=".json");var o=cc.url.raw("resources/data/mapData.bin");cc.loader.load({url:o,type:"binary"},function(i,n){i||JSZip.loadAsync(n).then(function(e){return e.file(t).async("text")}).then(function(t){var i=JSON.parse(t);e(i)})})}else{var r=i.instance.getJsonAsset(t);e(r)}},e.prototype.getResAsync=function(t,e){return new Promise(function(i,n){e?cc.loader.loadRes(t,e,function(t,e){t?n(t):i(e)}):cc.loader.loadRes(t,function(t,e){t?n(t):i(e)})})},e.prototype.getResByUrlAsync=function(t){return new Promise(function(e,i){cc.loader.load(t,function(t,n){t?i(t):e(n)})})},e.prototype.getRes=function(t,e){return cc.loader.getRes(t,e)},e.prototype.getResById=function(t){return cc.loader.getRes(t)},e.folderOver=[],e.Prefabs={},e.Texture2D={},e.SpriteFrame={},e.DragonBonesAsset={},e.DragonBonesAtlasAsset={},e.particle={},e.JsonAsset={},e.mat={},e.mapData={},e.instance=null,e=i=o([a],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../../util/event_mgr":"event_mgr","../../util/global_def":"global_def","./../../game_logic":"game_logic"}],scenControl:[function(t,e,i){"use strict";cc._RF.push(e,"2dc8eC2ARdJOIdxtCxcRWP5","scenControl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../game_logic"),a=t("../../../util/event_mgr"),s=t("../../scene/gameScene"),h=t("../ItemInfo"),l=t("../../tools/wordFactory"),c=t("../../../util/global_def"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.red=null,e.redSpr=null,e.index=0,e.totalIndex=0,e.count=0,e.redRunTime=null,e.eas=1,e.dir=1,e}return n(e,t),e.prototype.init=function(){this.node.opacity=0;var t=this.node.parent;t.removeComponent(cc.Sprite),this.totalIndex=t.count?t.count.x:1,this.node.y+=this.node.height/2-100},e.prototype.onCollisionEnter=function(t,e){"hero"==t.node.group&&(this.getComponent(cc.BoxCollider).enabled=!1,this.doStart())},e.prototype.addList=function(){var t=this;r.default.instance.eventManager.addListener(a.EventType.KActiveEnemySucc,function(e){var i=Number(e.num);t.count+=i})},e.prototype.doStart=function(t){var e=this;this.addList();s.default.instance.closeMap(2,0,350);var i=t||"\u6218\u6597\u5f00\u59cb!",n=cc.v3(-45*i.length/2,200,0);l.default.instance.showDes(i,n,s.default.instance.node);var o=new cc.Node;this.redSpr=o.addComponent(cc.Sprite),this.redSpr.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.redSpr.spriteFrame=this.red,o.setContentSize(cc.size(c.G.viewX,c.G.viewY)),c.G.setMat(o,"warn"),o.parent=s.default.instance.node,this.redRunTime=60,this.eas=1,this.scheduleOnce(function(){e.checkIndex()},0)},e.prototype.update=function(){if(null!=this.redRunTime){if(this.redRunTime<=0)return this.redSpr.node.destroy(),void(this.redRunTime=null);var t=this.redSpr.getMaterial(0);this.eas=this.eas+.1*this.dir,this.eas>=2&&(this.dir=-1),this.eas<=1&&(this.dir=1),t.setProperty("colorEea",this.eas),this.redRunTime--}},e.prototype.success=function(){this.doOver()},e.prototype.doOver=function(t){var e=this,i=t||"Go!",n=cc.v3(-45*i.length/2,200,0);l.default.instance.showDes(i,n,s.default.instance.node),this.scheduleOnce(function(){s.default.instance.addComponent(s.adjustMapCamera),s.default.instance.openMap(),e.clear()},1)},e.prototype.checkIndex=function(){var t=this;this.schedule(function(){t.index<=t.totalIndex?t.count<=0&&(r.default.instance.eventManager.addEvent(a.EventType.KActiveEnemy,{num:t.index}),t.index++):t.success()},1,cc.macro.REPEAT_FOREVER,2)},o([d(cc.SpriteFrame)],e.prototype,"red",void 0),e=o([p],e)}(h.default);i.default=f,cc._RF.pop()},{"../../../game_logic":"game_logic","../../../util/event_mgr":"event_mgr","../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../../tools/wordFactory":"wordFactory","../ItemInfo":"ItemInfo"}],shaker:[function(t,e,i){"use strict";cc._RF.push(e,"5c35eQdXjlGo6erMxgnpZxs","shaker");var n=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.ShakeType=void 0;var o,r=t("../global_def");(function(t){t[t.kHor=0]="kHor",t[t.kHorReg=1]="kHorReg",t[t.kVer=2]="kVer",t[t.kVerReg=3]="kVerReg",t[t.kRand=4]="kRand"})(o=i.ShakeType||(i.ShakeType={}));var a=cc._decorator,s=a.ccclass,h=(a.property,function(){function t(){this.minRange_=0,this.maxRange_=0,this.attenuation_=0,this.atteFreq_=0,this.atteFreqVar_=0,this.atteFreqVarF_=0,this.freq_=0,this.freqVar_=0,this.freqVarF_=0,this.dura_=0,this.type_=0,this.shakeDura_=0,this.shakeTimer_=0,this.atteTimer_=0,this.atteFvTimer_=0,this.freqFvTimer_=0,this.attenuationCp_=0,this.atteFreqCp_=0,this.minRangeCp_=0,this.maxRangeCp_=0,this.freqCp_=0,this.horSign_=0,this.verSign_=0,this.origXs_=[],this.origYs_=[],this.nodes_=null,this.callback_=null,this.cbParams_=null,this.bRun_=!1}return t.prototype.init=function(t,e,i,n,r,a){void 0===a&&(a=o.kRand),this.nodes_=t,this.minRange_=e,this.maxRange_=i,this.freq_=n,this.dura_=r,this.type_=a,this.minRangeCp_=e,this.maxRangeCp_=i,this.freqCp_=n;for(var s=0;s<this.nodes_.length;++s)this.origXs_[s]=this.nodes_[s].x,this.origYs_[s]=this.nodes_[s].y},t.prototype.appendAttenuation=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.attenuation_=t,this.atteFreq_=e,this.atteFreqVar_=i,this.atteFreqVarF_=n,this.attenuationCp_=t,this.atteFreqCp_=e},t.prototype.appendFreqVariable=function(t,e){this.freqVar_=t,this.freqVarF_=e},t.prototype.appendOverCallback=function(t,e){void 0===e&&(e=null),this.callback_=t,this.cbParams_=e},t.prototype.shake=function(){if(r.G.isExistObj(this.nodes_)){this.bRun_=!0,this.shakeDura_=0,this.horSign_=0,this.verSign_=0,this.attenuation_=this.attenuationCp_,this.atteFreq_=this.atteFreqCp_,this.minRange_=this.minRangeCp_,this.maxRange_=this.maxRangeCp_,this.freq_=this.freqCp_,this.shakeTimer_=0,this.atteFvTimer_=0,this.atteTimer_=0,this.freqFvTimer_=0;for(var t=0;t<this.nodes_.length;++t)this.nodes_[t].x=this.origXs_[t],this.nodes_[t].y=this.origYs_[t]}else cc.error("[Shaker shake func] - There's no valid node specified")},t.prototype.stop=function(){this.shake(),this.bRun_=!1},t.prototype.update=function(t){if(this.bRun_){if(this.shakeDura_+=t,this.shakeDura_>=this.dura_){for(var e=0;e<this.nodes_.length;++e)this.nodes_[e].x=this.origXs_[e],this.nodes_[e].y=this.origYs_[e];return this.callback_&&this.callback_(this.cbParams_),void(this.bRun_=!1)}if(this.shakeTimer_-=t,this.shakeTimer_<=0){this.shakeTimer_=this.freq_;var i=this._calOffset();for(e=0;e<this.nodes_.length;++e)this.nodes_[e].x=this.origXs_[e]+i.x,this.nodes_[e].y=this.origYs_[e]+i.y}0!=this.freqVar_&&(this.freqFvTimer_-=t,this.freqFvTimer_<=0&&(this.freqFvTimer_=this.freqVarF_,this.freq_+=this.freqVar_)),0!=this.attenuation_&&(this.atteTimer_-=t,this.atteTimer_<=0&&(this.atteTimer_=this.atteFreq_,this.minRange_-=this.attenuation_,this.minRange_<=0&&(this.minRange_=0),this.maxRange_-=this.attenuation_,this.maxRange_<=0&&(this.maxRange_=0)),0!=this.atteFreqVar_&&(this.atteFvTimer_-=t,this.atteFvTimer_<=0&&(this.atteFvTimer_=this.atteFreqVarF_,this.atteFreq_+=this.atteFreqVar_)))}},t.prototype._calOffset=function(){var t=0,e=0;return this.type_==o.kHor?(t=r.G.randRange(this.minRange_,this.maxRange_),r.G.randRange(1,100)>50&&(t=-t)):this.type_==o.kHorReg?(t=r.G.randRange(this.minRange_,this.maxRange_)*this.horSign_,0==this.horSign_?r.G.randRange(1,100)>50?this.horSign_=1:this.horSign_=-1:this.horSign_=-this.horSign_):this.type_==o.kVer?(e=r.G.randRange(this.minRange_,this.maxRange_),r.G.randRange(1,100)>50&&(e=-e)):this.type_==o.kVerReg?(e=r.G.randRange(this.minRange_,this.maxRange_)*this.verSign_,0==this.verSign_?r.G.randRange(1,100)>50?this.verSign_=1:this.verSign_=-1:this.verSign_=-this.verSign_):(t=r.G.randRange(this.minRange_,this.maxRange_),r.G.randRange(1,100)>50&&(t=-t),e=r.G.randRange(this.minRange_,this.maxRange_),r.G.randRange(1,100)>50&&(e=-e)),{x:t,y:e}},t=n([s],t)}());i.default=h,cc._RF.pop()},{"../global_def":"global_def"}],shop:[function(t,e,i){"use strict";cc._RF.push(e,"59888uk6tZH17rJgh22arDE","shop");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./house"),a=t("../../game_ui/game/Store"),s=t("../scene/gameScene"),h=t("./hero"),l=t("../../game_logic"),c=t("../../util/event_mgr"),u=t("../scene/uiControl"),p=cc._decorator,d=p.ccclass,f=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.addListener=function(){l.default.instance.eventManager.addListener(c.EventType.closeStore,function(t){var e=s.default.instance.hero.getComponent(h.heroAct);for(var i in t.addWeapons){var n=t.addWeapons[i];e.addWeapon(Number(n.id),1e7)}e.entity.addBlood(t.addBloodPerc),u.default.instance.refreshCoin()})},e.prototype.open=function(){if(this.tip.active){var t=s.default.instance.hero.getComponent(h.heroAct),e=new a.StoreData;e.currBlood=t.entity.blood,e.maxBlood=t.entity.bloodLimit;var i=[];for(var n in t.weaponData){var o={currBullet:t.weaponData[n].num,id:Number(n)};i.push(o)}e.weapons=i,a.Store.instance.show(e)}},e=o([d],e)}(r.default));i.default=f,cc._RF.pop()},{"../../game_logic":"game_logic","../../game_ui/game/Store":"Store","../../util/event_mgr":"event_mgr","../scene/gameScene":"gameScene","../scene/uiControl":"uiControl","./hero":"hero","./house":"house"}],startScene:[function(t,e,i){"use strict";cc._RF.push(e,"668c1EnWhlFOJbej1OpsglA","startScene");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.autoReleaseAssets=!0,e.Canvas=null,e}return n(e,t),e=o([a],e)}(cc.Scene));i.default=s,cc._RF.pop()},{}],statistic_tool:[function(t,e,i){"use strict";cc._RF.push(e,"18f28T+xQ1My5Ml2qkujA3m","statistic_tool"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../game_logic"),o=t("./structure/hd_map"),r=t("./network/http_req"),a=function(){function t(){}return t.add=function(t,e,i){var n={k:t,v:e,o:i||0};if(this.bucket_.containsKey(t))if(i&&1===i)this.bucket_.put(t,n);else{var o=this.bucket_.get(t);o.v+=e,this.bucket_.put(t,o)}else this.bucket_.put(t,n)},t.upload=function(){if(""!==n.default.instance.gameId&&0!=this.bucket_.size()){console.log("upload stat data");var t=this.bucket_.values();r.default.batchUpdateStat(t),this.bucket_.clear()}},t.schedule=function(t){this.timer_+=t,this.timer_>=5&&(this.upload(),this.timer_=0)},t.bucket_=new o.default,t.timer_=0,t}();i.default=a,cc._RF.pop()},{"../game_logic":"game_logic","./network/http_req":"http_req","./structure/hd_map":"hd_map"}],step:[function(t,e,i){"use strict";cc._RF.push(e,"e9165fJrF5PpajkCucXZmzL","step");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./ItemInfo"),a=t("../scene/gameGuide"),s=cc._decorator,h=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onCollisionEnter=function(t,e){a.default.instance.addStep(),this.node.destroy()},e=o([h],e)}(r.default));i.default=l,cc._RF.pop()},{"../scene/gameGuide":"gameGuide","./ItemInfo":"ItemInfo"}],storage_control:[function(t,e,i){"use strict";cc._RF.push(e,"cfc3buNv5VCY5BL/1lQobIX","storage_control");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../util/storage"),a=cc._decorator,s=a.ccclass,h=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var i;return n(e,t),i=e,e.prototype.onLoad=function(){cc.game.addPersistRootNode(this.node),i.instance=this,console.log("\u521d\u59cb\u5316\u5b58\u50a8")},e.prototype.getNum=function(t,e){void 0===e&&(e=0);var n=0;return i.data[t]?n=i.data[t]:null==(n=r.default.readNum(t))?(n=e,this.setNum(t,n)):i.data[t]=n,n},e.prototype.getString=function(t,e){void 0===e&&(e="");var n="";return i.data[t]?n=i.data[t]:null==(n=r.default.readString(t))?(n=e,this.setString(t,n)):i.data[t]=n,n},e.prototype.setNum=function(t,e){r.default.writeNum(t,e),i.data[t]=e},e.prototype.getBoolean=function(t,e){void 0===e&&(e=!0);var n=!0;return i.data[t]?n=i.data[t]:null==(n=r.default.readBoolean(t))?(n=e,this.setBoolean(t,n)):i.data[t]=n,n},e.prototype.setBoolean=function(t,e){void 0===e&&(e=!0),r.default.writeBoolean(t,e),i.data[t]=e},e.prototype.getJson=function(t,e){var n=[];return i.data[t]?n=i.data[t]:null==(n=r.default.readJSON(t))?(n=e,this.setJson(t,n)):i.data[t]=n,n},e.prototype.setJson=function(t,e){r.default.writeJSON(t,e),i.data[t]=e},e.prototype.getBooleanEveryday=function(t,e){void 0===e&&(e=!0);var n="last"+t,o=(new Date).getDate();return i.instance.getNum(n,o)!=o&&(i.instance.setBoolean(t,e),i.instance.setNum(n,o)),i.instance.getBoolean(t,e)},e.prototype.getNumEveryday=function(t,e){void 0===e&&(e=0);var n="last"+t,o=(new Date).getDate();return i.instance.getNum(n,o)!=o&&(i.instance.setNum(t,e),i.instance.setNum(n,o)),i.instance.getNum(t,e)},e.prototype.setString=function(t,e){r.default.wirteString(t,e),i.data[t]=e},e.instance=null,e.data={},e=i=o([s],e)}(cc.Component));i.default=h,cc._RF.pop()},{"../../util/storage":"storage"}],storage:[function(t,e,i){"use strict";cc._RF.push(e,"1b63bbiB4tPJYchWVff1Yr0","storage"),Object.defineProperty(i,"__esModule",{value:!0}),i.SaveDef=void 0;var n=function(){function t(){}return t.kGameData="gameDat",t.kSetting="setting",t.kAudio="audio",t.kTask="archivement",t.kGuide="guide",t.kWxStatus="wxStatus",t.kForceNav="nav",t.kDaily="kDaily",t.kPlayer="kPlayer",t.kRoleSkill="kRoleSkill",t.kRoleWeaponLvl="kRoleWeaponLvl",t.kRoleLv="kRoleLv",t.kPreTaskId="kPreTaskId",t.initTaskTime="initTaskTime",t.kAchievement="achievementTask",t.kStoryKey="kStoryKey",t}();i.SaveDef=n;var o=function(){function t(){}return t.readString=function(t){var e=null,i=cc.sys.localStorage.getItem(t);return null==i||""===i||isNaN(i)||(e=i),e},t.wirteString=function(t,e){cc.sys.localStorage.setItem(t,e)},t.clearAllStorage=function(){cc.sys.localStorage.clear()},t.writeBoolean=function(t,e){var i=e?1:0;cc.sys.localStorage.setItem(t,i)},t.readBoolean=function(t){var e=null,i=cc.sys.localStorage.getItem(t);return 0===i?e=!1:null==i||""===i||isNaN(i)||(e=1==i),e},t.writeNum=function(t,e){cc.sys.localStorage.setItem(t,e)},t.readNum=function(t){var e=null,i=cc.sys.localStorage.getItem(t);return 0===i?e=0:null==i||""===i||isNaN(i)||(e=parseInt(i)),e},t.writeJSON=function(t,e){var i=JSON.stringify(e);cc.sys.localStorage.setItem(t,i)},t.readJSON=function(t){var e=null,i=cc.sys.localStorage.getItem(t);return this.isExistObj(i)&&(e=JSON.parse(i)),e},t.remove=function(t){cc.sys.localStorage.removeItem(t)},t.isExistObj=function(t){return!this.isEmptyObj(t)},t.isEmptyObj=function(t){if(t){if("object"!=typeof t)return!1;for(var e in t)return!1}return!0},t}();i.default=o,cc._RF.pop()},{}],thornControl:[function(t,e,i){"use strict";cc._RF.push(e,"4fb0dhhIoJG/pRQy/f3h6so","thornControl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../ItemInfo"),a=t("../../../game_logic"),s=t("../../../util/event_mgr"),h=cc._decorator,l=h.ccclass,c=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=0,e}return n(e,t),e.prototype.init=function(){var t=this.node.parent;t.removeComponent(cc.Sprite),this.time=t.time?Number(t.time.x)/10:.5,this.node.y+=this.node.height/2-100},e.prototype.onLoad=function(){this.node.opacity=0},e.prototype.onCollisionEnter=function(t,e){a.default.instance.eventManager.addEvent(s.EventType.KActiveThorn,this,this.time),this.clear()},e=o([l],e)}(r.default));i.default=c,cc._RF.pop()},{"../../../game_logic":"game_logic","../../../util/event_mgr":"event_mgr","../ItemInfo":"ItemInfo"}],thorn:[function(t,e,i){"use strict";cc._RF.push(e,"ae530beRaVB+ZxZLJ+waj7I","thorn");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../ItemInfo"),a=t("../../scene/gameScene"),s=t("../../../util/effect/shaker"),h=t("../../../game_logic"),l=t("../../../util/event_mgr"),c=t("../../../util/global_def"),u=t("../hero"),p=t("../enemy"),d=cc._decorator,f=d.ccclass,_=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=0,e.index=0,e.run=-10,e}return n(e,t),e.prototype.init=function(){var t=this,e=this.node.parent;if(e.removeComponent(cc.Sprite),this.type=null!=e.index?1:0,this.index=e.index?e.index.x:0,1==this.type){var i=h.default.instance.eventManager.addListener(l.EventType.KActiveThorn,function(e,n){h.default.instance.eventManager.removeListener(l.EventType.KActiveThorn,i,!0),t.active(e,n)});a.default.instance.listenerManager.push({key:l.EventType.KActiveThorn,id:i})}else e.rand&&c.G.randRange(0,100)>50&&this.scheduleOnce(this.down.bind(this),c.G.randRange(3,10))},e.prototype.active=function(t,e){var i=Number(e);this.scheduleOnce(this.down.bind(this),this.index*i)},e.prototype.down=function(){var t=this,e=[this.node];a.default.instance.shake.init(e,2,4,.1,1,s.ShakeType.kHorReg),a.default.instance.shake.shake(),this.scheduleOnce(function(){t.run=300},1)},e.prototype.onCollisionEnter=function(t,e){if(!(this.run<=0)){var i=t.node;if("hero"==i.group){var n=i.getComponent(u.heroAct);n.showRed(),n.entity.addBlood(-20,"thorn")}else if("enemy"==i.group){var o=i.getComponent(p.enemyAct);o.entity.addBlood(-20,"thron"),o.setState(p.eActState.hurtYiJi)}}},e.prototype.update=function(){this.run<0||(this.node.y-=10,0==this.run&&this.clear(),this.run--)},e=o([f],e)}(r.default));i.default=_,cc._RF.pop()},{"../../../game_logic":"game_logic","../../../util/effect/shaker":"shaker","../../../util/event_mgr":"event_mgr","../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../ItemInfo":"ItemInfo","../enemy":"enemy","../hero":"hero"}],timed_task:[function(t,e,i){"use strict";cc._RF.push(e,"67be9FMV7hBUYBmzY2Hld7q","timed_task"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=t("./structure/hd_map");(function(t){t[t.kNone=0]="kNone",t[t.kTaskResTime=1]="kTaskResTime"})(n=i.TimedTaskType||(i.TimedTaskType={})),i.kInfinitedRepeat=-2;var r=function(){function t(){this.id=0,this.type=n.kNone,this.callback_=null,this.param_=null,this.timer_=0,this.repeat_=1,this.delay_=0,this.interval_=0,this.bFrame_=!1,this.bPause_=!1}return Object.defineProperty(t.prototype,"pause",{set:function(t){this.bPause_=this.bPause_},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e,o,r,a,s,h,l){void 0===o&&(o=0),void 0===r&&(r=1),void 0===a&&(a=0),void 0===s&&(s=null),void 0===h&&(h=n.kNone),void 0===l&&(l=!1),this.id=t,this.callback_=e,this.repeat_=r<i.kInfinitedRepeat?i.kInfinitedRepeat:r,this.delay_=o,this.interval_=a,this.timer_=a,this.type=h,this.bFrame_=l,this.bPause_=!1},t.prototype.excute=function(t){if(!this.bPause_){var e=!1;if(!(this.delay_>0))return this.repeat_>0||this.repeat_===i.kInfinitedRepeat?(this.bFrame_?++this.timer_:this.timer_+=t,this.timer_>=this.interval_&&(this.repeat_>0&&--this.repeat_,this.callback_&&this.callback_(this.param_),this.timer_=0)):0===this.repeat_&&(e=!0),e;this.bFrame_?--this.delay_:this.delay_-=t}},t}(),a=function(){function t(){this.baseId_=0,this.noneTypeMap_=new o.default,this.specTypeMap_=new o.default}return t.prototype.add=function(t,e,i,o,a,s,h){void 0===e&&(e=0),void 0===i&&(i=1),void 0===o&&(o=0),void 0===a&&(a=null),void 0===s&&(s=n.kNone),void 0===h&&(h=!1),++this.baseId_;var l,c=new r;(c.init(this.baseId_,t,e,i,o,a,s,h),s===n.kNone)?this.noneTypeMap_.put(this.baseId_,c):this.specTypeMap_.containsKey(s)?null!=(l=this.specTypeMap_.get(s))&&l.push(c):((l=new Array).push(c),this.specTypeMap_.put(s,l));return this.baseId_},t.prototype.addWithFrame=function(t,e,i,o,r,a){void 0===e&&(e=0),void 0===i&&(i=1),void 0===o&&(o=0),void 0===r&&(r=null),void 0===a&&(a=n.kNone),this.add(t,e,i,o,r,a,!0)},t.prototype.pause=function(t,e,i){var o;if(void 0===i&&(i=n.kNone),i===n.kNone)this.noneTypeMap_.containsKey(e)?this.noneTypeMap_.get(e).pause=t:console.warn("[TimedTask] not valid id in type <TimedTaskType.kNone>");else if(this.specTypeMap_.containsKey(i)){if(-1===e){if(o=this.specTypeMap_.get(i))for(var r=0;r<o.length;++r)o[r].pause=t}else if(null!=(o=this.specTypeMap_.get(i)))for(r=0;r<o.length;++r)if(o[r].id===e){o[r].pause=t;break}}else console.warn("[TimedTask] not valid type: ",i)},t.prototype.pauseAll=function(t,e){this.noneTypeMap_.each(function(i,n,o){if(e){for(var r=!1,a=0;a<e.length;++a)if(e[a]==o.id){e.splice(a,1),r=!0;break}r||(o.pause=t)}else o.pause=t}),this.specTypeMap_.each(function(i,n,o){if(e)for(var r=0;r<o.length;++r){for(var a=!1,s=0;s<e.length;++s)if(e[s]==o[r].id){e.splice(s,1),a=!0;break}a||(o[r].pause=t)}else for(var h=0;h<o.length;++h)o[h].pause=t})},t.prototype.remove=function(t,e){if(void 0===e&&(e=n.kNone),e===n.kNone)this.noneTypeMap_.containsKey(t)&&this.noneTypeMap_.remove(t);else if(this.specTypeMap_.containsKey(e))if(-1===t)this.specTypeMap_.remove(e);else{var i=this.specTypeMap_.get(e);if(null!=i){for(var o=0;o<i.length;++o)if(i[o].id===t){i.splice(o,1);break}0==i.length&&this.specTypeMap_.remove(e)}}else console.warn("[TimedTask] not valid type: ",e)},t.prototype.clear=function(){this.baseId_=0,this.noneTypeMap_.clear(),this.specTypeMap_.clear()},t.prototype.excuteTasks=function(t){if(this.noneTypeMap_.size()>0){var e=[];this.noneTypeMap_.each(function(i,n,o){o.excute(t)&&e.push(o.id)});for(var i=0;i<e.length;++i)this.remove(e[i])}if(this.specTypeMap_.size()>0){var n=[],o=[];this.specTypeMap_.each(function(e,i,r){if(r){n.push(i);for(var a=0;a<r.length;++a)r[a].excute(t)&&o.push(r[a].id)}});for(i=0;i<n.length;++i)for(var r=0;r<o.length;++r)this.remove(o[r],n[i])}},t.instance=new t,t}();i.TimedTaskMgr=a,i.TimedTaskInst=a.instance,cc._RF.pop()},{"./structure/hd_map":"hd_map"}],tip_ui:[function(t,e,i){"use strict";cc._RF.push(e,"b2c64ozBkJEAr6KnN5Ci1X5","tip_ui");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=t("./base_ui"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lbl_=null,e.showTrans_=null,e}return n(e,t),e.prototype.init=function(t){t&&(this.com_=t,t.setSize(cc.view.getVisibleSize().width,cc.view.getVisibleSize().height),this.lbl_=t.getChild("tipLbl").asTextField,this.showTrans_=t.getTransition("showTrans"),t.sortingOrder=o.UIHierarchy.kTip,t.visible=!1,o.BaseUI.root.addChild(t))},e.prototype.show=function(t){var e=this;this.com_&&(this.com_.visible=!0,this.lbl_.text=t,this.showTrans_.stop(),this.showTrans_.play(function(){e.com_.visible=!1}))},e.instance=new e,e}(o.BaseUI);i.TipUI=r,i.TipUIInst=r.instance,cc._RF.pop()},{"./base_ui":"base_ui"}],transitions:[function(t,e,i){"use strict";cc._RF.push(e,"ffad94S+ZJMQoGFjGDjGeNY","transitions");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./global_def"),a=t("../game/tools/resource_control"),s=cc._decorator,h=s.ccclass,l=s.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._texture1=null,e._texture2=null,e._sprite=null,e._material=null,e._spriteMaterial=null,e._spriteNode=null,e.des=null,e._camera=null,e._onLoadFinished=null,e.transitionTime=120,e.badKing=null,e.badKingNode=null,e.doMid=null,e.loading=!1,e.time=0,e}var i;return n(e,t),i=e,e.prototype.onLoad=function(){i.instance=this,cc.game.addPersistRootNode(this.node),this.node.x=r.G.viewX/2,this.node.y=r.G.viewY/2,this._texture2=this.createTexture(),this.des=this.node.getChildByName("des"),this._spriteNode=this.node.getChildByName("_spriteNode"),this._sprite=this._spriteNode.addComponent(cc.Sprite);var t=new cc.SpriteFrame;this._sprite.spriteFrame=t},e.prototype.createTexture=function(){var t=new cc.RenderTexture,e=cc.view.getVisibleSize();return t.initWithSize(e.width,e.height),t},e.prototype.updateSpriteMaterial=function(t){if(this._sprite){this._material=a.default.instance.getMat(t),console.log("111111111111111111111111111111111111111111111111111111",this._material);var e=cc.MaterialVariant.create(this._material,this._sprite);e.setProperty("texture2",this._texture2),e.setProperty("ratio",this._texture2.width/this._texture2.height),e.setProperty("screenSize",new Float32Array([this._texture2.width,this._texture2.height])),this._sprite.setMaterial(0,e),this._spriteMaterial=e}},e.prototype.loadScene=function(t,e,i,n,o,r,a){this.doMid=a,this.updateSpriteMaterial(n),this._spriteNode.active=!0,this._texture1=this.createTexture(),this._sprite.spriteFrame.setTexture(this._texture1);for(var s in e){var h=e[s],l=cc.find(h);if(!l)return void console.log("Can not find fromCamera with path ");var c=l.getComponent(cc.Camera),u=c.targetTexture;c.targetTexture=this._texture1,c.render(cc.director.getScene()),c.targetTexture=u}var p=this;this.scheduleOnce(function(){cc.director.loadScene(t,function(){o&&o();for(var t in i){var e=i[t],n=cc.find(e),a=n&&n.getComponent(cc.Camera);if(!n)return void cc.warn("Can not find toCamera with path "+e);a.targetTexture,a.targetTexture=p._texture2,a.render(cc.director.getScene())}p._onLoadFinished=function(){for(var t in i){var e=i[t],n=cc.find(e);(n&&n.getComponent(cc.Camera)).targetTexture=null}p._spriteNode.active=!1,r&&r()},p.time=0,p.loading=!0})},0)},e.prototype.update=function(t){this.loading&&(this.time+=1,this.time==this.transitionTime/2&&this.doMid&&(this.doMid(),this.doMid=null),this.time>=this.transitionTime&&(this.time=this.transitionTime,this.loading=!1,this._onLoadFinished&&this._onLoadFinished(),this._onLoadFinished=null),this._spriteMaterial.setProperty("time",this.time/this.transitionTime))},e.instance=null,o([l(cc.Prefab)],e.prototype,"badKing",void 0),e=i=o([h],e)}(cc.Component);i.default=c,cc._RF.pop()},{"../game/tools/resource_control":"resource_control","./global_def":"global_def"}],uiControl:[function(t,e,i){"use strict";cc._RF.push(e,"d3e73AlpplKFqMtQfpNw0Ph","uiControl");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./gameScene"),a=t("../prefabs/hero"),s=t("../../game_logic"),h=t("../prefabs/lifeBase"),l=t("../../util/global_def"),c=t("../../util/transitions"),u=t("../user_info/user_info"),p=t("../../game_ui/game/PausePnl"),d=t("../../game_ui/game/HomePnl"),f=t("../../game_ui/game/StoryPnl"),_=t("../../util/mgp_util"),g=cc._decorator,m=g.ccclass,y=g.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.upBtn=null,e.leftBtn=null,e.rightBtn=null,e.attackBtn=null,e.shootBtn=null,e.opt=130,e.weaponPanle=null,e.weaponNum=null,e.curWeapon=null,e.bloodBar=null,e.coinNum=null,e.hasClickAct=[!1,!1,!1],e.act=[],e.weapShow=!1,e.endBar=0,e.setBar=!1,e.curCoin=0,e.pause=!1,e}var i;return n(e,t),i=e,e.prototype.onLoad=function(){i.instance=this,this.upBtn.on(cc.Node.EventType.TOUCH_START,this.onClickUpBtn.bind(this)),this.leftBtn.on(cc.Node.EventType.TOUCH_START,this.onClickLeftBtn.bind(this)),this.rightBtn.on(cc.Node.EventType.TOUCH_START,this.onClickRightBtn.bind(this)),this.attackBtn.on(cc.Node.EventType.TOUCH_START,this.onClickAttack.bind(this)),this.shootBtn.on(cc.Node.EventType.TOUCH_START,this.onClickShootBtn.bind(this)),this.leftBtn.on(cc.Node.EventType.TOUCH_END,this.onClickCancel.bind(this)),this.leftBtn.on(cc.Node.EventType.TOUCH_CANCEL,this.onClickCancel.bind(this)),this.rightBtn.on(cc.Node.EventType.TOUCH_END,this.onClickCancel.bind(this)),this.rightBtn.on(cc.Node.EventType.TOUCH_CANCEL,this.onClickCancel.bind(this)),this.upBtn.on(cc.Node.EventType.TOUCH_END,this.cancleUpBtn.bind(this)),this.upBtn.on(cc.Node.EventType.TOUCH_CANCEL,this.cancleUpBtn.bind(this)),this.attackBtn.on(cc.Node.EventType.TOUCH_END,this.cancelAttack.bind(this)),this.attackBtn.on(cc.Node.EventType.TOUCH_CANCEL,this.cancelAttack.bind(this)),this.shootBtn.on(cc.Node.EventType.TOUCH_END,this.canleShootBtn.bind(this)),this.shootBtn.on(cc.Node.EventType.TOUCH_CANCEL,this.canleShootBtn.bind(this)),this.node.getChildByName("pause").on(cc.Node.EventType.TOUCH_START,this.onClickPauseBtn.bind(this)),cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:this.onKeyPressed.bind(this),onKeyReleased:this.onKeyReleased.bind(this)},this.node),this.refreshCoin(),this.saveCoin()},e.prototype.refreshCoin=function(){this.coinNum.string=String(u.GameUserInfo.prop.coin)},e.prototype.onKeyPressed=function(t,e){switch(t){case cc.macro.KEY.left:case cc.macro.KEY.a:this.onClickLeftBtn();break;case cc.macro.KEY.right:case cc.macro.KEY.d:this.onClickRightBtn();break;case cc.macro.KEY.up:case cc.macro.KEY.w:this.onClickUpBtn();break;case cc.macro.KEY.num0:this.onClickShootBtn()}},e.prototype.onKeyReleased=function(t,e){switch(t){case cc.macro.KEY.left:case cc.macro.KEY.a:this.onClickCancel("leftBtn");break;case cc.macro.KEY.right:case cc.macro.KEY.d:this.onClickCancel("rightBtn");break;case cc.macro.KEY.up:case cc.macro.KEY.w:this.cancleUpBtn();break;case cc.macro.KEY.num0:this.canleShootBtn()}},e.prototype.onClickLeftBtn=function(){this.leftBtn.opacity=255,this.hasClickAct[0]||(this.hasClickAct[0]=!0,this.act.push(0),this.doAct())},e.prototype.onClickRightBtn=function(){this.rightBtn.opacity=255,this.hasClickAct[1]||(this.hasClickAct[1]=!0,this.act.push(1),this.doAct())},e.prototype.onClickCancel=function(t){var e=t.target?t.target.name:t;for(var i in this.act)"leftBtn"==e&&0==this.act[i]&&(this.leftBtn.opacity=this.opt,this.act.splice(Number(i),1),this.hasClickAct[0]=!1),"rightBtn"==e&&1==this.act[i]&&(this.rightBtn.opacity=this.opt,this.act.splice(Number(i),1),this.hasClickAct[1]=!1);this.doAct()},e.prototype.doAct=function(){var t=this.act.length;if(0==t){var e=r.default.instance.hero.getComponent(a.heroAct).state;r.default.instance.hero.getComponent(a.heroAct).setDir(0),e!=a.actState.left&&e!=a.actState.right||r.default.instance.hero.getComponent(a.heroAct).pushInStruct(a.INStructType.null)}var i=this.act[t-1];0==i?(r.default.instance.hero.getComponent(a.heroAct).setDir(-1),r.default.instance.hero.getComponent(a.heroAct).pushInStruct(a.INStructType.left)):1==i&&(r.default.instance.hero.getComponent(a.heroAct).setDir(1),r.default.instance.hero.getComponent(a.heroAct).pushInStruct(a.INStructType.right))},e.prototype.onClickUpBtn=function(){this.upBtn.opacity=255,r.default.instance.hero.getComponent(a.heroAct).pushInStruct(a.INStructType.up)},e.prototype.cancleUpBtn=function(){this.upBtn.opacity=this.opt},e.prototype.onClickAttack=function(){this.attackBtn.opacity=255,r.default.instance.hero.getComponent(a.heroAct).pushInStruct(a.INStructType.attack),r.default.instance.hero.getComponent(a.heroAct).touchAttck=!0},e.prototype.cancelAttack=function(){this.attackBtn.opacity=this.opt,r.default.instance.hero.getComponent(a.heroAct).cancleTouch()},e.prototype.onClickRefresh=function(){s.default.instance.changeScene("gameScene",null,function(){r.default.instance.peakCamera.active=!0,r.default.instance.mapCamera.active=!0})},e.prototype.onClickAttTest=function(){r.default.instance.hero.getComponent(h.default).ani.playAnimation("xuliyiji",1)},e.prototype.onClickShootBtn=function(){this.shootBtn.opacity=255,r.default.instance.hero.getComponent(a.heroAct).isShoot=!0,r.default.instance.hero.getComponent(a.heroAct).pushInStruct(a.INStructType.shoot)},e.prototype.canleShootBtn=function(){this.shootBtn.opacity=this.opt,r.default.instance.hero.getComponent(a.heroAct).isShoot=!1},e.prototype.onClickChangeWeap=function(){for(var t=r.default.instance.hero.getComponent(a.heroAct),e=t.weaponCom.weaponType,i=(t.weaponData,l.G.Game.weaponCount),n=1;n<=i;++n){var o=(e+n)%i;if(0!=t.weaponData[o].num)return void t.changeWeapon(o)}},e.prototype.changeWeapIcon=function(t){var e=this;cc.loader.loadRes("Map/common",cc.SpriteAtlas,function(i,n){i||(e.curWeapon.spriteFrame=n._spriteFrames[t])})},e.prototype.showWeapPanle=function(){this.weapShow=!0,this.shootBtn.active=!0,this.weaponPanle.active=!0},e.prototype.hidWeapPanle=function(){this.canleShootBtn(),this.weapShow=!1,this.shootBtn.active=!1,this.weaponPanle.active=!1},e.prototype.showWeapPro=function(t){this.weaponNum.fillRange=t},e.prototype.addBlood=function(t){var e=r.default.instance.hero.getComponent(h.default);this.endBar=e.blood/e.bloodLimit,this.setBar=!0},e.prototype.updateBlood=function(){if(0!=this.setBar){var t=this.endBar-this.bloodBar.fillRange;if(t<.05)return this.bloodBar.fillRange=this.endBar,void(this.setBar=!1);var e=.2*t;this.bloodBar.fillRange+=e}},e.prototype.update=function(){this.updateBlood()},e.prototype.addCoin=function(t){this.curCoin+=t,u.GameUserInfo.prop.coin+=t,u.GameUserInfo.prop.coin<0&&(u.GameUserInfo.prop.coin=0),this.coinNum.string=String(u.GameUserInfo.prop.coin)},e.prototype.saveCoin=function(){this.schedule(function(){u.GameUserInfo.saveProp()},3,cc.macro.REPEAT_FOREVER,3)},e.prototype.onClickPauseBtn=function(){p.default.instance.show(function(){cc.director.pause()})},e.prototype.onClickChange=function(){window.mapData=null;c.default.instance.loadScene("home",["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],["Canvas/MainCamera"],"swirl",null,null)},e.prototype.toHome=function(t){void 0===t&&(t=!0),window.mapData=null;c.default.instance.loadScene("home",["bg/Bg Camera","bg/Peak Camera","Canvas/Map Camera"],["Canvas/MainCamera"],"crop-circle",null,null,function(){_.MgpUtil.showInterstitialAd(),d.default.instance.show(),d.default.instance.showExport(),t&&f.default.instance.show()})},e.instance=null,o([y(cc.Node)],e.prototype,"upBtn",void 0),o([y(cc.Node)],e.prototype,"leftBtn",void 0),o([y(cc.Node)],e.prototype,"rightBtn",void 0),o([y(cc.Node)],e.prototype,"attackBtn",void 0),o([y(cc.Node)],e.prototype,"shootBtn",void 0),o([y(cc.Node)],e.prototype,"weaponPanle",void 0),o([y(cc.Sprite)],e.prototype,"weaponNum",void 0),o([y(cc.Sprite)],e.prototype,"curWeapon",void 0),o([y(cc.Sprite)],e.prototype,"bloodBar",void 0),o([y(cc.Label)],e.prototype,"coinNum",void 0),e=i=o([m],e)}(cc.Component);i.default=v,cc._RF.pop()},{"../../game_logic":"game_logic","../../game_ui/game/HomePnl":"HomePnl","../../game_ui/game/PausePnl":"PausePnl","../../game_ui/game/StoryPnl":"StoryPnl","../../util/global_def":"global_def","../../util/mgp_util":"mgp_util","../../util/transitions":"transitions","../prefabs/hero":"hero","../prefabs/lifeBase":"lifeBase","../user_info/user_info":"user_info","./gameScene":"gameScene"}],ui_motion:[function(t,e,i){"use strict";cc._RF.push(e,"28724BJYyNBA5QQoiEWaWNF","ui_motion");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r,a,s,h=t("../global_def"),l=cc._decorator,c=l.ccclass,u=l.property;(function(t){t[t.kNone=0]="kNone",t[t.kMove=1]="kMove",t[t.kScale=2]="kScale",t[t.kRot=3]="kRot",t[t.kFade=4]="kFade",t[t.kMoveFade=5]="kMoveFade",t[t.kScaleFade=6]="kScaleFade",t[t.kScaleRot=7]="kScaleRot"})(r=i.MotionType||(i.MotionType={})),function(t){t[t.kNone=0]="kNone",t[t.kCubic=1]="kCubic",t[t.kBack=2]="kBack",t[t.kBounce=3]="kBounce",t[t.kElastic=4]="kElastic",t[t.kCircle=5]="kCircle",t[t.kSine=6]="kSine"}(a||(a={})),function(t){t[t.kIn=0]="kIn",t[t.kOut=1]="kOut",t[t.kInOut=2]="kInOut"}(s||(s={}));var p=function(){function t(){this.type=0,this.begin=new cc.Vec2(0,0),this.begin2=null,this.end=new cc.Vec2(0,0),this.end2=null,this.ease=new cc.Vec2(0,1),this.ease2=null,this.elasticFactor=.3,this.dura=0,this.delay=0}return o([u({type:cc.Integer,visible:!0,displayName:"Type",tooltip:"\u8fd0\u52a8\u7c7b\u578b\uff0c1.\u5e73\u79fb 2.\u7f29\u653e 3.\u65cb\u8f6c 4.\u6e10\u53d8 5.\u5e73\u79fb\u4e14\u6e10\u53d8 6.\u7f29\u653e\u4e14\u6e10\u53d8 7.\u7f29\u653e\u4e14\u65cb\u8f6c"})],t.prototype,"type",void 0),o([u(cc.Vec2)],t.prototype,"begin",void 0),o([u({type:cc.Vec2,visible:!0,displayName:"Begin2",tooltip:"\u5f53type\u4e3a5\u30016\u30017\u65f6\u751f\u6548\uff0c\u6307\u4ee3\u8d77\u59cb\u900f\u660e\u5ea6\u6216\u8005\u8d77\u59cb\u89d2\u5ea6\uff0c\u900f\u660e\u5ea6\u8303\u56f4\u662f0~255"})],t.prototype,"begin2",void 0),o([u(cc.Vec2)],t.prototype,"end",void 0),o([u(cc.Vec2)],t.prototype,"end2",void 0),o([u({visible:!0,displayName:"Ease",tooltip:"x \u7f13\u52a8\u7c7b\u578b\uff081 cubic 2 back 3 bounce 4 elastic 5 circle 6 sine\uff09, y \u7f13\u52a8\u65f6\u673a\uff081 \u5165\u573a 2 \u51fa\u573a 3 \u5165\u573a\u4e0e\u51fa\u573a\uff09"})],t.prototype,"ease",void 0),o([u(cc.Vec2)],t.prototype,"ease2",void 0),o([u({type:cc.Float,visible:!0,displayName:"ElasticFactor",tooltip:"\u4ec5\u5f53\u7f13\u52a8\u7c7b\u578b\u4e3aelastic\uff08\u5f39\u6027\uff09\u65f6\u751f\u6548"})],t.prototype,"elasticFactor",void 0),o([u({type:cc.Float,visible:!0,displayName:"Duration",tooltip:"\u52a8\u6548\u6267\u884c\u65f6\u957f\uff0c\u5355\u4f4d\u662f\u79d2"})],t.prototype,"dura",void 0),o([u({type:cc.Float,visible:!0,displayName:"Delay",tooltip:"\u7528\u6765\u63a7\u5236\u5ef6\u8fdf\u591a\u4e45\u6267\u884c\u52a8\u6548\uff0c\u5355\u4f4d\u662f\u79d2"})],t.prototype,"delay",void 0),t=o([c("MotionPara")],t)}(),d=function(){function t(){this.node=null,this.param=new p}return o([u(cc.Node)],t.prototype,"node",void 0),o([u(p)],t.prototype,"param",void 0),t=o([c("MotionNode")],t)}(),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.motionNode_=[],e.bTriggerWhileEnable_=!1,e.cbDelay_=0,e.callback_=null,e}return n(e,t),e.prototype.run=function(t,e,i,n,o,r,a,s){var h=new d;h.node=t,h.param=new p,h.param.type=e,h.param.begin=i,h.param.end=n,h.param.delay=r,h.param.dura=o,this._parseParam(h)},e.prototype.onEnable=function(){this.bTriggerWhileEnable_&&this.triggerMotion()},e.prototype.triggerMotion=function(t){this.callback_&&(this.unschedule(this.callback_),this.callback_=null),this.cbDelay_=0,this.callback_=t;for(var e=0;e<this.motionNode_.length;++e)this._parseParam(this.motionNode_[e]);t&&(this.cbDelay_+=.1,this.scheduleOnce(this.callback_,this.cbDelay_))},e.prototype._parseParam=function(t){var e=t.param.delay+t.param.dura;e>this.cbDelay_&&(this.cbDelay_=e),t.node.stopAllActions(),t.param.type==r.kMove?this._move(t):t.param.type==r.kScale?this._scale(t):t.param.type==r.kRot?this._rotation(t):t.param.type==r.kFade?this._fade(t):t.param.type==r.kMoveFade?this._moveAndFade(t):t.param.type==r.kScaleFade?this._scaleAndFade(t):t.param.type==r.kScaleRot&&this._scaleAndRot(t)},e.prototype._move=function(t){t.node.setPosition(t.param.begin);var e=cc.moveTo(t.param.dura,t.param.end);this._ease(e,t.param.ease,t.param.elasticFactor),this._excuteAction(e,t.node,t.param.delay)},e.prototype._scale=function(t){t.node.setScale(t.param.begin.x,t.param.begin.y);var e=cc.scaleTo(t.param.dura,t.param.end.x,t.param.end.y);this._ease(e,t.param.ease,t.param.elasticFactor),this._excuteAction(e,t.node,t.param.delay)},e.prototype._rotation=function(t){t.node.rotation=t.param.begin.x;var e=cc.rotateTo(t.param.dura,t.param.end.x);this._ease(e,t.param.ease,t.param.elasticFactor),this._excuteAction(e,t.node,t.param.delay)},e.prototype._fade=function(t){t.node.opacity=t.param.begin.x;var e=cc.fadeTo(t.param.dura,t.param.end.x);this._ease(e,t.param.ease,t.param.elasticFactor),this._excuteAction(e,t.node,t.param.delay)},e.prototype._moveAndFade=function(t){t.node.setPosition(t.param.begin);var e=cc.moveTo(t.param.dura,t.param.end);if(this._ease(e,t.param.ease,t.param.elasticFactor),t.param.begin2){t.node.opacity=t.param.begin2.x;var i=cc.fadeTo(t.param.dura,t.param.end2.x);this._ease(i,t.param.ease2,t.param.elasticFactor);var n=cc.spawn(e,i);this._excuteAction(n,t.node,t.param.delay)}else cc.error("param lost,please check the param begin2, end2 and ease2 is existed")},e.prototype._scaleAndFade=function(t){t.node.setScale(t.param.begin.x,t.param.begin.y);var e=cc.scaleTo(t.param.dura,t.param.end.x,t.param.end.y);if(this._ease(e,t.param.ease,t.param.elasticFactor),t.param.begin2){t.node.opacity=t.param.begin2.x;var i=cc.fadeTo(t.param.dura,t.param.end2.x);this._ease(i,t.param.ease2,t.param.elasticFactor);var n=cc.spawn(e,i);this._excuteAction(n,t.node,t.param.delay)}else cc.error("param lost,please check the param begin2, end2 and ease2 is existed")},e.prototype._scaleAndRot=function(t){t.node.setScale(t.param.begin.x,t.param.begin.y);var e=cc.scaleTo(t.param.dura,t.param.end.x,t.param.end.y);if(this._ease(e,t.param.ease,t.param.elasticFactor),t.param.begin2){t.node.rotation=t.param.begin2.x;var i=cc.rotateTo(t.param.dura,t.param.end2.x);this._ease(i,t.param.ease2,t.param.elasticFactor);var n=cc.spawn(e,i);this._excuteAction(n,t.node,t.param.delay)}else cc.error("param lost,please check the param begin2, end2 and ease2 is existed")},e.prototype._excuteAction=function(t,e,i){if(i>0){var n=cc.delayTime(i);e.runAction(cc.sequence(n,t))}else e.runAction(t)},e.prototype._ease=function(t,e,i){if(null==e||e.x!=a.kNone){var n=null,o=e.x,r=e.y;o==a.kCubic?r==s.kIn?n=cc.easeCubicActionIn():r==s.kOut?n=cc.easeCubicActionOut():r==s.kInOut&&(n=cc.easeCubicActionInOut()):o==a.kBack?r==s.kIn?n=cc.easeBackIn():r==s.kOut?n=cc.easeBackOut():r==s.kInOut&&(n=cc.easeBackInOut()):o==a.kBounce?r==s.kIn?n=cc.easeBounceIn():r==s.kOut?n=cc.easeBounceOut():r==s.kInOut&&(n=cc.easeBounceInOut()):o==a.kElastic?r==s.kIn?n=cc.easeElasticIn(i):r==s.kOut?n=cc.easeElasticOut(i):r==s.kInOut&&(n=cc.easeElasticInOut(i)):o==a.kCircle?r==s.kIn?n=cc.easeCircleActionIn():r==s.kOut?n=cc.easeCircleActionOut():r==s.kInOut&&(n=cc.easeCircleActionInOut()):o==a.kSine&&(r==s.kIn?n=cc.easeSineIn():r==s.kOut?n=cc.easeSineOut():r==s.kInOut&&(n=cc.easeSineInOut())),n&&t.easing(n)}},e.prototype.typoEffect=function(t,e,i,n){void 0===n&&(n=.05);var o="",r=e.split(""),a=r.length,s=0,l=function(){o+=r[s],t.string=o,++s>=a&&h.G.isExistObj(i)&&i()}.bind(this);this.schedule(l,n,a-1,0)},o([u(d)],e.prototype,"motionNode_",void 0),o([u({visible:!0,displayName:"TriggerWhileEnable",tooltip:"\u52fe\u9009\u540e\uff0c\u8282\u70b9\u4f1a\u5728active\u4e3atrue\u65f6\u6267\u884c\u52a8\u6548\uff0c\u4f46\u662f\u6ca1\u6709\u52a8\u6548\u4e4b\u540e\u5b8c\u6bd5\u540e\u7684\u56de\u8c03\u65b9\u6cd5"})],e.prototype,"bTriggerWhileEnable_",void 0),e=o([c],e)}(cc.Component);i.default=f,cc._RF.pop()},{"../global_def":"global_def"}],user_info:[function(t,e,i){"use strict";cc._RF.push(e,"4efc8voJd9GD5HCQfF092c5","user_info"),Object.defineProperty(i,"__esModule",{value:!0}),i.GameUserInfo=i.AchievementTask=i.PlayerProp=i.DailyData=i.BonusInfo=i.SkillInfo=i.SkillType=i.BonusType=void 0;var n,o=t("../../util/storage"),r=t("../../util/structure/hd_map"),a=t("../../game_ui/game/repository"),s=t("../../game_ui/game/StoryPnl"),h=t("../../data/data_hub");(function(t){t[t.kCoin=1]="kCoin",t[t.kBox1=2]="kBox1",t[t.kBox2=3]="kBox2",t[t.kBox3=4]="kBox3",t[t.kPiece1=5]="kPiece1",t[t.kPiece2=6]="kPiece2",t[t.kPiece3=7]="kPiece3"})(n=i.BonusType||(i.BonusType={}));var l=function(){function t(){}return t.lianji="0",t.xiati="1",t.shangti="2",t.qinna="3",t.xuli="4",t}();i.SkillType=l;var c=function(){return function(){this[0]=0,this[1]=0,this[2]=0,this[3]=0,this[4]=0}}();i.SkillInfo=c;var u=function(){return function(t,e,i){void 0===i&&(i=""),this.type=n.kCoin,this.count=0,this.desc="",this.type=t,this.count=e,this.desc=i}}();i.BonusInfo=u;var p=function(){return function(){this.signInBonusMap=new r.default,this.lastSignInDay=0,this.signInAwarded=0,this.signInAwardCnt=0,this.signInTotalCnt=0,this.taskDegMap=new r.default,this.taskBonusMap=new r.default,this.lastTaskTime=0,this.videoLimited=0,this.bnrClickCnt=0}}();i.DailyData=p;var d=function(){return function(){this.coin=0,this.ownRoles=[0],this.ownWeapons=["0","1","2","3","4"],this.itemMap=new r.default,this.currRole=0,this.currWeapon="0",this.specialCurrency=0}}();i.PlayerProp=d;var f=function(){return function(){this.taskFullMap=new r.default,this.taskReceiveMap=new r.default}}();i.AchievementTask=f;var _=function(){return function(){this.curChapter="0",this.curPeriod="0",this.chapterMap=new r.default,this.periodMap=new r.default}}(),g=function(){function t(){}return t.updUserCoin=function(e){var i=!1,n=t.prop.coin+e;return n>=0&&(t.prop.coin=n,t.saveProp(),i=!0),i},t.updUserSpecialCurrency=function(e){var i=!1,n=t.prop.specialCurrency+e;return n>=0&&(t.prop.specialCurrency=n,t.saveProp(),i=!0),i},t.hasRole=function(e){for(var i=t.prop.ownRoles,n=0,o=i.length;n<o;n++)if(i[n]==e)return!0;return!1},t.calOfflineTime=function(){if(t.dailyDat.offlineTimestamp>0){var e=Date.now()-t.dailyDat.offlineTimestamp,i=e/1e3;t.calVideoBonusTime(i),t.dailyDat.offlineTimestamp+=e}},t.calVideoBonusTime=function(e){t.dailyDat.videoBonusTime-=e},Object.defineProperty(t,"isBannerClickAvailable",{get:function(){return this.dailyDat.bnrClickCnt<h.DataHub.config.bnrClickCnt},enumerable:!1,configurable:!0}),t.addRole=function(e){t.prop.ownRoles.push(e);var i=new c;t.setRoleSkill(e,i),t.prop.itemMap.put(o.SaveDef.kRoleLv+e,0),t.saveProp()},t.getRoleLvl=function(e){return t.prop.itemMap.get(o.SaveDef.kRoleLv+e)},t.upRoleLvl=function(e,i){t.prop.itemMap.put(o.SaveDef.kRoleLv+e,i),t.saveProp()},t.getRoleSkill=function(e){return t.prop.itemMap.get(o.SaveDef.kRoleSkill+e)},t.setRoleSkill=function(e,i){t.prop.itemMap.put(o.SaveDef.kRoleSkill+e,i),t.saveProp()},t.updRoleSkill=function(e,i){var n=t.getRoleSkill(e);return n[i]<a.Repository.instance.skillData.get(i).max_lv&&(n[i]+=1,t.prop.itemMap.put(o.SaveDef.kRoleSkill,n),t.saveProp(),!0)},t.hasWeapon=function(e){for(var i=!1,n=t.prop.ownWeapons,o=0,r=n.length;o<r;o++)if(n[o]==e){i=!0;break}return i},t.setWeapon=function(e){-1==t.prop.ownWeapons.indexOf(e)&&t.prop.ownWeapons.push(e),t.prop.itemMap.put(o.SaveDef.kRoleWeaponLvl+e,0),t.saveProp()},t.updWeaponLvl=function(e){var i=t.prop.itemMap.get(o.SaveDef.kRoleWeaponLvl+e);i<a.Repository.instance.weaponData.get(e).max_lv&&(t.prop.itemMap.put(o.SaveDef.kRoleWeaponLvl+e,++i),t.saveProp())},t.getWeaponLvl=function(e){return t.hasWeapon(e)?t.prop.itemMap.get(o.SaveDef.kRoleWeaponLvl+e):null},t.updCurChapter=function(e){t.storyProp.curChapter=e,t.saveStoryProp()},t.addCurPeriod=function(){var e=Number(t.storyProp.curChapter),i=Number(t.storyProp.curPeriod),n=s.StoryData.getChapterCount()-1;i+1>s.StoryData.getPerioCount(t.storyProp.curChapter)-1?(t.storyProp.curChapter=e+1>n?String(n):String(e+1),t.storyProp.curPeriod=String(i+1)):t.storyProp.curPeriod=String(i+1);var o=t.storyProp.curChapter+"_"+t.storyProp.curPeriod;t.storyProp.periodMap.put(o,1),t.storyProp.chapterMap.put(t.storyProp.curChapter,1),t.saveStoryProp()},t.updCurPeriod=function(e){t.storyProp.curPeriod=e,t.saveStoryProp()},t.saveProp=function(){o.default.writeJSON(o.SaveDef.kPlayer,t.prop)},Object.defineProperty(t,"isVideoLimited",{get:function(){return 1===t.dailyDat.videoLimited},enumerable:!1,configurable:!0}),Object.defineProperty(t,"isSignInAwarded",{get:function(){return 1===t.dailyDat.signInAwarded},enumerable:!1,configurable:!0}),Object.defineProperty(t,"isSignIn7Days",{get:function(){return t.dailyDat.signInAwardCnt>=7},enumerable:!1,configurable:!0}),t.resetLastClickTimestamp=function(){this.lastClickTimestamp=0},t.calBannerJumpInterval=function(){if(this.lastClickTimestamp>0){var t=(Date.now()-this.lastClickTimestamp)/1e3;t>1.5&&(t=1.5),this.lastClickTimestamp=0,this.bnrJumpInterval=t}else this.lastClickTimestamp=Date.now()},t.addBannerClickCnt=function(){++this.dailyDat.bnrClickCnt,this.saveSignIn()},t.limitVideo=function(){t.dailyDat.videoLimited=1},t.isCoinAfford=function(e){return t.prop.coin>=e},t.saveSignIn=function(){o.default.writeJSON(o.SaveDef.kDaily,t.dailyDat)},t.setOfflineTimestamp=function(){t.dailyDat.offlineTimestamp=Date.now()},t.saveAchievement=function(){o.default.writeJSON(o.SaveDef.kAchievement,t.achievement)},t.saveStoryProp=function(){o.default.writeJSON(o.SaveDef.kStoryKey,t.storyProp)},t.read=function(){var e=o.default.readJSON(o.SaveDef.kPlayer);if(e)t.prop.coin=e.coin,t.prop.ownWeapons=e.ownWeapons,t.prop.ownRoles=e.ownRoles,t.prop.itemMap.copy(e.itemMap),t.prop.currRole=e.currRole,e.specialCurrencys&&(t.prop.specialCurrency=e.specialCurrency),e.taskFullMap;else{for(var i=0;i<t.prop.ownRoles.length;i++)t.prop.itemMap.put(o.SaveDef.kRoleSkill+i,new c),t.prop.itemMap.put(o.SaveDef.kRoleLv+i,0);t.saveProp()}var n=o.default.readJSON(o.SaveDef.kAchievement);n&&(t.achievement.taskFullMap.copy(n.taskFullMap),t.achievement.taskReceiveMap.copy(n.taskReceiveMap));var r=o.default.readJSON(o.SaveDef.kStoryKey);r?(t.storyProp.curChapter=r.curChapter,t.storyProp.curPeriod=r.curPeriod,t.storyProp.chapterMap.copy(r.chapterMap),t.storyProp.periodMap.copy(r.periodMap)):(t.storyProp.chapterMap.put("0",1),t.storyProp.periodMap.put("0_0",1),t.saveStoryProp());var a=o.default.readJSON(o.SaveDef.kDaily);if(a){t.dailyDat.signInAwardCnt=a.signInAwardCnt,t.dailyDat.lastSignInDay=a.lastSignInDay,t.dailyDat.signInTotalCnt=a.signInTotalCnt,(s=new Date).getDate()==t.dailyDat.lastSignInDay?(t.dailyDat.videoLimited=a.videoLimited,t.dailyDat.signInAwarded=a.signInAwarded,t.dailyDat.bnrClickCnt=a.bnrClickCnt||0,t.dailyDat.taskDegMap.copy(a.taskDegMap),t.dailyDat.taskBonusMap.copy(a.taskBonusMap)):(t.dailyDat.signInAwardCnt=a.signInAwardCnt+1,t.dailyDat.videoLimited=0,t.dailyDat.signInAwarded=0,t.dailyDat.bnrClickCnt=0,t.dailyDat.lastSignInDay=s.getDate()),t.dailyDat.signInBonusMap.copy(a.signInBonusMap),t.saveSignIn()}else{t.dailyDat.lastSignInDay=0,t.dailyDat.signInAwardCnt=0,t.dailyDat.signInAwarded=0,t.dailyDat.signInTotalCnt=0,t.dailyDat.bnrClickCnt=0,t.dailyDat.videoLimited=0;var s=new Date;t.dailyDat.lastSignInDay=s.getDate(),t.saveSignIn()}},t.prop=new d,t.dailyDat=new p,t.achievement=new f,t.storyProp=new _,t.bnrJumpInterval=1,t.lastClickTimestamp=0,t}();i.GameUserInfo=g,cc._RF.pop()},{"../../data/data_hub":"data_hub","../../game_ui/game/StoryPnl":"StoryPnl","../../game_ui/game/repository":"repository","../../util/storage":"storage","../../util/structure/hd_map":"hd_map"}],water:[function(t,e,i){"use strict";cc._RF.push(e,"1a315R27ehP7biFndPWrzp1","water");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./ItemInfo"),a=t("./lifeBase"),s=t("./hero"),h=cc._decorator,l=h.ccclass,c=h.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.persistent=!1,e.box=null,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.onCollisionEnter=function(t,e){var i=t.node;if("hero"==i.group)(n=i.getComponent(s.heroAct))&&n.setState(s.actState.fallWater);else if("enemy"==i.group){var n;(n=i.getComponent(a.default))&&n.addBlood(-1e6,"water")}},o([c(cc.BoxCollider)],e.prototype,"box",void 0),e=o([l],e)}(r.default);i.default=u,cc._RF.pop()},{"./ItemInfo":"ItemInfo","./hero":"hero","./lifeBase":"lifeBase"}],weapon:[function(t,e,i){"use strict";cc._RF.push(e,"d084bvfDDdIw4GqHrzD7+4k","weapon");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.WeaponType=void 0;var r,a=t("./../hero"),s=t("../../scene/gameScene"),h=t("../../../util/global_def"),l=t("../../tools/nodePool_control"),c=t("../../scene/uiControl"),u=t("../enemy"),p=t("../ItemInfo"),d=cc._decorator,f=d.ccclass,_=d.property;(function(t){t[t.darts=3]="darts",t[t.knife=2]="knife",t[t.gun0=0]="gun0",t[t.gun1=1]="gun1",t[t.bullet=5]="bullet",t[t.brick=4]="brick"})(r=i.WeaponType||(i.WeaponType={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="",e.hurtNum=20,e.weaponType=255,e.weaponNum=10,e.type=0,e.changeSlot="weapon_3",e.iconImage=null,e.dir=1,e.run=!1,e}var i;return n(e,t),i=e,e.prototype.onLoad=function(){var t=cc.fadeTo(.3,120),e=cc.fadeTo(.3,255),i=cc.fadeTo(.3,150),n=cc.fadeTo(.3,255);this.node.runAction(cc.repeatForever(cc.sequence(t,e,i,n,cc.delayTime(2))))},e.prototype.destroyAni=function(){var t=this,e=cc.jumpBy(.25,cc.v2(0,50),50,1),i=cc.fadeOut(.5);this.node.stopAllActions(),this.node.runAction(cc.sequence(e,i,cc.callFunc(function(){t.node.destroy(),s.default.instance.map.removeMapNode(t.node.parent)})))},e.prototype.onCollisionEnter=function(t,e){var i=t.node;0==this.type&&"hero"==i.group&&"hero"==i.name?(i.getComponent(a.heroAct).addWeapon(this.weaponType,this.weaponNum),this.destroyAni()):1==this.type&&"enemy"==i.group&&this.hitEnemy(i)},e.prototype.hitEnemy=function(t){var e=t.getComponent(u.enemyAct);e.setDefense(),e.isCanHurt()&&(e.hurtDir=-this.dir,e.entity.addBlood(-this.hurtNum,this.name),e.setState(u.eActState.hurtYiJi)),this.node.destroy()},e.prototype.changeImage=function(){var t=this.node.parent.getComponent(a.heroAct),e=this.name,i=t.entity.ani.armature().getSlot(this.changeSlot),n=dragonBones.CCFactory.getInstance(),o=s.default.instance.weapon.getArmatureKey(),r=s.default.instance.weapon.armatureName;n.replaceSlotDisplay(o,r,e,"\u6b66\u5668/"+e,i),c.default.instance.changeWeapIcon(this.iconImage)},e.prototype.fire=function(){var t=this,e=this.node.parent,n=e.getComponent(a.heroAct);n.entity.ani.playAnimation(n.aniName.aniTouZhi,1),this.scheduleOnce(function(){var o=l.default.instance.getNode(t.name);o.getComponent(i).type=1,o.parent=e.parent;var r=n.getDir();o.x=e.x+50*r,o.y=e.y,o.getComponent(i).fly(r),n.addWeapon(t.weaponType,-1)},.2)},e.prototype.fly=function(t){var e=this;this.dir=t,this.run=!0,this.node.stopAllActions(),this.schedule(function(){var t=e.node.convertToWorldSpaceAR(cc.v2(0,0));(t=s.default.instance.node.convertToNodeSpaceAR(t)).x>s.default.instance.mapCamera.x+h.G.viewX/2&&(e.run=!1,e.node.angle=0,l.default.instance.putNode(e.node))},.3)},e.prototype.mv=function(){this.node.angle+=-16*this.dir,this.node.x+=15*this.dir},e.prototype.update=function(){this.run&&this.mv()},o([_({type:r})],e.prototype,"weaponType",void 0),e=i=o([f],e)}(p.default);i.default=g,cc._RF.pop()},{"../../../util/global_def":"global_def","../../scene/gameScene":"gameScene","../../scene/uiControl":"uiControl","../../tools/nodePool_control":"nodePool_control","../ItemInfo":"ItemInfo","../enemy":"enemy","./../hero":"hero"}],wordFactory:[function(t,e,i){"use strict";cc._RF.push(e,"a6008Haf5RLb59oYzpY2Dg4","wordFactory");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r,a=t("./nodePool_control"),s=t("../../util/global_def"),h=cc._decorator,l=h.ccclass;h.property;(function(t){t[t.flutter=0]="flutter",t[t.jump=1]="jump"})(r=i.wordType||(i.wordType={}));var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var i;return n(e,t),i=e,e.prototype.onLoad=function(){i.instance=this},e.prototype.play=function(t,e,i,n){switch(t){case r.flutter:var o=a.default.instance.getNode("fWords");o.parent=n,o.getComponent(cc.Label).string=e,o.opacity=255,o.stopAllActions(),o.position=i,o.scale=-.2;var h=cc.moveBy(1.3,s.G.randRange(-30,30),200),l=cc.scaleTo(1.3,-1.5),c=cc.fadeOut(.3);this.scheduleOnce(function(){o.runAction(c)},1),o.runAction(cc.sequence(cc.spawn(h,l),cc.callFunc(function(){a.default.instance.putNode(o)})));break;case r.jump:var u=a.default.instance.getNode("jWords");u.parent=n,u.stopAllActions(),u.getComponent(cc.Label).string="-"+e,Number(e)>10?u.color=cc.color(255,0,0):u.color=cc.color(255,255,255),u.opacity=255,u.stopAllActions(),u.position=i;var p=cc.jumpBy(.6,cc.v2(0,s.G.randRange(170,190)),150,1);u.scale=-.8;l=cc.scaleTo(.5,-1.3);var d=cc.fadeOut(.6);h=cc.moveBy(.5,s.G.randRange(-30,30),120);u.runAction(cc.sequence(p,cc.spawn(l,d,h),cc.callFunc(function(){a.default.instance.putNode(u)})))}},e.prototype.showDes=function(t,e,i,n,o){void 0===n&&(n=cc.color(255,255,255)),void 0===o&&(o=40);for(var r=t.length,a=function(r){var a=new cc.Node;a.parent=i,a.color=n;var s=a.addComponent(cc.Label);s.string=t[r],s.fontSize=o,a.y=e.y,a.x=e.x+45*r,a.scale=0,a.runAction(cc.sequence(cc.delayTime(.1*r),cc.spawn(cc.scaleTo(.2,1),cc.jumpBy(.2,cc.v2(0,0),70,1)),cc.delayTime(1),cc.fadeOut(1),cc.callFunc(function(){a.destroy()})))},s=0;s<r;++s)a(s)},e.instance=null,e=i=o([l],e)}(cc.Component);i.default=c,cc._RF.pop()},{"../../util/global_def":"global_def","./nodePool_control":"nodePool_control"}],wx_util:[function(t,e,i){"use strict";cc._RF.push(e,"ddd35rF9ldDko6TQsndGHNu","wx_util");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=t("./global_def"),r=t("../game_setting"),a=t("../game_ui/common/ad_sim_ui"),s=t("./timed_task"),h=t("../data/data_hub"),l=t("./mgp_def"),c=t("./storage"),u=t("./event_mgr"),p=t("../game_logic"),d=t("./network/http_req"),f=t("../game/user_info/user_info"),_=t("./mgp_util"),g=t("../game_ui/game/ExportPnl"),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._curId=null,e._curTag=null,e}return n(e,t),e.prototype.saveData=function(){var t={openId:r.GameSetting.openId};c.default.writeJSON(c.SaveDef.kWxStatus,t)},e.prototype.readData=function(){var t=c.default.readJSON(c.SaveDef.kWxStatus);t&&(r.GameSetting.openId=t.openId)},e.prototype.fetchSdkInfo=function(){this.sdkInfo=wx.getSystemInfoSync(),console.log("[WxUtil SDK info]",this.sdkInfo.screenWidth,this.sdkInfo.screenHeight,this.sdkInfo.platform,this.sdkInfo.SDKVersion),1==r.GameSetting.testServer&&(this.domain_="http://119.23.108.126:8900/comLogin")},e.prototype.compareVersion=function(t,e){for(var i=t.split("."),n=e.split("."),o=Math.max(i.length,n.length);i.length<o;)i.push("0");for(;n.length<o;)n.push("0");for(var r=0;r<o;r++){var a=parseInt(i[r]),s=parseInt(n[r]);if(a>s)return 1;if(a<s)return-1}return 0},e.prototype.convertMenuButtonRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i={x:0,y:0,w:0,h:0},n=this.sdkInfo;if(-1!=this.compareVersion(n.SDKVersion,"2.1.0")){var o=wx.getMenuButtonBoundingClientRect(),r=cc.view.getVisibleSize().width,a=cc.view.getVisibleSize().height,s=r/n.screenWidth,h=a/n.screenHeight;i.x=o.left*s+t,i.y=o.top*h+e,i.w=o.width*s,i.h=o.height*h}return i},e.prototype.login=function(t,e,i,n,o){var r=this;void 0===n&&(n=!1),void 0===o&&(o=!1),n?this._login(t,e,i,o):wx.checkSession({success:function(t){console.log("check session succ",t),r.readData()},fail:function(n){console.log("check session fail",n),r._login(t,e,i,o)},complete:function(t){}})},e.prototype._login=function(t,e,i,n){var o=this;void 0===n&&(n=!1),wx.login({success:function(a){a.code&&(o.loginCode_=a.code,n?t&&t():wx.request({url:o.domain_+"/user/getSessionKey",data:{code:a.code,proName:r.GameSetting.proName,choose:"1"},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(i){i.statusCode>=200&&i.statusCode<=400?(console.log("login request succ",i),t&&t(JSON.parse(i.data.res))):(console.log("login request fail",i),e&&e(i))},fail:function(t){console.log("login request complete fail",t),i&&i(t)}}))},fail:function(t){console.log("login fail",t),i&&i(t)},complete:function(t){}})},e.prototype.fetchUserInfo=function(t,e,i,n,r,a){var s=this;-1!=this.compareVersion(this.sdkInfo.SDKVersion,"1.2.0")?wx.getSetting({success:function(h){if(h.authSetting["scope.userInfo"])wx.getUserInfo({withCredentials:!0,lang:"zh_CN",success:function(t){e&&e(t.userInfo),s._authLogin(t,i,n)},fail:function(t){o.G.log("get setting scope userInfo failed",1,t)},complete:function(t){}});else if(-1!=s.compareVersion(s.sdkInfo.SDKVersion,"2.0.1")){var l=wx.createImage();l.src="res/raw-assets/resources/"+t+".png",l.onload=function(){var t=a;if(o.G.isEmptyObj(t)){var s=l.width,h=l.height;t={left:.5*this.sdkInfo.screenWidth-.5*s,top:.5*this.sdkInfo.screenHeight,width:s,height:h,color:"#ffffff",lineHeight:40,backgroundColor:"#ff0000",borderColor:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}}this._authentication(e,t,l.src,r,i,n)}.bind(s)}else s.modalDialog("\u5fae\u4fe1\u66f4\u65b0\u63d0\u793a","\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8f83\u4f4e\uff0c\u5efa\u8bae\u5347\u7ea7\u4ee5\u4fdd\u969c\u6e38\u620f\u4f53\u9a8c",function(){wx.exitMiniProgram({})},null,!1)},fail:function(t){},complete:function(t){}}):this.modalDialog("\u5fae\u4fe1\u66f4\u65b0\u63d0\u793a","\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u8bf7\u5347\u7ea7\u5df2\u4fdd\u969c\u6b63\u5e38\u6e38\u620f\u4f53\u9a8c",function(){wx.exitMiniProgram({})},null,!1)},e.prototype._authLogin=function(t,e,i){wx.request({url:this.domain_+"/user/auth",data:{encryptedData:t.encryptedData,iv:t.iv,code:this.loginCode_,proName:r.GameSetting.proName},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(t){t.statusCode>=200&&t.statusCode<=400?(console.log("_authLogin request succ",t),e&&e(t.data.res)):(console.log("_authLogin request fail",t),i&&i())},fail:function(t){console.log("_authLogin request complete fail",t)}})},e.prototype._authentication=function(t,e,i,n,r,a){var s=wx.createUserInfoButton({type:"image",text:"txt",image:i,style:e,withCredentials:!0,lang:"zh_CN"});s.show(),o.G.log("create button",1,s);var h=function(l){if(o.G.log("_authentication onTap",1,l),null==l.iv||null==l.encryptedData){o.G.log("cancel auth");var c=wx.createImage();c.src=i,c.onload=function(){var i=e;if(o.G.isEmptyObj(i)){var s=c.width,h=c.height;i={left:.5*this.sdkInfo.screenWidth-.5*s,top:.5*this.sdkInfo.screenHeight,width:s,height:h,color:"#ffffff",lineHeight:40,backgroundColor:"#ff0000",borderColor:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}}this._authentication(t,e,c.src,n,r,a)}.bind(this)}else t&&t(l.userInfo),this._authLogin(l,r,a),n&&n();s.offTap(h),s.destroy()}.bind(this);s.onTap(h)},e.prototype.uploadUserInfo=function(t,e,i,n,o,a){wx.request({url:this.domain_+"/user/updUser",data:{proName:r.GameSetting.proName,openid:r.GameSetting.openId,unionid:r.GameSetting.unionId,nickname:t,gender:i,avatarurl:e,city:n,province:o,country:a},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(t){},fail:function(t){}})},e.prototype.showForward=function(t){wx.showShareMenu({withShareTicket:!1,success:function(t){},fail:function(){},complete:function(){}}),wx.onShareAppMessage(function(){var e=null;return t&&(e=t()),e})},e.prototype.shareNorm=function(t,e,i,n){var o=this,a=e.lastIndexOf("Shared/"),s=r.GameSetting.proName,h="";-1!=a&&(h=e.substring(a+s.length+8)),d.default.shareOut(h),wx.shareAppMessage({title:t,imageUrl:e,query:"hdimg="+h,cancel:function(){console.log("norm share cancel"),o.bNormShareCancel=!0,o.normShareFailCallback&&(o.normShareFailCallback(),o.normShareFailCallback=null)}}),this.normShareTimestamp=Date.now(),this.normShareSuccCallback=i,this.normShareFailCallback=n,this.bNormShareCancel=!1},e.prototype.shareForTMSDK=function(t,e,i,n){void 0===n&&(n=""),o.G.isTMSDK?wx.tmSDK.shareAppMessage({scene:t,success:function(){e&&e()},cancel:function(){i&&i()},query:n}):o.G.log("tmSdk is not active,share for tmSdk can not be invoking")},e.prototype.normShareResult=function(){var t=this;this.normShareTimestamp>0&&(Date.now()-this.normShareTimestamp>=2400?setTimeout(function(){t.bNormShareCancel||(t.normShareSuccCallback&&(t.normShareSuccCallback(),t.normShareSuccCallback=null),o.G.log("norm share succ"))},100):(this.normShareFailCallback&&(this.normShareFailCallback(),this.normShareFailCallback=null),o.G.log("norm share fail")),this.normShareTimestamp=0)},e.prototype.launchQueryCheck=function(t){void 0===t&&(t=!1);var e=wx.getLaunchOptionsSync();e&&o.G.isExistObj(e.query)&&e.query.hdimg&&d.default.shareClick(e.query.hdimg)},e.prototype.onShowQueryCheck=function(t,e){void 0===e&&(e=!1),o.G.isExistObj(t)&&t.hdimg&&d.default.shareClick(t.hdimg)},e.prototype.reqTimerReset=function(t,e,i){var n=function(){var n=this;wx.request({url:this.domain_+"/user/reqTimerReset",data:{proName:r.GameSetting.proName,sysName:t,openId:r.GameSetting.openId,choose:e.toString()},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(t){if(t.statusCode>=200&&t.statusCode<=400){console.log("reqTimerReset request succ",t);var e=parseInt(t.data.res);i&&i(e)}else console.log("reqTimerReset request fail",t),n.modalDialog("\u7f51\u7edc\u62a5\u544a","\u5f53\u524d\u7f51\u7edc\u73af\u5883\u4e0d\u4f73\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u540e\u91cd\u8bd5")},fail:function(t){console.log("reqTimerReset request fail",t)}})}.bind(this);""==r.GameSetting.openId?this.login(function(t){r.GameSetting.sessionKey=t.sessionKey,r.GameSetting.openId=t.openId,n(),o.G.log("reqTimerReset relogin",1,t)},null,null,!0):n()},e.prototype.reqTimerResetUnion=function(t,e,i,n){var o=function(){wx.request({url:this.domain_+"/user/reqTimerResetU",data:{proName:r.GameSetting.proName,sysName:t,unionId:r.GameSetting.unionId,choose:e.toString()},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(t){if(t.statusCode>=200&&t.statusCode<=400){console.log("reqTimerResetUnion request succ",t);var e=parseInt(t.data.res);i&&i(e)}else console.log("reqTimerResetUnion request fail",t)},fail:function(t){console.log("reqTimerResetUnion request complete fail",t)}})}.bind(this);""==r.GameSetting.unionId?n&&n():o()},e.prototype._getVideoBonus=function(){this.videoBonusCallback_&&(this.videoBonusCallback_(),this.videoBonusCallback_=null)},e.prototype.watchVideoAds=function(t,e,i,n,r,a,l,c){var d=this;if(void 0===l&&(l=""),void 0===c&&(c=!1),!c){var m=o.G.randRange(0,100),y=h.DataHub.config.VideoExportShare;if(m>100-y[2])return void this.shareForTMSDK("homeShare",e);if(m>100-y[2]-y[1])return void g.ExportPnl.instance.show(e,1)}if(CC_WECHATGAME){a=function(){f.GameUserInfo.updUserCoin(200)};var b=this.sdkInfo;if(-1!=this.compareVersion(b.SDKVersion,"2.1.0")){var C=function(o){if(d.videoAdsProtectFlags_.containsKey(t)&&1===d.videoAdsProtectFlags_.get(t))return;console.log("Ads Close callback",o.isEnded),p.default.instance.eventManager.addEvent(u.EventType.kAudioResume,null,{pauseType:1}),o&&o.isEnded||void 0===o?(e&&e(),d.videoAdsProtectFlags_.put(t,1)):(d.modalDialog("\u63d0\u793a","\u9700\u8981\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u5956\u52b1\u54e6!",function(){d.watchVideoAds(t,e,i,n,r,a,l,c)},i),d.videoAdsProtectFlags_.put(t,0)),d.videoTimeId_>0&&(s.TimedTaskInst.remove(d.videoTimeId_),d.videoTimeId_=0),d.videoBonusCallback_=null},S=function(t){console.log("Ads error callback",t.errMsg),p.default.instance.eventManager.addEvent(u.EventType.kAudioResume,null,{pauseType:1}),n&&n(t),d.videoBonusCallback_=null,-1!=d.compareVersion(b.SDKVersion,"2.2.2")&&t.errCode&&(console.log("video err code",t.errCode),1e3!=t.errCode&&1003!=t.errCode&&1004!=t.errCode&&f.GameUserInfo.limitVideo()),_.MgpUtil.shareForTMSDK("homeShare",e)};if(this.videoAd_=wx.createRewardedVideoAd({adUnitId:t}),this.videoAd_.load().then(function(){d.videoAd_.show().then(function(){p.default.instance.eventManager.addEvent(u.EventType.kAudioPause,null,{pauseType:1}),o.G.randRange(0,100)<=h.DataHub.config.videoBonus&&(d.videoTimeId_>0&&(s.TimedTaskInst.remove(d.videoTimeId_),d.videoTimeId_=0),d.videoBonusCallback_=a,d.videoTimeId_=s.TimedTaskInst.add(function(){var t=l||"\u70b9\u51fb\u5e95\u90e8\u6761\u5e45\u53ef\u83b7\u5f97200\u91d1\u5e01";d.toast(t,5e3),console.log("video show3333333333333333333333")},5))}).catch(function(t){return console.log("video err",t)}),d.videoAdsProtectFlags_.put(t,0)}).catch(function(t){return console.log(t.errMsg)}),this.videoAdsCallbackMap_.containsKey(t)){this.videoAdsCallbackMap_.get(t);this.videoAd_.offClose(),this.videoAd_.offError(),this.videoAdsCallbackMap_.remove(t)}this.videoAd_.onClose(C),this.videoAd_.onError(S);var w=new v(C,S);this.videoAdsCallbackMap_.put(t,w),r&&r()}else this.modalDialog("\u63d0\u793a","\u5fae\u4fe1\u7248\u672c\u8f83\u4f4e\uff0c\u6682\u4e0d\u652f\u6301\u89c6\u9891\u89c2\u770b",null,null,!1)}else e()},e.prototype.bannerStat=function(t){if(this.bBnrShowed_&&this.recordBannerClickSucTimestamp(),t&&t.mode&&t.targetAction){if("back"==t.mode&&3==t.targetAction||"hide"==t.mode&&-1==t.targetAction)return void o.G.Game.bannerClickCount--;this._getVideoBonus()}},e.prototype.recordBannerCDTimestamp=function(){this.bnrClickCDTimestamp_=Date.now()},e.prototype.isBannerClickCD=function(){var t=!1;this.bnrClickCDTimestamp_>0&&(t=(Date.now()-this.bnrClickCDTimestamp_)/1e3<h.DataHub.config.bnrClickCD,o.G.log("isBannerClickCD",t));return t},e.prototype.recordBannerClickSucTimestamp=function(){this.bnrClickSucTimestamp_=Date.now(),o.G.log("recordBannerClickSucTimestamp",this.bnrClickSucTimestamp_)},e.prototype.decideBannerClickSuc=function(){if(this.bnrClickSucTimestamp_>0){var t=Date.now()-this.bnrClickSucTimestamp_;t/1e3<h.DataHub.config.bnrClickSucTime&&(o.G.log("decideBannerClickSuc",t),f.GameUserInfo.addBannerClickCnt(),this.recordBannerCDTimestamp(),this.bnrClickSucTimestamp_=0)}},e.prototype.hideCurBanner=function(){this._curId&&this._curTag&&(this.hideBannerWithRule(this._curId,this._curTag),this._curId=null,this._curTag=null)},e.prototype.showBannerWithRule=function(t,e,i,n){var r=this;void 0===n&&(n=""),g.ExportPnl.instance.cutDown||(this._curId=t,this._curTag=n,this.isBannerLimited(t)?(o.G.log("showBannerWithRule limited",t,n),e&&e()):0!==h.DataHub.config.adChk||f.GameUserInfo.isBannerClickAvailable?(o.G.log("showBannerWithRule orig banner",t),this.bBnrShowed_=!0,this.showBanner(t,n)):(o.G.log("showBannerWithRule cd enter",t,n),this.bnrRefreshTaskId_>0&&(s.TimedTaskInst.remove(this.bnrRefreshTaskId_),this.bnrRefreshTaskId_=0),this.showBanner(t,n),this.bnrRefreshTaskId_=s.TimedTaskInst.add(function(){r.bnrRefreshTaskId_=0,o.G.log("showBannerWithRule cd hide",t,n),r.hideBanner(t,n),e&&e()},1)),i&&this.bnrHideCbMap_.put(t+n,i))},e.prototype.hideBannerWithRule=function(t,e){void 0===e&&(e=""),this.hideBanner(t,e),this.bBnrShowed_=!1;var i=t+e;this.bnrHideCbMap_.containsKey(i)&&(this.bnrHideCbMap_.get(i)(),this.bnrHideCbMap_.remove(i))},e.prototype._calBannerXYWZ=function(t,e,i,n,o){void 0===i&&(i=1),void 0===n&&(n=15),void 0===o&&(o=0);var r=this.sdkInfo.screenWidth;t&&(r=t);var a=120*(r/300),s=0;if(e){var h=cc.view.getVisibleSize().height,l=e.localToGlobal().y+e.height,c=(l+n)/h;s=this.sdkInfo.screenHeight*c,console.log("addBanner node",c,l,n,h-l,h,s,this.sdkInfo.screenHeight)}else s=this.sdkInfo.screenHeight-a,0==i&&(s=0);var u=o/cc.view.getVisibleSize().width*this.sdkInfo.screenWidth;return{x:.5*this.sdkInfo.screenWidth-.5*r+u,y:s,w:r,h:a}},e.prototype.preloadBanner=function(t,e,i,n,r,s,l,c,u,p){var d=this;void 0===n&&(n=15),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=1),void 0===c&&(c=4),void 0===u&&(u=""),void 0===p&&(p=0),console.log("banner\u95f4\u9694",n,h.DataHub.config.bnrGap);var f=t;if(t+=u,!CC_WECHATGAME)return a.BannerSimUI.addTestBannerHolder(t,e?e.asCom:null,l,p),void(r&&r());if(-1!=this.compareVersion(this.sdkInfo.SDKVersion,"2.0.4")){if(c>1e3&&this.bnrItemMap_.containsKey(t))this.bnrItemMap_.get(t).refreshCnt>=c&&this.destroyBanner(t);var _=null;if(!this.bnrItemMap_.containsKey(t)){_=new b;var g=this._calBannerXYWZ(i,e,l,n,p);_.obj=wx.createBannerAd({adUnitId:f,style:{left:g.x,top:g.y,width:g.w,height:g.h}}),_.id=t,_.refreshCnt=0,_.refreshRule=c,_.errCb=s,_.x=g.x,_.y=g.y,_.w=g.w,_.h=g.h,_.adErrCallback=function(t){o.G.log("Banner Ads pull failed",t),++_.refreshCnt,-1!=d.compareVersion(d.sdkInfo.SDKVersion,"2.2.2")&&t.errCode&&(1e3==t.errCode||1003==t.errCode||(_.bLimited=!0)),_.errCb&&_.errCb()},_.obj.onError(_.adErrCallback.bind(_));var m=function(){o.G.log("Banner pull success"),r&&r(),_.obj.offLoad(m)};_.obj.onLoad(m),this.bnrItemMap_.put(t,_)}}},e.prototype.isBannerShowed=function(t,e){if(void 0===e&&(e=""),t+=e,!CC_WECHATGAME)return a.BannerSimUI.isTestBannerHolderShowed(t);var i=!1;this.bnrItemMap_.containsKey(t)&&(i=this.bnrItemMap_.get(t).bShow);return i},e.prototype.isBannerLimited=function(t,e){if(void 0===e&&(e=""),t+=e,!CC_WECHATGAME)return a.BannerSimUI.isTestBannerLimited(t);var i=!1;this.bnrItemMap_.containsKey(t)&&(i=this.bnrItemMap_.get(t).bLimited);return i},e.prototype.showBanner=function(t,e){var i=this;void 0===e&&(e="");var n=t;if(t+=e,CC_WECHATGAME){if(-1!=this.compareVersion(this.sdkInfo.SDKVersion,"2.0.4")&&(this.hideLastOne(),this.bnrItemMap_.containsKey(t))){var r=this.bnrItemMap_.get(t);if(console.log("banner\u8282\u70b9",r),r.refreshRule<1e3&&r.refreshCnt>=r.refreshRule){var s=new b;s.obj=wx.createBannerAd({adUnitId:n,style:{left:r.x,top:r.y,width:r.w,height:r.h}}),s.id=t,s.refreshCnt=0,s.refreshRule=r.refreshRule,s.errCb=r.errCb,s.adErrCallback=function(t){o.G.log("Banner Ads pull failed",t),++s.refreshCnt,-1!=i.compareVersion(i.sdkInfo.SDKVersion,"2.2.2")&&t.errCode&&(1e3==t.errCode||1003==t.errCode||(s.bLimited=!0)),s.errCb&&s.errCb()},s.obj.onError(s.adErrCallback.bind(s)),s.x=r.x,s.y=r.y,s.w=r.w,s.h=r.h,r.del(),this.bnrItemMap_.remove(t),this.bnrItemMap_.put(t,s),r=s}r.show(),this.lastBnrItemStack_.push(r)}}else a.BannerSimUI.showTestBannerHolder(t)},e.prototype.hideBanner=function(t,e){(void 0===e&&(e=""),t+=e,CC_WECHATGAME)?this.bnrItemMap_.containsKey(t)&&(this.bnrItemMap_.get(t).hide(),this.lastBnrItemStack_.pop(),this.lastBnrItemStack_.length>0&&this.lastBnrItemStack_[this.lastBnrItemStack_.length-1].show()):a.BannerSimUI.hideTestBannerHolder(t)},e.prototype.showLastOne=function(){CC_WECHATGAME?this.lastBnrItemStack_.length>0&&this.lastBnrItemStack_[this.lastBnrItemStack_.length-1].show():a.BannerSimUI.showLastTestBanner()},e.prototype.hideLastOne=function(){CC_WECHATGAME?this.lastBnrItemStack_.length>0&&this.lastBnrItemStack_[this.lastBnrItemStack_.length-1].hide():a.BannerSimUI.hideLastTestBanner()},e.prototype.destroyBanner=function(t,e){if(void 0===e&&(e=""),t+=e,this.bnrItemMap_.containsKey(t)){this.bnrItemMap_.get(t).del();for(var i=0;i<this.lastBnrItemStack_.length;++i)if(this.lastBnrItemStack_[i].id===t){this.lastBnrItemStack_.splice(i,1);break}this.bnrItemMap_.remove(t)}},e.prototype.hideAllBanners=function(){var t=this;CC_WECHATGAME?(this.hideLastOne(),this.bnrItemMap_.each(function(e,i,n){t.hideBanner(i)})):a.BannerSimUI.hideAllTestBanner()},e.prototype.addInterstitialAd=function(t){if(CC_WECHATGAME){var e=this.sdkInfo;if(-1!=this.compareVersion(e.SDKVersion,"2.6.0"))try{this.interAd_=wx.createInterstitialAd({adUnitId:t})}catch(t){console.log("addInterstitialAd",t)}}},e.prototype.showInterstitialAd=function(){if(CC_WECHATGAME){var t=this.sdkInfo;if(-1!=this.compareVersion(t.SDKVersion,"2.6.0")&&this.interAd_)try{this.interAd_.show()}catch(t){console.log("showInterstitialAd",t)}}},e.prototype.checkVersionUpdate=function(t,e){var i=this,n=this.sdkInfo;if(-1!=this.compareVersion(n.SDKVersion,"1.9.90")){var r=n.system;if(-1!==r.indexOf("Android")){var a=r.substr(7).trim();if(-1==this.compareVersion(a,"6.6.7"))return o.G.log("skip update cause the system version is too low",1,a),void(e&&e())}o.G.log("check version update",n.system);var s=wx.getUpdateManager();s.onCheckForUpdate(function(i){console.log(i.hasUpdate),i.hasUpdate?t&&t():e&&e()}),s.onUpdateReady(function(){i.modalDialog("\u66f4\u65b0\u63d0\u793a","\u65b0\u7248\u672c\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u8bf7\u91cd\u542f\u6e38\u620f",function(){s.applyUpdate()},null,!1)}),s.onUpdateFailed(function(){i.modalDialog("\u66f4\u65b0\u63d0\u793a","\u65b0\u7248\u672c\u4e0b\u8f7d\u5931\u8d25\uff0c\u8bf7\u786e\u8ba4\u7f51\u7edc\u73af\u5883\u662f\u5426\u826f\u597d\u6216\u8005\u91cd\u542f\u5fae\u4fe1",null,null,!1)})}else this.modalDialog("\u5fae\u4fe1\u66f4\u65b0\u63d0\u793a","\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8f83\u4f4e\uff0c\u5efa\u8bae\u5347\u7ea7\u4ee5\u4fdd\u969c\u6e38\u620f\u4f53\u9a8c",null,null,!1),e&&e()},e.prototype.modalDialog=function(t,e,i,n,o,r,a,s,h){void 0===o&&(o=!0),void 0===r&&(r="\u53d6\u6d88"),void 0===a&&(a="#000000"),void 0===s&&(s="\u786e\u5b9a"),void 0===h&&(h="#3cc51f"),wx.showModal({title:t,content:e,showCancel:o,cancelText:r,cancelColor:a,confirmText:s,confirmColor:h,success:function(t){t.confirm?i&&i():t.cancel&&n&&n()}})},e.prototype.toast=function(t,e){void 0===e&&(e=1500),wx.showToast({title:t,duration:e,icon:"none"})},e.prototype.showGameClub=function(t,e,i,n){-1!=this.compareVersion(this.sdkInfo.SDKVersion,"2.0.3")&&(null==this.gameClub_&&(this.gameClub_=wx.createGameClubButton({type:"image",text:"",image:"",style:{left:t,top:e,width:i,height:n},icon:"dark"})),this.gameClub_.show())},e.prototype.hideGameClub=function(){o.G.isExistObj(this.gameClub_)&&this.gameClub_.hide()},e.prototype.removeGameClub=function(){o.G.isExistObj(this.gameClub_)&&(this.gameClub_.destroy(),this.gameClub_=null)},e.prototype.vibrateShort=function(){-1!=this.compareVersion(this.sdkInfo.SDKVersion,"1.2.0")&&wx.vibrateShort()},e.prototype.vibrateLong=function(){-1!=this.compareVersion(this.sdkInfo.SDKVersion,"1.2.0")&&wx.vibrateLong()},e.prototype.setAudioOption=function(t,e){-1!=this.compareVersion(this.sdkInfo.SDKVersion,"2.3.0")&&wx.setInnerAudioOption({mixWithOther:t,obeyMuteSwitch:e})},e.prototype.playAudio=function(t,e,i,n,o){void 0===e&&(e=!1),void 0===i&&(i=0),void 0===n&&(n=1),void 0===o&&(o=!1);var r=null;if(this.audioInfoMap_.containsKey(t)?r=this.audioInfoMap_.get(t):(r=new y(t),this.audioInfoMap_.put(t,r)),r){var a=r.obj;a&&(a.src=t,a.startTime=i,a.volume=n,a.loop=e,a.autoplay=o,a.play())}},e.prototype.addAudioCallback=function(t,e){if(this.audioInfoMap_.containsKey(t)){var i=this.audioInfoMap_.get(t);i.endCallback&&i.obj.offEnded(i.endCallback),i.endCallback=e,i.obj.onEnded(i.endCallback)}},e.prototype.resumeAudio=function(t){this.audioInfoMap_.containsKey(t)&&this.audioInfoMap_.get(t).obj.play()},e.prototype.pauseAudio=function(t){this.audioInfoMap_.containsKey(t)&&this.audioInfoMap_.get(t).obj.pause()},e.prototype.stopAudio=function(t){this.audioInfoMap_.containsKey(t)&&this.audioInfoMap_.get(t).obj.stop()},e.prototype.destroyAudio=function(t){if(this.audioInfoMap_.containsKey(t)){var e=this.audioInfoMap_.get(t);e.endCallback&&e.obj.offEnded(e.endCallback),e.obj.destroy(),this.audioInfoMap_.remove(t)}},e.prototype.onAudioInterruptionEnd=function(){wx.onAudioInterruptionEnd(function(){p.default.instance.eventManager.addEvent(u.EventType.kAudioResume)})},e.prototype.onShow=function(t){var e=this;void 0===t&&(t=!1),wx.onShow(function(i){p.default.instance.eventManager.addEvent(u.EventType.kAudioResume,null,{pauseType:2}),o.G.log("onShow"),e.onShowQueryCheck(i.query,t),e.normShareResult(),cc.director.resume(),f.GameUserInfo.calOfflineTime(),e.decideBannerClickSuc()})},e.prototype.onHide=function(){var t=this;wx.onHide(function(e){cc.director.pause(),p.default.instance.eventManager.addEvent(u.EventType.kAudioPause,null,{pauseType:2}),t.bannerStat(e),f.GameUserInfo.setOfflineTimestamp(),f.GameUserInfo.saveSignIn()})},e.prototype.triggerGC=function(){wx.triggerGC()},e.prototype.exitGame=function(){wx.exitMiniProgram({})},e.prototype.checkFileAccess=function(t,e,i){wx.getFileSystemManager().access({path:t,success:function(){e&&e()},fail:function(){i&&i()}})},e}(l.MinigamePlatDef);i.default=m;var y=function(){return function(t){this.obj=null,this.endCallback=null,this.obj=wx.createInnerAudioContext()}}(),v=function(){return function(t,e){this.closeCallback=null,this.errCallback=null,this.closeCallback=t,this.errCallback=e}}(),b=function(){function t(){this.id="",this.obj=null,this.errCb=null,this.adErrCallback=null,this.refreshRule=4,this.refreshCnt=0,this.x=0,this.y=0,this.w=0,this.h=0,this.bShow=!1,this.bLimited=!1}return t.prototype.show=function(){var t=this;this.obj&&(++this.refreshCnt,this.obj.show().then(function(e){console.log("banner show",t.id)}).catch(function(e){console.log("banner show err",e),++t.refreshCnt}),this.bShow=!0)},t.prototype.hide=function(){this.obj&&(this.obj.hide(),this.bShow=!1)},t.prototype.del=function(){this.obj&&(this.adErrCallback&&(this.obj.offError(this.adErrCallback),this.adErrCallback=null),this.obj.destroy())},t}();cc._RF.pop()},{"../data/data_hub":"data_hub","../game/user_info/user_info":"user_info","../game_logic":"game_logic","../game_setting":"game_setting","../game_ui/common/ad_sim_ui":"ad_sim_ui","../game_ui/game/ExportPnl":"ExportPnl","./event_mgr":"event_mgr","./global_def":"global_def","./mgp_def":"mgp_def","./mgp_util":"mgp_util","./network/http_req":"http_req","./storage":"storage","./timed_task":"timed_task"}]},{},["HDSDK","bonus_data","buff_data","data_hub","fairygui","ItemInfo","animation","archive","bottle","box_0","fire","hole","thorn","thornControl","cloud","coin","collItem","clock","enemy","EnemyFactory","boss0","boss1","cg_gun","cg_stick","jc_gun","jc_stick","enemyPoint","bulletEnemy","findPath","ghost","hero","heroLD","heroLX","heroPointLD","heroPointLX","heroPoint","house","lifeBase","npc","physicalBase","bigNodeManager","deathMath","apple","checken","food","platform","scenControl","shop","step","water","brick","bullet","darts","gun0","gun1","knife","weapon","bg","gameGuide","gameScene","home","pathFind","plot","uiControl","BlackMap","Map","data_control","nodePool_control","resource_control","storage_control","wordFactory","user_info","game_logic","game_setting","ad_sim_ui","base_ui","dialog_ui","export_ui","fgui_root","tip_ui","BonusData","EndLayer","ExportFriPnl","ExportPnl","GamePnl","HomePnl","PausePnl","ResultPnl","RevivePnl","SignInPnl","Store","StoryPnl","TaskPnl","TrialPnl","iconItem","repository","startScene","audio_mgr","shaker","ui_motion","event_mgr","global_def","mgp_def","mgp_util","http_req","statistic_tool","storage","hd_map","math_vec2","timed_task","transitions","wx_util"]);